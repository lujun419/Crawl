!
function($, w) {
    function BuildTGQ(a, b, c) {
        var d = a.length,
        e = ['<div class="tooltip-table tab-arrow">'];
        b && e.push("<div style='border-bottom: 1px solid #ccc;padding-left: 10px;padding-right: 10px;'>" + b + "</div>"),
        c && e.push('<div class="desc"><strong class="f-orange">' + c + "</strong></div>"),
        d > 1 && e.push($.tmpl.render('<div class="hd clearfix">{{each (index, item) list}}<a href="javascript:void(0);" data-index="${index}" class="xtab{{if index==0}} current{{/if}}">${item.Title}</a>{{/each}}<div class="slide-block" style="left: 10px; width: 98px; display: block;"><b></b></div></div>', {
            list: a
        }).replace("98px", 12 * a[0].Title.length + 20 + "px")),
        e.push('<div class="bd">');
        for (var f = 0; d > f; f++) {
            d > 1 && e.push('<div class="pane"' + (0 == f ? ' style="display:block;"': "") + ">"),
            e.push('<div class="flt-back"><table><tbody>');
            for (var g = a[f].Data, h = g.length, i = 0; h > i; i++) if (g[i].Type && "TodayFree" === g[i].Type) {
                var j = (window.pageGlobal.TodayFreeConfig, g[i].Title);
                e.push('<tr><td colspan="2">' + j + "</td></tr>")
            } else {
                var k = g[i],
                l = k.Title;
                if (k.Data) {
                    var m = ["<table" + ("\u8d2d\u7968\u987b\u77e5" == l ? ' class="min-height"': "") + "><tbody>"];
                    if ("HCP" === k.Type) {
                        for (; k.Data.length % 3 != 0;) k.Data.push(["", ""]);
                        for (var n = 0,
                        o = k.Data.length / 3; o > n; n++) for (var p = 0; 2 > p; p++) {
                            m.push("<tr>");
                            for (var q = 0; 3 > q; q++) m.push((0 == p ? "<th>": "<td>") + k.Data[3 * n + q][p] + (0 == n ? "</th>": "</td>"));
                            m.push("</tr>")
                        }
                    } else if ("NewBaggage" === k.Type && k.Data && k.Data.length) {
                        var r = online.getBaggageTip(k.Data, k.HasBaggageService);
                        m.push('<tr><td colspan="2" style="padding:0;">' + r + "</td></tr>")
                    } else for (var s = k.Data.length,
                    t = 0; s > t; t++) {
                        var u = k.Data[t],
                        v = u.length;
                        switch (v) {
                        case 2:
                            u[0] && u[0].length > 0 ? m.push('<tr><td class="col-sub">' + u[0] + "</td><td>" + u[1] + "</td></tr>") : m.push('<tr><td colspan="2">' + u[1] + "</td></tr>");
                            break;
                        case 3:
                        case 4:
                            t > 0 && v === k.Data[t - 1].length && (u.hideHead = 3 === v || u[2] === k.Data[t - 1][2]),
                            u[0] && u[0].length > 0 ? m.push('<tr><td class="col-sub">' + u[0] + '</td><td class="nopadding">' + $.tmpl.render(STABLE_TPL, {
                                item: u,
                                len: v
                            }) + "</td></tr>") : m.push('<tr><td class="nopadding" colspan="2">' + $.tmpl.render(STABLE_TPL, {
                                item: u,
                                len: v
                            }) + "</td></tr>")
                        }
                    }
                    m.push("</tbody></table>"),
                    e.push('<tr><th class="tit">' + l + '</th><td class="nopadding">' + m.join("") + "</td></tr>")
                } else k.Text ? e.push('<tr><th class="tit">' + l + "</td><td>" + k.Text + "</td></tr>") : e.push('<tr><td colspan="2">' + l + "</td></tr>")
            }
            e.push("</tbody></table></div>"),
            d > 1 && e.push("</div>")
        }
        return e.push("</div></div>"),
        e = e.join("").replace(/(&yen;)([\.\d]+)/g, '<span class="price"><dfn>$1</dfn>$2</span>')
    }
    function NewcomparePrice(a) {
        $.extend(this, a),
        this.PriceAttributeCompareKey = pageGlobal.PriceAttirbuteCompareKey || ["Restriction", "Penalties", "Baggageallowance", "Invoicetype", "Travelrisk"]
    }
    function Uniq(a) {
        $.extend(this, a),
        this.clear()
    }
    function initGiftTpl() {
        var a = document.createElement("div");
        a.id = "gift_list_tmpl",
        a.innerHTML = '{{if txt1.GiftDetailList.length == 1}}{{if txt1.GiftDetailList[0].DescriptionHtml != ""}}<div class="tooltip tooltip_no_padding" style="border:none">{{else}}<div class="tooltip" style="border:none">{{/if}}{{/if}}{{if txt1.GiftDetailList.length > 1}}<div class="tooltip" style="border:none"> {{/if}}<div class="tooltip-content"><div class="ttip_content">{{if txt1.GiftDetailList.length == 1 }}{{if txt1.GiftDetailList[0].GiftID == "-100" || txt1.GiftDetailList[0].GiftID == "-99" || txt1.GiftDetailList[0].GiftID == "-98" }}<div>${txt1.GiftDetailList[0].DescriptionHtml}</div>{{else}}{{if txt1.GiftDetailList[0].DescriptionHtml!=""}}<div style="line-height:1.5;"> ${txt1.GiftDetailList[0].DescriptionHtml}</div> <p style="text-align:right; margin-top: -10px; padding: 0 10px 10px;position: relative;z-index:9;background: #fff9ec;"><a href="javascript:;" onclick="online.showGiftInfoBox.call(this,\'${txt1.uid}\')" >\u67e5\u770b\u8be6\u60c5</a></p>{{else}} <p style="margin:0 0 10px 0; line-height:1.5;">${txt1.GiftDetailList[0].Description}</p><p style="text-align:right; line-height:1.5;margin:0px;"><a href="javascript:;" onclick="online.showGiftInfoBox.call(this,\'${txt1.uid}\')" >\u67e5\u770b\u8be6\u60c5</a></p>{{/if}}{{/if}}{{else}}{{if txt1.GiftDetailList.length - 1 != 0 }}<div class="gift_list"><ul>{{each (k, v) txt1.GiftDetailList}}<li><strong>\u793c\u76d2${["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03"][k]}\uff1a</strong>${v.Description}</li>{{/each}}</ul><p style=" margin:10px 0 0 0; text-align:right;"><a href="javascript:;" data-ubt-key="sGiftDetail" onclick="online.showGiftInfoBox.call(this,\'${txt1.uid}\')">\u67e5\u770b\u8be6\u60c5</a></p></div>{{/if}}{{/if}}</div></div></div>',
        a.style.display = "none",
        document.body.appendChild(a);
        var b = '<div id="gift_pop" class="base_pop" style="width:600px;display:none;"><div class="pop_hd"><a href="javascript:void(0);" class="delete" onclick="$(\'#gift_pop\').unmask();">\xd7</a><h3>\u793c\u76d2\u8be6\u60c5</h3></div><div class="pop_bd"><div id="pop_bd_ClassName" class=""> <!-- box_gift_detail \u6216\u8005 box_gift_tab --><div class="gift_content">    </div><div class="btn_outer"><input type="button" class="base_btns2 determine" onclick="$(\'#gift_pop\').unmask();" value="\u5173\u95ed"></div></div></div></div>',
        c = '<div id="gift_single" ><p class="gift_single_title"><strong>${d.GiftDetailList[0].Description}</strong></p><div class="gift_single_content">{{if d.GiftDetailList[0].DetailInfoHtml!=""}}${d.GiftDetailList[0].DetailInfoHtml} {{else}} ${d.GiftDetailList[0].DetailInfo} {{/if}}</div></div>',
        d = '<div id="gift_multi" >{{each (k, v) d.GiftDetailList}}<div class="item"><h4><strong>\u793c\u76d2${["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03"][k]}\uff1a</strong>${v.Description}<a href="javascript:;">\u66f4\u591a</a></h4><div class="item_con" style="display: none;">{{if v.DetailInfoHtml!=""}}${v.DetailInfoHtml} {{else}} ${v.DetailInfo} {{/if}}</div></div>{{/each}}</div>',
        e = document.createElement("div");
        e.id = "giftTplDiv",
        e.innerHTML = b + c + d,
        e.style.display = "none",
        document.body.appendChild(e)
    }
    function bindHotCountryEvent(a, b) {
        "true" == $("#destCity").attr("mod_hot_country") && a && ($("#destCity").getMod("address_poi", "2.0").method("bind", "change",
        function(c, d) {
            b(d && d.isCountry),
            d.data && a.hideTips()
        }), $("#destCity").getMod("address_poi", "2.0").method("bind", "userinput",
        function(b, c) {
            c && c.isCountry && (a.updateCountrySource(c.eventType), a.uploadUbt())
        }), $("#homeCity").getMod("address_poi", "2.0").method("bind", "change",
        function(c, d) {
            if (a.showed) {
                if (!a.checkIsMappingHotCountryPair()) return $("#destCity").getMod("address_poi", "2.0").method("select", ""),
                void b(!1);
                a.uploadUbt()
            }
            a.hideTips()
        }), window.dateTimeChangeEventListener = function() {
            a.uploadUbt()
        })
    }
    function showOrHideElementForHotCountry(a) {
        a ? ($("#ddate_form_group_country").show(), $("#ddate_form_group_city").hide(), $("#adate_form_group_city").hide(), $("#aChangeCity").hide(), $("#search-options-more").hide(), $("#hotCountrySearchBtn").show(), $("#btnSearch").hide(), hotCountryService.showed = !0) : ($("#ddate_form_group_country").hide(), $("#ddate_form_group_city").show(), $("#adate_form_group_city").show(), $("#aChangeCity").show(), $("#search-options-more").show(), $("#hotCountrySearchBtn").hide(), $("#btnSearch").show(), hotCountryService.showed = !1)
    } !
    function(a, b) {
        function c(a) {
            var b = oa[a] = {};
            return $.each(a.split(ba),
            function(a, c) {
                b[c] = !0
            }),
            b
        }
        function d(a, c, d) {
            if (d === b && 1 === a.nodeType) {
                var e = "data-" + c.replace(qa, "-$1").toLowerCase();
                if (d = a.getAttribute(e), "string" == typeof d) {
                    try {
                        d = "true" === d ? !0 : "false" === d ? !1 : "null" === d ? null: +d + "" === d ? +d: pa.test(d) ? $.parseJSON(d) : d
                    } catch(f) {}
                    $.data(a, c, d)
                } else d = b
            }
            return d
        }
        function e(a) {
            var b;
            for (b in a) if (("data" !== b || !$.isEmptyObject(a[b])) && "toJSON" !== b) return ! 1;
            return ! 0
        }
        function f() {
            return ! 1
        }
        function g() {
            return ! 0
        }
        function h(a) {
            return ! a || !a.parentNode || 11 === a.parentNode.nodeType
        }
        function i(a, b) {
            do a = a[b];
            while (a && 1 !== a.nodeType);
            return a
        }
        function j(a, b, c) {
            if (b = b || 0, $.isFunction(b)) return $.grep(a,
            function(a, d) {
                var e = !!b.call(a, d, a);
                return e === c
            });
            if (b.nodeType) return $.grep(a,
            function(a, d) {
                return a === b === c
            });
            if ("string" == typeof b) {
                var d = $.grep(a,
                function(a) {
                    return 1 === a.nodeType
                });
                if (Ka.test(b)) return $.filter(b, d, !c);
                b = $.filter(b, d)
            }
            return $.grep(a,
            function(a, d) {
                return $.inArray(a, b) >= 0 === c
            })
        }
        function k(a) {
            var b = Na.split("|"),
            c = a.createDocumentFragment();
            if (c.createElement) for (; b.length;) c.createElement(b.pop());
            return c
        }
        function l(a, b) {
            return a.getElementsByTagName(b)[0] || a.appendChild(a.ownerDocument.createElement(b))
        }
        function m(a, b) {
            if (1 === b.nodeType && $.hasData(a)) {
                var c, d, e, f = $._data(a),
                g = $._data(b, f),
                h = f.events;
                if (h) {
                    delete g.handle,
                    g.events = {};
                    for (c in h) for (d = 0, e = h[c].length; e > d; d++) $.event.add(b, c, h[c][d])
                }
                g.data && (g.data = $.extend({},
                g.data))
            }
        }
        function n(a, b) {
            var c;
            1 === b.nodeType && (b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), "object" === c ? (b.parentNode && (b.outerHTML = a.outerHTML), $.support.html5Clone && a.innerHTML && !$.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : "input" === c && Xa.test(a.type) ? (b.defaultChecked = b.checked = a.checked, b.value !== a.value && (b.value = a.value)) : "option" === c ? b.selected = a.defaultSelected: "input" === c || "textarea" === c ? b.defaultValue = a.defaultValue: "script" === c && b.text !== a.text && (b.text = a.text), b.removeAttribute($.expando))
        }
        function o(a) {
            return "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName("*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll("*") : []
        }
        function p(a) {
            Xa.test(a.type) && (a.defaultChecked = a.checked)
        }
        function q(a, b) {
            if (b in a) return b;
            for (var c = b.charAt(0).toUpperCase() + b.slice(1), d = b, e = rb.length; e--;) if (b = rb[e] + c, b in a) return b;
            return d
        }
        function r(a, b) {
            return a = b || a,
            "none" === $.css(a, "display") || !$.contains(a.ownerDocument, a)
        }
        function s(a, b) {
            for (var c, d, e = [], f = 0, g = a.length; g > f; f++) c = a[f],
            c.style && (e[f] = $._data(c, "olddisplay"), b ? (!e[f] && "none" === c.style.display && (c.style.display = ""), "" === c.style.display && r(c) && (e[f] = $._data(c, "olddisplay", w(c.nodeName)))) : (d = cb(c, "display"), !e[f] && "none" !== d && $._data(c, "olddisplay", d)));
            for (f = 0; g > f; f++) c = a[f],
            c.style && (b && "none" !== c.style.display && "" !== c.style.display || (c.style.display = b ? e[f] || "": "none"));
            return a
        }
        function t(a, b, c) {
            var d = kb.exec(b);
            return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b
        }
        function u(a, b, c, d) {
            for (var e = c === (d ? "border": "content") ? 4 : "width" === b ? 1 : 0, f = 0; 4 > e; e += 2)"margin" === c && (f += $.css(a, c + qb[e], !0)),
            d ? ("content" === c && (f -= parseFloat(cb(a, "padding" + qb[e])) || 0), "margin" !== c && (f -= parseFloat(cb(a, "border" + qb[e] + "Width")) || 0)) : (f += parseFloat(cb(a, "padding" + qb[e])) || 0, "padding" !== c && (f += parseFloat(cb(a, "border" + qb[e] + "Width")) || 0));
            return f
        }
        function v(a, b, c) {
            var d = "width" === b ? a.offsetWidth: a.offsetHeight,
            e = !0,
            f = $.support.boxSizing && "border-box" === $.css(a, "boxSizing");
            if (0 >= d || null == d) {
                if (d = cb(a, b), (0 > d || null == d) && (d = a.style[b]), lb.test(d)) return d;
                e = f && ($.support.boxSizingReliable || d === a.style[b]),
                d = parseFloat(d) || 0
            }
            return d + u(a, b, c || (f ? "border": "content"), e) + "px"
        }
        function w(a) {
            if (nb[a]) return nb[a];
            var b = $("<" + a + ">").appendTo(P.body),
            c = b.css("display");
            return b.remove(),
            ("none" === c || "" === c) && (db = P.body.appendChild(db || $.extend(P.createElement("iframe"), {
                frameBorder: 0,
                width: 0,
                height: 0
            })), eb && db.createElement || (eb = (db.contentWindow || db.contentDocument).document, eb.write("<!doctype html><html><body>"), eb.close()), b = eb.body.appendChild(eb.createElement(a)), c = cb(b, "display"), P.body.removeChild(db)),
            nb[a] = c,
            c
        }
        function x(a, b, c, d) {
            var e;
            if ($.isArray(b)) $.each(b,
            function(b, e) {
                c || ub.test(a) ? d(a, e) : x(a + "[" + ("object" == typeof e ? b: "") + "]", e, c, d)
            });
            else if (c || "object" !== $.type(b)) d(a, b);
            else for (e in b) x(a + "[" + e + "]", b[e], c, d)
        }
        function y(a) {
            return function(b, c) {
                "string" != typeof b && (c = b, b = "*");
                var d, e, f, g = b.toLowerCase().split(ba),
                h = 0,
                i = g.length;
                if ($.isFunction(c)) for (; i > h; h++) d = g[h],
                f = /^\+/.test(d),
                f && (d = d.substr(1) || "*"),
                e = a[d] = a[d] || [],
                e[f ? "unshift": "push"](c)
            }
        }
        function z(a, c, d, e, f, g) {
            f = f || c.dataTypes[0],
            g = g || {},
            g[f] = !0;
            for (var h, i = a[f], j = 0, k = i ? i.length: 0, l = a === Kb; k > j && (l || !h); j++) h = i[j](c, d, e),
            "string" == typeof h && (!l || g[h] ? h = b: (c.dataTypes.unshift(h), h = z(a, c, d, e, h, g)));
            return (l || !h) && !g["*"] && (h = z(a, c, d, e, "*", g)),
            h
        }
        function A(a, c) {
            var d, e, f = $.ajaxSettings.flatOptions || {};
            for (d in c) c[d] !== b && ((f[d] ? a: e || (e = {}))[d] = c[d]);
            e && $.extend(!0, a, e)
        }
        function B(a, c, d) {
            var e, f, g, h, i = a.contents,
            j = a.dataTypes,
            k = a.responseFields;
            for (f in k) f in d && (c[k[f]] = d[f]);
            for (;
            "*" === j[0];) j.shift(),
            e === b && (e = a.mimeType || c.getResponseHeader("content-type"));
            if (e) for (f in i) if (i[f] && i[f].test(e)) {
                j.unshift(f);
                break
            }
            if (j[0] in d) g = j[0];
            else {
                for (f in d) {
                    if (!j[0] || a.converters[f + " " + j[0]]) {
                        g = f;
                        break
                    }
                    h || (h = f)
                }
                g = g || h
            }
            return g ? (g !== j[0] && j.unshift(g), d[g]) : void 0
        }
        function C(a, b) {
            var c, d, e, f, g = a.dataTypes.slice(),
            h = g[0],
            i = {},
            j = 0;
            if (a.dataFilter && (b = a.dataFilter(b, a.dataType)), g[1]) for (c in a.converters) i[c.toLowerCase()] = a.converters[c];
            for (; e = g[++j];) if ("*" !== e) {
                if ("*" !== h && h !== e) {
                    if (c = i[h + " " + e] || i["* " + e], !c) for (d in i) if (f = d.split(" "), f[1] === e && (c = i[h + " " + f[0]] || i["* " + f[0]])) {
                        c === !0 ? c = i[d] : i[d] !== !0 && (e = f[0], g.splice(j--, 0, e));
                        break
                    }
                    if (c !== !0) if (c && a["throws"]) b = c(b);
                    else try {
                        b = c(b)
                    } catch(k) {
                        return {
                            state: "parsererror",
                            error: c ? k: "No conversion from " + h + " to " + e
                        }
                    }
                }
                h = e
            }
            return {
                state: "success",
                data: b
            }
        }
        function D() {
            try {
                return new a.XMLHttpRequest
            } catch(b) {}
        }
        function E() {
            try {
                return new a.ActiveXObject("Microsoft.XMLHTTP")
            } catch(b) {}
        }
        function F() {
            return setTimeout(function() {
                Vb = b
            },
            0),
            Vb = $.now()
        }
        function G(a, b) {
            $.each(b,
            function(b, c) {
                for (var d = (_b[b] || []).concat(_b["*"]), e = 0, f = d.length; f > e; e++) if (d[e].call(a, b, c)) return
            })
        }
        function H(a, b, c) {
            var d, e = 0,
            f = $b.length,
            g = $.Deferred().always(function() {
                delete h.elem
            }),
            h = function() {
                for (var b = Vb || F(), c = Math.max(0, i.startTime + i.duration - b), d = c / i.duration || 0, e = 1 - d, f = 0, h = i.tweens.length; h > f; f++) i.tweens[f].run(e);
                return g.notifyWith(a, [i, e, c]),
                1 > e && h ? c: (g.resolveWith(a, [i]), !1)
            },
            i = g.promise({
                elem: a,
                props: $.extend({},
                b),
                opts: $.extend(!0, {
                    specialEasing: {}
                },
                c),
                originalProperties: b,
                originalOptions: c,
                startTime: Vb || F(),
                duration: c.duration,
                tweens: [],
                createTween: function(b, c, d) {
                    var e = $.Tween(a, i.opts, b, c, i.opts.specialEasing[b] || i.opts.easing);
                    return i.tweens.push(e),
                    e
                },
                stop: function(b) {
                    for (var c = 0,
                    d = b ? i.tweens.length: 0; d > c; c++) i.tweens[c].run(1);
                    return b ? g.resolveWith(a, [i, b]) : g.rejectWith(a, [i, b]),
                    this
                }
            }),
            j = i.props;
            for (I(j, i.opts.specialEasing); f > e; e++) if (d = $b[e].call(i, a, j, i.opts)) return d;
            return G(i, j),
            $.isFunction(i.opts.start) && i.opts.start.call(a, i),
            $.fx.timer($.extend(h, {
                anim: i,
                queue: i.opts.queue,
                elem: a
            })),
            i.progress(i.opts.progress).done(i.opts.done, i.opts.complete).fail(i.opts.fail).always(i.opts.always)
        }
        function I(a, b) {
            var c, d, e, f, g;
            for (c in a) if (d = $.camelCase(c), e = b[d], f = a[c], $.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = $.cssHooks[d], g && "expand" in g) {
                f = g.expand(f),
                delete a[d];
                for (c in f) c in a || (a[c] = f[c], b[c] = e)
            } else b[d] = e
        }
        function J(a, b, c) {
            var d, e, f, g, h, i, j, k, l, m = this,
            n = a.style,
            o = {},
            p = [],
            q = a.nodeType && r(a);
            c.queue || (k = $._queueHooks(a, "fx"), null == k.unqueued && (k.unqueued = 0, l = k.empty.fire, k.empty.fire = function() {
                k.unqueued || l()
            }), k.unqueued++, m.always(function() {
                m.always(function() {
                    k.unqueued--,
                    $.queue(a, "fx").length || k.empty.fire()
                })
            })),
            1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [n.overflow, n.overflowX, n.overflowY], "inline" === $.css(a, "display") && "none" === $.css(a, "float") && ($.support.inlineBlockNeedsLayout && "inline" !== w(a.nodeName) ? n.zoom = 1 : n.display = "inline-block")),
            c.overflow && (n.overflow = "hidden", $.support.shrinkWrapBlocks || m.done(function() {
                n.overflow = c.overflow[0],
                n.overflowX = c.overflow[1],
                n.overflowY = c.overflow[2]
            }));
            for (d in b) if (f = b[d], Xb.exec(f)) {
                if (delete b[d], i = i || "toggle" === f, f === (q ? "hide": "show")) continue;
                p.push(d)
            }
            if (g = p.length) {
                h = $._data(a, "fxshow") || $._data(a, "fxshow", {}),
                "hidden" in h && (q = h.hidden),
                i && (h.hidden = !q),
                q ? $(a).show() : m.done(function() {
                    $(a).hide()
                }),
                m.done(function() {
                    var b;
                    $.removeData(a, "fxshow", !0);
                    for (b in o) $.style(a, b, o[b])
                });
                for (d = 0; g > d; d++) e = p[d],
                j = m.createTween(e, q ? h[e] : 0),
                o[e] = h[e] || $.style(a, e),
                e in h || (h[e] = j.start, q && (j.end = j.start, j.start = "width" === e || "height" === e ? 1 : 0))
            }
        }
        function K(a, b, c, d, e) {
            return new K.prototype.init(a, b, c, d, e)
        }
        function L(a, b) {
            var c, d = {
                height: a
            },
            e = 0;
            for (b = b ? 1 : 0; 4 > e; e += 2 - b) c = qb[e],
            d["margin" + c] = d["padding" + c] = a;
            return b && (d.opacity = d.width = a),
            d
        }
        function M(a) {
            return $.isWindow(a) ? a: 9 === a.nodeType ? a.defaultView || a.parentWindow: !1
        }
        var N, O, P = a.document,
        Q = a.location,
        R = a.navigator,
        S = a.jQuery,
        T = a.$,
        U = Array.prototype.push,
        V = Array.prototype.slice,
        W = Array.prototype.indexOf,
        X = Object.prototype.toString,
        Y = Object.prototype.hasOwnProperty,
        Z = String.prototype.trim,
        $ = function(a, b) {
            return new $.fn.init(a, b, N)
        },
        _ = /[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,
        aa = /\S/,
        ba = /\s+/,
        ca = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        da = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,
        ea = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
        fa = /^[\],:{}\s]*$/,
        ga = /(?:^|:|,)(?:\s*\[)+/g,
        ha = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
        ia = /"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,
        ja = /^-ms-/,
        ka = /-([\da-z])/gi,
        la = function(a, b) {
            return (b + "").toUpperCase()
        },
        ma = function() {
            P.addEventListener ? (P.removeEventListener("DOMContentLoaded", ma, !1), $.ready()) : "complete" === P.readyState && (P.detachEvent("onreadystatechange", ma), $.ready())
        },
        na = {};
        $.fn = $.prototype = {
            constructor: $,
            init: function(a, c, d) {
                var e, f, g;
                if (!a) return this;
                if (a.nodeType) return this.context = this[0] = a,
                this.length = 1,
                this;
                if ("string" == typeof a) {
                    if (e = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : da.exec(a), e && (e[1] || !c)) {
                        if (e[1]) return c = c instanceof $ ? c[0] : c,
                        g = c && c.nodeType ? c.ownerDocument || c: P,
                        a = $.parseHTML(e[1], g, !0),
                        ea.test(e[1]) && $.isPlainObject(c) && this.attr.call(a, c, !0),
                        $.merge(this, a);
                        if (f = P.getElementById(e[2]), f && f.parentNode) {
                            if (f.id !== e[2]) return d.find(a);
                            this.length = 1,
                            this[0] = f
                        }
                        return this.context = P,
                        this.selector = a,
                        this
                    }
                    return ! c || c.jquery ? (c || d).find(a) : this.constructor(c).find(a)
                }
                return $.isFunction(a) ? d.ready(a) : (a.selector !== b && (this.selector = a.selector, this.context = a.context), $.makeArray(a, this))
            },
            selector: "",
            jquery: "1.8.3",
            length: 0,
            size: function() {
                return this.length
            },
            toArray: function() {
                return V.call(this)
            },
            get: function(a) {
                return null == a ? this.toArray() : 0 > a ? this[this.length + a] : this[a]
            },
            pushStack: function(a, b, c) {
                var d = $.merge(this.constructor(), a);
                return d.prevObject = this,
                d.context = this.context,
                "find" === b ? d.selector = this.selector + (this.selector ? " ": "") + c: b && (d.selector = this.selector + "." + b + "(" + c + ")"),
                d
            },
            each: function(a, b) {
                return $.each(this, a, b)
            },
            ready: function(a) {
                return $.ready.promise().done(a),
                this
            },
            eq: function(a) {
                return a = +a,
                -1 === a ? this.slice(a) : this.slice(a, a + 1)
            },
            first: function() {
                return this.eq(0)
            },
            last: function() {
                return this.eq( - 1)
            },
            slice: function() {
                return this.pushStack(V.apply(this, arguments), "slice", V.call(arguments).join(","))
            },
            map: function(a) {
                return this.pushStack($.map(this,
                function(b, c) {
                    return a.call(b, c, b)
                }))
            },
            end: function() {
                return this.prevObject || this.constructor(null)
            },
            push: U,
            sort: [].sort,
            splice: [].splice
        },
        $.fn.init.prototype = $.fn,
        $.extend = $.fn.extend = function() {
            var a, c, d, e, f, g, h = arguments[0] || {},
            i = 1,
            j = arguments.length,
            k = !1;
            for ("boolean" == typeof h && (k = h, h = arguments[1] || {},
            i = 2), "object" != typeof h && !$.isFunction(h) && (h = {}), j === i && (h = this, --i); j > i; i++) if (null != (a = arguments[i])) for (c in a) d = h[c],
            e = a[c],
            h !== e && (k && e && ($.isPlainObject(e) || (f = $.isArray(e))) ? (f ? (f = !1, g = d && $.isArray(d) ? d: []) : g = d && $.isPlainObject(d) ? d: {},
            h[c] = $.extend(k, g, e)) : e !== b && (h[c] = e));
            return h
        },
        $.extend({
            noConflict: function(b) {
                return a.$ === $ && (a.$ = T),
                b && a.jQuery === $ && (a.jQuery = S),
                $
            },
            isReady: !1,
            readyWait: 1,
            holdReady: function(a) {
                a ? $.readyWait++:$.ready(!0)
            },
            ready: function(a) {
                if (a === !0 ? !--$.readyWait: !$.isReady) {
                    if (!P.body) return setTimeout($.ready, 1);
                    $.isReady = !0,
                    a !== !0 && --$.readyWait > 0 || (O.resolveWith(P, [$]), $.fn.trigger && $(P).trigger("ready").off("ready"))
                }
            },
            isFunction: function(a) {
                return "function" === $.type(a)
            },
            isArray: Array.isArray ||
            function(a) {
                return "array" === $.type(a)
            },
            isWindow: function(a) {
                return null != a && a == a.window
            },
            isNumeric: function(a) {
                return ! isNaN(parseFloat(a)) && isFinite(a)
            },
            type: function(a) {
                return null == a ? String(a) : na[X.call(a)] || "object"
            },
            isPlainObject: function(a) {
                if (!a || "object" !== $.type(a) || a.nodeType || $.isWindow(a)) return ! 1;
                try {
                    if (a.constructor && !Y.call(a, "constructor") && !Y.call(a.constructor.prototype, "isPrototypeOf")) return ! 1
                } catch(c) {
                    return ! 1
                }
                var d;
                for (d in a);
                return d === b || Y.call(a, d)
            },
            isEmptyObject: function(a) {
                var b;
                for (b in a) return ! 1;
                return ! 0
            },
            error: function(a) {
                throw new Error(a)
            },
            parseHTML: function(a, b, c) {
                var d;
                return a && "string" == typeof a ? ("boolean" == typeof b && (c = b, b = 0), b = b || P, (d = ea.exec(a)) ? [b.createElement(d[1])] : (d = $.buildFragment([a], b, c ? null: []), $.merge([], (d.cacheable ? $.clone(d.fragment) : d.fragment).childNodes))) : null
            },
            parseJSON: function(b) {
                return b && "string" == typeof b ? (b = $.trim(b), a.JSON && a.JSON.parse ? a.JSON.parse(b) : fa.test(b.replace(ha, "@").replace(ia, "]").replace(ga, "")) ? new Function("return " + b)() : void $.error("Invalid JSON: " + b)) : null
            },
            parseXML: function(c) {
                var d, e;
                if (!c || "string" != typeof c) return null;
                try {
                    a.DOMParser ? (e = new DOMParser, d = e.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c))
                } catch(f) {
                    d = b
                }
                return (!d || !d.documentElement || d.getElementsByTagName("parsererror").length) && $.error("Invalid XML: " + c),
                d
            },
            noop: function() {},
            globalEval: function(b) {
                b && aa.test(b) && (a.execScript ||
                function(b) {
                    a.eval.call(a, b)
                })(b)
            },
            camelCase: function(a) {
                return a.replace(ja, "ms-").replace(ka, la)
            },
            nodeName: function(a, b) {
                return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
            },
            each: function(a, c, d) {
                var e, f = 0,
                g = a.length,
                h = g === b || $.isFunction(a);
                if (d) if (h) {
                    for (e in a) if (c.apply(a[e], d) === !1) break
                } else for (; g > f && c.apply(a[f++], d) !== !1;);
                else if (h) {
                    for (e in a) if (c.call(a[e], e, a[e]) === !1) break
                } else for (; g > f && c.call(a[f], f, a[f++]) !== !1;);
                return a
            },
            trim: Z && !Z.call("\ufeff\xa0") ?
            function(a) {
                return null == a ? "": Z.call(a)
            }: function(a) {
                return null == a ? "": (a + "").replace(ca, "")
            },
            makeArray: function(a, b) {
                var c, d = b || [];
                return null != a && (c = $.type(a), null == a.length || "string" === c || "function" === c || "regexp" === c || $.isWindow(a) ? U.call(d, a) : $.merge(d, a)),
                d
            },
            inArray: function(a, b, c) {
                var d;
                if (b) {
                    if (W) return W.call(b, a, c);
                    for (d = b.length, c = c ? 0 > c ? Math.max(0, d + c) : c: 0; d > c; c++) if (c in b && b[c] === a) return c
                }
                return - 1
            },
            merge: function(a, c) {
                var d = c.length,
                e = a.length,
                f = 0;
                if ("number" == typeof d) for (; d > f; f++) a[e++] = c[f];
                else for (; c[f] !== b;) a[e++] = c[f++];
                return a.length = e,
                a
            },
            grep: function(a, b, c) {
                var d, e = [],
                f = 0,
                g = a.length;
                for (c = !!c; g > f; f++) d = !!b(a[f], f),
                c !== d && e.push(a[f]);
                return e
            },
            map: function(a, c, d) {
                var e, f, g = [],
                h = 0,
                i = a.length,
                j = a instanceof $ || i !== b && "number" == typeof i && (i > 0 && a[0] && a[i - 1] || 0 === i || $.isArray(a));
                if (j) for (; i > h; h++) e = c(a[h], h, d),
                null != e && (g[g.length] = e);
                else for (f in a) e = c(a[f], f, d),
                null != e && (g[g.length] = e);
                return g.concat.apply([], g)
            },
            guid: 1,
            proxy: function(a, c) {
                var d, e, f;
                return "string" == typeof c && (d = a[c], c = a, a = d),
                $.isFunction(a) ? (e = V.call(arguments, 2), f = function() {
                    return a.apply(c, e.concat(V.call(arguments)))
                },
                f.guid = a.guid = a.guid || $.guid++, f) : b
            },
            access: function(a, c, d, e, f, g, h) {
                var i, j = null == d,
                k = 0,
                l = a.length;
                if (d && "object" == typeof d) {
                    for (k in d) $.access(a, c, k, d[k], 1, g, e);
                    f = 1
                } else if (e !== b) {
                    if (i = h === b && $.isFunction(e), j && (i ? (i = c, c = function(a, b, c) {
                        return i.call($(a), c)
                    }) : (c.call(a, e), c = null)), c) for (; l > k; k++) c(a[k], d, i ? e.call(a[k], k, c(a[k], d)) : e, h);
                    f = 1
                }
                return f ? a: j ? c.call(a) : l ? c(a[0], d) : g
            },
            now: function() {
                return (new Date).getTime()
            }
        }),
        $.ready.promise = function(b) {
            if (!O) if (O = $.Deferred(), "complete" === P.readyState) setTimeout($.ready, 1);
            else if (P.addEventListener) P.addEventListener("DOMContentLoaded", ma, !1),
            a.addEventListener("load", $.ready, !1);
            else {
                P.attachEvent("onreadystatechange", ma),
                a.attachEvent("onload", $.ready);
                var c = !1;
                try {
                    c = null == a.frameElement && P.documentElement
                } catch(d) {}
                c && c.doScroll &&
                function e() {
                    if (!$.isReady) {
                        try {
                            c.doScroll("left")
                        } catch(a) {
                            return setTimeout(e, 50)
                        }
                        $.ready()
                    }
                } ()
            }
            return O.promise(b)
        },
        $.each("Boolean Number String Function Array Date RegExp Object".split(" "),
        function(a, b) {
            na["[object " + b + "]"] = b.toLowerCase()
        }),
        N = $(P);
        var oa = {};
        $.Callbacks = function(a) {
            a = "string" == typeof a ? oa[a] || c(a) : $.extend({},
            a);
            var d, e, f, g, h, i, j = [],
            k = !a.once && [],
            l = function(b) {
                for (d = a.memory && b, e = !0, i = g || 0, g = 0, h = j.length, f = !0; j && h > i; i++) if (j[i].apply(b[0], b[1]) === !1 && a.stopOnFalse) {
                    d = !1;
                    break
                }
                f = !1,
                j && (k ? k.length && l(k.shift()) : d ? j = [] : m.disable())
            },
            m = {
                add: function() {
                    if (j) {
                        var b = j.length; !
                        function c(b) {
                            $.each(b,
                            function(b, d) {
                                var e = $.type(d);
                                "function" === e ? (!a.unique || !m.has(d)) && j.push(d) : d && d.length && "string" !== e && c(d)
                            })
                        } (arguments),
                        f ? h = j.length: d && (g = b, l(d))
                    }
                    return this
                },
                remove: function() {
                    return j && $.each(arguments,
                    function(a, b) {
                        for (var c; (c = $.inArray(b, j, c)) > -1;) j.splice(c, 1),
                        f && (h >= c && h--, i >= c && i--)
                    }),
                    this
                },
                has: function(a) {
                    return $.inArray(a, j) > -1
                },
                empty: function() {
                    return j = [],
                    this
                },
                disable: function() {
                    return j = k = d = b,
                    this
                },
                disabled: function() {
                    return ! j
                },
                lock: function() {
                    return k = b,
                    d || m.disable(),
                    this
                },
                locked: function() {
                    return ! k
                },
                fireWith: function(a, b) {
                    return b = b || [],
                    b = [a, b.slice ? b.slice() : b],
                    j && (!e || k) && (f ? k.push(b) : l(b)),
                    this
                },
                fire: function() {
                    return m.fireWith(this, arguments),
                    this
                },
                fired: function() {
                    return !! e
                }
            };
            return m
        },
        $.extend({
            Deferred: function(a) {
                var b = [["resolve", "done", $.Callbacks("once memory"), "resolved"], ["reject", "fail", $.Callbacks("once memory"), "rejected"], ["notify", "progress", $.Callbacks("memory")]],
                c = "pending",
                d = {
                    state: function() {
                        return c
                    },
                    always: function() {
                        return e.done(arguments).fail(arguments),
                        this
                    },
                    then: function() {
                        var a = arguments;
                        return $.Deferred(function(c) {
                            $.each(b,
                            function(b, d) {
                                var f = d[0],
                                g = a[b];
                                e[d[1]]($.isFunction(g) ?
                                function() {
                                    var a = g.apply(this, arguments);
                                    a && $.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[f + "With"](this === e ? c: this, [a])
                                }: c[f])
                            }),
                            a = null
                        }).promise()
                    },
                    promise: function(a) {
                        return null != a ? $.extend(a, d) : d
                    }
                },
                e = {};
                return d.pipe = d.then,
                $.each(b,
                function(a, f) {
                    var g = f[2],
                    h = f[3];
                    d[f[1]] = g.add,
                    h && g.add(function() {
                        c = h
                    },
                    b[1 ^ a][2].disable, b[2][2].lock),
                    e[f[0]] = g.fire,
                    e[f[0] + "With"] = g.fireWith
                }),
                d.promise(e),
                a && a.call(e, e),
                e
            },
            when: function(a) {
                var b, c, d, e = 0,
                f = V.call(arguments),
                g = f.length,
                h = 1 !== g || a && $.isFunction(a.promise) ? g: 0,
                i = 1 === h ? a: $.Deferred(),
                j = function(a, c, d) {
                    return function(e) {
                        c[a] = this,
                        d[a] = arguments.length > 1 ? V.call(arguments) : e,
                        d === b ? i.notifyWith(c, d) : --h || i.resolveWith(c, d)
                    }
                };
                if (g > 1) for (b = new Array(g), c = new Array(g), d = new Array(g); g > e; e++) f[e] && $.isFunction(f[e].promise) ? f[e].promise().done(j(e, d, f)).fail(i.reject).progress(j(e, c, b)) : --h;
                return h || i.resolveWith(d, f),
                i.promise()
            }
        }),
        $.support = function() {
            var b, c, d, e, f, g, h, i, j, k, l, m = P.createElement("div");
            if (m.setAttribute("className", "t"), m.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", c = m.getElementsByTagName("*"), d = m.getElementsByTagName("a")[0], !c || !d || !c.length) return {};
            e = P.createElement("select"),
            f = e.appendChild(P.createElement("option")),
            g = m.getElementsByTagName("input")[0],
            d.style.cssText = "top:1px;float:left;opacity:.5",
            b = {
                leadingWhitespace: 3 === m.firstChild.nodeType,
                tbody: !m.getElementsByTagName("tbody").length,
                htmlSerialize: !!m.getElementsByTagName("link").length,
                style: /top/.test(d.getAttribute("style")),
                hrefNormalized: "/a" === d.getAttribute("href"),
                opacity: /^0.5/.test(d.style.opacity),
                cssFloat: !!d.style.cssFloat,
                checkOn: "on" === g.value,
                optSelected: f.selected,
                getSetAttribute: "t" !== m.className,
                enctype: !!P.createElement("form").enctype,
                html5Clone: "<:nav></:nav>" !== P.createElement("nav").cloneNode(!0).outerHTML,
                boxModel: "CSS1Compat" === P.compatMode,
                submitBubbles: !0,
                changeBubbles: !0,
                focusinBubbles: !1,
                deleteExpando: !0,
                noCloneEvent: !0,
                inlineBlockNeedsLayout: !1,
                shrinkWrapBlocks: !1,
                reliableMarginRight: !0,
                boxSizingReliable: !0,
                pixelPosition: !1
            },
            g.checked = !0,
            b.noCloneChecked = g.cloneNode(!0).checked,
            e.disabled = !0,
            b.optDisabled = !f.disabled;
            try {
                delete m.test
            } catch(n) {
                b.deleteExpando = !1
            }
            if (!m.addEventListener && m.attachEvent && m.fireEvent && (m.attachEvent("onclick", l = function() {
                b.noCloneEvent = !1
            }), m.cloneNode(!0).fireEvent("onclick"), m.detachEvent("onclick", l)), g = P.createElement("input"), g.value = "t", g.setAttribute("type", "radio"), b.radioValue = "t" === g.value, g.setAttribute("checked", "checked"), g.setAttribute("name", "t"), m.appendChild(g), h = P.createDocumentFragment(), h.appendChild(m.lastChild), b.checkClone = h.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = g.checked, h.removeChild(g), h.appendChild(m), m.attachEvent) for (j in {
                submit: !0,
                change: !0,
                focusin: !0
            }) i = "on" + j,
            k = i in m,
            k || (m.setAttribute(i, "return;"), k = "function" == typeof m[i]),
            b[j + "Bubbles"] = k;
            return $(function() {
                var c, d, e, f, g = "padding:0;margin:0;border:0;display:block;overflow:hidden;",
                h = P.getElementsByTagName("body")[0];
                h && (c = P.createElement("div"), c.style.cssText = "visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px", h.insertBefore(c, h.firstChild), d = P.createElement("div"), c.appendChild(d), d.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", e = d.getElementsByTagName("td"), e[0].style.cssText = "padding:0;margin:0;border:0;display:none", k = 0 === e[0].offsetHeight, e[0].style.display = "", e[1].style.display = "none", b.reliableHiddenOffsets = k && 0 === e[0].offsetHeight, d.innerHTML = "", d.style.cssText = "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;", b.boxSizing = 4 === d.offsetWidth, b.doesNotIncludeMarginInBodyOffset = 1 !== h.offsetTop, a.getComputedStyle && (b.pixelPosition = "1%" !== (a.getComputedStyle(d, null) || {}).top, b.boxSizingReliable = "4px" === (a.getComputedStyle(d, null) || {
                    width: "4px"
                }).width, f = P.createElement("div"), f.style.cssText = d.style.cssText = g, f.style.marginRight = f.style.width = "0", d.style.width = "1px", d.appendChild(f), b.reliableMarginRight = !parseFloat((a.getComputedStyle(f, null) || {}).marginRight)), "undefined" != typeof d.style.zoom && (d.innerHTML = "", d.style.cssText = g + "width:1px;padding:1px;display:inline;zoom:1", b.inlineBlockNeedsLayout = 3 === d.offsetWidth, d.style.display = "block", d.style.overflow = "visible", d.innerHTML = "<div></div>", d.firstChild.style.width = "5px", b.shrinkWrapBlocks = 3 !== d.offsetWidth, c.style.zoom = 1), h.removeChild(c), c = d = e = f = null)
            }),
            h.removeChild(m),
            c = d = e = f = g = h = m = null,
            b
        } ();
        var pa = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
        qa = /([A-Z])/g;
        $.extend({
            cache: {},
            deletedIds: [],
            uuid: 0,
            expando: "jQuery" + ($.fn.jquery + Math.random()).replace(/\D/g, ""),
            noData: {
                embed: !0,
                object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
                applet: !0
            },
            hasData: function(a) {
                return a = a.nodeType ? $.cache[a[$.expando]] : a[$.expando],
                !!a && !e(a)
            },
            data: function(a, c, d, e) {
                if ($.acceptData(a)) {
                    var f, g, h = $.expando,
                    i = "string" == typeof c,
                    j = a.nodeType,
                    k = j ? $.cache: a,
                    l = j ? a[h] : a[h] && h;
                    if (l && k[l] && (e || k[l].data) || !i || d !== b) return l || (j ? a[h] = l = $.deletedIds.pop() || $.guid++:l = h),
                    k[l] || (k[l] = {},
                    j || (k[l].toJSON = $.noop)),
                    ("object" == typeof c || "function" == typeof c) && (e ? k[l] = $.extend(k[l], c) : k[l].data = $.extend(k[l].data, c)),
                    f = k[l],
                    e || (f.data || (f.data = {}), f = f.data),
                    d !== b && (f[$.camelCase(c)] = d),
                    i ? (g = f[c], null == g && (g = f[$.camelCase(c)])) : g = f,
                    g
                }
            },
            removeData: function(a, b, c) {
                if ($.acceptData(a)) {
                    var d, f, g, h = a.nodeType,
                    i = h ? $.cache: a,
                    j = h ? a[$.expando] : $.expando;
                    if (i[j]) {
                        if (b && (d = c ? i[j] : i[j].data)) {
                            $.isArray(b) || (b in d ? b = [b] : (b = $.camelCase(b), b = b in d ? [b] : b.split(" ")));
                            for (f = 0, g = b.length; g > f; f++) delete d[b[f]];
                            if (! (c ? e: $.isEmptyObject)(d)) return
                        } (c || (delete i[j].data, e(i[j]))) && (h ? $.cleanData([a], !0) : $.support.deleteExpando || i != i.window ? delete i[j] : i[j] = null)
                    }
                }
            },
            _data: function(a, b, c) {
                return $.data(a, b, c, !0)
            },
            acceptData: function(a) {
                var b = a.nodeName && $.noData[a.nodeName.toLowerCase()];
                return ! b || b !== !0 && a.getAttribute("classid") === b
            }
        }),
        $.fn.extend({
            data: function(a, c) {
                var e, f, g, h, i, j = this[0],
                k = 0,
                l = null;
                if (a === b) {
                    if (this.length && (l = $.data(j), 1 === j.nodeType && !$._data(j, "parsedAttrs"))) {
                        for (g = j.attributes, i = g.length; i > k; k++) h = g[k].name,
                        h.indexOf("data-") || (h = $.camelCase(h.substring(5)), d(j, h, l[h]));
                        $._data(j, "parsedAttrs", !0)
                    }
                    return l
                }
                return "object" == typeof a ? this.each(function() {
                    $.data(this, a)
                }) : (e = a.split(".", 2), e[1] = e[1] ? "." + e[1] : "", f = e[1] + "!", $.access(this,
                function(c) {
                    return c === b ? (l = this.triggerHandler("getData" + f, [e[0]]), l === b && j && (l = $.data(j, a), l = d(j, a, l)), l === b && e[1] ? this.data(e[0]) : l) : (e[1] = c, void this.each(function() {
                        var b = $(this);
                        b.triggerHandler("setData" + f, e),
                        $.data(this, a, c),
                        b.triggerHandler("changeData" + f, e)
                    }))
                },
                null, c, arguments.length > 1, null, !1))
            },
            removeData: function(a) {
                return this.each(function() {
                    $.removeData(this, a)
                })
            }
        }),
        $.extend({
            queue: function(a, b, c) {
                var d;
                return a ? (b = (b || "fx") + "queue", d = $._data(a, b), c && (!d || $.isArray(c) ? d = $._data(a, b, $.makeArray(c)) : d.push(c)), d || []) : void 0
            },
            dequeue: function(a, b) {
                b = b || "fx";
                var c = $.queue(a, b),
                d = c.length,
                e = c.shift(),
                f = $._queueHooks(a, b),
                g = function() {
                    $.dequeue(a, b)
                };
                "inprogress" === e && (e = c.shift(), d--),
                e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)),
                !d && f && f.empty.fire()
            },
            _queueHooks: function(a, b) {
                var c = b + "queueHooks";
                return $._data(a, c) || $._data(a, c, {
                    empty: $.Callbacks("once memory").add(function() {
                        $.removeData(a, b + "queue", !0),
                        $.removeData(a, c, !0)
                    })
                })
            }
        }),
        $.fn.extend({
            queue: function(a, c) {
                var d = 2;
                return "string" != typeof a && (c = a, a = "fx", d--),
                arguments.length < d ? $.queue(this[0], a) : c === b ? this: this.each(function() {
                    var b = $.queue(this, a, c);
                    $._queueHooks(this, a),
                    "fx" === a && "inprogress" !== b[0] && $.dequeue(this, a)
                })
            },
            dequeue: function(a) {
                return this.each(function() {
                    $.dequeue(this, a)
                })
            },
            delay: function(a, b) {
                return a = $.fx ? $.fx.speeds[a] || a: a,
                b = b || "fx",
                this.queue(b,
                function(b, c) {
                    var d = setTimeout(b, a);
                    c.stop = function() {
                        clearTimeout(d)
                    }
                })
            },
            clearQueue: function(a) {
                return this.queue(a || "fx", [])
            },
            promise: function(a, c) {
                var d, e = 1,
                f = $.Deferred(),
                g = this,
                h = this.length,
                i = function() {--e || f.resolveWith(g, [g])
                };
                for ("string" != typeof a && (c = a, a = b), a = a || "fx"; h--;) d = $._data(g[h], a + "queueHooks"),
                d && d.empty && (e++, d.empty.add(i));
                return i(),
                f.promise(c)
            }
        });
        var ra, sa, ta, ua = /[\t\r\n]/g,
        va = /\r/g,
        wa = /^(?:button|input)$/i,
        xa = /^(?:button|input|object|select|textarea)$/i,
        ya = /^a(?:rea|)$/i,
        za = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
        Aa = $.support.getSetAttribute;
        $.fn.extend({
            attr: function(a, b) {
                return $.access(this, $.attr, a, b, arguments.length > 1)
            },
            removeAttr: function(a) {
                return this.each(function() {
                    $.removeAttr(this, a)
                })
            },
            prop: function(a, b) {
                return $.access(this, $.prop, a, b, arguments.length > 1)
            },
            removeProp: function(a) {
                return a = $.propFix[a] || a,
                this.each(function() {
                    try {
                        this[a] = b,
                        delete this[a]
                    } catch(c) {}
                })
            },
            addClass: function(a) {
                var b, c, d, e, f, g, h;
                if ($.isFunction(a)) return this.each(function(b) {
                    $(this).addClass(a.call(this, b, this.className))
                });
                if (a && "string" == typeof a) for (b = a.split(ba), c = 0, d = this.length; d > c; c++) if (e = this[c], 1 === e.nodeType) if (e.className || 1 !== b.length) {
                    for (f = " " + e.className + " ", g = 0, h = b.length; h > g; g++) f.indexOf(" " + b[g] + " ") < 0 && (f += b[g] + " ");
                    e.className = $.trim(f)
                } else e.className = a;
                return this
            },
            removeClass: function(a) {
                var c, d, e, f, g, h, i;
                if ($.isFunction(a)) return this.each(function(b) {
                    $(this).removeClass(a.call(this, b, this.className))
                });
                if (a && "string" == typeof a || a === b) for (c = (a || "").split(ba), h = 0, i = this.length; i > h; h++) if (e = this[h], 1 === e.nodeType && e.className) {
                    for (d = (" " + e.className + " ").replace(ua, " "), f = 0, g = c.length; g > f; f++) for (; d.indexOf(" " + c[f] + " ") >= 0;) d = d.replace(" " + c[f] + " ", " ");
                    e.className = a ? $.trim(d) : ""
                }
                return this
            },
            toggleClass: function(a, b) {
                var c = typeof a,
                d = "boolean" == typeof b;
                return $.isFunction(a) ? this.each(function(c) {
                    $(this).toggleClass(a.call(this, c, this.className, b), b)
                }) : this.each(function() {
                    if ("string" === c) for (var e, f = 0,
                    g = $(this), h = b, i = a.split(ba); e = i[f++];) h = d ? h: !g.hasClass(e),
                    g[h ? "addClass": "removeClass"](e);
                    else("undefined" === c || "boolean" === c) && (this.className && $._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "": $._data(this, "__className__") || "")
                })
            },
            hasClass: function(a) {
                for (var b = " " + a + " ",
                c = 0,
                d = this.length; d > c; c++) if (1 === this[c].nodeType && (" " + this[c].className + " ").replace(ua, " ").indexOf(b) >= 0) return ! 0;
                return ! 1
            },
            val: function(a) {
                var c, d, e, f = this[0]; {
                    if (arguments.length) return e = $.isFunction(a),
                    this.each(function(d) {
                        var f, g = $(this);
                        1 === this.nodeType && (f = e ? a.call(this, d, g.val()) : a, null == f ? f = "": "number" == typeof f ? f += "": $.isArray(f) && (f = $.map(f,
                        function(a) {
                            return null == a ? "": a + ""
                        })), c = $.valHooks[this.type] || $.valHooks[this.nodeName.toLowerCase()], c && "set" in c && c.set(this, f, "value") !== b || (this.value = f))
                    });
                    if (f) return c = $.valHooks[f.type] || $.valHooks[f.nodeName.toLowerCase()],
                    c && "get" in c && (d = c.get(f, "value")) !== b ? d: (d = f.value, "string" == typeof d ? d.replace(va, "") : null == d ? "": d)
                }
            }
        }),
        $.extend({
            valHooks: {
                option: {
                    get: function(a) {
                        var b = a.attributes.value;
                        return ! b || b.specified ? a.value: a.text
                    }
                },
                select: {
                    get: function(a) {
                        for (var b, c, d = a.options,
                        e = a.selectedIndex,
                        f = "select-one" === a.type || 0 > e,
                        g = f ? null: [], h = f ? e + 1 : d.length, i = 0 > e ? h: f ? e: 0; h > i; i++) if (c = d[i], (c.selected || i === e) && ($.support.optDisabled ? !c.disabled: null === c.getAttribute("disabled")) && (!c.parentNode.disabled || !$.nodeName(c.parentNode, "optgroup"))) {
                            if (b = $(c).val(), f) return b;
                            g.push(b)
                        }
                        return g
                    },
                    set: function(a, b) {
                        var c = $.makeArray(b);
                        return $(a).find("option").each(function() {
                            this.selected = $.inArray($(this).val(), c) >= 0
                        }),
                        c.length || (a.selectedIndex = -1),
                        c
                    }
                }
            },
            attrFn: {},
            attr: function(a, c, d, e) {
                var f, g, h, i = a.nodeType;
                if (a && 3 !== i && 8 !== i && 2 !== i) return e && $.isFunction($.fn[c]) ? $(a)[c](d) : "undefined" == typeof a.getAttribute ? $.prop(a, c, d) : (h = 1 !== i || !$.isXMLDoc(a), h && (c = c.toLowerCase(), g = $.attrHooks[c] || (za.test(c) ? sa: ra)), d !== b ? null === d ? void $.removeAttr(a, c) : g && "set" in g && h && (f = g.set(a, d, c)) !== b ? f: (a.setAttribute(c, d + ""), d) : g && "get" in g && h && null !== (f = g.get(a, c)) ? f: (f = a.getAttribute(c), null === f ? b: f))
            },
            removeAttr: function(a, b) {
                var c, d, e, f, g = 0;
                if (b && 1 === a.nodeType) for (d = b.split(ba); g < d.length; g++) e = d[g],
                e && (c = $.propFix[e] || e, f = za.test(e), f || $.attr(a, e, ""), a.removeAttribute(Aa ? e: c), f && c in a && (a[c] = !1))
            },
            attrHooks: {
                type: {
                    set: function(a, b) {
                        if (wa.test(a.nodeName) && a.parentNode) $.error("type property can't be changed");
                        else if (!$.support.radioValue && "radio" === b && $.nodeName(a, "input")) {
                            var c = a.value;
                            return a.setAttribute("type", b),
                            c && (a.value = c),
                            b
                        }
                    }
                },
                value: {
                    get: function(a, b) {
                        return ra && $.nodeName(a, "button") ? ra.get(a, b) : b in a ? a.value: null
                    },
                    set: function(a, b, c) {
                        return ra && $.nodeName(a, "button") ? ra.set(a, b, c) : void(a.value = b)
                    }
                }
            },
            propFix: {
                tabindex: "tabIndex",
                readonly: "readOnly",
                "for": "htmlFor",
                "class": "className",
                maxlength: "maxLength",
                cellspacing: "cellSpacing",
                cellpadding: "cellPadding",
                rowspan: "rowSpan",
                colspan: "colSpan",
                usemap: "useMap",
                frameborder: "frameBorder",
                contenteditable: "contentEditable"
            },
            prop: function(a, c, d) {
                var e, f, g, h = a.nodeType;
                if (a && 3 !== h && 8 !== h && 2 !== h) return g = 1 !== h || !$.isXMLDoc(a),
                g && (c = $.propFix[c] || c, f = $.propHooks[c]),
                d !== b ? f && "set" in f && (e = f.set(a, d, c)) !== b ? e: a[c] = d: f && "get" in f && null !== (e = f.get(a, c)) ? e: a[c]
            },
            propHooks: {
                tabIndex: {
                    get: function(a) {
                        var c = a.getAttributeNode("tabindex");
                        return c && c.specified ? parseInt(c.value, 10) : xa.test(a.nodeName) || ya.test(a.nodeName) && a.href ? 0 : b
                    }
                }
            }
        }),
        sa = {
            get: function(a, c) {
                var d, e = $.prop(a, c);
                return e === !0 || "boolean" != typeof e && (d = a.getAttributeNode(c)) && d.nodeValue !== !1 ? c.toLowerCase() : b
            },
            set: function(a, b, c) {
                var d;
                return b === !1 ? $.removeAttr(a, c) : (d = $.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase())),
                c
            }
        },
        Aa || (ta = {
            name: !0,
            id: !0,
            coords: !0
        },
        ra = $.valHooks.button = {
            get: function(a, c) {
                var d;
                return d = a.getAttributeNode(c),
                d && (ta[c] ? "" !== d.value: d.specified) ? d.value: b
            },
            set: function(a, b, c) {
                var d = a.getAttributeNode(c);
                return d || (d = P.createAttribute(c), a.setAttributeNode(d)),
                d.value = b + ""
            }
        },
        $.each(["width", "height"],
        function(a, b) {
            $.attrHooks[b] = $.extend($.attrHooks[b], {
                set: function(a, c) {
                    return "" === c ? (a.setAttribute(b, "auto"), c) : void 0
                }
            })
        }), $.attrHooks.contenteditable = {
            get: ra.get,
            set: function(a, b, c) {
                "" === b && (b = "false"),
                ra.set(a, b, c)
            }
        }),
        $.support.hrefNormalized || $.each(["href", "src", "width", "height"],
        function(a, c) {
            $.attrHooks[c] = $.extend($.attrHooks[c], {
                get: function(a) {
                    var d = a.getAttribute(c, 2);
                    return null === d ? b: d
                }
            })
        }),
        $.support.style || ($.attrHooks.style = {
            get: function(a) {
                return a.style.cssText.toLowerCase() || b
            },
            set: function(a, b) {
                return a.style.cssText = b + ""
            }
        }),
        $.support.optSelected || ($.propHooks.selected = $.extend($.propHooks.selected, {
            get: function(a) {
                var b = a.parentNode;
                return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex),
                null
            }
        })),
        $.support.enctype || ($.propFix.enctype = "encoding"),
        $.support.checkOn || $.each(["radio", "checkbox"],
        function() {
            $.valHooks[this] = {
                get: function(a) {
                    return null === a.getAttribute("value") ? "on": a.value
                }
            }
        }),
        $.each(["radio", "checkbox"],
        function() {
            $.valHooks[this] = $.extend($.valHooks[this], {
                set: function(a, b) {
                    return $.isArray(b) ? a.checked = $.inArray($(a).val(), b) >= 0 : void 0
                }
            })
        });
        var Ba = /^(?:textarea|input|select)$/i,
        Ca = /^([^\.]*|)(?:\.(.+)|)$/,
        Da = /(?:^|\s)hover(\.\S+|)\b/,
        Ea = /^key/,
        Fa = /^(?:mouse|contextmenu)|click/,
        Ga = /^(?:focusinfocus|focusoutblur)$/,
        Ha = function(a) {
            return $.event.special.hover ? a: a.replace(Da, "mouseenter$1 mouseleave$1")
        };
        $.event = {
            add: function(a, c, d, e, f) {
                var g, h, i, j, k, l, m, n, o, p, q;
                if (3 !== a.nodeType && 8 !== a.nodeType && c && d && (g = $._data(a))) {
                    for (d.handler && (o = d, d = o.handler, f = o.selector), d.guid || (d.guid = $.guid++), i = g.events, i || (g.events = i = {}), h = g.handle, h || (g.handle = h = function(a) {
                        return "undefined" == typeof $ || a && $.event.triggered === a.type ? b: $.event.dispatch.apply(h.elem, arguments)
                    },
                    h.elem = a), c = $.trim(Ha(c)).split(" "), j = 0; j < c.length; j++) k = Ca.exec(c[j]) || [],
                    l = k[1],
                    m = (k[2] || "").split(".").sort(),
                    q = $.event.special[l] || {},
                    l = (f ? q.delegateType: q.bindType) || l,
                    q = $.event.special[l] || {},
                    n = $.extend({
                        type: l,
                        origType: k[1],
                        data: e,
                        handler: d,
                        guid: d.guid,
                        selector: f,
                        needsContext: f && $.expr.match.needsContext.test(f),
                        namespace: m.join(".")
                    },
                    o),
                    p = i[l],
                    p || (p = i[l] = [], p.delegateCount = 0, q.setup && q.setup.call(a, e, m, h) !== !1 || (a.addEventListener ? a.addEventListener(l, h, !1) : a.attachEvent && a.attachEvent("on" + l, h))),
                    q.add && (q.add.call(a, n), n.handler.guid || (n.handler.guid = d.guid)),
                    f ? p.splice(p.delegateCount++, 0, n) : p.push(n),
                    $.event.global[l] = !0;
                    a = null
                }
            },
            global: {},
            remove: function(a, b, c, d, e) {
                var f, g, h, i, j, k, l, m, n, o, p, q = $.hasData(a) && $._data(a);
                if (q && (m = q.events)) {
                    for (b = $.trim(Ha(b || "")).split(" "), f = 0; f < b.length; f++) if (g = Ca.exec(b[f]) || [], h = i = g[1], j = g[2], h) {
                        for (n = $.event.special[h] || {},
                        h = (d ? n.delegateType: n.bindType) || h, o = m[h] || [], k = o.length, j = j ? new RegExp("(^|\\.)" + j.split(".").sort().join("\\.(?:.*\\.|)") + "(\\.|$)") : null, l = 0; l < o.length; l++) p = o[l],
                        (e || i === p.origType) && (!c || c.guid === p.guid) && (!j || j.test(p.namespace)) && (!d || d === p.selector || "**" === d && p.selector) && (o.splice(l--, 1), p.selector && o.delegateCount--, n.remove && n.remove.call(a, p));
                        0 === o.length && k !== o.length && ((!n.teardown || n.teardown.call(a, j, q.handle) === !1) && $.removeEvent(a, h, q.handle), delete m[h])
                    } else for (h in m) $.event.remove(a, h + b[f], c, d, !0);
                    $.isEmptyObject(m) && (delete q.handle, $.removeData(a, "events", !0))
                }
            },
            customEvent: {
                getData: !0,
                setData: !0,
                changeData: !0
            },
            trigger: function(c, d, e, f) {
                if (!e || 3 !== e.nodeType && 8 !== e.nodeType) {
                    var g, h, i, j, k, l, m, n, o, p, q = c.type || c,
                    r = [];
                    if (Ga.test(q + $.event.triggered)) return;
                    if (q.indexOf("!") >= 0 && (q = q.slice(0, -1), h = !0), q.indexOf(".") >= 0 && (r = q.split("."), q = r.shift(), r.sort()), (!e || $.event.customEvent[q]) && !$.event.global[q]) return;
                    if (c = "object" == typeof c ? c[$.expando] ? c: new $.Event(q, c) : new $.Event(q), c.type = q, c.isTrigger = !0, c.exclusive = h, c.namespace = r.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + r.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, l = q.indexOf(":") < 0 ? "on" + q: "", !e) {
                        g = $.cache;
                        for (i in g) g[i].events && g[i].events[q] && $.event.trigger(c, d, g[i].handle.elem, !0);
                        return
                    }
                    if (c.result = b, c.target || (c.target = e), d = null != d ? $.makeArray(d) : [], d.unshift(c), m = $.event.special[q] || {},
                    m.trigger && m.trigger.apply(e, d) === !1) return;
                    if (o = [[e, m.bindType || q]], !f && !m.noBubble && !$.isWindow(e)) {
                        for (p = m.delegateType || q, j = Ga.test(p + q) ? e: e.parentNode, k = e; j; j = j.parentNode) o.push([j, p]),
                        k = j;
                        k === (e.ownerDocument || P) && o.push([k.defaultView || k.parentWindow || a, p])
                    }
                    for (i = 0; i < o.length && !c.isPropagationStopped(); i++) j = o[i][0],
                    c.type = o[i][1],
                    n = ($._data(j, "events") || {})[c.type] && $._data(j, "handle"),
                    n && n.apply(j, d),
                    n = l && j[l],
                    n && $.acceptData(j) && n.apply && n.apply(j, d) === !1 && c.preventDefault();
                    return c.type = q,
                    !f && !c.isDefaultPrevented() && (!m._default || m._default.apply(e.ownerDocument, d) === !1) && ("click" !== q || !$.nodeName(e, "a")) && $.acceptData(e) && l && e[q] && ("focus" !== q && "blur" !== q || 0 !== c.target.offsetWidth) && !$.isWindow(e) && (k = e[l], k && (e[l] = null), $.event.triggered = q, e[q](), $.event.triggered = b, k && (e[l] = k)),
                    c.result
                }
            },
            dispatch: function(c) {
                c = $.event.fix(c || a.event);
                var d, e, f, g, h, i, j, k, l, m = ($._data(this, "events") || {})[c.type] || [],
                n = m.delegateCount,
                o = V.call(arguments),
                p = !c.exclusive && !c.namespace,
                q = $.event.special[c.type] || {},
                r = [];
                if (o[0] = c, c.delegateTarget = this, !q.preDispatch || q.preDispatch.call(this, c) !== !1) {
                    if (n && (!c.button || "click" !== c.type)) for (f = c.target; f != this; f = f.parentNode || this) if (f.disabled !== !0 || "click" !== c.type) {
                        for (h = {},
                        j = [], d = 0; n > d; d++) k = m[d],
                        l = k.selector,
                        h[l] === b && (h[l] = k.needsContext ? $(l, this).index(f) >= 0 : $.find(l, this, null, [f]).length),
                        h[l] && j.push(k);
                        j.length && r.push({
                            elem: f,
                            matches: j
                        })
                    }
                    for (m.length > n && r.push({
                        elem: this,
                        matches: m.slice(n)
                    }), d = 0; d < r.length && !c.isPropagationStopped(); d++) for (i = r[d], c.currentTarget = i.elem, e = 0; e < i.matches.length && !c.isImmediatePropagationStopped(); e++) k = i.matches[e],
                    (p || !c.namespace && !k.namespace || c.namespace_re && c.namespace_re.test(k.namespace)) && (c.data = k.data, c.handleObj = k, g = (($.event.special[k.origType] || {}).handle || k.handler).apply(i.elem, o), g !== b && (c.result = g, g === !1 && (c.preventDefault(), c.stopPropagation())));
                    return q.postDispatch && q.postDispatch.call(this, c),
                    c.result
                }
            },
            props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
            fixHooks: {},
            keyHooks: {
                props: "char charCode key keyCode".split(" "),
                filter: function(a, b) {
                    return null == a.which && (a.which = null != b.charCode ? b.charCode: b.keyCode),
                    a
                }
            },
            mouseHooks: {
                props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                filter: function(a, c) {
                    var d, e, f, g = c.button,
                    h = c.fromElement;
                    return null == a.pageX && null != c.clientX && (d = a.target.ownerDocument || P, e = d.documentElement, f = d.body, a.pageX = c.clientX + (e && e.scrollLeft || f && f.scrollLeft || 0) - (e && e.clientLeft || f && f.clientLeft || 0), a.pageY = c.clientY + (e && e.scrollTop || f && f.scrollTop || 0) - (e && e.clientTop || f && f.clientTop || 0)),
                    !a.relatedTarget && h && (a.relatedTarget = h === a.target ? c.toElement: h),
                    !a.which && g !== b && (a.which = 1 & g ? 1 : 2 & g ? 3 : 4 & g ? 2 : 0),
                    a
                }
            },
            fix: function(a) {
                if (a[$.expando]) return a;
                var b, c, d = a,
                e = $.event.fixHooks[a.type] || {},
                f = e.props ? this.props.concat(e.props) : this.props;
                for (a = $.Event(d), b = f.length; b;) c = f[--b],
                a[c] = d[c];
                return a.target || (a.target = d.srcElement || P),
                3 === a.target.nodeType && (a.target = a.target.parentNode),
                a.metaKey = !!a.metaKey,
                e.filter ? e.filter(a, d) : a
            },
            special: {
                load: {
                    noBubble: !0
                },
                focus: {
                    delegateType: "focusin"
                },
                blur: {
                    delegateType: "focusout"
                },
                beforeunload: {
                    setup: function(a, b, c) {
                        $.isWindow(this) && (this.onbeforeunload = c)
                    },
                    teardown: function(a, b) {
                        this.onbeforeunload === b && (this.onbeforeunload = null)
                    }
                }
            },
            simulate: function(a, b, c, d) {
                var e = $.extend(new $.Event, c, {
                    type: a,
                    isSimulated: !0,
                    originalEvent: {}
                });
                d ? $.event.trigger(e, null, b) : $.event.dispatch.call(b, e),
                e.isDefaultPrevented() && c.preventDefault()
            }
        },
        $.event.handle = $.event.dispatch,
        $.removeEvent = P.removeEventListener ?
        function(a, b, c) {
            a.removeEventListener && a.removeEventListener(b, c, !1)
        }: function(a, b, c) {
            var d = "on" + b;
            a.detachEvent && ("undefined" == typeof a[d] && (a[d] = null), a.detachEvent(d, c))
        },
        $.Event = function(a, b) {
            return this instanceof $.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault() ? g: f) : this.type = a, b && $.extend(this, b), this.timeStamp = a && a.timeStamp || $.now(), this[$.expando] = !0, void 0) : new $.Event(a, b)
        },
        $.Event.prototype = {
            preventDefault: function() {
                this.isDefaultPrevented = g;
                var a = this.originalEvent;
                a && (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
            },
            stopPropagation: function() {
                this.isPropagationStopped = g;
                var a = this.originalEvent;
                a && (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
            },
            stopImmediatePropagation: function() {
                this.isImmediatePropagationStopped = g,
                this.stopPropagation()
            },
            isDefaultPrevented: f,
            isPropagationStopped: f,
            isImmediatePropagationStopped: f
        },
        $.each({
            mouseenter: "mouseover",
            mouseleave: "mouseout"
        },
        function(a, b) {
            $.event.special[a] = {
                delegateType: b,
                bindType: b,
                handle: function(a) {
                    var c, d = this,
                    e = a.relatedTarget,
                    f = a.handleObj;
                    f.selector;
                    return (!e || e !== d && !$.contains(d, e)) && (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b),
                    c
                }
            }
        }),
        $.support.submitBubbles || ($.event.special.submit = {
            setup: function() {
                return $.nodeName(this, "form") ? !1 : void $.event.add(this, "click._submit keypress._submit",
                function(a) {
                    var c = a.target,
                    d = $.nodeName(c, "input") || $.nodeName(c, "button") ? c.form: b;
                    d && !$._data(d, "_submit_attached") && ($.event.add(d, "submit._submit",
                    function(a) {
                        a._submit_bubble = !0
                    }), $._data(d, "_submit_attached", !0))
                })
            },
            postDispatch: function(a) {
                a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && $.event.simulate("submit", this.parentNode, a, !0))
            },
            teardown: function() {
                return $.nodeName(this, "form") ? !1 : void $.event.remove(this, "._submit")
            }
        }),
        $.support.changeBubbles || ($.event.special.change = {
            setup: function() {
                return Ba.test(this.nodeName) ? (("checkbox" === this.type || "radio" === this.type) && ($.event.add(this, "propertychange._change",
                function(a) {
                    "checked" === a.originalEvent.propertyName && (this._just_changed = !0)
                }), $.event.add(this, "click._change",
                function(a) {
                    this._just_changed && !a.isTrigger && (this._just_changed = !1),
                    $.event.simulate("change", this, a, !0)
                })), !1) : void $.event.add(this, "beforeactivate._change",
                function(a) {
                    var b = a.target;
                    Ba.test(b.nodeName) && !$._data(b, "_change_attached") && ($.event.add(b, "change._change",
                    function(a) {
                        this.parentNode && !a.isSimulated && !a.isTrigger && $.event.simulate("change", this.parentNode, a, !0)
                    }), $._data(b, "_change_attached", !0))
                })
            },
            handle: function(a) {
                var b = a.target;
                return this !== b || a.isSimulated || a.isTrigger || "radio" !== b.type && "checkbox" !== b.type ? a.handleObj.handler.apply(this, arguments) : void 0
            },
            teardown: function() {
                return $.event.remove(this, "._change"),
                !Ba.test(this.nodeName)
            }
        }),
        $.support.focusinBubbles || $.each({
            focus: "focusin",
            blur: "focusout"
        },
        function(a, b) {
            var c = 0,
            d = function(a) {
                $.event.simulate(b, a.target, $.event.fix(a), !0)
            };
            $.event.special[b] = {
                setup: function() {
                    0 === c++&&P.addEventListener(a, d, !0)
                },
                teardown: function() {
                    0 === --c && P.removeEventListener(a, d, !0)
                }
            }
        }),
        $.fn.extend({
            on: function(a, c, d, e, g) {
                var h, i;
                if ("object" == typeof a) {
                    "string" != typeof c && (d = d || c, c = b);
                    for (i in a) this.on(i, c, d, a[i], g);
                    return this
                }
                if (null == d && null == e ? (e = c, d = c = b) : null == e && ("string" == typeof c ? (e = d, d = b) : (e = d, d = c, c = b)), e === !1) e = f;
                else if (!e) return this;
                return 1 === g && (h = e, e = function(a) {
                    return $().off(a),
                    h.apply(this, arguments)
                },
                e.guid = h.guid || (h.guid = $.guid++)),
                this.each(function() {
                    $.event.add(this, a, e, d, c)
                })
            },
            one: function(a, b, c, d) {
                return this.on(a, b, c, d, 1)
            },
            off: function(a, c, d) {
                var e, g;
                if (a && a.preventDefault && a.handleObj) return e = a.handleObj,
                $(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace: e.origType, e.selector, e.handler),
                this;
                if ("object" == typeof a) {
                    for (g in a) this.off(g, c, a[g]);
                    return this
                }
                return (c === !1 || "function" == typeof c) && (d = c, c = b),
                d === !1 && (d = f),
                this.each(function() {
                    $.event.remove(this, a, d, c)
                })
            },
            bind: function(a, b, c) {
                return this.on(a, null, b, c)
            },
            unbind: function(a, b) {
                return this.off(a, null, b)
            },
            live: function(a, b, c) {
                return $(this.context).on(a, this.selector, b, c),
                this
            },
            die: function(a, b) {
                return $(this.context).off(a, this.selector || "**", b),
                this
            },
            delegate: function(a, b, c, d) {
                return this.on(b, a, c, d)
            },
            undelegate: function(a, b, c) {
                return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
            },
            trigger: function(a, b) {
                return this.each(function() {
                    $.event.trigger(a, b, this)
                })
            },
            triggerHandler: function(a, b) {
                return this[0] ? $.event.trigger(a, b, this[0], !0) : void 0
            },
            toggle: function(a) {
                var b = arguments,
                c = a.guid || $.guid++,
                d = 0,
                e = function(c) {
                    var e = ($._data(this, "lastToggle" + a.guid) || 0) % d;
                    return $._data(this, "lastToggle" + a.guid, e + 1),
                    c.preventDefault(),
                    b[e].apply(this, arguments) || !1
                };
                for (e.guid = c; d < b.length;) b[d++].guid = c;
                return this.click(e)
            },
            hover: function(a, b) {
                return this.mouseenter(a).mouseleave(b || a)
            }
        }),
        $.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
        function(a, b) {
            $.fn[b] = function(a, c) {
                return null == c && (c = a, a = null),
                arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
            },
            Ea.test(b) && ($.event.fixHooks[b] = $.event.keyHooks),
            Fa.test(b) && ($.event.fixHooks[b] = $.event.mouseHooks)
        }),
        function(a, b) {
            function c(a, b, c, d) {
                c = c || [],
                b = b || F;
                var e, f, g, h, i = b.nodeType;
                if (!a || "string" != typeof a) return c;
                if (1 !== i && 9 !== i) return [];
                if (g = v(b), !g && !d && (e = ca.exec(a))) if (h = e[1]) {
                    if (9 === i) {
                        if (f = b.getElementById(h), !f || !f.parentNode) return c;
                        if (f.id === h) return c.push(f),
                        c
                    } else if (b.ownerDocument && (f = b.ownerDocument.getElementById(h)) && w(b, f) && f.id === h) return c.push(f),
                    c
                } else {
                    if (e[2]) return K.apply(c, L.call(b.getElementsByTagName(a), 0)),
                    c;
                    if ((h = e[3]) && ma && b.getElementsByClassName) return K.apply(c, L.call(b.getElementsByClassName(h), 0)),
                    c
                }
                return p(a.replace(Z, "$1"), b, c, d, g)
            }
            function d(a) {
                return function(b) {
                    var c = b.nodeName.toLowerCase();
                    return "input" === c && b.type === a
                }
            }
            function e(a) {
                return function(b) {
                    var c = b.nodeName.toLowerCase();
                    return ("input" === c || "button" === c) && b.type === a
                }
            }
            function f(a) {
                return N(function(b) {
                    return b = +b,
                    N(function(c, d) {
                        for (var e, f = a([], c.length, b), g = f.length; g--;) c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                    })
                })
            }
            function g(a, b, c) {
                if (a === b) return c;
                for (var d = a.nextSibling; d;) {
                    if (d === b) return - 1;
                    d = d.nextSibling
                }
                return 1
            }
            function h(a, b) {
                var d, e, f, g, h, i, j, k = Q[D][a + " "];
                if (k) return b ? 0 : k.slice(0);
                for (h = a, i = [], j = t.preFilter; h;) { (!d || (e = _.exec(h))) && (e && (h = h.slice(e[0].length) || h), i.push(f = [])),
                    d = !1,
                    (e = aa.exec(h)) && (f.push(d = new E(e.shift())), h = h.slice(d.length), d.type = e[0].replace(Z, " "));
                    for (g in t.filter)(e = ha[g].exec(h)) && (!j[g] || (e = j[g](e))) && (f.push(d = new E(e.shift())), h = h.slice(d.length), d.type = g, d.matches = e);
                    if (!d) break
                }
                return b ? h.length: h ? c.error(a) : Q(a, i).slice(0)
            }
            function i(a, b, c) {
                var d = b.dir,
                e = c && "parentNode" === b.dir,
                f = I++;
                return b.first ?
                function(b, c, f) {
                    for (; b = b[d];) if (e || 1 === b.nodeType) return a(b, c, f)
                }: function(b, c, g) {
                    if (g) {
                        for (; b = b[d];) if ((e || 1 === b.nodeType) && a(b, c, g)) return b
                    } else for (var h, i = H + " " + f + " ",
                    j = i + r; b = b[d];) if (e || 1 === b.nodeType) {
                        if ((h = b[D]) === j) return b.sizset;
                        if ("string" == typeof h && 0 === h.indexOf(i)) {
                            if (b.sizset) return b
                        } else {
                            if (b[D] = j, a(b, c, g)) return b.sizset = !0,
                            b;
                            b.sizset = !1
                        }
                    }
                }
            }
            function j(a) {
                return a.length > 1 ?
                function(b, c, d) {
                    for (var e = a.length; e--;) if (!a[e](b, c, d)) return ! 1;
                    return ! 0
                }: a[0]
            }
            function k(a, b, c, d, e) {
                for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++)(f = a[h]) && (!c || c(f, d, e)) && (g.push(f), j && b.push(h));
                return g
            }
            function l(a, b, c, d, e, f) {
                return d && !d[D] && (d = l(d)),
                e && !e[D] && (e = l(e, f)),
                N(function(f, g, h, i) {
                    var j, l, m, n = [],
                    p = [],
                    q = g.length,
                    r = f || o(b || "*", h.nodeType ? [h] : h, []),
                    s = !a || !f && b ? r: k(r, n, a, h, i),
                    t = c ? e || (f ? a: q || d) ? [] : g: s;
                    if (c && c(s, t, h, i), d) for (j = k(t, p), d(j, [], h, i), l = j.length; l--;)(m = j[l]) && (t[p[l]] = !(s[p[l]] = m));
                    if (f) {
                        if (e || a) {
                            if (e) {
                                for (j = [], l = t.length; l--;)(m = t[l]) && j.push(s[l] = m);
                                e(null, t = [], j, i)
                            }
                            for (l = t.length; l--;)(m = t[l]) && (j = e ? M.call(f, m) : n[l]) > -1 && (f[j] = !(g[j] = m))
                        }
                    } else t = k(t === g ? t.splice(q, t.length) : t),
                    e ? e(null, g, t, i) : K.apply(g, t)
                })
            }
            function m(a) {
                for (var b, c, d, e = a.length,
                f = t.relative[a[0].type], g = f || t.relative[" "], h = f ? 1 : 0, k = i(function(a) {
                    return a === b
                },
                g, !0), n = i(function(a) {
                    return M.call(b, a) > -1
                },
                g, !0), o = [function(a, c, d) {
                    return ! f && (d || c !== A) || ((b = c).nodeType ? k(a, c, d) : n(a, c, d))
                }]; e > h; h++) if (c = t.relative[a[h].type]) o = [i(j(o), c)];
                else {
                    if (c = t.filter[a[h].type].apply(null, a[h].matches), c[D]) {
                        for (d = ++h; e > d && !t.relative[a[d].type]; d++);
                        return l(h > 1 && j(o), h > 1 && a.slice(0, h - 1).join("").replace(Z, "$1"), c, d > h && m(a.slice(h, d)), e > d && m(a = a.slice(d)), e > d && a.join(""))
                    }
                    o.push(c)
                }
                return j(o)
            }
            function n(a, b) {
                var d = b.length > 0,
                e = a.length > 0,
                f = function(g, h, i, j, l) {
                    var m, n, o, p = [],
                    q = 0,
                    s = "0",
                    u = g && [],
                    v = null != l,
                    w = A,
                    x = g || e && t.find.TAG("*", l && h.parentNode || h),
                    y = H += null == w ? 1 : Math.E;
                    for (v && (A = h !== F && h, r = f.el); null != (m = x[s]); s++) {
                        if (e && m) {
                            for (n = 0; o = a[n]; n++) if (o(m, h, i)) {
                                j.push(m);
                                break
                            }
                            v && (H = y, r = ++f.el)
                        }
                        d && ((m = !o && m) && q--, g && u.push(m))
                    }
                    if (q += s, d && s !== q) {
                        for (n = 0; o = b[n]; n++) o(u, p, h, i);
                        if (g) {
                            if (q > 0) for (; s--;) ! u[s] && !p[s] && (p[s] = J.call(j));
                            p = k(p)
                        }
                        K.apply(j, p),
                        v && !g && p.length > 0 && q + b.length > 1 && c.uniqueSort(j)
                    }
                    return v && (H = y, A = w),
                    u
                };
                return f.el = 0,
                d ? N(f) : f
            }
            function o(a, b, d) {
                for (var e = 0,
                f = b.length; f > e; e++) c(a, b[e], d);
                return d
            }
            function p(a, b, c, d, e) {
                var f, g, i, j, k, l = h(a);
                l.length;
                if (!d && 1 === l.length) {
                    if (g = l[0] = l[0].slice(0), g.length > 2 && "ID" === (i = g[0]).type && 9 === b.nodeType && !e && t.relative[g[1].type]) {
                        if (b = t.find.ID(i.matches[0].replace(ga, ""), b, e)[0], !b) return c;
                        a = a.slice(g.shift().length)
                    }
                    for (f = ha.POS.test(a) ? -1 : g.length - 1; f >= 0 && (i = g[f], !t.relative[j = i.type]); f--) if ((k = t.find[j]) && (d = k(i.matches[0].replace(ga, ""), da.test(g[0].type) && b.parentNode || b, e))) {
                        if (g.splice(f, 1), a = d.length && g.join(""), !a) return K.apply(c, L.call(d, 0)),
                        c;
                        break
                    }
                }
                return x(a, l)(d, b, e, c, da.test(a)),
                c
            }
            function q() {}
            var r, s, t, u, v, w, x, y, z, A, B = !0,
            C = "undefined",
            D = ("sizcache" + Math.random()).replace(".", ""),
            E = String,
            F = a.document,
            G = F.documentElement,
            H = 0,
            I = 0,
            J = [].pop,
            K = [].push,
            L = [].slice,
            M = [].indexOf ||
            function(a) {
                for (var b = 0,
                c = this.length; c > b; b++) if (this[b] === a) return b;
                return - 1
            },
            N = function(a, b) {
                return a[D] = null == b || b,
                a
            },
            O = function() {
                var a = {},
                b = [];
                return N(function(c, d) {
                    return b.push(c) > t.cacheLength && delete a[b.shift()],
                    a[c + " "] = d
                },
                a)
            },
            P = O(),
            Q = O(),
            R = O(),
            S = "[\\x20\\t\\r\\n\\f]",
            T = "(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",
            U = T.replace("w", "w#"),
            V = "([*^$|!~]?=)",
            W = "\\[" + S + "*(" + T + ")" + S + "*(?:" + V + S + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + U + ")|)|)" + S + "*\\]",
            X = ":(" + T + ")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:" + W + ")|[^:]|\\\\.)*|.*))\\)|)",
            Y = ":(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + S + "*((?:-\\d)?\\d*)" + S + "*\\)|)(?=[^-]|$)",
            Z = new RegExp("^" + S + "+|((?:^|[^\\\\])(?:\\\\.)*)" + S + "+$", "g"),
            _ = new RegExp("^" + S + "*," + S + "*"),
            aa = new RegExp("^" + S + "*([\\x20\\t\\r\\n\\f>+~])" + S + "*"),
            ba = new RegExp(X),
            ca = /^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,
            da = /[\x20\t\r\n\f]*[+~]/,
            ea = /h\d/i,
            fa = /input|select|textarea|button/i,
            ga = /\\(?!\\)/g,
            ha = {
                ID: new RegExp("^#(" + T + ")"),
                CLASS: new RegExp("^\\.(" + T + ")"),
                NAME: new RegExp("^\\[name=['\"]?(" + T + ")['\"]?\\]"),
                TAG: new RegExp("^(" + T.replace("w", "w*") + ")"),
                ATTR: new RegExp("^" + W),
                PSEUDO: new RegExp("^" + X),
                POS: new RegExp(Y, "i"),
                CHILD: new RegExp("^:(only|nth|first|last)-child(?:\\(" + S + "*(even|odd|(([+-]|)(\\d*)n|)" + S + "*(?:([+-]|)" + S + "*(\\d+)|))" + S + "*\\)|)", "i"),
                needsContext: new RegExp("^" + S + "*[>+~]|" + Y, "i")
            },
            ia = function(a) {
                var b = F.createElement("div");
                try {
                    return a(b)
                } catch(c) {
                    return ! 1
                } finally {
                    b = null
                }
            },
            ja = ia(function(a) {
                return a.appendChild(F.createComment("")),
                !a.getElementsByTagName("*").length
            }),
            ka = ia(function(a) {
                return a.innerHTML = "<a href='#'></a>",
                a.firstChild && typeof a.firstChild.getAttribute !== C && "#" === a.firstChild.getAttribute("href")
            }),
            la = ia(function(a) {
                a.innerHTML = "<select></select>";
                var b = typeof a.lastChild.getAttribute("multiple");
                return "boolean" !== b && "string" !== b
            }),
            ma = ia(function(a) {
                return a.innerHTML = "<div class='hidden e'></div><div class='hidden'></div>",
                a.getElementsByClassName && a.getElementsByClassName("e").length ? (a.lastChild.className = "e", 2 === a.getElementsByClassName("e").length) : !1
            }),
            na = ia(function(a) {
                a.id = D + 0,
                a.innerHTML = "<a name='" + D + "'></a><div name='" + D + "'></div>",
                G.insertBefore(a, G.firstChild);
                var b = F.getElementsByName && F.getElementsByName(D).length === 2 + F.getElementsByName(D + 0).length;
                return s = !F.getElementById(D),
                G.removeChild(a),
                b
            });
            try {
                L.call(G.childNodes, 0)[0].nodeType
            } catch(oa) {
                L = function(a) {
                    for (var b, c = []; b = this[a]; a++) c.push(b);
                    return c
                }
            }
            c.matches = function(a, b) {
                return c(a, null, null, b)
            },
            c.matchesSelector = function(a, b) {
                return c(b, null, null, [a]).length > 0
            },
            u = c.getText = function(a) {
                var b, c = "",
                d = 0,
                e = a.nodeType;
                if (e) {
                    if (1 === e || 9 === e || 11 === e) {
                        if ("string" == typeof a.textContent) return a.textContent;
                        for (a = a.firstChild; a; a = a.nextSibling) c += u(a)
                    } else if (3 === e || 4 === e) return a.nodeValue
                } else for (; b = a[d]; d++) c += u(b);
                return c
            },
            v = c.isXML = function(a) {
                var b = a && (a.ownerDocument || a).documentElement;
                return b ? "HTML" !== b.nodeName: !1
            },
            w = c.contains = G.contains ?
            function(a, b) {
                var c = 9 === a.nodeType ? a.documentElement: a,
                d = b && b.parentNode;
                return a === d || !!(d && 1 === d.nodeType && c.contains && c.contains(d))
            }: G.compareDocumentPosition ?
            function(a, b) {
                return b && !!(16 & a.compareDocumentPosition(b))
            }: function(a, b) {
                for (; b = b.parentNode;) if (b === a) return ! 0;
                return ! 1
            },
            c.attr = function(a, b) {
                var c, d = v(a);
                return d || (b = b.toLowerCase()),
                (c = t.attrHandle[b]) ? c(a) : d || la ? a.getAttribute(b) : (c = a.getAttributeNode(b), c ? "boolean" == typeof a[b] ? a[b] ? b: null: c.specified ? c.value: null: null)
            },
            t = c.selectors = {
                cacheLength: 50,
                createPseudo: N,
                match: ha,
                attrHandle: ka ? {}: {
                    href: function(a) {
                        return a.getAttribute("href", 2)
                    },
                    type: function(a) {
                        return a.getAttribute("type")
                    }
                },
                find: {
                    ID: s ?
                    function(a, b, c) {
                        if (typeof b.getElementById !== C && !c) {
                            var d = b.getElementById(a);
                            return d && d.parentNode ? [d] : []
                        }
                    }: function(a, c, d) {
                        if (typeof c.getElementById !== C && !d) {
                            var e = c.getElementById(a);
                            return e ? e.id === a || typeof e.getAttributeNode !== C && e.getAttributeNode("id").value === a ? [e] : b: []
                        }
                    },
                    TAG: ja ?
                    function(a, b) {
                        return typeof b.getElementsByTagName !== C ? b.getElementsByTagName(a) : void 0
                    }: function(a, b) {
                        var c = b.getElementsByTagName(a);
                        if ("*" === a) {
                            for (var d, e = [], f = 0; d = c[f]; f++) 1 === d.nodeType && e.push(d);
                            return e
                        }
                        return c
                    },
                    NAME: na &&
                    function(a, b) {
                        return typeof b.getElementsByName !== C ? b.getElementsByName(name) : void 0
                    },
                    CLASS: ma &&
                    function(a, b, c) {
                        return typeof b.getElementsByClassName === C || c ? void 0 : b.getElementsByClassName(a)
                    }
                },
                relative: {
                    ">": {
                        dir: "parentNode",
                        first: !0
                    },
                    " ": {
                        dir: "parentNode"
                    },
                    "+": {
                        dir: "previousSibling",
                        first: !0
                    },
                    "~": {
                        dir: "previousSibling"
                    }
                },
                preFilter: {
                    ATTR: function(a) {
                        return a[1] = a[1].replace(ga, ""),
                        a[3] = (a[4] || a[5] || "").replace(ga, ""),
                        "~=" === a[2] && (a[3] = " " + a[3] + " "),
                        a.slice(0, 4)
                    },
                    CHILD: function(a) {
                        return a[1] = a[1].toLowerCase(),
                        "nth" === a[1] ? (a[2] || c.error(a[0]), a[3] = +(a[3] ? a[4] + (a[5] || 1) : 2 * ("even" === a[2] || "odd" === a[2])), a[4] = +(a[6] + a[7] || "odd" === a[2])) : a[2] && c.error(a[0]),
                        a
                    },
                    PSEUDO: function(a) {
                        var b, c;
                        return ha.CHILD.test(a[0]) ? null: (a[3] ? a[2] = a[3] : (b = a[4]) && (ba.test(b) && (c = h(b, !0)) && (c = b.indexOf(")", b.length - c) - b.length) && (b = b.slice(0, c), a[0] = a[0].slice(0, c)), a[2] = b), a.slice(0, 3))
                    }
                },
                filter: {
                    ID: s ?
                    function(a) {
                        return a = a.replace(ga, ""),
                        function(b) {
                            return b.getAttribute("id") === a
                        }
                    }: function(a) {
                        return a = a.replace(ga, ""),
                        function(b) {
                            var c = typeof b.getAttributeNode !== C && b.getAttributeNode("id");
                            return c && c.value === a
                        }
                    },
                    TAG: function(a) {
                        return "*" === a ?
                        function() {
                            return ! 0
                        }: (a = a.replace(ga, "").toLowerCase(),
                        function(b) {
                            return b.nodeName && b.nodeName.toLowerCase() === a
                        })
                    },
                    CLASS: function(a) {
                        var b = P[D][a + " "];
                        return b || (b = new RegExp("(^|" + S + ")" + a + "(" + S + "|$)")) && P(a,
                        function(a) {
                            return b.test(a.className || typeof a.getAttribute !== C && a.getAttribute("class") || "")
                        })
                    },
                    ATTR: function(a, b, d) {
                        return function(e, f) {
                            var g = c.attr(e, a);
                            return null == g ? "!=" === b: b ? (g += "", "=" === b ? g === d: "!=" === b ? g !== d: "^=" === b ? d && 0 === g.indexOf(d) : "*=" === b ? d && g.indexOf(d) > -1 : "$=" === b ? d && g.substr(g.length - d.length) === d: "~=" === b ? (" " + g + " ").indexOf(d) > -1 : "|=" === b ? g === d || g.substr(0, d.length + 1) === d + "-": !1) : !0
                        }
                    },
                    CHILD: function(a, b, c, d) {
                        return "nth" === a ?
                        function(a) {
                            var b, e, f = a.parentNode;
                            if (1 === c && 0 === d) return ! 0;
                            if (f) for (e = 0, b = f.firstChild; b && (1 !== b.nodeType || (e++, a !== b)); b = b.nextSibling);
                            return e -= d,
                            e === c || e % c === 0 && e / c >= 0
                        }: function(b) {
                            var c = b;
                            switch (a) {
                            case "only":
                            case "first":
                                for (; c = c.previousSibling;) if (1 === c.nodeType) return ! 1;
                                if ("first" === a) return ! 0;
                                c = b;
                            case "last":
                                for (; c = c.nextSibling;) if (1 === c.nodeType) return ! 1;
                                return ! 0
                            }
                        }
                    },
                    PSEUDO: function(a, b) {
                        var d, e = t.pseudos[a] || t.setFilters[a.toLowerCase()] || c.error("unsupported pseudo: " + a);
                        return e[D] ? e(b) : e.length > 1 ? (d = [a, a, "", b], t.setFilters.hasOwnProperty(a.toLowerCase()) ? N(function(a, c) {
                            for (var d, f = e(a, b), g = f.length; g--;) d = M.call(a, f[g]),
                            a[d] = !(c[d] = f[g])
                        }) : function(a) {
                            return e(a, 0, d)
                        }) : e
                    }
                },
                pseudos: {
                    not: N(function(a) {
                        var b = [],
                        c = [],
                        d = x(a.replace(Z, "$1"));
                        return d[D] ? N(function(a, b, c, e) {
                            for (var f, g = d(a, null, e, []), h = a.length; h--;)(f = g[h]) && (a[h] = !(b[h] = f))
                        }) : function(a, e, f) {
                            return b[0] = a,
                            d(b, null, f, c),
                            !c.pop()
                        }
                    }),
                    has: N(function(a) {
                        return function(b) {
                            return c(a, b).length > 0
                        }
                    }),
                    contains: N(function(a) {
                        return function(b) {
                            return (b.textContent || b.innerText || u(b)).indexOf(a) > -1
                        }
                    }),
                    enabled: function(a) {
                        return a.disabled === !1
                    },
                    disabled: function(a) {
                        return a.disabled === !0
                    },
                    checked: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return "input" === b && !!a.checked || "option" === b && !!a.selected
                    },
                    selected: function(a) {
                        return a.parentNode && a.parentNode.selectedIndex,
                        a.selected === !0
                    },
                    parent: function(a) {
                        return ! t.pseudos.empty(a)
                    },
                    empty: function(a) {
                        var b;
                        for (a = a.firstChild; a;) {
                            if (a.nodeName > "@" || 3 === (b = a.nodeType) || 4 === b) return ! 1;
                            a = a.nextSibling
                        }
                        return ! 0
                    },
                    header: function(a) {
                        return ea.test(a.nodeName)
                    },
                    text: function(a) {
                        var b, c;
                        return "input" === a.nodeName.toLowerCase() && "text" === (b = a.type) && (null == (c = a.getAttribute("type")) || c.toLowerCase() === b)
                    },
                    radio: d("radio"),
                    checkbox: d("checkbox"),
                    file: d("file"),
                    password: d("password"),
                    image: d("image"),
                    submit: e("submit"),
                    reset: e("reset"),
                    button: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return "input" === b && "button" === a.type || "button" === b
                    },
                    input: function(a) {
                        return fa.test(a.nodeName)
                    },
                    focus: function(a) {
                        var b = a.ownerDocument;
                        return a === b.activeElement && (!b.hasFocus || b.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
                    },
                    active: function(a) {
                        return a === a.ownerDocument.activeElement
                    },
                    first: f(function() {
                        return [0]
                    }),
                    last: f(function(a, b) {
                        return [b - 1]
                    }),
                    eq: f(function(a, b, c) {
                        return [0 > c ? c + b: c]
                    }),
                    even: f(function(a, b) {
                        for (var c = 0; b > c; c += 2) a.push(c);
                        return a
                    }),
                    odd: f(function(a, b) {
                        for (var c = 1; b > c; c += 2) a.push(c);
                        return a
                    }),
                    lt: f(function(a, b, c) {
                        for (var d = 0 > c ? c + b: c; --d >= 0;) a.push(d);
                        return a
                    }),
                    gt: f(function(a, b, c) {
                        for (var d = 0 > c ? c + b: c; ++d < b;) a.push(d);
                        return a
                    })
                }
            },
            y = G.compareDocumentPosition ?
            function(a, b) {
                return a === b ? (z = !0, 0) : (a.compareDocumentPosition && b.compareDocumentPosition ? 4 & a.compareDocumentPosition(b) : a.compareDocumentPosition) ? -1 : 1
            }: function(a, b) {
                if (a === b) return z = !0,
                0;
                if (a.sourceIndex && b.sourceIndex) return a.sourceIndex - b.sourceIndex;
                var c, d, e = [],
                f = [],
                h = a.parentNode,
                i = b.parentNode,
                j = h;
                if (h === i) return g(a, b);
                if (!h) return - 1;
                if (!i) return 1;
                for (; j;) e.unshift(j),
                j = j.parentNode;
                for (j = i; j;) f.unshift(j),
                j = j.parentNode;
                c = e.length,
                d = f.length;
                for (var k = 0; c > k && d > k; k++) if (e[k] !== f[k]) return g(e[k], f[k]);
                return k === c ? g(a, f[k], -1) : g(e[k], b, 1)
            },
            [0, 0].sort(y),
            B = !z,
            c.uniqueSort = function(a) {
                var b, c = [],
                d = 1,
                e = 0;
                if (z = B, a.sort(y), z) {
                    for (; b = a[d]; d++) b === a[d - 1] && (e = c.push(d));
                    for (; e--;) a.splice(c[e], 1)
                }
                return a
            },
            c.error = function(a) {
                throw new Error("Syntax error, unrecognized expression: " + a)
            },
            x = c.compile = function(a, b) {
                var c, d = [],
                e = [],
                f = R[D][a + " "];
                if (!f) {
                    for (b || (b = h(a)), c = b.length; c--;) f = m(b[c]),
                    f[D] ? d.push(f) : e.push(f);
                    f = R(a, n(e, d))
                }
                return f
            },
            F.querySelectorAll &&
            function() {
                var a, b = p,
                d = /'|\\/g,
                e = /\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
                f = [":focus"],
                g = [":active"],
                i = G.matchesSelector || G.mozMatchesSelector || G.webkitMatchesSelector || G.oMatchesSelector || G.msMatchesSelector;
                ia(function(a) {
                    a.innerHTML = "<select><option selected=''></option></select>",
                    a.querySelectorAll("[selected]").length || f.push("\\[" + S + "*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),
                    a.querySelectorAll(":checked").length || f.push(":checked")
                }),
                ia(function(a) {
                    a.innerHTML = "<p test=''></p>",
                    a.querySelectorAll("[test^='']").length && f.push("[*^$]=" + S + "*(?:\"\"|'')"),
                    a.innerHTML = "<input type='hidden'/>",
                    a.querySelectorAll(":enabled").length || f.push(":enabled", ":disabled")
                }),
                f = new RegExp(f.join("|")),
                p = function(a, c, e, g, i) {
                    if (!g && !i && !f.test(a)) {
                        var j, k, l = !0,
                        m = D,
                        n = c,
                        o = 9 === c.nodeType && a;
                        if (1 === c.nodeType && "object" !== c.nodeName.toLowerCase()) {
                            for (j = h(a), (l = c.getAttribute("id")) ? m = l.replace(d, "\\$&") : c.setAttribute("id", m), m = "[id='" + m + "'] ", k = j.length; k--;) j[k] = m + j[k].join("");
                            n = da.test(a) && c.parentNode || c,
                            o = j.join(",")
                        }
                        if (o) try {
                            return K.apply(e, L.call(n.querySelectorAll(o), 0)),
                            e
                        } catch(p) {} finally {
                            l || c.removeAttribute("id")
                        }
                    }
                    return b(a, c, e, g, i)
                },
                i && (ia(function(b) {
                    a = i.call(b, "div");
                    try {
                        i.call(b, "[test!='']:sizzle"),
                        g.push("!=", X)
                    } catch(c) {}
                }), g = new RegExp(g.join("|")), c.matchesSelector = function(b, d) {
                    if (d = d.replace(e, "='$1']"), !v(b) && !g.test(d) && !f.test(d)) try {
                        var h = i.call(b, d);
                        if (h || a || b.document && 11 !== b.document.nodeType) return h
                    } catch(j) {}
                    return c(d, null, null, [b]).length > 0
                })
            } (),
            t.pseudos.nth = t.pseudos.eq,
            t.filters = q.prototype = t.pseudos,
            t.setFilters = new q,
            c.attr = $.attr,
            $.find = c,
            $.expr = c.selectors,
            $.expr[":"] = $.expr.pseudos,
            $.unique = c.uniqueSort,
            $.text = c.getText,
            $.isXMLDoc = c.isXML,
            $.contains = c.contains
        } (a);
        var Ia = /Until$/,
        Ja = /^(?:parents|prev(?:Until|All))/,
        Ka = /^.[^:#\[\.,]*$/,
        La = $.expr.match.needsContext,
        Ma = {
            children: !0,
            contents: !0,
            next: !0,
            prev: !0
        };
        $.fn.extend({
            find: function(a) {
                var b, c, d, e, f, g, h = this;
                if ("string" != typeof a) return $(a).filter(function() {
                    for (b = 0, c = h.length; c > b; b++) if ($.contains(h[b], this)) return ! 0
                });
                for (g = this.pushStack("", "find", a), b = 0, c = this.length; c > b; b++) if (d = g.length, $.find(a, this[b], g), b > 0) for (e = d; e < g.length; e++) for (f = 0; d > f; f++) if (g[f] === g[e]) {
                    g.splice(e--, 1);
                    break
                }
                return g
            },
            has: function(a) {
                var b, c = $(a, this),
                d = c.length;
                return this.filter(function() {
                    for (b = 0; d > b; b++) if ($.contains(this, c[b])) return ! 0
                })
            },
            not: function(a) {
                return this.pushStack(j(this, a, !1), "not", a)
            },
            filter: function(a) {
                return this.pushStack(j(this, a, !0), "filter", a)
            },
            is: function(a) {
                return !! a && ("string" == typeof a ? La.test(a) ? $(a, this.context).index(this[0]) >= 0 : $.filter(a, this).length > 0 : this.filter(a).length > 0)
            },
            closest: function(a, b) {
                for (var c, d = 0,
                e = this.length,
                f = [], g = La.test(a) || "string" != typeof a ? $(a, b || this.context) : 0; e > d; d++) for (c = this[d]; c && c.ownerDocument && c !== b && 11 !== c.nodeType;) {
                    if (g ? g.index(c) > -1 : $.find.matchesSelector(c, a)) {
                        f.push(c);
                        break
                    }
                    c = c.parentNode
                }
                return f = f.length > 1 ? $.unique(f) : f,
                this.pushStack(f, "closest", a)
            },
            index: function(a) {
                return a ? "string" == typeof a ? $.inArray(this[0], $(a)) : $.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.prevAll().length: -1
            },
            add: function(a, b) {
                var c = "string" == typeof a ? $(a, b) : $.makeArray(a && a.nodeType ? [a] : a),
                d = $.merge(this.get(), c);
                return this.pushStack(h(c[0]) || h(d[0]) ? d: $.unique(d))
            },
            addBack: function(a) {
                return this.add(null == a ? this.prevObject: this.prevObject.filter(a))
            }
        }),
        $.fn.andSelf = $.fn.addBack,
        $.each({
            parent: function(a) {
                var b = a.parentNode;
                return b && 11 !== b.nodeType ? b: null
            },
            parents: function(a) {
                return $.dir(a, "parentNode")
            },
            parentsUntil: function(a, b, c) {
                return $.dir(a, "parentNode", c)
            },
            next: function(a) {
                return i(a, "nextSibling")
            },
            prev: function(a) {
                return i(a, "previousSibling")
            },
            nextAll: function(a) {
                return $.dir(a, "nextSibling")
            },
            prevAll: function(a) {
                return $.dir(a, "previousSibling")
            },
            nextUntil: function(a, b, c) {
                return $.dir(a, "nextSibling", c)
            },
            prevUntil: function(a, b, c) {
                return $.dir(a, "previousSibling", c)
            },
            siblings: function(a) {
                return $.sibling((a.parentNode || {}).firstChild, a)
            },
            children: function(a) {
                return $.sibling(a.firstChild)
            },
            contents: function(a) {
                return $.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document: $.merge([], a.childNodes)
            }
        },
        function(a, b) {
            $.fn[a] = function(c, d) {
                var e = $.map(this, b, c);
                return Ia.test(a) || (d = c),
                d && "string" == typeof d && (e = $.filter(d, e)),
                e = this.length > 1 && !Ma[a] ? $.unique(e) : e,
                this.length > 1 && Ja.test(a) && (e = e.reverse()),
                this.pushStack(e, a, V.call(arguments).join(","))
            }
        }),
        $.extend({
            filter: function(a, b, c) {
                return c && (a = ":not(" + a + ")"),
                1 === b.length ? $.find.matchesSelector(b[0], a) ? [b[0]] : [] : $.find.matches(a, b)
            },
            dir: function(a, c, d) {
                for (var e = [], f = a[c]; f && 9 !== f.nodeType && (d === b || 1 !== f.nodeType || !$(f).is(d));) 1 === f.nodeType && e.push(f),
                f = f[c];
                return e
            },
            sibling: function(a, b) {
                for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
                return c
            }
        });
        var Na = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
        Oa = / jQuery\d+="(?:null|\d+)"/g,
        Pa = /^\s+/,
        Qa = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
        Ra = /<([\w:]+)/,
        Sa = /<tbody/i,
        Ta = /<|&#?\w+;/,
        Ua = /<(?:script|style|link)/i,
        Va = /<(?:script|object|embed|option|style)/i,
        Wa = new RegExp("<(?:" + Na + ")[\\s/>]", "i"),
        Xa = /^(?:checkbox|radio)$/,
        Ya = /checked\s*(?:[^=]|=\s*.checked.)/i,
        Za = /\/(java|ecma)script/i,
        $a = /^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,
        _a = {
            option: [1, "<select multiple='multiple'>", "</select>"],
            legend: [1, "<fieldset>", "</fieldset>"],
            thead: [1, "<table>", "</table>"],
            tr: [2, "<table><tbody>", "</tbody></table>"],
            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
            col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
            area: [1, "<map>", "</map>"],
            _default: [0, "", ""]
        },
        ab = k(P),
        bb = ab.appendChild(P.createElement("div"));
        _a.optgroup = _a.option,
        _a.tbody = _a.tfoot = _a.colgroup = _a.caption = _a.thead,
        _a.th = _a.td,
        $.support.htmlSerialize || (_a._default = [1, "X<div>", "</div>"]),
        $.fn.extend({
            text: function(a) {
                return $.access(this,
                function(a) {
                    return a === b ? $.text(this) : this.empty().append((this[0] && this[0].ownerDocument || P).createTextNode(a))
                },
                null, a, arguments.length)
            },
            wrapAll: function(a) {
                if ($.isFunction(a)) return this.each(function(b) {
                    $(this).wrapAll(a.call(this, b))
                });
                if (this[0]) {
                    var b = $(a, this[0].ownerDocument).eq(0).clone(!0);
                    this[0].parentNode && b.insertBefore(this[0]),
                    b.map(function() {
                        for (var a = this; a.firstChild && 1 === a.firstChild.nodeType;) a = a.firstChild;
                        return a
                    }).append(this)
                }
                return this
            },
            wrapInner: function(a) {
                return $.isFunction(a) ? this.each(function(b) {
                    $(this).wrapInner(a.call(this, b))
                }) : this.each(function() {
                    var b = $(this),
                    c = b.contents();
                    c.length ? c.wrapAll(a) : b.append(a)
                })
            },
            wrap: function(a) {
                var b = $.isFunction(a);
                return this.each(function(c) {
                    $(this).wrapAll(b ? a.call(this, c) : a)
                })
            },
            unwrap: function() {
                return this.parent().each(function() {
                    $.nodeName(this, "body") || $(this).replaceWith(this.childNodes)
                }).end()
            },
            append: function() {
                return this.domManip(arguments, !0,
                function(a) { (1 === this.nodeType || 11 === this.nodeType) && this.appendChild(a)
                })
            },
            prepend: function() {
                return this.domManip(arguments, !0,
                function(a) { (1 === this.nodeType || 11 === this.nodeType) && this.insertBefore(a, this.firstChild)
                })
            },
            before: function() {
                if (!h(this[0])) return this.domManip(arguments, !1,
                function(a) {
                    this.parentNode.insertBefore(a, this)
                });
                if (arguments.length) {
                    var a = $.clean(arguments);
                    return this.pushStack($.merge(a, this), "before", this.selector)
                }
            },
            after: function() {
                if (!h(this[0])) return this.domManip(arguments, !1,
                function(a) {
                    this.parentNode.insertBefore(a, this.nextSibling)
                });
                if (arguments.length) {
                    var a = $.clean(arguments);
                    return this.pushStack($.merge(this, a), "after", this.selector)
                }
            },
            remove: function(a, b) {
                for (var c, d = 0; null != (c = this[d]); d++)(!a || $.filter(a, [c]).length) && (!b && 1 === c.nodeType && ($.cleanData(c.getElementsByTagName("*")), $.cleanData([c])), c.parentNode && c.parentNode.removeChild(c));
                return this
            },
            empty: function() {
                for (var a, b = 0; null != (a = this[b]); b++) for (1 === a.nodeType && $.cleanData(a.getElementsByTagName("*")); a.firstChild;) a.removeChild(a.firstChild);
                return this
            },
            clone: function(a, b) {
                return a = null == a ? !1 : a,
                b = null == b ? a: b,
                this.map(function() {
                    return $.clone(this, a, b)
                })
            },
            html: function(a) {
                return $.access(this,
                function(a) {
                    var c = this[0] || {},
                    d = 0,
                    e = this.length;
                    if (a === b) return 1 === c.nodeType ? c.innerHTML.replace(Oa, "") : b;
                    if ("string" == typeof a && !Ua.test(a) && ($.support.htmlSerialize || !Wa.test(a)) && ($.support.leadingWhitespace || !Pa.test(a)) && !_a[(Ra.exec(a) || ["", ""])[1].toLowerCase()]) {
                        a = a.replace(Qa, "<$1></$2>");
                        try {
                            for (; e > d; d++) c = this[d] || {},
                            1 === c.nodeType && ($.cleanData(c.getElementsByTagName("*")), c.innerHTML = a);
                            c = 0
                        } catch(f) {}
                    }
                    c && this.empty().append(a)
                },
                null, a, arguments.length)
            },
            replaceWith: function(a) {
                return h(this[0]) ? this.length ? this.pushStack($($.isFunction(a) ? a() : a), "replaceWith", a) : this: $.isFunction(a) ? this.each(function(b) {
                    var c = $(this),
                    d = c.html();
                    c.replaceWith(a.call(this, b, d))
                }) : ("string" != typeof a && (a = $(a).detach()), this.each(function() {
                    var b = this.nextSibling,
                    c = this.parentNode;
                    $(this).remove(),
                    b ? $(b).before(a) : $(c).append(a)
                }))
            },
            detach: function(a) {
                return this.remove(a, !0)
            },
            domManip: function(a, c, d) {
                a = [].concat.apply([], a);
                var e, f, g, h, i = 0,
                j = a[0],
                k = [],
                m = this.length;
                if (!$.support.checkClone && m > 1 && "string" == typeof j && Ya.test(j)) return this.each(function() {
                    $(this).domManip(a, c, d)
                });
                if ($.isFunction(j)) return this.each(function(e) {
                    var f = $(this);
                    a[0] = j.call(this, e, c ? f.html() : b),
                    f.domManip(a, c, d)
                });
                if (this[0]) {
                    if (e = $.buildFragment(a, this, k), g = e.fragment, f = g.firstChild, 1 === g.childNodes.length && (g = f), f) for (c = c && $.nodeName(f, "tr"), h = e.cacheable || m - 1; m > i; i++) d.call(c && $.nodeName(this[i], "table") ? l(this[i], "tbody") : this[i], i === h ? g: $.clone(g, !0, !0));
                    g = f = null,
                    k.length && $.each(k,
                    function(a, b) {
                        b.src ? $.ajax ? $.ajax({
                            url: b.src,
                            type: "GET",
                            dataType: "script",
                            async: !1,
                            global: !1,
                            "throws": !0
                        }) : $.error("no ajax") : $.globalEval((b.text || b.textContent || b.innerHTML || "").replace($a, "")),
                        b.parentNode && b.parentNode.removeChild(b)
                    })
                }
                return this
            }
        }),
        $.buildFragment = function(a, c, d) {
            var e, f, g, h = a[0];
            return c = c || P,
            c = !c.nodeType && c[0] || c,
            c = c.ownerDocument || c,
            1 === a.length && "string" == typeof h && h.length < 512 && c === P && "<" === h.charAt(0) && !Va.test(h) && ($.support.checkClone || !Ya.test(h)) && ($.support.html5Clone || !Wa.test(h)) && (f = !0, e = $.fragments[h], g = e !== b),
            e || (e = c.createDocumentFragment(), $.clean(a, c, e, d), f && ($.fragments[h] = g && e)),
            {
                fragment: e,
                cacheable: f
            }
        },
        $.fragments = {},
        $.each({
            appendTo: "append",
            prependTo: "prepend",
            insertBefore: "before",
            insertAfter: "after",
            replaceAll: "replaceWith"
        },
        function(a, b) {
            $.fn[a] = function(c) {
                var d, e = 0,
                f = [],
                g = $(c),
                h = g.length,
                i = 1 === this.length && this[0].parentNode;
                if ((null == i || i && 11 === i.nodeType && 1 === i.childNodes.length) && 1 === h) return g[b](this[0]),
                this;
                for (; h > e; e++) d = (e > 0 ? this.clone(!0) : this).get(),
                $(g[e])[b](d),
                f = f.concat(d);
                return this.pushStack(f, a, g.selector)
            }
        }),
        $.extend({
            clone: function(a, b, c) {
                var d, e, f, g;
                if ($.support.html5Clone || $.isXMLDoc(a) || !Wa.test("<" + a.nodeName + ">") ? g = a.cloneNode(!0) : (bb.innerHTML = a.outerHTML, bb.removeChild(g = bb.firstChild)), !($.support.noCloneEvent && $.support.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || $.isXMLDoc(a))) for (n(a, g), d = o(a), e = o(g), f = 0; d[f]; ++f) e[f] && n(d[f], e[f]);
                if (b && (m(a, g), c)) for (d = o(a), e = o(g), f = 0; d[f]; ++f) m(d[f], e[f]);
                return d = e = null,
                g
            },
            clean: function(a, b, c, d) {
                var e, f, g, h, i, j, l, m, n, o, q, r = b === P && ab,
                s = [];
                for (b && "undefined" != typeof b.createDocumentFragment || (b = P), e = 0; null != (g = a[e]); e++) if ("number" == typeof g && (g += ""), g) {
                    if ("string" == typeof g) if (Ta.test(g)) {
                        for (r = r || k(b), l = b.createElement("div"), r.appendChild(l), g = g.replace(Qa, "<$1></$2>"), h = (Ra.exec(g) || ["", ""])[1].toLowerCase(), i = _a[h] || _a._default, j = i[0], l.innerHTML = i[1] + g + i[2]; j--;) l = l.lastChild;
                        if (!$.support.tbody) for (m = Sa.test(g), n = "table" !== h || m ? "<table>" !== i[1] || m ? [] : l.childNodes: l.firstChild && l.firstChild.childNodes, f = n.length - 1; f >= 0; --f) $.nodeName(n[f], "tbody") && !n[f].childNodes.length && n[f].parentNode.removeChild(n[f]); ! $.support.leadingWhitespace && Pa.test(g) && l.insertBefore(b.createTextNode(Pa.exec(g)[0]), l.firstChild),
                        g = l.childNodes,
                        l.parentNode.removeChild(l)
                    } else g = b.createTextNode(g);
                    g.nodeType ? s.push(g) : $.merge(s, g)
                }
                if (l && (g = l = r = null), !$.support.appendChecked) for (e = 0; null != (g = s[e]); e++) $.nodeName(g, "input") ? p(g) : "undefined" != typeof g.getElementsByTagName && $.grep(g.getElementsByTagName("input"), p);
                if (c) for (o = function(a) {
                    return ! a.type || Za.test(a.type) ? d ? d.push(a.parentNode ? a.parentNode.removeChild(a) : a) : c.appendChild(a) : void 0
                },
                e = 0; null != (g = s[e]); e++) $.nodeName(g, "script") && o(g) || (c.appendChild(g), "undefined" != typeof g.getElementsByTagName && (q = $.grep($.merge([], g.getElementsByTagName("script")), o), s.splice.apply(s, [e + 1, 0].concat(q)), e += q.length));
                return s
            },
            cleanData: function(a, b) {
                for (var c, d, e, f, g = 0,
                h = $.expando,
                i = $.cache,
                j = $.support.deleteExpando,
                k = $.event.special; null != (e = a[g]); g++) if ((b || $.acceptData(e)) && (d = e[h], c = d && i[d])) {
                    if (c.events) for (f in c.events) k[f] ? $.event.remove(e, f) : $.removeEvent(e, f, c.handle);
                    i[d] && (delete i[d], j ? delete e[h] : e.removeAttribute ? e.removeAttribute(h) : e[h] = null, $.deletedIds.push(d))
                }
            }
        }),
        function() {
            var a, b;
            $.uaMatch = function(a) {
                a = a.toLowerCase();
                var b = /(chrome)[ \/]([\w.]+)/.exec(a) || /(webkit)[ \/]([\w.]+)/.exec(a) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a) || /(msie) ([\w.]+)/.exec(a) || a.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a) || [];
                return {
                    browser: b[1] || "",
                    version: b[2] || "0"
                }
            },
            a = $.uaMatch(R.userAgent),
            b = {},
            a.browser && (b[a.browser] = !0, b.version = a.version),
            b.chrome ? b.webkit = !0 : b.webkit && (b.safari = !0),
            $.browser = b,
            $.sub = function() {
                function a(b, c) {
                    return new a.fn.init(b, c)
                }
                $.extend(!0, a, this),
                a.superclass = this,
                a.fn = a.prototype = this(),
                a.fn.constructor = a,
                a.sub = this.sub,
                a.fn.init = function(c, d) {
                    return d && d instanceof $ && !(d instanceof a) && (d = a(d)),
                    $.fn.init.call(this, c, d, b)
                },
                a.fn.init.prototype = a.fn;
                var b = a(P);
                return a
            }
        } ();
        var cb, db, eb, fb = /alpha\([^)]*\)/i,
        gb = /opacity=([^)]*)/,
        hb = /^(top|right|bottom|left)$/,
        ib = /^(none|table(?!-c[ea]).+)/,
        jb = /^margin/,
        kb = new RegExp("^(" + _ + ")(.*)$", "i"),
        lb = new RegExp("^(" + _ + ")(?!px)[a-z%]+$", "i"),
        mb = new RegExp("^([-+])=(" + _ + ")", "i"),
        nb = {
            BODY: "block"
        },
        ob = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        pb = {
            letterSpacing: 0,
            fontWeight: 400
        },
        qb = ["Top", "Right", "Bottom", "Left"],
        rb = ["Webkit", "O", "Moz", "ms"],
        sb = $.fn.toggle;
        $.fn.extend({
            css: function(a, c) {
                return $.access(this,
                function(a, c, d) {
                    return d !== b ? $.style(a, c, d) : $.css(a, c)
                },
                a, c, arguments.length > 1)
            },
            show: function() {
                return s(this, !0)
            },
            hide: function() {
                return s(this)
            },
            toggle: function(a, b) {
                var c = "boolean" == typeof a;
                return $.isFunction(a) && $.isFunction(b) ? sb.apply(this, arguments) : this.each(function() { (c ? a: r(this)) ? $(this).show() : $(this).hide()
                })
            }
        }),
        $.extend({
            cssHooks: {
                opacity: {
                    get: function(a, b) {
                        if (b) {
                            var c = cb(a, "opacity");
                            return "" === c ? "1": c
                        }
                    }
                }
            },
            cssNumber: {
                fillOpacity: !0,
                fontWeight: !0,
                lineHeight: !0,
                opacity: !0,
                orphans: !0,
                widows: !0,
                zIndex: !0,
                zoom: !0
            },
            cssProps: {
                "float": $.support.cssFloat ? "cssFloat": "styleFloat"
            },
            style: function(a, c, d, e) {
                if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                    var f, g, h, i = $.camelCase(c),
                    j = a.style;
                    if (c = $.cssProps[i] || ($.cssProps[i] = q(j, i)), h = $.cssHooks[c] || $.cssHooks[i], d === b) return h && "get" in h && (f = h.get(a, !1, e)) !== b ? f: j[c];
                    if (g = typeof d, "string" === g && (f = mb.exec(d)) && (d = (f[1] + 1) * f[2] + parseFloat($.css(a, c)), g = "number"), !(null == d || "number" === g && isNaN(d) || ("number" === g && !$.cssNumber[i] && (d += "px"), h && "set" in h && (d = h.set(a, d, e)) === b))) try {
                        j[c] = d
                    } catch(k) {}
                }
            },
            css: function(a, c, d, e) {
                var f, g, h, i = $.camelCase(c);
                return c = $.cssProps[i] || ($.cssProps[i] = q(a.style, i)),
                h = $.cssHooks[c] || $.cssHooks[i],
                h && "get" in h && (f = h.get(a, !0, e)),
                f === b && (f = cb(a, c)),
                "normal" === f && c in pb && (f = pb[c]),
                d || e !== b ? (g = parseFloat(f), d || $.isNumeric(g) ? g || 0 : f) : f
            },
            swap: function(a, b, c) {
                var d, e, f = {};
                for (e in b) f[e] = a.style[e],
                a.style[e] = b[e];
                d = c.call(a);
                for (e in b) a.style[e] = f[e];
                return d
            }
        }),
        a.getComputedStyle ? cb = function(b, c) {
            var d, e, f, g, h = a.getComputedStyle(b, null),
            i = b.style;
            return h && (d = h.getPropertyValue(c) || h[c], "" === d && !$.contains(b.ownerDocument, b) && (d = $.style(b, c)), lb.test(d) && jb.test(c) && (e = i.width, f = i.minWidth, g = i.maxWidth, i.minWidth = i.maxWidth = i.width = d, d = h.width, i.width = e, i.minWidth = f, i.maxWidth = g)),
            d
        }: P.documentElement.currentStyle && (cb = function(a, b) {
            var c, d, e = a.currentStyle && a.currentStyle[b],
            f = a.style;
            return null == e && f && f[b] && (e = f[b]),
            lb.test(e) && !hb.test(b) && (c = f.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), f.left = "fontSize" === b ? "1em": e, e = f.pixelLeft + "px", f.left = c, d && (a.runtimeStyle.left = d)),
            "" === e ? "auto": e
        }),
        $.each(["height", "width"],
        function(a, b) {
            $.cssHooks[b] = {
                get: function(a, c, d) {
                    return c ? 0 === a.offsetWidth && ib.test(cb(a, "display")) ? $.swap(a, ob,
                    function() {
                        return v(a, b, d)
                    }) : v(a, b, d) : void 0
                },
                set: function(a, c, d) {
                    return t(a, c, d ? u(a, b, d, $.support.boxSizing && "border-box" === $.css(a, "boxSizing")) : 0)
                }
            }
        }),
        $.support.opacity || ($.cssHooks.opacity = {
            get: function(a, b) {
                return gb.test((b && a.currentStyle ? a.currentStyle.filter: a.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "": b ? "1": ""
            },
            set: function(a, b) {
                var c = a.style,
                d = a.currentStyle,
                e = $.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")": "",
                f = d && d.filter || c.filter || "";
                c.zoom = 1,
                b >= 1 && "" === $.trim(f.replace(fb, "")) && c.removeAttribute && (c.removeAttribute("filter"), d && !d.filter) || (c.filter = fb.test(f) ? f.replace(fb, e) : f + " " + e)
            }
        }),
        $(function() {
            $.support.reliableMarginRight || ($.cssHooks.marginRight = {
                get: function(a, b) {
                    return $.swap(a, {
                        display: "inline-block"
                    },
                    function() {
                        return b ? cb(a, "marginRight") : void 0
                    })
                }
            }),
            !$.support.pixelPosition && $.fn.position && $.each(["top", "left"],
            function(a, b) {
                $.cssHooks[b] = {
                    get: function(a, c) {
                        if (c) {
                            var d = cb(a, b);
                            return lb.test(d) ? $(a).position()[b] + "px": d
                        }
                    }
                }
            })
        }),
        $.expr && $.expr.filters && ($.expr.filters.hidden = function(a) {
            return 0 === a.offsetWidth && 0 === a.offsetHeight || !$.support.reliableHiddenOffsets && "none" === (a.style && a.style.display || cb(a, "display"))
        },
        $.expr.filters.visible = function(a) {
            return ! $.expr.filters.hidden(a)
        }),
        $.each({
            margin: "",
            padding: "",
            border: "Width"
        },
        function(a, b) {
            $.cssHooks[a + b] = {
                expand: function(c) {
                    var d, e = "string" == typeof c ? c.split(" ") : [c],
                    f = {};
                    for (d = 0; 4 > d; d++) f[a + qb[d] + b] = e[d] || e[d - 2] || e[0];
                    return f
                }
            },
            jb.test(a) || ($.cssHooks[a + b].set = t)
        });
        var tb = /%20/g,
        ub = /\[\]$/,
        vb = /\r?\n/g,
        wb = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
        xb = /^(?:select|textarea)/i;
        $.fn.extend({
            serialize: function() {
                return $.param(this.serializeArray())
            },
            serializeArray: function() {
                return this.map(function() {
                    return this.elements ? $.makeArray(this.elements) : this
                }).filter(function() {
                    return this.name && !this.disabled && (this.checked || xb.test(this.nodeName) || wb.test(this.type))
                }).map(function(a, b) {
                    var c = $(this).val();
                    return null == c ? null: $.isArray(c) ? $.map(c,
                    function(a, c) {
                        return {
                            name: b.name,
                            value: a.replace(vb, "\r\n")
                        }
                    }) : {
                        name: b.name,
                        value: c.replace(vb, "\r\n")
                    }
                }).get()
            }
        }),
        $.param = function(a, c) {
            var d, e = [],
            f = function(a, b) {
                b = $.isFunction(b) ? b() : null == b ? "": b,
                e[e.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
            };
            if (c === b && (c = $.ajaxSettings && $.ajaxSettings.traditional), $.isArray(a) || a.jquery && !$.isPlainObject(a)) $.each(a,
            function() {
                f(this.name, this.value)
            });
            else for (d in a) x(d, a[d], c, f);
            return e.join("&").replace(tb, "+")
        };
        var yb, zb, Ab = /#.*$/,
        Bb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
        Cb = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,
        Db = /^(?:GET|HEAD)$/,
        Eb = /^\/\//,
        Fb = /\?/,
        Gb = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
        Hb = /([?&])_=[^&]*/,
        Ib = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
        Jb = $.fn.load,
        Kb = {},
        Lb = {},
        Mb = ["*/"] + ["*"];
        try {
            zb = Q.href
        } catch(Nb) {
            zb = P.createElement("a"),
            zb.href = "",
            zb = zb.href
        }
        yb = Ib.exec(zb.toLowerCase()) || [],
        $.fn.load = function(a, c, d) {
            if ("string" != typeof a && Jb) return Jb.apply(this, arguments);
            if (!this.length) return this;
            var e, f, g, h = this,
            i = a.indexOf(" ");
            return i >= 0 && (e = a.slice(i, a.length), a = a.slice(0, i)),
            $.isFunction(c) ? (d = c, c = b) : c && "object" == typeof c && (f = "POST"),
            $.ajax({
                url: a,
                type: f,
                dataType: "html",
                data: c,
                complete: function(a, b) {
                    d && h.each(d, g || [a.responseText, b, a])
                }
            }).done(function(a) {
                g = arguments,
                h.html(e ? $("<div>").append(a.replace(Gb, "")).find(e) : a)
            }),
            this
        },
        $.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
        function(a, b) {
            $.fn[b] = function(a) {
                return this.on(b, a)
            }
        }),
        $.each(["get", "post"],
        function(a, c) {
            $[c] = function(a, d, e, f) {
                return $.isFunction(d) && (f = f || e, e = d, d = b),
                $.ajax({
                    type: c,
                    url: a,
                    data: d,
                    success: e,
                    dataType: f
                })
            }
        }),
        $.extend({
            getScript: function(a, c) {
                return $.get(a, b, c, "script")
            },
            getJSON: function(a, b, c) {
                return $.get(a, b, c, "json")
            },
            ajaxSetup: function(a, b) {
                return b ? A(a, $.ajaxSettings) : (b = a, a = $.ajaxSettings),
                A(a, b),
                a
            },
            ajaxSettings: {
                url: zb,
                isLocal: Cb.test(yb[1]),
                global: !0,
                type: "GET",
                contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                processData: !0,
                async: !0,
                accepts: {
                    xml: "application/xml, text/xml",
                    html: "text/html",
                    text: "text/plain",
                    json: "application/json, text/javascript",
                    "*": Mb
                },
                contents: {
                    xml: /xml/,
                    html: /html/,
                    json: /json/
                },
                responseFields: {
                    xml: "responseXML",
                    text: "responseText"
                },
                converters: {
                    "* text": a.String,
                    "text html": !0,
                    "text json": $.parseJSON,
                    "text xml": $.parseXML
                },
                flatOptions: {
                    context: !0,
                    url: !0
                }
            },
            ajaxPrefilter: y(Kb),
            ajaxTransport: y(Lb),
            ajax: function(a, c) {
                function d(a, c, d, g) {
                    var j, l, s, t, v, x = c;
                    2 !== u && (u = 2, i && clearTimeout(i), h = b, f = g || "", w.readyState = a > 0 ? 4 : 0, d && (t = B(m, w, d)), a >= 200 && 300 > a || 304 === a ? (m.ifModified && (v = w.getResponseHeader("Last-Modified"), v && ($.lastModified[e] = v), v = w.getResponseHeader("Etag"), v && ($.etag[e] = v)), 304 === a ? (x = "notmodified", j = !0) : (j = C(m, t), x = j.state, l = j.data, s = j.error, j = !s)) : (s = x, (!x || a) && (x = "error", 0 > a && (a = 0))), w.status = a, w.statusText = (c || x) + "", j ? p.resolveWith(n, [l, x, w]) : p.rejectWith(n, [w, x, s]), w.statusCode(r), r = b, k && o.trigger("ajax" + (j ? "Success": "Error"), [w, m, j ? l: s]), q.fireWith(n, [w, x]), k && (o.trigger("ajaxComplete", [w, m]), --$.active || $.event.trigger("ajaxStop")))
                }
                "object" == typeof a && (c = a, a = b),
                c = c || {};
                var e, f, g, h, i, j, k, l, m = $.ajaxSetup({},
                c),
                n = m.context || m,
                o = n !== m && (n.nodeType || n instanceof $) ? $(n) : $.event,
                p = $.Deferred(),
                q = $.Callbacks("once memory"),
                r = m.statusCode || {},
                s = {},
                t = {},
                u = 0,
                v = "canceled",
                w = {
                    readyState: 0,
                    setRequestHeader: function(a, b) {
                        if (!u) {
                            var c = a.toLowerCase();
                            a = t[c] = t[c] || a,
                            s[a] = b
                        }
                        return this
                    },
                    getAllResponseHeaders: function() {
                        return 2 === u ? f: null
                    },
                    getResponseHeader: function(a) {
                        var c;
                        if (2 === u) {
                            if (!g) for (g = {}; c = Bb.exec(f);) g[c[1].toLowerCase()] = c[2];
                            c = g[a.toLowerCase()]
                        }
                        return c === b ? null: c
                    },
                    overrideMimeType: function(a) {
                        return u || (m.mimeType = a),
                        this
                    },
                    abort: function(a) {
                        return a = a || v,
                        h && h.abort(a),
                        d(0, a),
                        this
                    }
                };
                if (p.promise(w), w.success = w.done, w.error = w.fail, w.complete = q.add, w.statusCode = function(a) {
                    if (a) {
                        var b;
                        if (2 > u) for (b in a) r[b] = [r[b], a[b]];
                        else b = a[w.status],
                        w.always(b)
                    }
                    return this
                },
                m.url = ((a || m.url) + "").replace(Ab, "").replace(Eb, yb[1] + "//"), m.dataTypes = $.trim(m.dataType || "*").toLowerCase().split(ba), null == m.crossDomain && (j = Ib.exec(m.url.toLowerCase()), m.crossDomain = !(!j || j[1] === yb[1] && j[2] === yb[2] && (j[3] || ("http:" === j[1] ? 80 : 443)) == (yb[3] || ("http:" === yb[1] ? 80 : 443)))), m.data && m.processData && "string" != typeof m.data && (m.data = $.param(m.data, m.traditional)), z(Kb, m, c, w), 2 === u) return w;
                if (k = m.global, m.type = m.type.toUpperCase(), m.hasContent = !Db.test(m.type), k && 0 === $.active++&&$.event.trigger("ajaxStart"), !m.hasContent && (m.data && (m.url += (Fb.test(m.url) ? "&": "?") + m.data, delete m.data), e = m.url, m.cache === !1)) {
                    var x = $.now(),
                    y = m.url.replace(Hb, "$1_=" + x);
                    m.url = y + (y === m.url ? (Fb.test(m.url) ? "&": "?") + "_=" + x: "")
                } (m.data && m.hasContent && m.contentType !== !1 || c.contentType) && w.setRequestHeader("Content-Type", m.contentType),
                m.ifModified && (e = e || m.url, $.lastModified[e] && w.setRequestHeader("If-Modified-Since", $.lastModified[e]), $.etag[e] && w.setRequestHeader("If-None-Match", $.etag[e])),
                w.setRequestHeader("Accept", m.dataTypes[0] && m.accepts[m.dataTypes[0]] ? m.accepts[m.dataTypes[0]] + ("*" !== m.dataTypes[0] ? ", " + Mb + "; q=0.01": "") : m.accepts["*"]);
                for (l in m.headers) w.setRequestHeader(l, m.headers[l]);
                if (!m.beforeSend || m.beforeSend.call(n, w, m) !== !1 && 2 !== u) {
                    v = "abort";
                    for (l in {
                        success: 1,
                        error: 1,
                        complete: 1
                    }) w[l](m[l]);
                    if (h = z(Lb, m, c, w)) {
                        w.readyState = 1,
                        k && o.trigger("ajaxSend", [w, m]),
                        m.async && m.timeout > 0 && (i = setTimeout(function() {
                            w.abort("timeout")
                        },
                        m.timeout));
                        try {
                            u = 1,
                            h.send(s, d)
                        } catch(A) {
                            if (! (2 > u)) throw A;
                            d( - 1, A)
                        }
                    } else d( - 1, "No Transport");
                    return w
                }
                return w.abort()
            },
            active: 0,
            lastModified: {},
            etag: {}
        });
        var Ob = [],
        Pb = /\?/,
        Qb = /(=)\?(?=&|$)|\?\?/,
        Rb = $.now();
        $.ajaxSetup({
            jsonp: "callback",
            jsonpCallback: function() {
                var a = Ob.pop() || $.expando + "_" + Rb++;
                return this[a] = !0,
                a
            }
        }),
        $.ajaxPrefilter("json jsonp",
        function(c, d, e) {
            var f, g, h, i = c.data,
            j = c.url,
            k = c.jsonp !== !1,
            l = k && Qb.test(j),
            m = k && !l && "string" == typeof i && !(c.contentType || "").indexOf("application/x-www-form-urlencoded") && Qb.test(i);
            return "jsonp" === c.dataTypes[0] || l || m ? (f = c.jsonpCallback = $.isFunction(c.jsonpCallback) ? c.jsonpCallback() : c.jsonpCallback, g = a[f], l ? c.url = j.replace(Qb, "$1" + f) : m ? c.data = i.replace(Qb, "$1" + f) : k && (c.url += (Pb.test(j) ? "&": "?") + c.jsonp + "=" + f), c.converters["script json"] = function() {
                return h || $.error(f + " was not called"),
                h[0]
            },
            c.dataTypes[0] = "json", a[f] = function() {
                h = arguments
            },
            e.always(function() {
                a[f] = g,
                c[f] && (c.jsonpCallback = d.jsonpCallback, Ob.push(f)),
                h && $.isFunction(g) && g(h[0]),
                h = g = b
            }), "script") : void 0
        }),
        $.ajaxSetup({
            accepts: {
                script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
            },
            contents: {
                script: /javascript|ecmascript/
            },
            converters: {
                "text script": function(a) {
                    return $.globalEval(a),
                    a
                }
            }
        }),
        $.ajaxPrefilter("script",
        function(a) {
            a.cache === b && (a.cache = !1),
            a.crossDomain && (a.type = "GET", a.global = !1)
        }),
        $.ajaxTransport("script",
        function(a) {
            if (a.crossDomain) {
                var c, d = P.head || P.getElementsByTagName("head")[0] || P.documentElement;
                return {
                    send: function(e, f) {
                        c = P.createElement("script"),
                        c.async = "async",
                        a.scriptCharset && (c.charset = a.scriptCharset),
                        c.src = a.url,
                        c.onload = c.onreadystatechange = function(a, e) { (e || !c.readyState || /loaded|complete/.test(c.readyState)) && (c.onload = c.onreadystatechange = null, d && c.parentNode && d.removeChild(c), c = b, e || f(200, "success"))
                        },
                        d.insertBefore(c, d.firstChild)
                    },
                    abort: function() {
                        c && c.onload(0, 1)
                    }
                }
            }
        });
        var Sb, Tb = a.ActiveXObject ?
        function() {
            for (var a in Sb) Sb[a](0, 1)
        }: !1,
        Ub = 0;
        $.ajaxSettings.xhr = a.ActiveXObject ?
        function() {
            return ! this.isLocal && D() || E()
        }: D,
        function(a) {
            $.extend($.support, {
                ajax: !!a,
                cors: !!a && "withCredentials" in a
            })
        } ($.ajaxSettings.xhr()),
        $.support.ajax && $.ajaxTransport(function(c) {
            if (!c.crossDomain || $.support.cors) {
                var d;
                return {
                    send: function(e, f) {
                        var g, h, i = c.xhr();
                        if (c.username ? i.open(c.type, c.url, c.async, c.username, c.password) : i.open(c.type, c.url, c.async), c.xhrFields) for (h in c.xhrFields) i[h] = c.xhrFields[h];
                        c.mimeType && i.overrideMimeType && i.overrideMimeType(c.mimeType),
                        !c.crossDomain && !e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest");
                        try {
                            for (h in e) i.setRequestHeader(h, e[h])
                        } catch(j) {}
                        i.send(c.hasContent && c.data || null),
                        d = function(a, e) {
                            var h, j, k, l, m;
                            try {
                                if (d && (e || 4 === i.readyState)) if (d = b, g && (i.onreadystatechange = $.noop, Tb && delete Sb[g]), e) 4 !== i.readyState && i.abort();
                                else {
                                    h = i.status,
                                    k = i.getAllResponseHeaders(),
                                    l = {},
                                    m = i.responseXML,
                                    m && m.documentElement && (l.xml = m);
                                    try {
                                        l.text = i.responseText
                                    } catch(n) {}
                                    try {
                                        j = i.statusText
                                    } catch(n) {
                                        j = ""
                                    }
                                    h || !c.isLocal || c.crossDomain ? 1223 === h && (h = 204) : h = l.text ? 200 : 404
                                }
                            } catch(o) {
                                e || f( - 1, o)
                            }
                            l && f(h, j, l, k)
                        },
                        c.async ? 4 === i.readyState ? setTimeout(d, 0) : (g = ++Ub, Tb && (Sb || (Sb = {},
                        $(a).unload(Tb)), Sb[g] = d), i.onreadystatechange = d) : d()
                    },
                    abort: function() {
                        d && d(0, 1)
                    }
                }
            }
        });
        var Vb, Wb, Xb = /^(?:toggle|show|hide)$/,
        Yb = new RegExp("^(?:([-+])=|)(" + _ + ")([a-z%]*)$", "i"),
        Zb = /queueHooks$/,
        $b = [J],
        _b = {
            "*": [function(a, b) {
                var c, d, e = this.createTween(a, b),
                f = Yb.exec(b),
                g = e.cur(),
                h = +g || 0,
                i = 1,
                j = 20;
                if (f) {
                    if (c = +f[2], d = f[3] || ($.cssNumber[a] ? "": "px"), "px" !== d && h) {
                        h = $.css(e.elem, a, !0) || c || 1;
                        do i = i || ".5",
                        h /= i,
                        $.style(e.elem, a, h + d);
                        while (i !== (i = e.cur() / g) && 1 !== i && --j)
                    }
                    e.unit = d,
                    e.start = h,
                    e.end = f[1] ? h + (f[1] + 1) * c: c
                }
                return e
            }]
        };
        $.Animation = $.extend(H, {
            tweener: function(a, b) {
                $.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
                for (var c, d = 0,
                e = a.length; e > d; d++) c = a[d],
                _b[c] = _b[c] || [],
                _b[c].unshift(b)
            },
            prefilter: function(a, b) {
                b ? $b.unshift(a) : $b.push(a)
            }
        }),
        $.Tween = K,
        K.prototype = {
            constructor: K,
            init: function(a, b, c, d, e, f) {
                this.elem = a,
                this.prop = c,
                this.easing = e || "swing",
                this.options = b,
                this.start = this.now = this.cur(),
                this.end = d,
                this.unit = f || ($.cssNumber[c] ? "": "px")
            },
            cur: function() {
                var a = K.propHooks[this.prop];
                return a && a.get ? a.get(this) : K.propHooks._default.get(this)
            },
            run: function(a) {
                var b, c = K.propHooks[this.prop];
                return this.options.duration ? this.pos = b = $.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a,
                this.now = (this.end - this.start) * b + this.start,
                this.options.step && this.options.step.call(this.elem, this.now, this),
                c && c.set ? c.set(this) : K.propHooks._default.set(this),
                this
            }
        },
        K.prototype.init.prototype = K.prototype,
        K.propHooks = {
            _default: {
                get: function(a) {
                    var b;
                    return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (b = $.css(a.elem, a.prop, !1, ""), b && "auto" !== b ? b: 0) : a.elem[a.prop]
                },
                set: function(a) {
                    $.fx.step[a.prop] ? $.fx.step[a.prop](a) : a.elem.style && (null != a.elem.style[$.cssProps[a.prop]] || $.cssHooks[a.prop]) ? $.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
                }
            }
        },
        K.propHooks.scrollTop = K.propHooks.scrollLeft = {
            set: function(a) {
                a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
            }
        },
        $.each(["toggle", "show", "hide"],
        function(a, b) {
            var c = $.fn[b];
            $.fn[b] = function(d, e, f) {
                return null == d || "boolean" == typeof d || !a && $.isFunction(d) && $.isFunction(e) ? c.apply(this, arguments) : this.animate(L(b, !0), d, e, f)
            }
        }),
        $.fn.extend({
            fadeTo: function(a, b, c, d) {
                return this.filter(r).css("opacity", 0).show().end().animate({
                    opacity: b
                },
                a, c, d)
            },
            animate: function(a, b, c, d) {
                var e = $.isEmptyObject(a),
                f = $.speed(b, c, d),
                g = function() {
                    var b = H(this, $.extend({},
                    a), f);
                    e && b.stop(!0)
                };
                return e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
            },
            stop: function(a, c, d) {
                var e = function(a) {
                    var b = a.stop;
                    delete a.stop,
                    b(d)
                };
                return "string" != typeof a && (d = c, c = a, a = b),
                c && a !== !1 && this.queue(a || "fx", []),
                this.each(function() {
                    var b = !0,
                    c = null != a && a + "queueHooks",
                    f = $.timers,
                    g = $._data(this);
                    if (c) g[c] && g[c].stop && e(g[c]);
                    else for (c in g) g[c] && g[c].stop && Zb.test(c) && e(g[c]);
                    for (c = f.length; c--;) f[c].elem === this && (null == a || f[c].queue === a) && (f[c].anim.stop(d), b = !1, f.splice(c, 1)); (b || !d) && $.dequeue(this, a)
                })
            }
        }),
        $.each({
            slideDown: L("show"),
            slideUp: L("hide"),
            slideToggle: L("toggle"),
            fadeIn: {
                opacity: "show"
            },
            fadeOut: {
                opacity: "hide"
            },
            fadeToggle: {
                opacity: "toggle"
            }
        },
        function(a, b) {
            $.fn[a] = function(a, c, d) {
                return this.animate(b, a, c, d)
            }
        }),
        $.speed = function(a, b, c) {
            var d = a && "object" == typeof a ? $.extend({},
            a) : {
                complete: c || !c && b || $.isFunction(a) && a,
                duration: a,
                easing: c && b || b && !$.isFunction(b) && b
            };
            return d.duration = $.fx.off ? 0 : "number" == typeof d.duration ? d.duration: d.duration in $.fx.speeds ? $.fx.speeds[d.duration] : $.fx.speeds._default,
            (null == d.queue || d.queue === !0) && (d.queue = "fx"),
            d.old = d.complete,
            d.complete = function() {
                $.isFunction(d.old) && d.old.call(this),
                d.queue && $.dequeue(this, d.queue)
            },
            d
        },
        $.easing = {
            linear: function(a) {
                return a
            },
            swing: function(a) {
                return.5 - Math.cos(a * Math.PI) / 2
            }
        },
        $.timers = [],
        $.fx = K.prototype.init,
        $.fx.tick = function() {
            var a, c = $.timers,
            d = 0;
            for (Vb = $.now(); d < c.length; d++) a = c[d],
            !a() && c[d] === a && c.splice(d--, 1);
            c.length || $.fx.stop(),
            Vb = b
        },
        $.fx.timer = function(a) {
            a() && $.timers.push(a) && !Wb && (Wb = setInterval($.fx.tick, $.fx.interval))
        },
        $.fx.interval = 13,
        $.fx.stop = function() {
            clearInterval(Wb),
            Wb = null
        },
        $.fx.speeds = {
            slow: 600,
            fast: 200,
            _default: 400
        },
        $.fx.step = {},
        $.expr && $.expr.filters && ($.expr.filters.animated = function(a) {
            return $.grep($.timers,
            function(b) {
                return a === b.elem
            }).length
        });
        var ac = /^(?:body|html)$/i;
        $.fn.offset = function(a) {
            if (arguments.length) return a === b ? this: this.each(function(b) {
                $.offset.setOffset(this, a, b)
            });
            var c, d, e, f, g, h, i, j = {
                top: 0,
                left: 0
            },
            k = this[0],
            l = k && k.ownerDocument;
            if (l) return (d = l.body) === k ? $.offset.bodyOffset(k) : (c = l.documentElement, $.contains(c, k) ? ("undefined" != typeof k.getBoundingClientRect && (j = k.getBoundingClientRect()), e = M(l), f = c.clientTop || d.clientTop || 0, g = c.clientLeft || d.clientLeft || 0, h = e.pageYOffset || c.scrollTop, i = e.pageXOffset || c.scrollLeft, {
                top: j.top + h - f,
                left: j.left + i - g
            }) : j)
        },
        $.offset = {
            bodyOffset: function(a) {
                var b = a.offsetTop,
                c = a.offsetLeft;
                return $.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat($.css(a, "marginTop")) || 0, c += parseFloat($.css(a, "marginLeft")) || 0),
                {
                    top: b,
                    left: c
                }
            },
            setOffset: function(a, b, c) {
                var d = $.css(a, "position");
                "static" === d && (a.style.position = "relative");
                var e, f, g = $(a),
                h = g.offset(),
                i = $.css(a, "top"),
                j = $.css(a, "left"),
                k = ("absolute" === d || "fixed" === d) && $.inArray("auto", [i, j]) > -1,
                l = {},
                m = {};
                k ? (m = g.position(), e = m.top, f = m.left) : (e = parseFloat(i) || 0, f = parseFloat(j) || 0),
                $.isFunction(b) && (b = b.call(a, c, h)),
                null != b.top && (l.top = b.top - h.top + e),
                null != b.left && (l.left = b.left - h.left + f),
                "using" in b ? b.using.call(a, l) : g.css(l)
            }
        },
        $.fn.extend({
            position: function() {
                if (this[0]) {
                    var a = this[0],
                    b = this.offsetParent(),
                    c = this.offset(),
                    d = ac.test(b[0].nodeName) ? {
                        top: 0,
                        left: 0
                    }: b.offset();
                    return c.top -= parseFloat($.css(a, "marginTop")) || 0,
                    c.left -= parseFloat($.css(a, "marginLeft")) || 0,
                    d.top += parseFloat($.css(b[0], "borderTopWidth")) || 0,
                    d.left += parseFloat($.css(b[0], "borderLeftWidth")) || 0,
                    {
                        top: c.top - d.top,
                        left: c.left - d.left
                    }
                }
            },
            offsetParent: function() {
                return this.map(function() {
                    for (var a = this.offsetParent || P.body; a && !ac.test(a.nodeName) && "static" === $.css(a, "position");) a = a.offsetParent;
                    return a || P.body
                })
            }
        }),
        $.each({
            scrollLeft: "pageXOffset",
            scrollTop: "pageYOffset"
        },
        function(a, c) {
            var d = /Y/.test(c);
            $.fn[a] = function(e) {
                return $.access(this,
                function(a, e, f) {
                    var g = M(a);
                    return f === b ? g ? c in g ? g[c] : g.document.documentElement[e] : a[e] : void(g ? g.scrollTo(d ? $(g).scrollLeft() : f, d ? f: $(g).scrollTop()) : a[e] = f)
                },
                a, e, arguments.length, null)
            }
        }),
        $.each({
            Height: "height",
            Width: "width"
        },
        function(a, c) {
            $.each({
                padding: "inner" + a,
                content: c,
                "": "outer" + a
            },
            function(d, e) {
                $.fn[e] = function(e, f) {
                    var g = arguments.length && (d || "boolean" != typeof e),
                    h = d || (e === !0 || f === !0 ? "margin": "border");
                    return $.access(this,
                    function(c, d, e) {
                        var f;
                        return $.isWindow(c) ? c.document.documentElement["client" + a] : 9 === c.nodeType ? (f = c.documentElement, Math.max(c.body["scroll" + a], f["scroll" + a], c.body["offset" + a], f["offset" + a], f["client" + a])) : e === b ? $.css(c, d, e, h) : $.style(c, d, e, h)
                    },
                    c, g ? e: b, g, null)
                }
            })
        }),
        a.jQuery = a.$ = $,
        "function" == typeof define && define.amd && define.amd.jQuery && define("jquery", [],
        function() {
            return $
        })
    } (window),
    function(a) {
        if (a.support.cors || !a.ajaxTransport || !window.XDomainRequest) return a;
        var b = /^(https?:)?\/\//i,
        c = /^get|post$/i,
        d = new RegExp("^(//|" + location.protocol + ")", "i");
        return a.ajaxTransport("* text html xml json",
        function(e, f, g) {
            if (e.crossDomain && e.async && c.test(e.type) && b.test(e.url) && d.test(e.url)) {
                var h = null;
                return {
                    send: function(b, c) {
                        var d = "",
                        g = (f.dataType || "").toLowerCase();
                        h = new XDomainRequest,
                        /^\d+$/.test(f.timeout) && (h.timeout = f.timeout),
                        h.ontimeout = function() {
                            c(500, "timeout")
                        },
                        h.onload = function() {
                            var b = "Content-Length: " + h.responseText.length + "\r\nContent-Type: " + h.contentType,
                            d = {
                                code: 200,
                                message: "success"
                            },
                            e = {
                                text: h.responseText
                            };
                            try {
                                if ("html" === g || /text\/html/i.test(h.contentType)) e.html = h.responseText;
                                else if ("json" === g || "text" !== g && /\/json/i.test(h.contentType)) try {
                                    e.json = a.parseJSON(h.responseText)
                                } catch(f) {
                                    d.code = 500,
                                    d.message = "parseerror"
                                } else if ("xml" === g || "text" !== g && /\/xml/i.test(h.contentType)) {
                                    var i = new ActiveXObject("Microsoft.XMLDOM");
                                    i.async = !1;
                                    try {
                                        i.loadXML(h.responseText)
                                    } catch(f) {
                                        i = void 0
                                    }
                                    if (!i || !i.documentElement || i.getElementsByTagName("parsererror").length) throw d.code = 500,
                                    d.message = "parseerror",
                                    "Invalid XML: " + h.responseText;
                                    e.xml = i
                                }
                            } catch(j) {
                                throw j
                            } finally {
                                c(d.code, d.message, e, b)
                            }
                        },
                        h.onprogress = function() {},
                        h.onerror = function() {
                            c(500, "error", {
                                text: h.responseText
                            })
                        },
                        f.data && (d = "string" === a.type(f.data) ? f.data: a.param(f.data)),
                        h.open(e.type, e.url),
                        h.send(d)
                    },
                    abort: function() {
                        h && h.abort()
                    }
                }
            }
        }),
        a
    } (jQuery),
    jQuery.noConflict(),
    function(a, b) {
        function c(b) {
            for (var c, d, e, f, g = "",
            h = new Date,
            i = h.getMonth(); b--;) {
                h.getMonth() !== i && h.setDate(1),
                c = y(h, "yyyy/mm/dd"),
                h.setMonth(h.getMonth() + 1, 1),
                h.setDate(0),
                d = y(h, "yyyy/mm/dd"),
                e = c + "-" + d,
                f = a.fn.datePicker.months.cn[h.getMonth()],
                g += '<span class="tag" data-range="' + e + '">' + f + "</span> ";
                var j = new Date(c).getMonth() === (new Date).getMonth() ? new Date: new Date(c);
                e = [];
                for (var k = "",
                i = j.getMonth(); j.getMonth() === i;) if (0 === j.getDay()) k = y(j, "yyyy/mm/dd") + "-" + y(j, "yyyy/mm/dd"),
                e.push(k),
                j.setDate(j.getDate() + 6);
                else {
                    for (; 6 !== j.getDay();) j.setDate(j.getDate() + 1);
                    for (; j.getMonth() === i;) {
                        if (k = y(j, "yyyy/mm/dd"), j.setDate(j.getDate() + 1), j.getMonth() !== i) {
                            k += "-" + k,
                            e.push(k);
                            break
                        }
                        k += "-" + y(j, "yyyy/mm/dd"),
                        e.push(k),
                        j.setDate(j.getDate() + 6)
                    }
                }
                e = e.join(","),
                f = a.fn.datePicker.months.cn[h.getMonth()] + "\u7684\u5468\u672b",
                h.setMonth(h.getMonth() + 1, 1),
                g += e ? '<span class="sm_tag" data-range="' + e + '">' + f + "</span> ": '<span class="sm_tag disabled" data-range="' + e + '">' + f + "</span> "
            }
            return h = new Date,
            c = y(h, "yyyy/mm/dd"),
            h.setDate(h.getDate() + 6),
            d = y(h, "yyyy/mm/dd"),
            e = c + "-" + d,
            f = "\u4e00\u5468\u5185",
            g += '<span class="sm_tag" data-range="' + e + '">' + f + "</span> "
        }
        function d(b, c) {
            var d = this;
            if (this.$input = a(b), !this.$input.length) throw new Error("no input element.");
            a.extend(this, B, c),
            this.displayed instanceof Date || (this.displayed = new Date, this.displayed.setDate(15)),
            this.dateUpdater === z && (this.dateUpdater = function(a) {
                if ("cn" !== d.language) return a.getDate();
                var b, c = a.getDate();
                if (d.enableSolarFestival) {
                    var e = a.getMonth() + 1;
                    if (b = "" + (10 > e ? "0": "") + e + (10 > c ? "0": "") + c, b in w) return w[b]
                }
                if (d.enableLunarFestival) {
                    var f = u(a),
                    g = 0 | f.day,
                    h = f.month;
                    if (b = "" + (10 > h ? "0": "") + h + (10 > g ? "0": "") + g, b in v) return v[b]
                }
                if (d.enableSolarTerm) {
                    var i = t.getMonthSolarTerms(a.getFullYear(), a.getMonth());
                    if (c in i) return i[c]
                }
                return c
            }),
            this.init()
        }
        var e = /^(yy|yyyy)([^ym]*)(m{1,2})([^md]*)(d{1,2})$/i,
        f = /^(?:(\d{4})\/)?(\d{1,2})(?:\/(\d{1,2}))?/,
        g = /^(y|m)(\d+)$/,
        h = '<div class="poi_calendar"></div>',
        i = '<div class="calendar_tag"><span class="lg_tag selected">\u4efb\u4f55\u65f6\u95f4</span></div>',
        j = '<div class="cus_checkbox"><label><i class="icon ico_checkbox"></i>\u81ea\u5b9a\u4e49\u51fa\u884c\u65f6\u95f4</label><div class="date_selected">\u53ef\u524d\u540e\u6d6e\u52a8\u5929\u6570 <i class="icon ico_minus disabled"></i><span class="date_txt">0</span><i class="icon ico_plus"></i></div></div>',
        k = i + j,
        l = '<div class="calendar_tit"><span class="month_switch">Month Year</span><span class="month_prev"><i class="ico_arrow"></i></span><span class="month_next"><i class="ico_arrow"></i></span></div>',
        m = '<div class="calendar_box"></div>',
        n = '<ul class="items"></ul>',
        o = '<li class="item">?</li>',
        p = '<div class="cus_days"><p>\u51fa\u6e38\u5929\u6570</p><span class="tag selected">\u4e0d\u9650</span><span class="tag" data-range="[3,5]">3-5\u5929</span><span class="tag" data-range="[6,8]">6-8\u5929</span><span class="tag" data-range="[9,11]">9-11\u5929</span><span class="tag" data-range="[12,15]">12-15\u5929</span></div>',
        q = '<div class="calendar_bottom"><a href="javascript:;" class="btn btn_confirm">\u786e\u5b9a</a></div>',
        r = p + q,
        s = a(b.body),
        t = function() {
            var a = {},
            b = [],
            c = ["\u5c0f\u5bd2", "\u5927\u5bd2", "\u7acb\u6625", "\u96e8\u6c34", "\u60ca\u86f0", "\u6625\u5206", "\u6e05\u660e", "\u8c37\u96e8", "\u7acb\u590f", "\u5c0f\u6ee1", "\u8292\u79cd", "\u590f\u81f3", "\u5c0f\u6691", "\u5927\u6691", "\u7acb\u79cb", "\u5904\u6691", "\u767d\u9732", "\u79cb\u5206", "\u5bd2\u9732", "\u971c\u964d", "\u7acb\u51ac", "\u5c0f\u96ea", "\u5927\u96ea", "\u51ac\u81f3"],
            d = [0, 21208, 42467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693, 263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758],
            e = function(a, b) {
                var c = new Date(31556925974.7 * (a - 1900) + 6e4 * d[b] + Date.UTC(1900, 0, 6, 2, 5));
                return c.getUTCDate()
            };
            return {
                getMonthSolarTerms: function(d, f) {
                    d instanceof Date && (f = d.getMonth(), d = d.getFullYear());
                    var g = "" + d + f;
                    if (g in a) return a[g];
                    var h, i = a[g] = {};
                    return h = e(d - 1900, 2 * f),
                    i[h - 1] = c[2 * f],
                    h = e(d - 1900, 2 * f + 1),
                    i[h - 1] = c[2 * f + 1],
                    b.push(g),
                    b.length > 12 && delete a[b.shift()],
                    i
                }
            }
        } (),
        u = function() {
            function a(a) {
                var c, d = 348;
                for (c = 32768; c > 8; c >>= 1) d += f[a - 1900] & c ? 1 : 0;
                return d + b(a)
            }
            function b(a) {
                return c(a) ? 65536 & f[a - 1900] ? 30 : 29 : 0
            }
            function c(a) {
                return 15 & f[a - 1900]
            }
            function d(a, b) {
                return f[a - 1900] & 65536 >> b ? 30 : 29
            }
            function e(e) {
                var f, g = 0,
                h = 0,
                i = new Date(1900, 0, 31),
                j = (e - i) / 864e5,
                k = {};
                for (k.dayCyl = j + 40, k.monCyl = 14, f = 1900; 2050 > f && j > 0; f++) h = a(f),
                j -= h,
                k.monCyl += 12;
                for (0 > j && (j += h, f--, k.monCyl -= 12), k.year = f, k.yearCyl = f - 1864, g = c(f), k.isLeap = !1, f = 1; 13 > f && j > 0; f++) g > 0 && f == g + 1 && 0 == k.isLeap ? (--f, k.isLeap = !0, h = b(k.year)) : h = d(k.year, f),
                1 == k.isLeap && f == g + 1 && (k.isLeap = !1),
                j -= h,
                0 == k.isLeap && k.monCyl++;
                return 0 == j && g > 0 && f == g + 1 && (k.isLeap ? k.isLeap = !1 : (k.isLeap = !0, --f, --k.monCyl)),
                0 > j && (j += h, --f, --k.monCyl),
                k.month = f,
                k.day = j + 1,
                k
            }
            var f = [19416, 19168, 42352, 21717, 53856, 55632, 91476, 22176, 39632, 21970, 19168, 42422, 42192, 53840, 119381, 46400, 54944, 44450, 38320, 84343, 18800, 42160, 46261, 27216, 27968, 109396, 11104, 38256, 21234, 18800, 25958, 54432, 59984, 28309, 23248, 11104, 100067, 37600, 116951, 51536, 54432, 120998, 46416, 22176, 107956, 9680, 37584, 53938, 43344, 46423, 27808, 46416, 86869, 19872, 42448, 83315, 21200, 43432, 59728, 27296, 44710, 43856, 19296, 43748, 42352, 21088, 62051, 55632, 23383, 22176, 38608, 19925, 19152, 42192, 54484, 53840, 54616, 46400, 46496, 103846, 38320, 18864, 43380, 42160, 45690, 27216, 27968, 44870, 43872, 38256, 19189, 18800, 25776, 29859, 59984, 27480, 21952, 43872, 38613, 37600, 51552, 55636, 54432, 55888, 30034, 22176, 43959, 9680, 37584, 51893, 43344, 46240, 47780, 44368, 21977, 19360, 42416, 86390, 21168, 43312, 31060, 27296, 44368, 23378, 19296, 42726, 42208, 53856, 60005, 54576, 23200, 30371, 38608, 19415, 19152, 42192, 118966, 53840, 54560, 56645, 46496, 22224, 21938, 18864, 42359, 42160, 43600, 111189, 27936, 44448];
            return e
        } (),
        v = {
            "0101": "\u6625\u8282",
            "0115": "\u5143\u5bb5",
            "0505": "\u7aef\u5348",
            "0707": "\u4e03\u5915",
            "0715": "\u4e2d\u5143",
            "0815": "\u4e2d\u79cb",
            "0909": "\u91cd\u9633",
            1208 : "\u814a\u516b",
            1224 : "\u5c0f\u5e74"
        },
        w = {
            "0101": "\u5143\u65e6",
            "0214": "\u60c5\u4eba\u8282",
            "0308": "\u5987\u5973\u8282",
            "0312": "\u690d\u6811\u8282",
            "0401": "\u611a\u4eba\u8282",
            "0501": "\u52b3\u52a8\u8282",
            "0504": "\u9752\u5e74\u8282",
            "0601": "\u513f\u7ae5\u8282",
            "0701": "\u5efa\u515a\u8282",
            "0801": "\u5efa\u519b\u8282",
            "0910": "\u6559\u5e08\u8282",
            1001 : "\u56fd\u5e86\u8282",
            1224 : "\u5e73\u5b89\u591c",
            1225 : "\u5723\u8bde"
        },
        x = function(a, b) {
            return a instanceof Date ? a: a instanceof d ? a.get(b) : void 0
        },
        y = function(a, b) {
            if (!a) return "";
            if (!b) return a.toString();
            var c = a.getFullYear(),
            d = a.getMonth() + 1,
            f = a.getDate();
            return b.replace(e,
            function(a, b, e, g, h, i) {
                return "" + (b && 2 === b.length ? c.substr(2) : c) + e + (g && 2 === g.length && 10 > d ? "0" + d: d) + h + (i && 2 === i.length && 10 > f ? "0" + f: f)
            })
        },
        z = function(a) {
            return a.getDate()
        },
        A = function(a, b) {
            return a.getFullYear() + " " + b[a.getMonth()]
        },
        B = {
            language: "cn",
            currentPanel: "day",
            enableSolarTerm: !0,
            enableLunarFestival: !0,
            enableSolarFestival: !0,
            start: null,
            end: null,
            selected: null,
            readonly: !0,
            displayRange: null,
            radius: 0,
            mode: "range_length_acc",
            rangeLen: null,
            dateUpdater: z,
            titleUpdater: A,
            templates: {
                container: h,
                header: k,
                controller: l,
                panel: m,
                itemWrap: n,
                item: o,
                footer: r
            }
        },
        C = function(a) {
            function b(a, b) {
                var c = f.exec(a);
                if (c) return c[1] || c[3] ? new Date(c[1] || b.getFullYear(), c[2] ? +c[2] - 1 : b.getMonth(), c[3] || b.getDate()) : new Date(b.getFullYear(), b.getMonth(), c[2])
            }
            if (!a) return null;
            a += "";
            var c = new Date,
            d = a.split("-"),
            e = d[0],
            g = d[1];
            return {
                from: e ? b(e, c) : null,
                to: g ? b(g, c) : null
            }
        },
        D = function(b, c, d, e, f) {
            for (var g, h = ""; b--;) h += c;
            return g = a(d).append(h),
            f && g.addClass(f),
            e && g.children().addClass(e),
            g
        },
        E = function(a, b) {
            var c, d, e, f, g, h = new Date,
            i = (new Date).setHours(0, 0, 0, 0),
            j = "";
            h.setDate(h.getDate() + 89),
            h = h.setHours(23, 59, 59, 999);
            for (var k in a) b > 0 && (e = a[k].range, c = new Date(e.split("-")[0]).setHours(0, 0, 0, 0), d = new Date(e.split("-")[1]).setHours(23, 59, 59, 999), (d > i && h >= d || c >= i && h > c) && (i > c && (c = i), d > h && (d = h), f = y(new Date(c), "yyyy/mm/dd") + "-" + y(new Date(d), "yyyy/mm/dd"), g = a[k].text, j += '<span class="sm_tag" data-range="' + f + '">' + g + "</span> ", b--));
            return j
        },
        F = function(b) {
            var d, e = b.templates,
            f = a(e.container);
            f.append(e.header).append(e.controller);
            var g = c(3);
            if (window.festivals) {
                var h = E(window.festivals, 3);
                f.find(".calendar_tag").append(g + h)
            } else a.ajax({
                url: "//m.ctrip.com/restapi/soa2/11823/getHolidays",
                crossDomain: !0,
                success: function(a) {
                    f.find(".calendar_tag").append(g + E(a.holidays, 3))
                }
            });
            return d = a(e.panel).addClass("day_panel").append(D(42, e.item, e.itemWrap, "day", "days")),
            d.prepend(D(7, e.item, e.itemWrap, "week", "weeks")),
            f.append(d),
            f.append(e.footer),
            f
        },
        G = function(b, c, d, e, f, g, h, i, j, k) {
            var l = new Date(d.getTime()),
            m = j && j[0] && j[0].from.setHours(0, 0, 0, 0),
            n = j && j[0] && j[0].to.setHours(23, 59, 59, 999),
            o = e && e.getTime(),
            p = f && f.getTime(),
            q = !0,
            r = b.find(".day");
            l.setDate(1),
            l.setDate(l.getDate() - l.getDay()),
            b.find(".month_switch").text(i(d, g)),
            r.each(function(b) {
                var e = a(this),
                g = l.getTime(),
                i = l.getDate();
                if (e.removeClass("disabled visibility old new selected selected_center selected_start selected_end"), e.data("zDay", i), e.text(h(l)), l.getMonth() !== d.getMonth()) {
                    if (35 === b) return q = !1,
                    !1;
                    e.addClass("disabled visibility")
                } else m && n && g > m && n > g && (e.addClass("selected"), "range_center" !== k && "range_center_acc" !== k || !c || c.getDate() !== l.getDate() || e.addClass("selected_center")); (o && o > g || f && g > p) && e.removeClass("selected").addClass("disabled"),
                l.setDate(i + 1)
            }),
            r.slice(35)[q ? "show": "hide"]()
        };
        d.prototype = {
            constructor: d,
            reflect: function(b) {
                if (function() {
                    var a = new Date("2011-06-02T09:34:29+02:00");
                    a && 1307000069e3 === +a ? Date.fromISO = function(a) {
                        return new Date(a)
                    }: Date.fromISO = function(a) {
                        var b, c, d = /^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,
                        e = d.exec(a) || [];
                        if (e[1]) {
                            b = e[1].split(/\D/);
                            for (var f = 0,
                            g = b.length; g > f; f++) b[f] = parseInt(b[f], 10) || 0;
                            return b[1] -= 1,
                            b = new Date(Date.UTC.apply(Date, b)),
                            b.getDate() ? (e[5] && (c = 60 * parseInt(e[5], 10), e[6] && (c += parseInt(e[6], 10)), "+" == e[4] && (c *= -1), c && b.setUTCMinutes(b.getUTCMinutes() + c)), b) : NaN
                        }
                        return NaN
                    }
                } (), b) {
                    if (!b.mode) return;
                    var c = this,
                    d = x(this.start, "start"),
                    e = x(this.end, "end"),
                    f = this.$dom,
                    g = H.months[this.language] || H.months._default,
                    h = (H.weeks[this.language] || H.weeks._default, []);
                    b.departDateRanges && b.departDateRanges.length > 0 && (this.range = [], a.each(b.departDateRanges,
                    function() {
                        c.range.push({
                            from: Date.fromISO(this.startDate),
                            to: Date.fromISO(this.endDate)
                        }),
                        h.push(y(Date.fromISO(this.startDate), "yyyy/mm/dd") + "-" + y(Date.fromISO(this.endDate), "yyyy/mm/dd"))
                    })),
                    "range_length_acc" === b.mode && (this.switchMode("range_length_acc"), b.departDateRanges && b.departDateRanges.length > 0 && (f.find(".calendar_tag").find("span").eq(0).removeClass("selected"), f.find(".calendar_tag").find("span:gt(0)").each(function() {
                        var b = !0;
                        a.each(a(this).data("range").split(","),
                        function(a, c) { - 1 === h.indexOf(c) && (b = !1)
                        }),
                        b ? a(this).addClass("selected") : a(this).removeClass("selected")
                    }))),
                    "range_center_acc" === b.mode && (this.switchMode("range_center_acc"), this.radius = b.radius, f.find(".date_txt").text(this.radius), b.radius > 1 && f.find(".ico_minus ").removeClass("disabled"), this.selected = b.selected ? Date.fromISO(b.selected) : new Date, this.displayed = new Date(this.displayed.setFullYear(this.selected.getFullYear(), this.selected.getMonth(), 15)), this.displayRange = this.range, d && d.setHours(0, 0, 0, 0), e && e.setHours(23, 59, 59, 999), G(f, this.selected, this.displayed, d, e, g, this.dateUpdater, this.titleUpdater, this.displayRange, this.mode)),
                    b.minDays && b.maxDays && (this.rangeLen = [b.minDays, b.maxDays], f.find(".cus_days").find(".tag").eq(0).removeClass("selected"), f.find(".cus_days").find(".tag:gt(0)").each(function() {
                        a(this).data("range").join(",") === c.rangeLen.join(",") ? a(this).addClass("selected") : a(this).removeClass("selected")
                    })),
                    this.$input.trigger("confirm", this)
                }
            },
            init: function() {
                var a = this.$input,
                b = F(this);
                s.append(b.hide()),
                this.$dom = b,
                this.readonly && !a.attr("readonly") && (this.needRemoveReadonly = !0, a.attr("readonly", !0)),
                this.switchMode(this.mode),
                this.reset(),
                this.bindEvents(),
                a.trigger("init", [this, b]),
                this.reflectData && this.reflect(this.reflectData)
            },
            updatePicker: function(a) {
                var b = this;
                this.selectRangeByCenterDate(this.selected && +this.selected >= +this.start ? this.selected: null, this.radius),
                setTimeout(function() {
                    b.reflect(a)
                },
                200)
            },
            reset: function() {
                var b = x(this.start, "start"),
                c = x(this.end, "end"),
                d = this.$dom,
                e = H.months[this.language] || H.months._default,
                f = H.weeks[this.language] || H.weeks._default;
                this.radius = 0,
                d.find(".date_txt").text(this.radius),
                this.rangeLen = null,
                d.find(".cus_days").find(".tag").eq(0).addClass("selected").siblings().removeClass("selected"),
                this.range = void 0,
                d.find(".calendar_tag").find("span").eq(0).addClass("selected").siblings().removeClass("selected"),
                d.find(".week").each(function(b) {
                    a(this).html(f[b])
                }),
                "range_center_acc" === this.mode ? this.switchMode("range_length_acc") : "range_center" === this.mode && this.switchMode("range_length"),
                this.selected = void 0,
                this.displayRange = null,
                b && b.setHours(0, 0, 0, 0),
                c && c.setHours(23, 59, 59, 999),
                G(d, this.selected, this.displayed, b, c, e, this.dateUpdater, this.titleUpdater, this.displayRange, this.mode)
            },
            bindEvents: function() {
                function c() {
                    g.find(".date_txt").text(f.radius),
                    h.trigger("radiuschange", f),
                    f.selected || (f.selected = (new Date).addDays(1)),
                    f.selectRangeByCenterDate(f.selected, f.radius),
                    f.showval()
                }
                function d(a) {
                    f.displayed.setMonth(f.displayed.getMonth() + a),
                    G(g, f.selected, f.displayed, x(f.start, "start"), x(f.end, "end"), i, f.dateUpdater, f.titleUpdater, f.displayRange, f.mode),
                    h.trigger("monthswitch", f)
                }
                function e() {
                    k && clearTimeout(k),
                    k = setTimeout(function() {
                        var a = h.offset();
                        a.top += h.outerHeight() + 8,
                        g.css(a)
                    },
                    200)
                }
                var f = this,
                g = this.$dom,
                h = this.$input,
                i = H.months[this.language] || H.months._default,
                j = a(b);
                h.on("click",
                function(a) {
                    a.stopPropagation();
                    var b = h.offset();
                    g.css({
                        top: b.top + h.outerHeight() + 8,
                        left: b.left
                    }),
                    g.toggle()
                }),
                j.on("click",
                function(a) {
                    try {
                        "none" != g.css("display") && window.dateTimeChangeEventListener && window.dateTimeChangeEventListener()
                    } catch(b) {}
                    g.hide()
                }),
                g.on("click",
                function(a) {
                    a.stopPropagation()
                }),
                g.on("click", ".cus_checkbox label",
                function(b) {
                    b.stopPropagation();
                    var c = a(this).find("i");
                    if (c.hasClass("ico_checkbox"))"range_length" === f.mode ? f.switchMode("range_center") : f.switchMode("range_center_acc"),
                    g.find(".day.selected_center").trigger("click");
                    else if (c.hasClass("ico_checkbox_active")) {
                        "range_center" === f.mode ? f.switchMode("range_length") : f.switchMode("range_length_acc");
                        var d = g.find(".calendar_tag .selected:first");
                        d.trigger("click"),
                        d.trigger("click")
                    }
                    f.selectRangeByCenterDate(this.selected && +this.selected >= +this.start ? this.selected: null, this.radius),
                    f.showval()
                }),
                g.find(".calendar_tag").on("click", ".tag,.sm_tag,.lg_tag",
                function(b) {
                    b.preventDefault();
                    var c = a(this);
                    if (!c.hasClass("disabled")) {
                        c.hasClass("lg_tag") ? (c.hasClass("selected") || c.addClass("selected").siblings().removeClass("selected"), f.displayRange = null) : c.siblings(".lg_tag").hasClass("selected") ? (c.siblings(".lg_tag").removeClass("selected"), c.addClass("selected")) : c.hasClass("selected") ? (c.removeClass("selected"), c.siblings(".selected").length || (c.siblings(".lg_tag").addClass("selected"), f.displayRange = null)) : c.addClass("selected");
                        var d = f.$dom.find(".calendar_tag").children(".selected"),
                        e = [];
                        d.each(function() {
                            e.push(a(this).data("range"))
                        }),
                        void 0 !== e[0] && f.selectRange(e.join(",")),
                        f.showval()
                    }
                }),
                g.on("click", ".day",
                function(b) {
                    var c = a(this);
                    if (!c.hasClass("disabled")) {
                        var d = new Date("1970/01/01"),
                        e = f.displayed;
                        d.setFullYear(e.getFullYear()),
                        d.setMonth(e.getMonth()),
                        d.setDate(c.data("zDay")),
                        f.radius = parseInt(g.find(".date_selected .date_txt").text()),
                        f.selectRangeByCenterDate(d, f.radius),
                        f.showval()
                    }
                }),
                g.on("click", ".ico_minus",
                function(b) {
                    0 !== f.radius && (f.radius--, 0 === f.radius && a(this).addClass("disabled"), 9 === f.radius && g.find(".ico_plus").removeClass("disabled"), c())
                }).on("click", ".ico_plus",
                function(b) {
                    10 !== f.radius && (f.radius++, 1 === f.radius && g.find(".ico_minus").removeClass("disabled"), 10 === f.radius && a(this).addClass("disabled"), c())
                }).on("click", ".cus_days .tag",
                function(b) {
                    b.stopPropagation(),
                    f.selected || (f.selected = new Date);
                    var c = a(this);
                    f.rangeLen = c.data("range"),
                    c.addClass("selected").siblings().removeClass("selected"),
                    f.showval()
                }),
                g.on("click", ".month_prev",
                function(a) {
                    var b = new Date(f.displayed.getFullYear(), f.displayed.getMonth(), 1);
                    f.start && b <= f.start || d( - 1)
                }).on("click", ".month_next",
                function(a) {
                    var b = new Date(f.displayed.getFullYear(), f.displayed.getMonth() + 1, 0);
                    f.end && b >= f.end || d(1)
                }),
                g.on("click", ".btn_confirm",
                function(a) {
                    f.close(!0);
                    try {
                        window.dateTimeChangeEventListener && window.dateTimeChangeEventListener()
                    } catch(b) {}
                }),
                a(window).on("resize", e);
                var k
            }, get: function(a) {
                return a ? this[a] : this
            },
            set: function(b, c) {
                var d = this;
                "string" == typeof b ? this[b] = c: a.isPlainObject(b) && a.each(b,
                function(a, b) {
                    d[a] = b
                })
            },
            switchMode: function(a) {
                this.mode = a;
                var b = this.$dom.find(".cus_checkbox i"),
                c = this.$dom.find(".calendar_tag"),
                d = this.$dom.find(".cus_checkbox .date_selected"),
                e = this.$dom.find(".calendar_tit"),
                f = this.$dom.find(".calendar_box"),
                g = this.$dom.find(".cus_days"); - 1 !== a.indexOf("center") && (c.slideUp(), d.show(), e.show(), f.show(), b.hasClass("ico_checkbox") && b.removeClass("ico_checkbox").addClass("ico_checkbox_active")),
                -1 !== a.indexOf("length") && (c.slideDown(), d.hide(), e.hide(), f.hide(), b.hasClass("ico_checkbox_active") && b.removeClass("ico_checkbox_active").addClass("ico_checkbox")),
                -1 === a.indexOf("acc") ? g.hide() : g.show()
            },
            selectRange: function(b, c, d) {
                var e, f = this.selected,
                h = this.displayed,
                i = x(this.start, "start"),
                j = x(this.end, "end"),
                k = this.$dom,
                l = this.$input,
                m = H.months[this.language] || H.months._default,
                n = [];
                if (i && i.setHours(0, 0, 0, 0), j && j.setHours(23, 59, 59, 999), "string" == typeof b && b && void 0 === c && void 0 === d) {
                    if (e = g.exec(b)) return "m" === e[1].toLowerCase() ? this.selectMonth(e[2]) : this.selectYear(e[2]);
                    for (var o = b.split(","), p = 0; p < o.length; p++) e = C(o[p]),
                    b = new Date(e.from),
                    c = new Date(e.to),
                    n.push({
                        from: new Date(b.setHours(0, 0, 0, 0)),
                        to: new Date(c.setHours(23, 59, 59, 999))
                    })
                } else {
                    if (b = b || i, c = c || j, !b && !c) return;
                    if (b instanceof Date || (b = new Date(b)), c instanceof Date || (c = new Date(c)), i && b.getTime() < i.getTime() && (b = i), j && c.getTime() > j.getTime() && (c = j), b.getTime() > c.getTime()) return;
                    n.push({
                        from: b,
                        to: c
                    })
                }
                var q = a.Event("beforeselect");
                l.trigger(q, this),
                q.result !== !1 && (this.displayRange = n, ("range_center" === this.mode || "range_center_acc" === this.mode) && (b.getFullYear() !== h.getFullYear() && h.setFullYear(b.getFullYear()), h.setMonth(b.getMonth()), G(k, f, h, i, j, m, this.dateUpdater, this.titleUpdater, this.displayRange, this.mode)), l.trigger("afterselect", this))
            },
            selectRangeByCenterDate: function(a, b) {
                b = b || this.radius,
                this.selected = a || new Date;
                var c = this.selected.getDate();
                this.selectRange(new Date(this.selected).setDate(c - b), new Date(this.selected).setDate(c + b), !0)
            },
            selectRangeByLen: function(a, b) {
                b = b || this.radius,
                this.selected = a || new Date;
                var c = this.selected.getDate();
                this.$dom.find("input:checkbox").eq(1).is(":checked") ? this.selectRange(new Date(this.selected).setDate(c - 2), new Date(this.selected).setDate(c + 2), !0) : this.selectRange(new Date(this.selected).setDate(c), new Date(this.selected).setDate(c), !0)
            },
            selectMonth: function(a, b) {
                var c, d = new Date;
                b && d.setFullYear(b),
                d.setMonth( + a - 1, 1, 0),
                c = new Date(d),
                c.setMonth(a, 0),
                this.selectRange(d, c)
            },
            selectYear: function(a) {
                var b, c = new Date;
                c.setFullYear(a, 0, 1, 0),
                b = new Date(c),
                b.setMonth(12, 0, 0),
                this.selectRange(c, b)
            },
            unselect: function() {
                this.range = [],
                this.selected = void 0,
                this.reset()
            },
            hide: function() {
                this.$dom.hide()
            },
            close: function(b) {
                if (b) {
                    if ("range_length" === this.mode || "range_length_acc" === this.mode) {
                        var c = [],
                        d = this.$dom.find(".calendar_tag").children(".selected");
                        d.each(function() {
                            c.push(a(this).data("range"))
                        }),
                        void 0 !== c[0] && this.selectRange(c.join(","))
                    } else this.radius = parseInt(this.$dom.find(".date_selected .date_txt").text()),
                    this.selectRangeByCenterDate(this.selected, this.radius);
                    this.showval()
                } else this.$input.trigger("cancel", this);
                this.$dom.hide()
            },
            showval: function() {
                this.range = this.displayRange;
                var b = "";
                if (this.range) {
                    if ("range_length" === this.mode || "range_length_acc" === this.mode) {
                        var c = this.$dom.find(".calendar_tag").children(".selected"),
                        d = [];
                        c.each(function() {
                            d.push(a(this).text())
                        }),
                        b = d && d.length ? d[0] : "",
                        b += d && d.length > 1 ? "...": ""
                    } else {
                        var e = parseInt(this.$dom.find(".date_txt").text());
                        b = y(this.selected, "yyyy-mm-dd"),
                        b += e ? "\u524d\u540e": ""
                    }
                    b += "range_length" === this.mode || "range_center" === this.mode ? " \u51fa\u53d1": this.valLen()
                } else b = "\u4efb\u4f55\u65f6\u95f4",
                "range_length_acc" === this.mode && this.valLen() && (b = this.valLen());
                this.$input.val(b),
                this.$input.trigger("confirm", this)
            },
            val: function(a) {
                return a = a || "yyyy-mm-dd",
                this.range ? y(this.range[0], a) + "~" + y(this.range[1], a) : ""
            },
            valLen: function(a, b) {
                return this.rangeLen ? " \u51fa\u6e38" + this.rangeLen[0] + "~" + this.rangeLen[1] + "\u5929": ""
            },
            destroy: function() {
                this.$dom.remove(),
                this.$input.data("datePicker", null),
                this.$input.off("init beforeselect afterselect"),
                this.needRemoveReadonly && this.$input.removeAttr("readonly"),
                this.$input = null
            }
        };
        var H = a.fn.datePicker = function(b) {
            return this.each(function() {
                var c = a(this),
                e = c.data("datePicker");
                e || c.data("datePicker", new d(c, b))
            })
        },
        I = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        J = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        H.months = {
            en: I,
            _default: I,
            cn: ["\u4e00\u6708", "\u4e8c\u6708", "\u4e09\u6708", "\u56db\u6708", "\u4e94\u6708", "\u516d\u6708", "\u4e03\u6708", "\u516b\u6708", "\u4e5d\u6708", "\u5341\u6708", "\u5341\u4e00\u6708", "\u5341\u4e8c\u6708"]
        },
        H.weeks = {
            en: J,
            _default: J,
            cn: ["\u65e5", "\u4e00", "\u4e8c", "\u4e09", "\u56db", "\u4e94", "\u516d"]
        },
        H.defaults = B,
        a.DatePicker = d,
        d.getFestivalInfo = function(a) {
            var b, c = a.getDate(),
            d = a.getMonth() + 1;
            if (b = "" + (10 > d ? "0": "") + d + (10 > c ? "0": "") + c, b in w) return {
                date: a,
                type: "solar",
                key: b,
                value: w[b]
            };
            var e = u(a),
            f = 0 | e.day,
            g = e.month;
            return b = "" + (10 > g ? "0": "") + g + (10 > f ? "0": "") + f,
            b in v ? {
                date: a,
                type: "lunar",
                key: b,
                value: v[b]
            }: !1
        },
        d.formatDate = y
    } (jQuery, document),
    function(a) {
        a.createRangeDatePicker = function(b, c) {
            if ("string" == typeof b) {
                var d = function(a, b) {
                    var c = b || new Date;
                    return new Date( + c + 60 * (c.getTimezoneOffset() + a) * 1e3)
                },
                e = {
                    destCityName: "\u5168\u4e16\u754c",
                    travelType: "",
                    inputDepartureCityName: "",
                    inputDepartureCity: "",
                    departDateRanges: [],
                    departStringDate: "\u4efb\u4f55\u65f6\u95f4",
                    minDays: null,
                    maxDays: null,
                    inputArrivalCities: {
                        themes: [],
                        cities: [],
                        areas: []
                    },
                    inputArrivalCitiesMap: {
                        themes: [],
                        cities: [],
                        areas: []
                    },
                    city_offset: 480
                },
                f = a(b),
                g = d(480),
                h = (f.data("datePicker"),
                function() {
                    var a = f.val("\u4efb\u4f55\u65f6\u95f4").data("datePicker");
                    a.hide(),
                    a.reset(),
                    a.range = "\u4efb\u4f55\u65f6\u95f4",
                    a.radius = 0,
                    a.selected = null,
                    a.rangeLen = null;
                    var b = e;
                    b.radius = a.radius,
                    b.selected = a.selected,
                    b.mode = "range_length_acc",
                    b.departDateRanges = [],
                    b.departStringDate = "\u4efb\u4f55\u65f6\u95f4",
                    b.minDays = null,
                    b.maxDays = null
                });
                return f.on("init",
                function(a, b, c) {}).on("confirm",
                function(b, d) {
                    var g = e,
                    h = [];
                    d.range && d.range.length && a.each(d.range,
                    function(a, b) {
                        h.push({
                            startDate: b.from.toISOString(),
                            endDate: b.to.toISOString()
                        })
                    }),
                    g.departDateRanges = h,
                    g.departStringDate = f.val(),
                    g.minDays = d.rangeLen && d.rangeLen[0],
                    g.maxDays = d.rangeLen && d.rangeLen[1],
                    g.radius = d.radius,
                    g.mode = d.mode,
                    g.selected = d.selected,
                    c && c()
                }).on("keydown",
                function(a) {
                    a.preventDefault(),
                    h()
                }).datePicker({
                    start: g,
                    end: g.addDays(89),
                    readonly: !1,
                    radius: 0,
                    mode: "range_length_acc"
                }),
                f.data("datePicker").switchMode("range_length_acc"),
                {
                    $picker: f,
                    data: e
                }
            }
        }
    } (jQuery);
    var RECOMMEND_REPORT_KEY = "flt_oversea_recommend_online_v2",
    ORDERING_INPUT_KEY = "flt_oversea_ordering_input_online_basic",
    FIRST_RECOMMEND_PROD_V = "FIRST_RECOMMEND_PROD_V",
    FIRST_RECOMMEND_PROD_V5 = "First_RecommendProductV5",
    FIRST_RECOMMEND_PROD_V1 = "First_RecommendProductV1",
    FIRST_RECOMMEND_PROD_V7 = "First_RecommendProductV7",
    RECOMMEND_PROD_V = "RECOMMEND_PROD_V",
    RECOMMEND_PROD_V5 = "RecommendProductV5",
    RECOMMEND_PROD_V1 = "RecommendProductV1",
    COND_KEY = "Condition",
    HASDIRECT = "HasDirect",
    TYPE_ARRAY = ["1", "5", "6", "7"],
    local_ubt = {};
    local_ubt[HASDIRECT] = "N",
    Array.isArray || (Array.isArray = function(a) {
        return "[object Array]" === Object.prototype.toString.call(a)
    });
    var InternationalRecommend = {
        firstIndex: !1,
        firstRecommendProd: function(a, b) {
            var c = $.storage.get("isClicked");
            if (!c || "D" !== pageGlobal.NewUbt.FlightWay || "#builtUp" === location.hash || this.isDepart()) {
                var d = [];
                d = this.getSeqs(a);
                var e = {
                    Type: b || "",
                    Sequence: "5" === b && pageGlobal.NearDateDirectFlightRecommendSwitch ? this.formatNearDateData(a) : d
                };
                this.checkHelper(FIRST_RECOMMEND_PROD_V + b, {}),
                local_ubt[FIRST_RECOMMEND_PROD_V + b] = e,
                "7" == b && (local_ubt[FIRST_RECOMMEND_PROD_V + b].isClick = "N")
            }
        },
        formatNearDateData: function(a) {
            if (!a.length) return [];
            var b = {};
            return b.IsRt = a[0].ReturnDate ? !0 : !1,
            b.DepartureCity = a[0].DepartureCity,
            b.ArrivalCity = a[0].ArrivalCity,
            b.DepartureDate = [],
            b.ReturnDate = [],
            a.each(function(a) {
                b.DepartureDate.push(a.DepartureDate),
                b.IsRt && b.ReturnDate.push(a.ReturnDate)
            }),
            this.getSeqs(b)
        },
        getSeqs: function(a) {
            var b = [];
            return b[0] = {
                From: a.DepartureCity || "",
                To: a.ArrivalCity || "",
                StartTime: a.DepartureDate || "",
                Duration: "",
                Price: a.Price || "",
                IsTax: "",
                Tax: a.Tax || "",
                ProductID: "",
                Class: ""
            },
            a.IsRt && (b[1] = {
                To: a.DepartureCity || "",
                From: a.ArrivalCity || "",
                StartTime: a.ReturnDate || "",
                Duration: "",
                Price: a.Price || "",
                IsTax: "",
                Tax: a.Tax || "",
                ProductID: "",
                Class: ""
            }),
            b
        },
        handleClickNearDate: function(a, b) {
            if (a) {
                var c = $(a),
                d = c.find(".fdc-trip")[0].getElementsByTagName("span")[0],
                e = c.find(".fdc-trip")[1],
                f = e && e.getElementsByTagName("span")[0],
                g = d.getAttribute("data-dyear") + "-" + d.innerText,
                h = f ? f.getAttribute("data-ryear") + "-" + f.innerText: "";
                pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                    a && "5" === a.Type && (a.IsClick = "Y", b.nearOnlineFlightsUbt.RecommendProduct = a, b.nearOnlineFlightsUbt.RecommendProduct.BackDate = h, b.nearOnlineFlightsUbt.RecommendProduct.ToDate = g)
                }),
                $.storage.set("nearOnlineByRecommendUbt", b.nearOnlineFlightsUbt, 30);
                var i = $.extend(!0, {},
                b.nearOnlineFlightsUbt);
                i.DCityCode = pageGlobal.NewUbt.Sequence[0].From.CityCode,
                i.ACityCode = pageGlobal.NewUbt.Sequence[0].To.CityCode,
                this.setClickedObj("5", i, b.flightWay)
            }
        },
        handleClickCalendar: function(a, b, c) {
            var d = {
                IsClickCalendar: "Y",
                BackDate: a,
                ToDate: b,
                DCityCode: condition.SegmentList[0].DCityCode,
                ACityCode: condition.SegmentList[0].ACityCode
            };
            this.setClickedObj("5", d, c.flightWay)
        },
        handleClickNearDate: function(a, b) {
            if (a) {
                var c = $(a),
                d = c.find(".fdc-trip")[0].getElementsByTagName("span")[0],
                e = c.find(".fdc-trip")[1],
                f = e && e.getElementsByTagName("span")[0],
                g = d.getAttribute("data-dyear") + "-" + d.innerText,
                h = f ? f.getAttribute("data-ryear") + "-" + f.innerText: "";
                pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                    a && "5" === a.Type && (a.IsClick = "Y", b.nearOnlineFlightsUbt.RecommendProduct = a, b.nearOnlineFlightsUbt.RecommendProduct.BackDate = h, b.nearOnlineFlightsUbt.RecommendProduct.ToDate = g)
                }),
                $.storage.set("nearOnlineByRecommendUbt", b.nearOnlineFlightsUbt, 30);
                var i = $.extend(!0, {},
                b.nearOnlineFlightsUbt);
                i.DCityCode = pageGlobal.NewUbt.Sequence[0].From.CityCode,
                i.ACityCode = pageGlobal.NewUbt.Sequence[0].To.CityCode,
                this.setClickedObj("5", i, b.flightWay)
            }
        },
        reportFirstRP: function(a, b) {
            if (!$("#J_noResultTips").length) {
                var c = $.storage.get("isClicked");
                c ? this.firstIndex = this.firstIndex ? this.firstIndex: !1 : this.firstIndex = !0,
                this.existRecommendProduct() && this.reportHelper(RECOMMEND_REPORT_KEY, this.getFirstReportObj(a, b))
            }
        },
        existRecommendProduct: function() {
            for (var a = !1,
            b = 0,
            c = TYPE_ARRAY.length; c > b; b++) if (this.bIsNotEmpty(local_ubt[RECOMMEND_PROD_V + TYPE_ARRAY[b]]) || this.bIsNotEmpty(local_ubt[FIRST_RECOMMEND_PROD_V + TYPE_ARRAY[b]])) {
                a = !0;
                break
            }
            return a
        },
        bIsNotEmpty: function(a) {
            return Array.isArray(a) ? !0 : a && Object.keys(a).length ? !0 : !1
        },
        existHasDirect: function() {
            local_ubt[HASDIRECT] = "Y"
        },
        reportHelper: function(a, b) {
            b && window.__bfi.push(["_tracklog", a, $.stringifyJSON(b)])
        },
        calcFrompvid: function(a) {
            return "" + Number(a.split(".").pop()) - 1
        },
        commonFormatObj: function(a, b, c, d) {
            var e = d ? FIRST_RECOMMEND_PROD_V: RECOMMEND_PROD_V;
            a.Sort_Final = b.Sort_Final,
            a.Sort_Default = b.Sort_Default,
            a.RecommendProduct = [],
            c && this.saveFilterCond(c),
            a[COND_KEY] = b[COND_KEY],
            a[HASDIRECT] = b[HASDIRECT],
            a.Sequence = pageGlobal.NewUbt.Sequence,
            TYPE_ARRAY.forEach(function(c) {
                b[e + c] && a.RecommendProduct.push(b[e + c])
            }),
            a.FlightClass = pageGlobal.NewUbt.FlightClass,
            a.FlightWay = pageGlobal.NewUbt.FlightWay,
            a.PassengerType = pageGlobal.NewUbt.PassengerType,
            a.FromPvid = this.calcFrompvid(window.$_bf._getFullPV())
        },
        existCheaperAnotherTimeRecommend: function() {
            return !! local_ubt[FIRST_RECOMMEND_PROD_V + "6"]
        },
        existAirportRecommendCity: function() {
            return !! local_ubt[FIRST_RECOMMEND_PROD_V + "7"]
        },
        getFirstReportObj: function(a, b) {
            var c = {},
            d = this,
            e = local_ubt;
            if (this.firstIndex) {
                if (pageGlobal.NearDateDirectFlightRecommendSwitch) {
                    if ($(".rec_flt_box")[0] && "none" == $(".rec_flt_box")[0].style.display && $("#neardate_recom_box")[0] && "none" == $("#neardate_recom_box")[0].style.display) {
                        if (!this.existCheaperAnotherTimeRecommend() && !this.existAirportRecommendCity()) return ! 1;
                        $("#neardate_recom_box")[0] && "none" == $("#neardate_recom_box")[0].style.display ? delete local_ubt[FIRST_RECOMMEND_PROD_V + "5"] : $(".rec_flt_box")[0] && "none" == $(".rec_flt_box")[0].style.display && delete local_ubt[FIRST_RECOMMEND_PROD_V + "1"]
                    }
                } else if ($(".rec_flt_box")[0] && "none" == $(".rec_flt_box")[0].style.display && $(".rec_flt_box")[1] && "none" == $(".rec_flt_box")[1].style.display) {
                    if (!this.existCheaperAnotherTimeRecommend() && !this.existAirportRecommendCity()) return ! 1;
                    delete local_ubt[FIRST_RECOMMEND_PROD_V + "1"],
                    delete local_ubt[FIRST_RECOMMEND_PROD_V + "5"]
                }
                2 === pageGlobal.NewUbt.Sequence.length && e.Sort_Final.length == e.Sort_Default.length == 1 && "D" == b.flightWay && "builtUp" !== b.flightType && (e.Sort_Final[1] = e.Sort_Final[0], e.Sort_Default[1] = e.Sort_Default[0]),
                this.commonFormatObj(c, e, b, !0)
            } else this.commonFormatObj(c, e, b),
            c.HasDirect = e.HasDirect,
            c.FlightNoSort = e.FlightNoSort,
            c.OrigSelFlightNoSort = e.OrigSelFlightNoSort;
            return c.Sequence.forEach(function(a) {
                d.removeProp(a, "Drecommand")
            }),
            c.TriggerType = a || e.TriggerType,
            this.existAirportRecommendCity() && delete local_ubt[FIRST_RECOMMEND_PROD_V + "7"].Sequence,
            c
        },
        removeProp: function(a, b) {
            a.hasOwnProperty(b) && delete a[b]
        },
        setClickedObj: function(a, b, c) {
            b || (b = local_ubt[FIRST_RECOMMEND_PROD_V + a]),
            b && (this.firstIndex = !0, b.flightWay = c, b.firstRecommendIndex = 1, $.storage.set("isClicked", b), $.storage.set("isClicked_type", a))
        },
        bIsClicked: function() {
            return !! $.storage.get("isClicked") && !!$.storage.get("isClicked_type")
        },
        saveFilterCond: function(a) {
            this.checkHelper(COND_KEY, []),
            "D" !== a.flightWay || "freeStyle" !== a.flightType || this.isDepart() ? local_ubt[COND_KEY][0] = a.reportFilterCond() : local_ubt[COND_KEY][1] = a.reportFilterCond()
        },
        clearClickedObj: function() {
            $.storage.set("isClicked", null, 0),
            $.storage.set("isClicked_type", "", 0),
            $.storage.set("topRecommendProduct", null, 0)
        },
        recommendProdAfterClick: function(a, b) {
            var c, d, e, f, g, h = [],
            i = 0,
            j = $.storage.get("isClicked"),
            k = $.storage.get("topRecommendProduct"),
            l = [],
            m = $.storage.get("isClicked_type"),
            n = "TotalPrice" == a.curType ? !0 : !1,
            o = this.isDepart();
            if (j && j.firstRecommendIndex) {
                if ("S" === pageGlobal.NewUbt.FlightWay && (j.firstRecommendIndex = !1, h = b), "D" === pageGlobal.NewUbt.FlightWay && o && 1 == j.firstRecommendIndex && (j.firstRecommendIndex = 2, h = b), "D" !== pageGlobal.NewUbt.FlightWay || "D" != j.flightWay || o || "builtUp" === a.flightType || (h = b, e = h[0], j.firstRecommendIndex = !1), "D" === pageGlobal.NewUbt.FlightWay && "D" == j.flightWay && !o && "builtUp" === a.flightType) if (h = b, f = h[0], j.firstRecommendIndex = !1, "5" === m) {
                    for (var p = 0,
                    q = h.length; q > p; p++) if (1 == h[p].FlightInfo[0].TransferCount) {
                        f = h[p],
                        i = p;
                        break
                    }
                } else f = h[0];
                if ("5" !== m || e || f) d = h[0];
                else for (var p = 0,
                q = h.length; q > p; p++) if (1 == h[p].TransferCount) {
                    d = h[p],
                    i = p;
                    break
                }
                g = h.length
            } else k && (c = !0, d = k);
            if (d && !e && !f) {
                l[0] = this.setSeq(d, void 0, void 0, n, g),
                "S" !== pageGlobal.NewUbt.FlightWay || c || (d.OrigFlightNoSort = i + 1 || 1, $.storage.set("topRecommendProduct", d));
                var r = {
                    Type: m,
                    IsClick: "Y",
                    OrigFlightNoSort: c ? d.OrigFlightNoSort: i + 1 || 1,
                    Sequence: l
                };
                this.setIsClickCalendar(r, m, j),
                this.recommendHelper(m, r)
            }
            if (e && !f && this.recommendHelper(m, void 0, e, n, g), f) {
                var r = {
                    Type: m,
                    IsClick: "Y",
                    OrigFlightNoSort: i + 1 || 1,
                    Sequence: []
                };
                this.setIsClickCalendar(r, m, j),
                this.recommendHelper(m, r),
                this.recommendCombineTarget(m, f, n, g)
            }
        },
        setIsClickCalendar: function(a, b, c) {
            pageGlobal.NearDateDirectFlightRecommendSwitch && "D" === pageGlobal.NewUbt.FlightWay && "5" === b && (c && c.IsClickCalendar ? a.IsClickCalendar = c.IsClickCalendar: a.IsClickCalendar = "N")
        },
        airportRecommendCityClick: function() {
            local_ubt[FIRST_RECOMMEND_PROD_V + "7"] && (local_ubt[FIRST_RECOMMEND_PROD_V + "7"].isClick = "Y", $.storage.set("airportRecommendCityType", "7"))
        },
        setSeq: function(a, b, c, d, e) {
            var f, g, h; ! b && a.FareList && Array.isArray(a.FareList) && (f = this.getMin(a.FareList, "Price")),
            b && (f = this.getMin(b, "Price")),
            a.FlightDetail && Array.isArray(a.FlightDetail) && (g = this.concatProps(a.FlightDetail, "FlightNo")),
            f && (f.ClassName ? h = this.getClassGrade(f) : f.ClassInfo && Array.isArray(f.ClassInfo) && (h = this.concatProps(f.ClassInfo, "ClassGrade")));
            var i = {
                From: a.DPort || "",
                To: a.APort || "",
                StartTime: a.DepartTime || "",
                Duration: this.minToHHMM(a.FlightTime),
                Price: c ? c: d ? a.TotalPrice || "": a.Price || "",
                IsTax: d ? "Y": "N",
                ProductID: g || "",
                flightCount: e,
                Class: h || ""
            };
            return i
        },
        concatProps: function(a, b) {
            for (var c = "" + a[0][b], d = 1, e = a.length; e > d; d++) c += ";" + a[d][b];
            return c
        },
        getMin: function(a, b) {
            for (var c = a[0][b], d = a[0], e = 1, f = a.length; f > e; e++) a[e][b] < c && (c = a[e][b], d = a[e]);
            return d
        },
        getClassGrade: function(a) {
            if (a) {
                if (a.IsY) return "Y";
                if (a.IsF) return "F";
                if (a.IsS) return "S";
                if (a.IsC) return "C"
            }
            return ""
        },
        minToHHMM: function(a) {
            var b = Number(a);
            return this.addZero(Math.floor(b / 60)) + ":" + this.addZero(b % 60)
        },
        addZero: function(a) {
            return 10 > a ? "0" + a: a
        },
        handleRecommendUbt: function() {
            var a = $.storage.get("isClicked"),
            b = $.storage.get("isClicked_type"),
            c = pageGlobal.NewUbt.Sequence,
            d = pageGlobal.NewUbt.FlightWay;
            if (a && b) {
                var e = !1,
                f = "",
                g = "",
                h = "",
                i = "",
                j = a.flightWay;
                "1" === b ? (f = a.From.CityCode, g = a.To.CityCode) : "5" == b ? (f = a.DCityCode, g = a.ACityCode, h = a.RecommendProduct.ToDate, i = a.RecommendProduct.BackDate) : "6" == b ? (f = a.Sequence[0].From, g = a.Sequence[0].To, h = a.Sequence[0].StartTime, i = a.Sequence[1].StartTime) : e = !0,
                e = e || f != c[0].From.CityCode || g != c[0].To.CityCode || d != j ? !0 : 1 == b ? !1 : h == c[0].StartTime ? "D" === pageGlobal.NewUbt.FlightWay && i !== c[1].StartTime ? !0 : !1 : !0,
                e && this.clearClickedObj()
            }
        },
        sortHelper: function(a, b, c) {
            this.checkHelper(b, []),
            "D" === a.flightWay && "freeStyle" === a.flightType ? this.isDepart() ? this.sortAssign(c, b, 0) : this.sortAssign(c, b, 1) : "S" === a.flightWay ? this.sortAssign(c, b, 0, !0) : "D" === a.flightWay && "builtUp" === a.flightType && this.sortAssign(c, b, 0, !0)
        },
        sortAssign: function(a, b, c, d) {
            if (d) switch (a) {
            case "DepartTime":
                local_ubt[b] = [2];
                break;
            case "ArrivalTime":
                local_ubt[b] = [3];
                break;
            case "FlightTime":
                local_ubt[b] = [4];
                break;
            case "Price":
            case "TotalPrice":
                local_ubt[b] = [5];
                break;
            default:
                local_ubt[b] = [1]
            } else switch (a) {
            case "DepartTime":
                local_ubt[b][c] = 2;
                break;
            case "ArrivalTime":
                local_ubt[b][c] = 3;
                break;
            case "FlightTime":
                local_ubt[b][c] = 4;
                break;
            case "Price":
            case "TotalPrice":
                local_ubt[b][c] = 5;
                break;
            default:
                local_ubt[b][c] = 1
            }
        },
        isDepart: function() {
            var a = !1;
            return $("#StepPanel a:first").length > 0 && $("#StepPanel a:first").hasClass("active") && -1 !== $("#StepPanel a:first").find(".status-active").html().indexOf("\u53bb") && (a = !0),
            a
        },
        checkHelper: function(a, b) {
            local_ubt[a] || (local_ubt[a] = b)
        },
        recommendHelper: function(a, b, c, d, e) {
            c ? local_ubt[RECOMMEND_PROD_V + a] && local_ubt[RECOMMEND_PROD_V + a].Sequence && (local_ubt[RECOMMEND_PROD_V + a].Sequence[1] = this.setSeq(c, void 0, void 0, d, e)) : (this.checkHelper(RECOMMEND_PROD_V + a, {}), local_ubt[RECOMMEND_PROD_V + a] = b)
        },
        recommendCombineTarget: function(a, b, c, d) {
            local_ubt[RECOMMEND_PROD_V + a] && (local_ubt[RECOMMEND_PROD_V + a].Sequence[0] = this.setSeq(b.FlightInfo[0], b.FareList, c ? b.TotalPrice: b.Price, c, d), local_ubt[RECOMMEND_PROD_V + a].Sequence[1] = this.setSeq(b.FlightInfo[1], b.FareList, void 0, c, d))
        },
        saveFlightSortNo: function(a, b) {
            this.checkHelper("FlightNoSort", []),
            "\u9884\u8ba2" === b ? local_ubt.FlightNoSort.push(a) : local_ubt.FlightNoSort[0] = a
        },
        updateSort: function(a) {
            "\u9009\u5b9a" === a && (local_ubt.Sort_Default[1] = local_ubt.Sort_Final[0], local_ubt.Sort_Final[1] = local_ubt.Sort_Final[0])
        },
        saveOrigSelFlightNoSort: function(a, b) {
            this.checkHelper("OrigSelFlightNoSort", []),
            "\u9884\u8ba2" === b ? local_ubt.OrigSelFlightNoSort.push(a) : local_ubt.OrigSelFlightNoSort[0] = a
        },
        orderingInputRP: function(a) {
            var b = $.storage.get("isClicked"),
            c = $.storage.get("isClicked_type");
            a && (b && c ? "5" === c ? "S" === a.NewUbt.FlightWay && 1 === a.NewUbt.Sequence.length || "D" === a.NewUbt.FlightWay && this.isRoundtripDepartNoTransfer(a) ? this.storeRecommendProduct(a, c) : this.storeRecommendProduct(a, c, !0) : this.storeRecommendProduct(a, c) : this.storeRecommendProduct(a, c, !0)),
            this.clearClickedObj()
        },
        isRoundtripDepartNoTransfer: function(a) {
            for (var b = a.NewUbt.Sequence,
            c = 0,
            d = 0,
            e = b.length; e > d; d++) 1 == b[d].SegmentNo && c++;
            return 1 == c ? !0 : !1
        },
        storeRecommendProduct: function(a, b, c) {
            var d = -1;
            a.NewUbt.RecommendProduct = a.NewUbt.RecommendProduct || [];
            for (var e = 0,
            f = a.NewUbt.RecommendProduct.length; f > e; e++) if (a.NewUbt.RecommendProduct[e].Type == b) {
                d = e;
                break
            }
            if ( - 1 !== d) {
                if (!c) return;
                a.NewUbt.RecommendProduct.splice(d, 1)
            } else c || a.NewUbt.RecommendProduct.push({
                Type: b
            })
        }
    },
    STABLE_TPL = '<table><tbody>{{ if item.hideHead != true}}<tr><th>\u8d77\u98de\u524d{{if len == 4}}${item[2]}\u5c0f\u65f6\u524d{{/if}}</th><th>{{if len === 4}}\u8d77\u98de\u524d${item[2]}\u5c0f\u65f6\u4e4b\u540e{{else}}\u8d77\u98de\u540e{{/if}}</th></tr>{{/if}}<tr><td class="col-mid">${item[1]}</td><td>${item[len === 4 ? 3 : 2]}</td></tr></tbody></table>';
    online.getEndorseText = function(a, b, c) {
        return a + c
    },
    online.getEndorseBack = function(a, b, c) {
        var d = this,
        e = d.elem;
        if (b = b || $(e).attr("tips_ajax"), online.setNewUbtSpecial("refundhovertime"), (b || c) && !e.isAjax) {
            var f = function(b, c) {
                if (c && !e.isAjax) {
                    if (d.data.txt1 = online.getEndorseText(c, a, d.data.txt1.replace("loading...", ""), $(e)), $("#hdEndorse_001") && 1 == $("#hdEndorse_001").length) {
                        var f = $.parseJSON(c);
                        f && f.TicketChanceFlag && $("#hdEndorse_001").value(f.TicketChanceFlag)
                    }
                    $(a).find(".jmp_bd").html(d.data.txt1),
                    e.isAjax = !0;
                    try {
                        d._calcPos()
                    } catch(g) {}
                    online.reportTicketChange()
                }
            };
            if (c) {
                var g = "F";
                $("#StepPanel a:first").length > 0 && $("#StepPanel a:first").hasClass("active") && -1 !== $("#currentStep").html().indexOf("\u53bb") && (g = "T"),
                $.ajax(online.getBaseUrl("AjaxRequest/SearchFlights/SearchRemarkHandler.ashx"), {
                    method: "POST",
                    context: {
                        IsDepart: g,
                        FlightWay: (window.condition || window.pageGlobal).FlightWay,
                        remarkParameter: c
                    },
                    onsuccess: f
                })
            } else $.ajax(online.getBaseUrl(b), {
                cache: !0,
                async: !0,
                onsuccess: f
            })
        }
    },
    online.reportTicketChange = function() {
        if (pageGlobal.NewUbt.BookingChannel && pageGlobal.NewUbt.BookingChannel.length) {
            var a = {},
            b = function() {
                for (var a = {},
                b = {
                    bookingChannel: [],
                    reason: 3
                },
                c = 0; c < pageGlobal.NewUbt.BookingChannel.length; c++) b.bookingChannel.push(pageGlobal.NewUbt.BookingChannel[c]);
                return $("#hdEndorse_001") && 1 == $("#hdEndorse_001").length && (a = $("#hdEndorse_001").value(), a && (b.reason = a)),
                b
            };
            a = b(),
            window.__bfi.push(["_tracklog", "c_endorse_tag", $.stringifyJSON(a)])
        }
    },
    $(document.body).bind("mousedown",
    function(a) {
        var b = $(a.target);
        if (b.hasClass("xtab")) {
            if (b.hasClass("current")) return;
            var c = b.parentNode().parentNode(),
            d = 1 * b.attr("data-index"),
            e = b.offset(),
            f = e.left - c.offset().left;
            c.find(".current").removeClass("current"),
            b.addClass("current"),
            c.find(".pane").hide(),
            c.find(".pane:eq(" + d + ")").css("display", "block"),
            c.find(".slide-block").css({
                width: parseInt(e.width) + "px",
                left: f + "px"
            });
            try {
                a.stop()
            } catch(a) {}
            return ! 1
        }
    }),
    function(win) {
        var stopoverRemind = {
            stopoverRemindUBT: {
                lug_display: 0,
                lug_hover: 0,
                oth_display: 0,
                oth_hover: 0
            },
            REMIND_KEY: "c_remindtag",
            onHoverStopoverRemind: function(a) {
                var b = this,
                c = {
                    Content: b.getContent(a)
                };
                if (window.__bfi.push(["_tracklog", b.REMIND_KEY, $.stringifyJSON(c)]), 0 == this.stopoverRemindUBT.lug_hover || 0 == this.stopoverRemindUBT.oth_hover) {
                    var d;
                    try {
                        d = $(a).text()
                    } catch(e) {}
                    d && -1 != d.indexOf("\u884c\u674e") ? this.stopoverRemindUBT.lug_hover = 1 : this.stopoverRemindUBT.oth_hover = 1
                }
            },
            getContent: function(target) {
                try {
                    var params = target.getAttribute("data-params"),
                    paramsObj = eval("(" + params + ")");
                    paramsObj.options && paramsObj.options.content && (params = paramsObj.options.content.txt0);
                    var outHTML = target.jmp.content.innerHTML || params,
                    res = {},
                    $target = $(target);
                    return res.Detail = this.getHTML(outHTML),
                    res.Is_transfer = this.getIsTransfer(target),
                    res.lug_direct = this.getLugDirect(outHTML),
                    res.Isinclude_transitvisa = (res.Detail || "").indexOf("\u8fc7\u5883\u7b7e") >= 0 ? 1 : 0,
                    res
                } catch(e) {}
            },
            getIsTransfer: function(a) {
                var b = jQuery(a).closest(".flight-stop-info"),
                c = 0;
                return b && b.find(".flight-stop").each(function(a, b) {
                    for (var d = b.childNodes,
                    a = 0,
                    e = d.length; e > a; a++) if (jQuery(d[a]).hasClass("stop-city-transfer")) {
                        c = 1;
                        break
                    }
                }),
                c
            },
            getLugDirect: function(a) {
                var b = a.indexOf("\u76f4\u8fbe"),
                c = a.indexOf("\u975e\u76f4\u8fbe"),
                d = a.indexOf("\u662f\u5426\u9700\u8981\u529e\u7406\u4e2d\u8f6c\u6258\u8fd0\uff0c\u9700\u54a8\u8be2\u59cb\u53d1\u5730\u503c\u673a\u67dc\u53f0");
                return - 1 == c && -1 != b ? 1 : -1 == c && -1 == b && -1 != d ? 2 : 0
            },
            getHTML: function(a) {
                var b = jQuery("<div>" + a + "</div>");
                return b.find("h4").each(function(a, b) {
                    b.innerHTML && (b.innerHTML += ":")
                }),
                b.find("p").each(function(a, b) {
                    b.innerHTML && (b.innerHTML += ";")
                }),
                jQuery.trim(b.text())
            },
            calcStopoverRemindDisplay: function() {
                if (0 == this.stopoverRemindUBT.lug_display || 0 == this.stopoverRemindUBT.oth_display) {
                    var a = this;
                    $(".J-transfer-warn").each(function(b) {
                        var c = $(b).text();
                        c && -1 != c.indexOf("\u884c\u674e") ? a.stopoverRemindUBT.lug_display = 1 : a.stopoverRemindUBT.oth_display = 1
                    })
                }
            },
            saveStopoverRemindUBT: function() {
                pageGlobal && pageGlobal.NewUbt && (pageGlobal.NewUbt.Remindtag ? (pageGlobal.NewUbt.Remindtag.lug_display = this.stopoverRemindUBT.lug_display, pageGlobal.NewUbt.Remindtag.lug_hover = this.stopoverRemindUBT.lug_hover, pageGlobal.NewUbt.Remindtag.oth_display = this.stopoverRemindUBT.oth_display, pageGlobal.NewUbt.Remindtag.oth_hover = this.stopoverRemindUBT.oth_hover) : pageGlobal.NewUbt.Remindtag = this.stopoverRemindUBT)
            },
            clearRemindList: function() {
                try {
                    pageGlobal.NewUbt.Remindtag && pageGlobal.NewUbt.Remindtag.remindList && (pageGlobal.NewUbt.Remindtag.remindList = [])
                } catch(a) {}
            },
            remindTipsUBT: function(a) {
                var b = [{
                    title: "\u8f6c\u673a\u7b7e\u8bc1\u884c\u674e\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u8f6c\u673a\u7b7e\u8bc1\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u8f6c\u673a\u884c\u674e\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u7b7e\u8bc1\u884c\u674e\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u4e2d\u8f6c\u884c\u674e\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u8fc7\u5883\u7b7e\u63d0\u9192",
                    display: 0
                },
                {
                    title: "\u8f6c\u673a\u63d0\u9192",
                    display: 0
                }],
                c = function(a, b) {
                    a.each(function(a, c) {
                        var d = "";
                        switch ((a.Tips && a.Tips.length > 0 || 1 === a.IsDifferentAirPort || a.CorssVisa || a.LuggageDirectTip) && (1 === a.IsDifferentAirPort || a.CorssVisa || a.LuggageDirectTip) && (1 === a.IsDifferentAirPort && (d += "\u8f6c\u673a"), a.CorssVisa && (d += 1 === a.IsDifferentAirPort || a.LuggageDirectTip ? "\u7b7e\u8bc1": "\u8fc7\u5883\u7b7e"), a.LuggageDirectTip && (1 === a.IsDifferentAirPort || a.CorssVisa || (d += "\u4e2d\u8f6c"), d += "\u884c\u674e"), d += "\u63d0\u9192"), d) {
                        case "\u8f6c\u673a\u7b7e\u8bc1\u884c\u674e\u63d0\u9192":
                            b[0].display++,
                            d = "";
                            break;
                        case "\u8f6c\u673a\u7b7e\u8bc1\u63d0\u9192":
                            b[1].display++,
                            d = "";
                            break;
                        case "\u8f6c\u673a\u884c\u674e\u63d0\u9192":
                            b[2].display++,
                            d = "";
                            break;
                        case "\u7b7e\u8bc1\u884c\u674e\u63d0\u9192":
                            b[3].display++,
                            d = "";
                            break;
                        case "\u4e2d\u8f6c\u884c\u674e\u63d0\u9192":
                            b[4].display++,
                            d = "";
                            break;
                        case "\u8fc7\u5883\u7b7e\u63d0\u9192":
                            b[5].display++,
                            d = "";
                            break;
                        case "\u8f6c\u673a\u63d0\u9192":
                            b[6].display++,
                            d = ""
                        }
                    })
                };
                if (a.each(function(a, d) {
                    a.FlightDetail ? c(a.FlightDetail, b) : a.FlightInfo.each(function(a, d) {
                        c(a.FlightDetail, b)
                    })
                }), pageGlobal && pageGlobal.NewUbt) if (pageGlobal.NewUbt.Remindtag && !pageGlobal.NewUbt.Remindtag.remindList) pageGlobal.NewUbt.Remindtag.remindList = [];
                else {
                    pageGlobal.NewUbt.Remindtag && pageGlobal.NewUbt.Remindtag.remindList || (pageGlobal.NewUbt.Remindtag = {},
                    pageGlobal.NewUbt.Remindtag.remindList = []);
                    var d = pageGlobal.NewUbt.Remindtag.remindList;
                    d.push(b),
                    b = [{
                        title: "\u8f6c\u673a\u7b7e\u8bc1\u884c\u674e\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u8f6c\u673a\u7b7e\u8bc1\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u8f6c\u673a\u884c\u674e\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u7b7e\u8bc1\u884c\u674e\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u4e2d\u8f6c\u884c\u674e\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u8fc7\u5883\u7b7e\u63d0\u9192",
                        display: 0
                    },
                    {
                        title: "\u8f6c\u673a\u63d0\u9192",
                        display: 0
                    }]
                }
            }
        };
        win.stopoverRemind = stopoverRemind
    } (window),
    online.getStopoverVisaInfo = function(a, b) {
        var c = this.elem,
        d = $(c).attr("tips_ajax");
        if (d && !c.isAjax) {
            c.isAjax = !0;
            var e = this;
            $.ajax(online.getBaseUrl(d), {
                cache: !0,
                async: !0,
                onsuccess: function(d, f) {
                    if (f = $.parseJSON(f), f && 200 === f.Status && (f = f.Message, e.data)) if ($(a).css("min-width", "240px"), b) {
                        var g = e.data.txt0.indexOf("<h4>\u4e2d\u8f6c\u6258\u8fd0\u884c\u674e</h4>");
                        0 > g ? e.data.txt0 += "<h4>\u8fc7\u5883\u7b7e</h4><p>" + f + "</p>": e.data.txt0 = e.data.txt0.substring(0, g) + "<h4>\u8fc7\u5883\u7b7e</h4><p>" + f + "</p>" + e.data.txt0.substring(g),
                        $(a).find(".jmp_content").html(e.data.txt0)
                    } else {
                        var h = $(a).find(".jmp_bd");
                        h.length < 1 && (h = $(a).find("p")),
                        h.html(e.data.txt0 = f)
                    }
                    window.stopoverRemind && window.stopoverRemind.onHoverStopoverRemind(c)
                },
                onerror: function() {
                    c.isAjax = !1
                }
            })
        } else window.stopoverRemind && window.stopoverRemind.onHoverStopoverRemind(c)
    },
    online.config.airline = function(a, b) {
        var c = {
            message: {
                filterResult: "\u652f\u6301\u2191\u2193\u9009\u62e9\uff0c\u6309\u82f1\u6587\u6392\u5e8f"
            },
            template: {
                suggestionInit: function(a) {
                    var c = a.find("a[data]");
                    c.bind("mouseover",
                    function() {
                        $(this).addClass("hover")
                    }).bind("mouseout",
                    function() {
                        $(this).removeClass("hover")
                    }),
                    $(b.modElement).bind("blur",
                    function() {
                        a.hide()
                    }).bind("focus",
                    function() {
                        a.show()
                    }).bind("keyup",
                    function(a) {
                        var b = a.target,
                        c = online.$get("btnSearchFlight"),
                        d = isNaN(a.keyCode) ? a.charCode: a.keyCode;
                        13 == d && "txtAirline" == b.id && c.focus()
                    })
                },
                suggestionIpad: '<a href="javascript:void(0)" class="ico_key" id="mini_c_address_keyboard">Keyboard</a><a href="javascript:void(0)" class="address_close" id="mini_c_address_close">close</a>',
                suggestion: '<div class="c_address_select"><div class="c_address_wrap">{ipad}<div class="c_address_hd">\u652f\u6301\u4e2d\u6587|\u4ee3\u7801\u641c\u7d22</div><div style="" class="c_address_list">{{enum(key,arr) data}}{{each arr}}<a href="javascript:;" title="${display}" data="${data}"><span>${rightDisplay}</span>${display}</a>{{/each}}{{/enum}}</div></div></div>',
                suggestionStyle: '				.c_address_hd { height: 24px; border-color: #2C7ECF; border-style: solid; border-width: 1px 1px 0; background-color: #67A1E2; color: #fff; line-height: 24px; text-align:center }				.c_address_bd { border-color: #999999; border-style: solid; border-width: 0 1px 1px; overflow: hidden; padding:10px; }				.c_address_select { width:232px; height:355px; font-family: Arial, Simsun; font-size: 12px; }				.c_address_wrap { width: 230px; height:405px; min-height: 305px; margin: 0; padding: 0 0 4px; border: 1px solid #969696; background:#fff; text-align: left; }				.c_address_hd { margin:-1px; }				.c_address_list { margin: 0; padding: 0; height:300px; }				.c_address_list span { float: right; font: 10px/22px verdana; margin: 0; overflow: hidden; padding: 0; text-align: right; white-space: nowrap; width: 110px; }				.c_address_list a { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; color: #0055AA; cursor: pointer; display: block; height: 22px; line-height: 22px; min-height: 22px; overflow: hidden; padding: 1px 9px 0; text-align: left; text-decoration: none; }				.c_address_list a.hover,.c_address_list a:hover { background: none repeat scroll 0 0 #E8F4FF; border-bottom: 1px solid #7F9DB9; border-top: 1px solid #7F9DB9; }				.address_selected { background: none repeat scroll 0 0 #FFE6A6; color: #FFFFFF; height: 22px; }				.c_address_pagebreak { line-height: 25px; margin: 0; padding: 0; text-align: center; }				.c_address_pagebreak a { color: #0055AA; display: inline-block; font-family: Arial, Simsun, sans-serif; font-size: 14px; margin: 0; padding: 0 4px; text-align: center; text-decoration: underline; width: 15px; }				a.address_current { color: #000; text-decoration: none; }				.c_address_select .ico_key, .c_address_select .ico_unkey{position: absolute;top: 1px;left: 1px;width: 34px;height: 24px;overflow: hidden;line-height: 999em;font-size: 0;content: "";background: url(//pic.c-ctrip.com/ctripOnPad/ico_key.png) no-repeat 0 0;-webkit-transform: scale(.7);}				.c_address_select .address_close {position: absolute;top: 3px;right: 4px;width: 18px;height: 19px;overflow: hidden;line-height: 999em;font-size: 0;content: "";text-indent: 99em;background: url(//pic.c-ctrip.com/ctripOnPad/pad_address_icon.png) no-repeat -32px 0;-webkit-transform: scale(0.5);}				.c_address_select .ico_unkey {background: url(//pic.c-ctrip.com/ctripOnPad/ico_unkey.png) no-repeat 0 0;}			',
                filterStyle: "				.c_address_hd { height: 24px; border-color: #2C7ECF; border-style: solid; border-width: 1px 1px 0; background-color: #67A1E2; color: #fff; line-height: 24px; padding-left: 10px; word-break: break-all; }				.c_address_bd { border-color: #999999; border-style: solid; border-width: 0 1px 1px; overflow: hidden; padding:10px; }				.c_address_select { width:232px; height:355px; font-family: Arial, Simsun; font-size: 12px; }				.c_address_wrap { width: 230px; height:349px; min-height: 305px; margin: 0; padding: 0 0 4px; border: 1px solid #969696; background:#fff; text-align: left; }				.c_address_hd { margin:-1px; }				.c_address_list { margin: 0; padding: 0; height:300px; }				.c_address_list label { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; display: block; height: 22px; line-height: 22px; min-height: 22px; overflow: hidden; padding: 1px 9px 0; text-align: center; }				.c_address_list span { float: right; font: 10px/22px verdana; margin: 0; overflow: hidden; padding: 0; text-align: right; white-space: nowrap; width: 110px; }				.c_address_list a { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; color: #0055AA; cursor: pointer; display: block; height: 22px; line-height: 22px; min-height: 22px; overflow: hidden; padding: 1px 9px 0; text-align: left; text-decoration: none; }				.c_address_list a.hover { background: none repeat scroll 0 0 #E8F4FF; border-bottom: 1px solid #7F9DB9; border-top: 1px solid #7F9DB9; }				.address_selected { background: none repeat scroll 0 0 #FFE6A6; color: #FFFFFF; height: 22px; }				.c_address_pagebreak { line-height: 25px; margin: 0; padding: 0; text-align: center; }				.c_address_pagebreak a { color: #0055AA; display: inline-block; font-family: Arial, Simsun, sans-serif; font-size: 14px; margin: 0; padding: 0 4px; text-align: center; text-decoration: underline; width: 15px; }				a.address_current { color: #000; text-decoration: none; }			"
            }
        };
        return online.extend(c.template, {
            suggestionInitIpad: c.template.suggestionInit,
            suggestionIpad: c.template.suggestion.replace("{ipad}", c.template.suggestionIpad),
            suggestionStyleIpad: c.template.suggestionStyle,
            suggestion: c.template.suggestion.replace("{ipad}", "")
        }),
        c
    },
    online.config.address = function(a) {
        var b = {
            message: {
                filterResult: "${val}\uff0c\u6309\u5b57\u7b26\u987a\u5e8f\u6392\u5e8f",
                noFilterResult: " \u5bf9\u4e0d\u8d77\uff0c\u65e0\u5339\u914d\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002 "
            },
            template: {
                suggestion: '                <div class="c_address_box">                    <div class="c_address_hd"><a class="close" href="javascript:;" onmousedown="this.focus();">&times;</a>\u652f\u6301\u4e2d\u6587/\u62fc\u97f3/\u82f1\u6587\u8f93\u5165</div>                    <ol class="c_address_ol">                        {{enum(key) data}}                            <li><span>${key}</span></li>                        {{/enum}}                    </ol>                    {{enum(key,arr) data}}                        <ul class="c_address_ul">                            {{each arr}}                                <li><a data="${data}" href="javascript:void(0);">${display}</a></li>                            {{/each}}                        </ul>                    {{/enum}}						<ul class="c_country_ul" id="${hotCountrySuggestionId}" style="display:none;">						</ul>                </div>            ',
                suggestionStyle: "				.c_address_box { padding: 10px; width: 408px; border: 1px solid #999; background-color: #fff; }				.c_address_box .close { float: right; width: 20px; height: 20px; color: #666; text-align: center; font: bold 16px / 20px Simsun; }				.c_address_box .close:hover { color: #FFA800; text-decoration: none; }				.c_address_box .c_address_ol { margin-top: 0; margin-bottom: 6px; width: 100%; height: 22px; border-bottom: 2px solid #ccc; }				.c_address_box .c_address_ol li { position: relative; display: inline; float: left; margin-right: 2px; line-height: 22px; cursor: pointer; }				.c_address_box .c_address_ol li span { white-space: nowrap; display: block; padding: 0 8px; }				.c_address_box .c_address_ol .hot_selected { display: block; padding: 0 7px; margin-bottom: -2px; border-bottom: 2px solid #06c; color: #06c; font-weight: bold; }				.c_address_box .c_address_ul, .c_address_box .c_country_ul { display: inline-block; overflow: hidden; *zoom: 1; }				.c_address_box .c_address_ul li, .c_address_box .c_country_ul li{ float: left; height: 22px; overflow: hidden; width: 92px; }				.c_address_box .c_address_ul a, .c_address_box .c_country_ul a{ display: block; overflow: hidden; margin: 0 2px 2px 0; padding-left: 5px; height: 22px; color: #333; text-overflow: ellipsis; white-space: nowrap; line-height: 22px; }				.c_address_box .c_address_ul a:hover, .c_address_box .c_country_ul a:hover{ background-color: #2577E3; color: #fff; text-decoration: none; }				.c_address_hd, .c_address_hd_error { margin-bottom: 10px; color: #999; }				.c_address_select .c_address_hd, .c_address_select .c_address_hd_error { padding: 5px 10px; }				.c_address_box .c_country_ul{ width: 100%; border-top: 1px solid #ccc; margin-top: 5px; padding-top: 5px; }			",
                filterPageSize: 10,
                suggestionStyleIpad: '				.c_address_box {position:relative;width:435px !important;background-color:#FFFFFF;font-size:12px;}				.c_address_box a {text-decoration:none;}				.c_address_hd {padding-left:10px;padding-right:24px;height:24px;text-indent:32px;text-align:center;border-color:#2C7ECF;border-style:solid;border-width:1px 1px 0;background-color:#67A1E2;color:#CEE3FC;line-height:24px;}				.c_address_hd strong {color:#FFFFFF;}				.c_address_bd {overflow:hidden;padding:10px;border-color:#999999;border-style:solid;border-width:0 1px 1px;}				.c_address_ol {margin:0;padding:0 0 20px;border-bottom:1px solid #5DA9E2;}				.c_address_ol li {float:left;height:20px;color:#005DAA;list-style-type:none;text-align:center;line-height:20px;cursor:pointer;}				.c_address_ol li span {display:block;padding:0 8px;white-space:nowrap;}				.c_address_ol li .hot_selected {display:block;padding:0 7px;border-color:#5DA9E2;border-style:solid;border-width:1px 1px 0;background-color:#FFFFFF;color:#000000;font-weight:bold;}				.c_address_ul {margin:0;padding:4px 0 0;width:100%;}				.c_address_ul li {float:left;overflow:hidden;width:103px;height:24px;}				.c_address_ul li a {display:block;padding-left:5px;height:22px;border:1px solid #FFFFFF;color:#1148A8;line-height:22px;}				.c_address_ul li a:hover {border:1px solid #ACCCEF;background-color:#E8F4FF;text-decoration:none;}				.c_address_box .ico_key,				.c_address_box .ico_unkey {position:absolute;top:1px;left:1px;width:34px;height:24px;overflow:hidden;line-height:999em;font-size:0;content:"";background:url(//pic.c-ctrip.com/ctripOnPad/ico_key.png) no-repeat 0 0;-webkit-transform:scale(.7);}				.c_address_box .ico_unkey {background:url(//pic.c-ctrip.com/ctripOnPad/ico_unkey.png) no-repeat 0 0;}				.c_address_box .address_close  {position:absolute;top:3px;right:4px;width:18px;height:19px;overflow:hidden;line-height:999em;font-size:0;content:"";text-indent:99em;background:url(//pic.c-ctrip.com/ctripOnPad/pad_address_icon.png) no-repeat -32px 0;-webkit-transform:scale(0.5);}			',
                filter: '				<div class="c_address_select">					<div class="c_address_wrap">						<div class="{{if !hasResult}}c_address_hd_error{{else}}c_address_hd{{/if}}">{{if hasResult}}{{tmpl message.filterResult}}{{else}}{{tmpl message.noFilterResult}}{{/if}}</div>						{{if hasResult}}							<div class="c_address_list">								{{each (i,item) list}}									{{if cQuery.type(item)=="string"}}										<label>${item}</label>									{{else}}										<a href="javascript:void(0);" data="${data}" style="display: block;">{{tmpl data.split("|")[3] }}<span>${left}</span></a>									{{/if}}								{{/each}}							</div>							{{if page.max>0}}								<div class="c_address_pagebreak">									{{if page.current>0}}										<a href="javascript:void(0);" page="${page.current-1}">&lt;-</a>									{{/if}}									{{if page.current<2}}										{{loop(index) Math.min(5,page.max+1)}}											<a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>										{{/loop}}									{{else page.current>page.max-2}}										{{loop(index) Math.max(0,page.max-4),page.max+1}}											<a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>										{{/loop}}									{{else}}										{{loop(index) Math.max(0,page.current-2),Math.min(page.current+3,page.max+1)}}											<a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>										{{/loop}}									{{/if}}									{{if page.current<page.max}}										<a href="javascript:void(0);" page="${page.current+1}">-&gt;</a>									{{/if}}								</div>							{{/if}}						{{/if}}					</div>				</div>			',
                filterStyle: "				.c_address_select { width:302px; font-family: Verdana, Arial; font-size: 12px; }				.c_address_wrap { width:300px; margin:0; padding:0 0 4px; border:1px solid #969696; background:#fff; text-align:left; }				.c_address_list { margin: 0; padding: 0; _height:370px; }				.c_address_list label { display: block; height:30px; padding:7px 9px 0; text-align: center; }				.c_address_list span { display:block; font: 10px/12px verdana; margin: 0; overflow: hidden; padding: 0; white-space: nowrap; color:#999; -webkit-text-size-adjust:none; }				.c_address_list a { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; color: #0055AA; cursor: pointer; display: block; height: 30px; line-height: 14px; min-height: 22px; overflow: hidden; padding:5px 9px 0; text-align: left; text-decoration: none; }				.c_address_list a.hover { background: none repeat scroll 0 0 #E8F4FF; border-bottom: 1px solid #7F9DB9; border-top: 1px solid #7F9DB9; }				.c_address_list b { color:#03459d; }				.address_selected { background: none repeat scroll 0 0 #FFE6A6; color: #FFFFFF; height: 22px; }				.c_address_pagebreak { line-height: 25px; margin: 0; padding: 0; text-align: center; }				.c_address_pagebreak a { color: #0055AA; display: inline-block; font-family: Arial, Simsun, sans-serif; font-size: 14px; margin: 0; padding: 0 4px; text-align: center; text-decoration: underline; width: 15px; }				a.address_current { color: #000; text-decoration: none; }"
            },
            jsonpFilter: (online.siteName || "/") + "international/tools/GetCities.ashx?s=${key}&a=" + ("start" == a[0].getAttribute("mod_address_source") ? "0": "1") + "&t=" + ("big5" == $.config("charset") ? "1": "0"),
            delay: 50
        };
        return online.extend(b.template, {
            filterIpad: b.template.filter,
            filterStyleIpad: b.template.filterStyle
        }),
        b
    };
    var addressFocusFlag = !0;
    online.create("util.RegisterMod", {
        options: {
            version: {
                address: "1.0",
                notice: "1.1",
                validate: "1.1",
                jmpInfo: "1.0",
                jmp: "1.0",
                calendar: "6.0",
                adFrame: "1.0",
                animate: "1.0",
                allyes: "1.0",
                tab: "1.2",
                sideBar: "2.0",
                emailPrompt: "1.0"
            },
            elements: $("[mod]"),
            charset: $.config("charset"),
            inits: {},
            jmpInfoTpl: {
                jmp_title: '<div class="jmp_hd"><h3 id="para1">${txt0}</h3></div><div id="para2" class="jmp_bd">${txt1}</div>',
                "#transit": '<div class="jmp_hd"><h3 id="txt0">${txt0}</h3></div><div class="jmp_bd"><div><span id="txt1" class="pubFlights_${txt3} airline">&nbsp;${txt1}</span> </div><div class="prindex_turn">\u8f6c<span></span></div><div><span id="txt2" class="pubFlights_${txt4} airline">&nbsp;${txt2}</span></div></div>'
            }
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a);
                for (var b in this.version) this.inits[b] = {};
                this.saveStorage = "flightintl_searchBoxVals_poi_" + this.charset,
                $.storage.remove(this.saveStorage),
                this.searchBoxVals = {},
                this.lowPriceCache = {},
                this.loadData(),
                this.modElement = null
            },
            toLocalTime: function(a) {
                if (!a) return (new Date).toDate();
                var b = a.split("|");
                if (b.length < 2) return (new Date).toDate();
                var c = b[ - 1 != b[1].indexOf(")(") ? 5 : 4];
                return online.getLocalTime(c)
            },
            loadData: function() {
                this.cookies = $.parseJSON($.cookie.get("FlightIntl", "Search"));
                var a = this.cookies;
                if (a && !(a.length < 3)) {
                    var b = this.searchBoxVals;
                    b.multipleRound = 3 === a.length ? "S": "D",
                    b.flightintl_startcity_single = a[0],
                    b.flightintl_arrivalcity_single = a[1];
                    var c = a[2] || "";
                    if (c && c.isDate()) {
                        var d = a[3],
                        e = this.toLocalTime(a[0]);
                        if (c.toDate() < e && (d && d.isDate() && (a[3] = d = new Date((new Date).getTime() + (d.toDate() - c.toDate())).addDays(1).toFormatString("yyyy-MM-dd")), a[2] = c = (new Date).addDays(1).toFormatString("yyyy-MM-dd"), 5 === a.length)) for (var f = a[4].length; f--;) a[4][f][2] = "";
                        b.flightintl_startdate_single = c,
                        d && d.isDate() ? b.flightintl_backdate_single = d: (a[3] = "", delete b.flightintl_backdate_single)
                    } else a[2] = "",
                    "D" === b.multipleRound && (a[3] = ""),
                    delete b.flightintl_startdate_single,
                    delete b.flightintl_backdate_single
                }
            },
            clearNotice: function(a) {
                online.clearNotice($(a))
            },
            getFirstCityNameByIp: function(a, b) {
                if (a.length < 1 || a.value().trim().length > 0 || this.searchBoxVals.flightintl_startcity_single) return ! 1;
                var c = this;
                $.loader.jsonp(online.siteName + "international/tools/GetUserPosition.ashx?t=0", {
                    charset: online.charset,
                    onload: function(d) {
                        if ("" != d && -1 != d.indexOf("|") && d.length < 150) {
                            var e = a.attr("mod_save_id");
                            e && (c.searchBoxVals[e] = d);
                            var f = c.inits.address[a[0].id || a[0].name];
                            f && (addressFocusFlag = !1, f.method("select", d), $.cookie.set("FlightIntl", "Search", $.stringifyJSON([d]), {
                                path: "/",
                                domain: location.host.split(".").slice( - 2).join(".")
                            }), setTimeout(function() {
                                addressFocusFlag = !0,
                                f.method("focus", {
                                    isHidden: !0,
                                    isSelected: !0
                                })
                            },
                            200), b && b([d])),
                            online.clearNotice(a)
                        }
                    }
                })
            },
            saveSearchBoxVals: function() {},
            clearSearchBoxVals: function(a) {
                "undefined" != typeof this.searchBoxVals[a] && delete this.searchBoxVals[a]
            },
            getMod: function(a, b) {
                return $(a).getMod(b, this.version[b])
            },
            docRegisterJmpInfo: function() {
                if (!this.isRegisterJmp) {
                    this.isRegisterJmp = !0;
                    var a = this.version.jmp;
                    $.mod.load("jmp", a,
                    function() {
                        $(document).regMod("jmp", a, {})
                    })
                }
            },
            register: function(a) {
                var b = this,
                c = function() {
                    b.getValidate(),
                    a && a.apply(b, arguments),
                    b.registerAll()
                };
                return window.cQuery && window.cQuery.mod && window.cQuery.mod._mods && "address_poi" in window.cQuery.mod._mods ? c() : $LAB.script(jsList.mods || getUrl("mods.js")).wait(c),
                this
            },
            getResourceUrl: function(a) {
                var b, c = {
                    PRO: "//webresource.c-ctrip.com/code/cquery/resource/address/flightintl/",
                    FIL: window.resourceURL,
                    AIL: "AjaxRequest/SearchFlights/GetAirlineHandler.ashx"
                },
                d = a + "_gb2312.js",
                e = window.releaseNo || "?_=" + Math.random(),
                f = pageGlobal[a + "Abled"];
                return pageGlobal.IsOpenSearchAirlineVersionSwitch && "airline" == a ? c.AIL + e: ("nationality" != a && "airline" != a && "dest_poi_timezone" != a && "start_poi_timezone" != a && (f = !0), b = c[f ? "PRO": "FIL"] || c.PRO, b + d + e)
            },
            register_address: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    this.modElement = a;
                    var b = a.attr("focus_loader"),
                    c = this,
                    d = this.version.address,
                    e = "",
                    f = function(a) {
                        var b = a.attr("mod_address_source"),
                        f = a.attr("id") || a.attr("name"),
                        g = a.attr("mod_address_reference"),
                        h = a.attr("mod_save_id"),
                        i = a.attr("mod_address_focusnext"),
                        j = a.attr("mod_address_hide"),
                        k = a.attr("mod_save_value");
                        if ("Alliance" !== b) {
                            k = k && "true" == k.toLowerCase() ? !0 : !1;
                            var l = a.attr("mod_address_tpl") ? online.config[e = a.attr("mod_address_tpl")](a, this) : {},
                            m = "address" === e;
                            m && (b += "_poi_timezone");
                            var n = {
                                name: f,
                                jsonpSource: c.getResourceUrl(b),
                                isFocusNext: !1,
                                _isFocusNext: i && "true" == i ? !0 : "false" == i ? !1 : $("#" + i),
                                isAutoCorrect: !0,
                                offset: a.attr("mod_address_position") ? 1 * a.attr("mod_address_position") : 5,
                                sort: ["^0$", "^1$", "^3$", "^0", "^1", "^3", "0", "1", "3", "^4+$"],
                                message: {
                                    sort: ["", "", "", "", "", "", "", "", "", '"${val}" \u56fd\u5bb6\u540d\uff0c\u76f8\u5173\u57ce\u5e02']
                                }
                            },
                            o = function(a, b) {
                                var d = a.attr("mod_next_value") ? $("#" + a.attr("mod_next_value")) : [],
                                e = a.attr("mod_address_reference"),
                                f = m ? b: [a.value(), e ? $("#" + e).value() : ""].join("|");
                                a.attr("mod_change_value", f),
                                d.length > 0 && !online.isNull(a[0]) && (online.isNull(d[0]) || null == d.value().match(/\([a-zA-Z]+\)/)) && d.attr("mod_change_id", a.attr("id"));
                                var g = a.attr("mod_address_date");
                                if (null != g) {
                                    var h = $("#" + g);
                                    if (h.length > 0) if (b) {
                                        var i = c.toLocalTime(b),
                                        j = i,
                                        k = 1 * (g.match(/(\d+)$/) || [0]).pop();
                                        if (k > 1) {
                                            g = g.replace(/\d+$/, k - 1),
                                            2 === k && -1 != g.indexOf("txtDDate") && (g = g.replace("txtDDate", "txtDate"));
                                            var l = $("#" + g.replace(/\d+$/, k - 1));
                                            l.length > 0 && l.value().isDate() && j < l.value().toDate() && (j = l.value().toDate())
                                        }
                                        h.data("minDate", j.toStdDateString()),
                                        h.data("MinDate", i.toStdDateString())
                                    } else {
                                        h.removeData("MinDate"),
                                        j = (new Date).toDate();
                                        var k = 1 * (g.match(/(\d+)$/) || [0]).pop();
                                        if (k > 1) {
                                            g = g.replace(/\d+$/, k - 1),
                                            2 === k && -1 != g.indexOf("txtDDate") && (g = g.replace("txtDDate", "txtDate"));
                                            var l = $("#" + g);
                                            l.length > 0 && l.value().isDate() && (j = l.value().toDate())
                                        }
                                        h.data("minDate", j.toStdDateString())
                                    }
                                }
                            };
                            g && (n.relate = {
                                2 : "#" + g
                            }),
                            m && (n.source = online.getInitSuggestion(b), delete l.template.filter, delete l.template.filterStyle, delete l.template.filterIpad, delete l.template.filterStyleIpad, l.jsonpFilter = "/international/tools/poi.ashx?charset=utf-8&key=${key}&channel=1&mode=1&f=1&v=" + (pageGlobal.POIVersion || "1"), l.delay = 150, j && (n.hideType = {},
                            n.hideType[j] = 1)),
                            $.extend(n, l),
                            "true" === $("#hdn_IsIncludedNoBookingFlights").value().toLowerCase() && (delete n.jsonpSource, "gb2312" == online.charset ? n.source = {
                                data: "@China|\u4e2d\u56fd\u5927\u9646|CN@",
                                suggestion: {
                                    "": [{
                                        display: "\u4e2d\u56fd\u5927\u9646",
                                        data: "China|\u4e2d\u56fd\u5927\u9646|CN",
                                        rightDisplay: "China"
                                    }]
                                }
                            }: n.source = {
                                data: "@China|\u4e2d\u570b\u5927\u9678|CN@",
                                suggestion: {
                                    "": [{
                                        display: "\u4e2d\u570b\u5927\u9678",
                                        data: "China|\u4e2d\u570b\u5927\u9678|CN",
                                        rightDisplay: "China"
                                    }]
                                }
                            }),
                            $.mod.load(m ? "address_poi": "address", m ? "2.0": d,
                            function() {
                                if (c.inits.address[f] = a.regMod(m ? "address_poi": "address", m ? "2.0": d, n), c.inits.address[f].method("bind", "change",
                                function(a, b) {
                                    var d = m ? b.data: b.items;
                                    h && "undefined" != typeof d && (c.searchBoxVals[h] = d),
                                    o($(this), d),
                                    setTimeout(function() {
                                        this.blur()
                                    }.bind(this))
                                }), a.bind("focus",
                                function() {
                                    var a = $(this).attr("mod_change_id"),
                                    b = $("#" + a).attr("mod_change_value");
                                    if (online.isNull(this) && b) if (m) {
                                        addressFocusFlag = !1;
                                        var c = $(this).getMod("address_poi", "2.0");
                                        c.method("select", b),
                                        setTimeout(function() {
                                            c.method("focus", {
                                                isSelected: !0
                                            }),
                                            addressFocusFlag = !0
                                        },
                                        100)
                                    } else {
                                        b = b.split("|"),
                                        $(this).value(b[0]);
                                        var d = $(this).attr("mod_address_reference");
                                        d && $("#" + d).value(b[1])
                                    }
                                }), a.bind("blur",
                                function() {
                                    if (addressFocusFlag) {
                                        var a = null,
                                        b = n._isFocusNext;
                                        if (b || $.isCDom(b)) {
                                            if ($.isCDom(b)) a = b[0];
                                            else switch ($.type(b)) {
                                            case "string":
                                                a = $(b)[0];
                                                break;
                                            case "object":
                                                "focus" in b && (a = b);
                                                break;
                                            case "boolean":
                                                var c = this.form;
                                                if (c) for (var d = c.elements,
                                                e = 0,
                                                f = 0,
                                                g = d.length - 1; g > f; f++) {
                                                    if (e) {
                                                        var h = $(d[f]);
                                                        if ((d[f].offsetWidth || d[f].offsetHeight) && "none" !== h.css("display") && "hidden" !== h.css("visibility")) {
                                                            a = d[f];
                                                            break
                                                        }
                                                    }
                                                    d[f] == this && (e = 1)
                                                }
                                            }
                                            if (a && online.isNull(a) && !online.isNull(this)) try {
                                                a.focus()
                                            } catch(i) {} else this.blur()
                                        }
                                    }
                                }), m && c.inits.address[f].method("bind", "userinput",
                                function(a, b) {
                                    if ("keydown" === b.eventType || "blur" === b.eventType || "filterMousedown" === b.eventType) {
                                        var c = (b.target && b.target.getAttribute("log") || "|").split("|"),
                                        d = {
                                            input: b.value,
                                            use: b.autoCorrectValue,
                                            type: c[0],
                                            status: b.status,
                                            requestTime: b.requestTime,
                                            mode: "keydown" === b.eventType ? 1 : "filterMousedown" === b.eventType ? 0 : 2,
                                            menuname: c[1]
                                        };
                                        try {
                                            window.__bfi.push(["_tracklog", "fltintl.poi", $.tmpl.render("input=${input}&use=${use}&type=${type}&menuname=${menuname}&status=${status}&mode=${mode}&ServerRequestTime=${requestTime}", d)])
                                        } catch(a) {}
                                    }
                                }), k && h) {
                                    var b = c.searchBoxVals[h];
                                    if (b) {
                                        var e = ("" + b).split("|");
                                        m ? (3 === e.length && e.push((e[1].match(/\(([a-z]{3})\)/i) || ["SHA"]).pop()), $("#" + f).getMod("address_poi", "2.0").method("select", e.join("|"))) : (a.value(e[0]), g && $("#" + g).value(e[1])),
                                        online.clearNotice(a)
                                    }
                                }
                                o(a)
                            })
                        }
                    }.bind(this);
                    b ? a.bind("focus", f.bind(this, a)) : f(a)
                }
            },
            getValidate: function() {
                return this.validateObj || (this.validateObj = $(document).regMod("validate", this.version.validate))
            },
            validate: function(a, b, c) {
                a = $(a),
                a.length < 1 || this.validateObj.method("show", $.extend({
                    $obj: a,
                    data: b,
                    removeErrorClass: !0,
                    hideEvent: "blur",
                    isScroll: !1,
                    css: {
                        maxWidth: 350,
                        minWidth: 40
                    },
                    isFocus: !0
                },
                c))
            },
            registerAll: function(a) {
                for (var b, c, d, e = a || this.elements,
                f = [], g = 0, h = e.length; h > g; g++) if (b = e[g], b && (c = b.getAttribute("mod"))) {
                    f = c.split("|"),
                    d = [];
                    for (var i = 0,
                    j = f.length; j > i; i++) if ("function" == typeof this["register_" + f[i]]) try {
                        this["register_" + f[i]]($(b))
                    } catch(k) {} else d.push(f[i]);
                    0 == d.length ? b.removeAttribute("mod") : b.setAttribute("mod", d.join("|"))
                }
                this.docRegisterJmpInfo()
            },
            register_linklist2: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = a.attr("mod_linklist_id");
                    if ("undefined" != typeof window.c_linklist2 && b && (b = window.c_linklist2[b]) && b.constructor === Array) {
                        for (var c = [], d = '<a href="{$link}" rel="nofollow" title="{$text}" target="{$target}">{$text}</a>', e = 1; 6 >= e && "undefined" != typeof b[e]; e++) {
                            var f = b[e].split("|", 2);
                            b[e] = online.replaceWith(d, {
                                text: f[0],
                                link: f[1],
                                target: b[e].target || "_blank"
                            }),
                            c.push(b[e])
                        }
                        a.html(c.join(""))
                    }
                }
            },
            register_linklist: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = a.attr("mod_linklist_id");
                    if ("undefined" != typeof window.c_linklist2 && b && (b = window.c_linklist2[b]) && b.constructor === Array) {
                        for (var c = [], d = '<li><a href="{$link}" title="{$text}" target="_blank" data-ubt-key="ServicePost">&middot;{$text}</a></li>', e = 0; 7 > e && "undefined" != typeof b[e]; e++) {
                            var f = b[e].split("|", 2);
                            0 === e && (f[1] += "#ctm_ref=fli_hp_srvan_def_t_1"),
                            b[e] = online.replaceWith(d, {
                                text: f[0],
                                link: f[1]
                            }),
                            b[e] = b[e].replace("ServicePost", "ServicePost" + e),
                            0 === e && (b[e] = b[e].replace("<li>", '<li class="more">').replace("&middot;", "").replace(/\u76f8\u5173\u4fe1\u606f/g, "\u670d\u52a1\u516c\u544a").replace("ServicePost0", "MoreServicePost")),
                            c.push(b[e])
                        }
                        d = c.shift(),
                        c.push(d),
                        a.html(c.join(""))
                    }
                }
            },
            register_allyes: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = this.version.allyes;
                    $.mod.load("allyes", b,
                    function() {
                        a.regMod("allyes", b, {
                            mod_allyes_user: a.attr("mod_allyes_user")
                        })
                    })
                }
            },
            register_adFrame: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = this.version.adFrame;
                    $.mod.load("adFrame", b,
                    function() {
                        a.regMod("adFrame", b, {
                            mod_adframe_style: a.attr("mod_adframe_style"),
                            mod_adframe_src: a.attr("mod_adframe_src")
                        })
                    })
                }
            },
            register_notice: function(a) {
                if (a = $(a), !(a.length < 1 || null !== a.attr("_cqnotice"))) {
                    var b = a.attr("id") || a.attr("name") || $.uid(),
                    c = a.attr("mod_notice_tip") || online.msg && online.msg.NOTICE && online.msg.NOTICE[0] || "",
                    d = this.version.notice,
                    e = this;
                    $.mod.load("notice", d,
                    function() {
                        e.inits[b + "_notice"] = e.inits.notice[b] = a.regMod("notice", d, {
                            name: b,
                            tips: c,
                            selClass: "inputSel"
                        }).method("checkValue"),
                        e.clearNotice(a)
                    })
                }
            },
            getTableTips: function(a) {
                var b = {};
                return a = this.getAspByJmpInfo(a),
                b.txt0 = null != a ? a: {},
                b
            },
            getAspByJmpInfo: function(a) {
                if (!a) return null;
                if (a = "string" != typeof a ? a.getAttribute("mod_jmpinfo_page") : a, -1 !== a.indexOf("?") && (a = a.match(/=(\w+)/), null !== a)) {
                    a = a[1];
                    try {
                        if (a && $$.module.jmpInfo.array.CraftType) {
                            var b = {},
                            c = $$.module.jmpInfo.array.CraftType.match(new RegExp("@(" + a + "\\|[^@]*\\|[^@]*\\|\\d*\\|\\d*)@", "i"));
                            if (!c || null == c) return ! 1;
                            c = c[1].split("|");
                            for (var d = 0,
                            e = c.length; e > d; d++) b["txt" + d] = c[d];
                            return b
                        }
                    } catch(f) {}
                }
                return null
            },
            register_jmpInfo: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = this.version.jmpInfo,
                    c = this;
                    "jmp_table" == a.attr("mod_jmpinfo_type") && arguments.length <= 1 || $.mod.load("jmp", b,
                    function() {
                        var d = {},
                        e = -1 != a.attr("mod_jmpinfo_content").indexOf("|") ? a.attr("mod_jmpinfo_content").split("|") : a.attr("mod_jmpinfo_content"),
                        f = {};
                        if (e && "object" == typeof e) for (var g = 0,
                        h = e.length; h > g; g++) f["txt" + g] = e[g];
                        else f.txt0 = e || "";
                        if (a.attr("mod_jmpinfo_type")) {
                            var i = a.attr("mod_jmpinfo_type");
                            d = {
                                type: i,
                                template: "#" + i,
                                classNames: {
                                    boxType: i
                                }
                            }
                        } else d = {
                            template: "$jmp_title",
                            type: "jmp_title",
                            classNames: {
                                boxType: "jmp_title"
                            },
                            templs: {
                                tipTempl: ['<div id=${id} class=${tip} group=${group} style="visibility:hidden;display:block;z-index:99;margin:0;left:-9999px;top:-9999px;overflow:hidden;position:absolute;width:320px;"><div id="tuna_jmpinfo">', '<div class="${box} ${boxType} ${boxArrow}">', '<b class="${arrow}"></b>', '<div class="${loading}">${loadingImg}</div>', "<div class=${content}></div>", "</div>", "</div>", "</div>"].join(""),
                                jmp_title: c.jmpInfoTpl[a.attr("mod_jmpinfo_page")]
                            }
                        };
                        if (a.attr("mod_jmpinfo_ajax")) d.dataUrl = "",
                        d.css = {
                            maxWidth: "300"
                        },
                        d.url = online.ajaxUrl[a.attr("mod_jmpinfo_ajax") + "AjaxUrl"],
                        d.url += -1 != d.url.indexOf("?") ? "&" + a.attr("param") : "?" + a.attr("param");
                        else {
                            var j = c.getAspByJmpInfo(a[0]);
                            j && null != j && (f.txt0 = j, d.css = {
                                maxWidth: "490"
                            }),
                            d.content = f
                        }
                        d.boundaryShow = !1,
                        d.position = a.attr("mod_jmpinfo_position") || "leftMiddle-leftTop",
                        a.regMod("jmp", b, {
                            options: d
                        })
                    })
                }
            },
            _calendar_auto_focus: function(a, b, c, d) {
                if (c && (this.searchBoxVals[c] = b), d) try {
                    a.calendarInstance.method("setWeek")
                } catch(e) {}
                var f = next = $(a).attr("mod_calendar_focusnext");
                if (!next) return void setTimeout(function() {
                    try {
                        $(a)[0].blur()
                    } catch(b) {}
                });
                var g, h = 0;
                if ( - 1 != next.indexOf("~") ? (next = next.split("~"), h = next.length, g = document.getElementById(next[0])) : g = document.getElementById(next), $(g).length > 0) {
                    b = b && b.isDate() ? b.toDate() : (new Date).toDate();
                    var i = $(g).data("MinDate");
                    if (i) i = i.toDate(),
                    null !== i && i > b && (b = i);
                    else if (!f.match(/_\d+$/)) {
                        var j = this.toLocalTime(this.searchBoxVals.flightintl_arrivalcity_single);
                        j > b && (b = j)
                    }
                    $(g).data("minDate", b.toStdDateString())
                }
                if (h > 1) if (g = "1" != next[1] ? document.getElementById(next[1]) : g, g && online.isNull(g) && (g.offsetHeight > 0 || $(g).parents("li").length > 0 && "none" != $($(g).parents("li")[0]).css("display"))) try {
                    g.focus()
                } catch(e) {} else setTimeout(function() {
                    try {
                        $(a)[0].blur()
                    } catch(b) {}
                })
            },
            register_calendar: function(a, b) {
                if (a = $(a), !(a.length < 1)) {
                    var c = this.version.calendar,
                    d = this,
                    e = a.attr("mod_save_value"),
                    f = a.attr("mod_save_id"),
                    g = a.attr("mod_calendar_reference"),
                    h = a[0].id || "";
                    e = e && "true" === e.toLowerCase(),
                    $.mod.load("calendar", c,
                    function() {
                        var i = {
                            autoShow: !1,
                            showWeek: !0,
                            maxDate: function() {
                                var a = new Date;
                                return 1 === a.getMonth() && 29 === a.getDate() && a.setDate(28),
                                a.addYears(1).toStdDateString()
                            } ()
                        },
                        j = {
                            onChange: function(a, b) {
                                d._calendar_auto_focus(a, b, f)
                            }
                        };
                        g && (i.reference = "#" + g),
                        online.extend(i, b || {}),
                        online.extend(j, b ? b.listeners: {}),
                        a.bind("blur",
                        function() {
                            d._calendar_auto_focus(this, $(this).value(), f, !0)
                        });
                        var k = {
                            options: i,
                            listeners: j
                        };
                        if ((pageGlobal.IsNewCalendarSwitchOpen || pageGlobal.Calendar) && ("DDate" === h && (i.refType = "end", i.reference = "#ADate", k.listeners.onBerforeShow = function() {
                            delete this.lowPrice,
                            this._layout.find(".remarks").hide();
                            var a = d.searchBoxVals.flightintl_startcity_single,
                            b = d.searchBoxVals.flightintl_arrivalcity_single;
                            if ("S" === d.searchBoxVals.multipleRound && a && b && "1" === $("#Quantity").value() && "0" === $("#ChildQuantity").value() && "0" === $("#InfantQuantity").value()) {
                                var c = (a + "").split("|"),
                                e = (b + "").split("|"),
                                f = c[3] + "_" + e[3];
                                if ("undefined" != typeof d.lowPriceCache[f]) return this.lowPrice = d.lowPriceCache[f],
                                void(null !== this.lowPrice && this._layout.find(".remarks").show());
                                if (!this.isLoad) {
                                    this.isLoad = !0;
                                    var g = this;
                                    $.ajax(online.getBaseUrl("AjaxRequest/AsyncResult/GetRecommendFlight.ashx"), {
                                        context: {
                                            QueryData: {
                                                FlightWay: "S",
                                                SegmentList: [{
                                                    DCityCode: c[3],
                                                    ACityCode: e[3],
                                                    DCity: a,
                                                    ACity: b,
                                                    DepartDate: (new Date).toFormatString("yyyy-MM-dd")
                                                }],
                                                LowPrice: 1
                                            }
                                        },
                                        method: "POST",
                                        onsuccess: function(a, b) {
                                            g.isLoad = !1,
                                            d.lowPriceCache[f] = b = ($.parseJSON(b) || {}).HomeLowPrice || null,
                                            null !== b && (g.lowPrice = b, g._layout.find(".remarks").show(), g.update())
                                        },
                                        onerror: function() {
                                            g.isLoad = !1
                                        }
                                    })
                                }
                            }
                        }), i.newVersion = 1, online.extend(k, {
                            classNames: {
                                hoverRange: "date-range",
                                range: "selected-range",
                                cn: "date-cn",
                                nothismonth: "disabled",
                                select: "selected",
                                blankdate: "disabled",
                                festival_select: "selected",
                                disable: "disable"
                            },
                            string: {
                                title: "<span>yyyy</span>\u5e74<strong>m</strong>\u6708"
                            },
                            festival: {
                                "2016-12-31": ["c_xiu", ""],
                                "2017-01-01": ["c_xiu", "\u5143\u65e6", "c_yuandan"],
                                "2017-01-02": ["c_xiu", ""],
                                "2017-01-22": ["c_ban", ""],
                                "2017-01-27": ["c_xiu", "\u9664\u5915", "c_chuxi"],
                                "2017-01-28": ["c_xiu", "\u6625\u8282", "c_chunjie"],
                                "2017-01-29": ["c_xiu", ""],
                                "2017-01-30": ["c_xiu", ""],
                                "2017-01-31": ["c_xiu", ""],
                                "2017-02-01": ["c_xiu", ""],
                                "2017-02-02": ["c_xiu", ""],
                                "2017-02-04": ["c_ban", ""],
                                "2017-04-01": ["c_ban", ""],
                                "2017-04-02": ["c_xiu", ""],
                                "2017-04-03": ["c_xiu", ""],
                                "2017-04-04": ["c_xiu", "\u6e05\u660e", "c_qingming"],
                                "2017-04-29": ["c_xiu", ""],
                                "2017-04-30": ["c_xiu", ""],
                                "2017-05-01": ["c_xiu", "\u4e94\u4e00", "c_wuyi"],
                                "2017-05-27": ["c_ban", ""],
                                "2017-05-28": ["c_xiu", ""],
                                "2017-05-29": ["c_xiu", ""],
                                "2017-05-30": ["c_xiu", "\u7aef\u5348", "c_duanwu"],
                                "2017-09-30": ["c_ban", ""],
                                "2017-10-01": ["c_xiu", "\u56fd\u5e86", "c_guoqing"],
                                "2017-10-02": ["c_xiu", ""],
                                "2017-10-03": ["c_xiu", ""],
                                "2017-10-04": ["c_xiu", "\u4e2d\u79cb", "c_zhongqiu"],
                                "2017-10-05": ["c_xiu", ""],
                                "2017-10-06": ["c_xiu", ""],
                                "2017-10-07": ["c_xiu", ""],
                                "2017-10-08": ["c_xiu", ""]
                            },
                            template: {
                                styles: ".icon{overflow: hidden; background: url(//pic.c-ctrip.com/fltdomestic111027/un_index_20141201.png?20160310) no-repeat;}.new-calendar{ font-family: \"microsoft yahei\",arial,sans-serif; position: relative; background:#eaefef; border-radius: 3px; box-shadow:0 0 8px #666; width: 780px; max-height: 340px; overflow: hidden; padding: 5px 5px 10px;}.new-calendar .months-area{height: 321px; overflow: hidden;}.new-calendar .remarks{ color: #666; margin: 5px 5px 0;}.new-calendar .prev-ico{position: absolute; left:10px; top: 15px; height: 25px; width: 25px; background-position: -256px -537px;}.new-calendar .prev-ico:hover{cursor:pointer; background-position: -312px -537px;}.new-calendar .un-prev-ico,.new-calendar .prev-ico.disable{position: absolute; left:10px; top: 15px; height: 25px; width: 25px; background-position: -200px -537px;}.new-calendar .next-ico{position: absolute; right:10px; top: 15px; height: 25px; width: 25px; background-position: -285px -537px;}.new-calendar .next-ico:hover{cursor:pointer; background-position: -341px -537px;}.new-calendar .un-next-ico,.new-calendar .next-ico.disable{position: absolute; right:10px; top: 15px; height: 25px; width: 25px; background-position: -229px -537px;}.new-calendar .month{float: left; width: 380px; padding: 10px 5px 0; overflow: hidden;}.new-calendar .month .week-tit{ font-size: 14px; margin-bottom: 8px;}.new-calendar .month .week-tit span{ display: inline-block; color: #666; width: 52px; border-right: 2px solid transparent; text-align: center;}.new-calendar .month .week-tit span.last{border-right: none;}.new-calendar .month .week-tit .weekend{ color: #f90;}.new-calendar .month .short-date{ font-size: 14px; margin:5px 0 10px; text-align: center; color: #666; }.new-calendar .month .short-date span, .new-calendar .month .short-date strong{ margin: auto 3px; font-family: 'tahoma';}.new-calendar .month .short-date strong{color: black;}.new-calendar .month table{ border-collapse: separate; border-spacing: 1px;}.new-calendar .month table tr td{ background: white; border-radius: 3px; transition: all 0.1s;}.new-calendar .month table tr td .ctrl-pos{position:relative; width: 53px; height: 40px; }.new-calendar .month table tr td:hover,.new-calendar .month table tr td.hover{ background: #549fff; color: white; transition: all 0.1s; cursor: pointer;}.new-calendar .month table tr td.selected{ background: #549fff !important; color: white !important;}.new-calendar .month table tr td.selected-range{ background: #b4d5ff; color: white; transition: all 0.1s; cursor: pointer;}.new-calendar .month table tr td.selected .price,.new-calendar .month table tr td.selected .tip1,.new-calendar .month table tr td.selected .tip2,.new-calendar .month table tr td.selected-range .price,.new-calendar .month table tr td.selected-range .tip1,.new-calendar .month table tr td.selected-range .tip2,.new-calendar .month table tr td.hover .price,.new-calendar .month table tr td.hover .tip1,.new-calendar .month table tr td.hover .tip2,.new-calendar .month table tr td.lowest.hover .price{ color: white;}.new-calendar .month table tr td.lowest.selected-range .price{ color: white;}.new-calendar .month table tr td.lowest.selected .price{ color: white;}.new-calendar .month table tr td.lowest .price{ color: #bb0b00;}.new-calendar .month table tr td.disabled{ color: #bbb;}.new-calendar .month table tr td.disabled:hover, .new-calendar .month table tr td.none:hover{ cursor: default; background: white;}.new-calendar .month table .date{ position: absolute; left: 3px; top: 0; font-family: -apple-system, arial, 'simsun'; font-size: 12px;}.new-calendar .month table .date strong{ font-size: 14px; }.new-calendar .month table .tip1, .new-calendar .month table .tip2{ position: absolute; right: 2px; top: 2px; color: white; width:14px; height: 14px; text-align: center; line-height: 13px; border-radius: 2px; }.new-calendar .month table .tip1{ color: #91bbf1; font-family: -apple-system, arial, 'simsun'; }.new-calendar .month table .tip2{ color: #d6dbe1; font-family: -apple-system, arial, 'simsun'; }.new-calendar .month table .price{ position: absolute; right: 5px; bottom: 0px; color: #91aebf; }",
                                wrapper: '<div class="new-calendar"><div><div class="icon prev-ico" data-bind="prev"></div><div class="icon next-ico" data-bind="next"></div></div><div id="${uid}" class="months-area"></div><div style="clear:both;"></div><div class="remarks" style="display:none;"><span>\u5f53\u524d\u663e\u793a\u7684\u4ef7\u683c\u4e3a\u542b\u7a0e\u4ef7\u3002\u56e0\u7968\u4ef7\u53d8\u52a8\u9891\u7e41\uff0c\u8bf7\u4ee5\u5b9e\u65f6\u67e5\u8be2\u62a5\u4ef7\u4e3a\u51c6\u3002</span></div></div>',
                                calendar: '<div class="month${monthclass}"><div class="short-date">${title}</div><div class="week-tit"><span class="weekend">\u65e5</span><span>\u4e00</span><span>\u4e8c</span><span>\u4e09</span><span>\u56db</span><span>\u4e94</span><span class="weekend last">\u516d</span></div><table><tbody><tr>{{each (i,val,max) data}}<td ${classes}><div class="ctrl-pos" ${attr}><div class="date" ${attr}>{{if val.text}}${val.text}{{else}}<strong ${attr}>${day}</strong>{{/if}}</div>{{if val.tip}}<div class="${val.tip}" ${attr}>{{if val.tip === "tip1"}}\u4f11{{else}}\u73ed{{/if}}</div>{{/if}}{{if val.price !== ""}}<div class="price" ${attr}><dfn ${attr}>&yen;</dfn>${val.price}</div>{{/if}}</div></td>{{if (i+1)%7==0 && (i+1) != max}}</tr><tr>{{/if}}{{/each}}</tr></tbody></table></div>'
                            }
                        }), /^DDate_\d+/.test(h) && (k.listeners.onBerforeShow = function() {
                            var a = $("body").offset().width,
                            b = this.target.offset();
                            this.setting.options.offset.left = 0,
                            b.left + 780 > a && (a -= b.left + 800, -560 > a && (a = -560), this.setting.options.offset.left = a)
                        })), d.inits.calendar[h] = a[0].calendarInstance = a.regMod("calendar", c, k), e && f) {
                            var l = d.searchBoxVals[f],
                            m = d.searchBoxVals.flightintl_startdate_single || d.searchBoxVals.flightintl_startdate_single1,
                            n = d.toLocalTime(d.searchBoxVals.flightintl_startcity_single);
                            l && m && m.toDate() >= n && a.value(l)
                        }
                        if (i.showWeek && a.value() && a[0].calendarInstance.method("setWeek"), i.reference && "end" !== i.refType && $(i.reference).value().trim().isDate()) {
                            var o = $(i.reference).value();
                            if ("flightintl_backdate_single" === f) {
                                var p = d.toLocalTime(d.searchBoxVals.flightintl_arrivalcity_single);
                                o.toDate() < p && (o = p.toStdDateString())
                            }
                            a.data("minDate", o)
                        }
                        d.clearNotice(a)
                    })
                }
            },
            register_tab: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = this.version.tab;
                    $.mod.load("tab", b,
                    function() {
                        $(a).regMod("tab", b, {
                            options: {
                                index: a.attr("mod_tab_index") || 0,
                                tab: online.first(a[0]).tagName.toLowerCase(),
                                panel: a.attr("mod_tab_panel"),
                                save: !0
                            },
                            style: {
                                tab: a.attr("mod_tab_check_class") || "sales_current",
                                panel: a.attr("mod_tab_class") || {
                                    display: ["", "none"]
                                }
                            }
                        })
                    })
                }
            },
            register_sideBar: function() {
                var a = this;
                $.mod.load("sideBar", this.version.sideBar,
                function() {
                    var b = "http://livechat.ctrip.com/livechat/Login.aspx?",
                    c = {
                        GroupCode: "FltIntlBookLocal",
                        exInfo: "1110|kefu",
                        version: "2.0"
                    },
                    d = pageGlobal.OrderId || pageGlobal.OrderID || $("#pageOrderId").value();
                    pageGlobal.NewCustomerServiceView && pageGlobal.NewCustomerServiceView.UseNewCustomerServiceUrl && pageGlobal.NewCustomerServiceView.Origin && (c.origin = pageGlobal.NewCustomerServiceView.Origin),
                    d && (c.exInfo = "1108|" + d, c.orderid = d),
                    b += online.param(c),
                    $(document).regMod("sideBar", a.version.sideBar, {
                        url: {
                            feedBackURL: "http://my.ctrip.com/uxp/Community/CommunityAdvice.aspx?productType=2",
                            liveChatURL: b
                        },
                        title: {
                            backTop: "\u56de\u5230\u9876\u7aef",
                            feedBack: "\u5efa\u8bae\u53cd\u9988",
                            liveChat: "\u5728\u7ebf\u5ba2\u670d"
                        }
                    })
                })
            },
            register_emailPrompt: function(a) {
                if (a = $(a), !(a.length < 1)) {
                    var b = this.version.emailPrompt;
                    $.mod.load("emailPrompt", b,
                    function() {
                        a.regMod("emailPrompt", b)
                    })
                }
            }
        }
    }),
    function() {
        if ($.browser.isIPad || $.browser.isIPhone || $.browser.isIPadUCWeb || $("html").bind("mousedown",
        function(a) {
            addressFocusFlag = !1,
            setTimeout(function() {
                addressFocusFlag = !0
            },
            160)
        }), "undefined" == typeof online.registerMod) {
            if (online.registerMod = online.$c("util.RegisterMod"), window.__noRegister__) return;
            online.registerMod.register(function() {
                online.validateObj = this.validateObj
            })
        }
    } (),
    online.create("util.Multipass", {
        options: {
            template: '            <div class="s_item_cont" online_multipass_index="${index-1}">                <div class="s_item_voyage online_number">${index}</div>                <div class="s_item online_label">                    ${i18n.startCity}                    <input name="txtBeginAddress${index}" mod_address_date="fl_txtDatePeriod${index}" type="text" id="fl_txtBeginAddress${index}" mod_change_id="fl_txtEndAddress${index-1}" {{if index ==1}} mod_save_id="flightintl_startcity_single" mod_save_value="true"{{/if}} mod_address_source="{{if index==1}}start{{else}}dest{{/if}}" class="input_text" mod_address_focusnext="true" mod_notice_tip="\u4e2d\u6587/\u82f1\u6587/\u62fc\u97f3" mod_address_reference="fl_txtBeginCityCode${index}" mod="address|notice" mod_address_tpl="address" autocomplete="off" />                </div>                <div class="s_item2 online_label">                    ${i18n.startDate}                    <input name="txtDatePeriod${index}" type="text" id="fl_txtDatePeriod${index}" class="input_text" mod="calendar|notice"  {{if index ==1}}mod_save_value="true" mod_save_id="flightintl_startdate_single"{{/if}} mod_notice_tip="yyyy-mm-dd" mod_calendar_reference="fl_txtDatePeriod${index-1}" mod_calendar_focusnext="fl_txtDatePeriod${index+1}~fl_txtEndAddress${index}" autocomplete="off" />                </div>                <div class="s_item2 online_label">                    ${i18n.endCity}                    <input name="txtEndAddress${index}" mod_address_focusnext="true" type="text" id="fl_txtEndAddress${index}" class="input_text" {{if index ==1}} mod_save_value="true" mod_save_id="flightintl_arrivalcity_single"{{/if}} mod_notice_tip="\u4e2d\u6587/\u82f1\u6587/\u62fc\u97f3" mod_address_source="dest" mod_address_reference="fl_txtEndCityCode${index}" mod="address|notice" mod_address_tpl="address" mod_next_value="fl_txtBeginAddress${index+1}" autocomplete="off" />                </div>                <a class="s_item_del del_line" href="javascript:void(0);" style="{{if index<=2}}display:none{{/if}}" data-ubt-key="DeleteSequence"></a>                <input name="txtBeginCityCode${index}" type="hidden" id="fl_txtBeginCityCode${index}" value="">                <input name="txtEndCityCode${index}" type="hidden" id="fl_txtEndCityCode${index}" value="">            </div>',
            i18n: {
                big5: {
                    startCity: "\u51fa\u767c\u57ce\u5e02",
                    endCity: "\u5230\u9054\u57ce\u5e02",
                    startDate: "\u51fa\u767c\u65e5\u671f"
                },
                gb2312: {
                    startCity: "\u51fa\u53d1\u57ce\u5e02",
                    endCity: "\u5230\u8fbe\u57ce\u5e02",
                    startDate: "\u51fa\u53d1\u65e5\u671f"
                }
            },
            target: $("#fl_flight_multiple"),
            container: $("#fl_multiple_div"),
            addTarget: $("#fl_add_new_line"),
            vals: online.registerMod ? online.registerMod.searchBoxVals: "",
            needEffect: !0,
            max: 6,
            min: 3,
            defaultValue: {},
            removeCallback: function() {},
            addCallback: function() {}
        },
        methods: {
            initialize: function(a) {
                if (this.info(), this.extend(this, a), this.target && !(this.target.length <= 0)) {
                    this.i18n = this.i18n[online.charset],
                    this.currentIndex = 0,
                    online.extend(this.vals, this.defaultValue);
                    var b = online.children(this.target[0]).length;
                    if (this.index = b, b < this.min) {
                        for (var c = this.min - b,
                        d = "",
                        e = 0; c > e; e++) d += this.render();
                        online.insertHtml("beforeend", this.target[0], d),
                        online.registerMod.registerAll(this.target.find("[mod]"))
                    }
                    this.index >= this.max && (this.addTarget[0].style.display = "none"),
                    this.vals.moreflightMin = this.index,
                    this.bindEvent()
                }
            },
            opacity: {
                set: function(a, b) {
                    var c = a.style;
                    $.browser.isIE ? (c.filter = (c.filter || "").replace(/alpha\([^\)]*\)/gi, "") + (1 == b ? "": "alpha(opacity=" + 100 * b + ")"), c.zoom = 1) : "number" == $.type(b) ? c.opacity = b: c.opacity = 0
                },
                get: function(a) {
                    var b = a.currentStyle ? a.currentStyle: window.getComputedStyle(a, null),
                    c = 1;
                    if ($.browser.isIE) {
                        var d = b.filter;
                        c = d && d.indexOf("opacity=") >= 0 ? parseFloat(d.match(/opacity=([^)]*)/)[1]) / 100 : 1
                    } else c = b.opacity;
                    return c *= 1
                }
            },
            render: function() {
                var a = {
                    index: ++this.index,
                    i18n: this.i18n
                };
                return this.index >= this.max && (this.addTarget[0].style.display = "none"),
                $.tmpl.render(this.template, a)
            },
            add: function() {
                if (! (this.index >= this.max)) {
                    online.insertHtml("beforeend", this.target[0], this.render());
                    var a = online.last(this.target[0]);
                    if (a) {
                        if (a.style.display = "", this.needEffect) {
                            a.style.background = "#E8F4FF";
                            var b = 0,
                            c = this;
                            this.opacity.set(a, b),
                            function() {
                                b += .1,
                                1 > b ? (c.opacity.set(a, b), setTimeout(arguments.callee, 20)) : (a.style.background = "none", online.registerMod.registerAll($(a).find("[mod]")), c.vals.moreflightMin = c.index)
                            } ()
                        } else online.registerMod.registerAll($(a).find("[mod]")),
                        this.vals.moreflightMin = this.index;
                        this.addCallback.call(this, $(a))
                    }
                }
            },
            remove: function(a) {
                var b = online.parent(a);
                if (b.style.background = "#E8F4FF", this.currentIndex = 0 | b.getAttribute("online_multipass_index"), this.removeCallback.call(this, $(b)), this.needEffect === !1) return $(b).remove(),
                void this.update();
                var c = 1,
                d = this; !
                function() {
                    if (c -= .1, c > .1) d.opacity.set(b, c),
                    setTimeout(arguments.callee, 10);
                    else {
                        var a = "";
                        $(b).find("input").each(function(b) {
                            a = b.attr("mod_save_id"),
                            a && online.registerMod.clearSearchBoxVals(a)
                        }),
                        $(b).remove(),
                        d.update()
                    }
                } ()
            },
            update: function() {--this.index,
                this.vals.moreflightMin = this.index,
                this.index <= this.max && this.addTarget.show();
                for (var a = online.children(this.target[0]), b = "", c = "", d = this, e = "", f = this.currentIndex, g = a.length; g > f; f++) $(a[f]).find(".line_num em:eq(0)").html(f + 1),
                $(a[f]).find(".online_number:eq(0)").html(f + 1),
                $(a[f]).attr("online_multipass_index", f),
                $(a[f]).find("input").each(function(a) {
                    a[0].id = a[0].id.replace(/\d+$/, f + 1),
                    a[0].name = a[0].name.replace(/\d+$/, f + 1),
                    b = a.attr("mod_address_reference"),
                    b && a.attr("mod_address_reference", b.replace(/\d+$/g, f + 1)),
                    b = a.attr("mod_calendar_reference"),
                    b && a.attr("mod_calendar_reference", b.replace(/\d+$/, f)),
                    (a.attr("mod") && null != a.attr("mod").match("calendar") || null != a.getMod("calendar")) && (b && (c = $("#" + a.attr("mod_calendar_reference")).value().trim(), c.isDate() && a.data("minDate", c)), b = a.attr("mod_calendar_focusnext"), b && (b = b.split("~"), b[0] = b[0].replace(/\d+$/, f + 2), b.length > 1 && "1" != b[1] && (b[1] = b[1].replace(/\d+$/, f + 1)), a.attr("mod_calendar_focusnext", b.join("~")))),
                    b = a.attr("mod_next_value"),
                    b && a.attr("mod_next_value", b.replace(/\d+$/, f + 2)),
                    b = a.attr("mod_change_id"),
                    b && a.attr("mod_change_id", b.replace(/\d+$/, f)),
                    b = a.attr("mod_save_id"),
                    b && (e = d.vals[b], online.registerMod.clearSearchBoxVals(b), b = b.replace(/\d+$/, f + 1), d.vals[b] = e, a.attr("mod_save_id", b))
                })
            },
            bindEvent: function() {
                var a = this;
                this.target.bind("mousedown",
                function(b) {
                    var c = b.target;
                    $(c).hasClass("del_line") && setTimeout(function() {
                        a.remove(c)
                    },
                    10)
                }),
                this.addTarget.bind("click",
                function(b) {
                    b.stop(),
                    a.add()
                })
            }
        }
    }),
    online.maskShow = function(a, b, c) {
        if (b = "undefined" == typeof b ? !0 : b, $(a)[b ? "mask": "unmask"](), b && "undefined" != typeof c) {
            var d = $(a).data("__mask__").maskDiv;
            c.color && (d.style.backgroundColor = c.color),
            c.opacity && $(d).css("opacity", c.opacity)
        }
    },
    online.create("service.public.ValidateService", {
        options: {
            submitBtn: online.$get("btnSearchFlight", !0) || $("#btnSearch")[0],
            scheduleBtn: $("#btnFlightSchedule")[0],
            msg: null,
            drpFlightWay: null,
            showWait: !0,
            mult: null,
            single: null,
            flight_multiple: $("#flight_multiple"),
            validateDomesticCity: [],
            callback: function() {}
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this.errorNumber = 0,
                this.nowTime = window.NSTime || new Date,
                this.nextYearTime = function(a) {
                    return 1 === a.getMonth() && 29 === a.getDate() && a.setDate(28),
                    a.addYears(1).toDate()
                } (this.nowTime),
                this.submitBtn && (this.submitBtn.disabled = !1, this.submitBtn.style.display = ""),
                this.scheduleBtn && (this.scheduleBtn.disabled = !1, this.scheduleBtn.style.display = ""),
                this.errorObj = null,
                this.index = 0,
                this.second = 0,
                this.bindEvent()
            },
            isDomesticCity: function(a) {
                var b = new RegExp("\\|" + a.replace(/\(.+$/g, "") + "\\(");
                return flightintl_dest_cn ? b.test(flightintl_dest_cn) : !0
            },
            getFlightWay: function() {
                var a = this.drpFlightWay;
                return null != a ? "SELECT" == a[0].nodeName ? a.value().toLowerCase() : a.filter(":checked").value().toLowerCase() : "s"
            },
            addDomesticCity: function(a) { ! this.isDomesticCity(a) && this.validateDomesticCity.push("T")
            },
            dateValue: function(a) {
                return new Date(a.getFullYear(), a.getMonth(), a.getDate())
            },
            validateSingle: function(a, b) {
                var c = null,
                d = null,
                e = null,
                f = "",
                g = this.single;
                if (this.errorNumber = 0, this.errorObj = null, d = g.txtDCity, online.isNull(d)) return this.errorNumber = 9,
                this.errorObj = d,
                !1;
                if (e = g.dest_city_1, f = e.value, online.isNull(e)) return this.errorNumber = 11,
                this.errorObj = e,
                !1;
                if (d = $("#" + $(d).attr("mod_address_reference")).value(), e = $("#" + $(e).attr("mod_address_reference")).value(), d == e) return this.errorNumber = 12,
                this.errorObj = g.dest_city_1,
                !1;
                if (c = g.txtDDatePeriod1, online.isNull(c)) return this.errorNumber = 10,
                this.errorObj = c,
                !1;
                if (!c.value.isDate()) return this.errorNumber = 4,
                this.errorObj = c,
                !1;
                f = c.value.toDate();
                var h = $(c).data("MinDate");
                if (h = h ? h.toDate() : this.dateValue(this.nowTime), h > f) return this.errorNumber = 14,
                this.errorObj = c,
                !1;
                if (f > this.dateValue(this.nextYearTime)) return this.errorNumber = 6,
                this.errorObj = c,
                !1;
                var i = online.registerMod.searchBoxVals;
                if (i.flightintl_startdate_single = c.value, c = g.txtADatePeriod1, "d" == a) {
                    if (online.isNull(c) && null != this.drpFlightWay) b !== !0 && ("SELECT" == this.drpFlightWay[0].nodeName ? (this.drpFlightWay.value("S"), this.drpFlightWay[0].selectedIndex = 0) : this.drpFlightWay[0].checked = !0);
                    else {
                        if (!c.value.isDate()) return this.errorNumber = 4,
                        this.errorObj = c,
                        !1;
                        if (f = c.value.toDate(), f < g.txtDDatePeriod1.value.toDate()) return this.errorNumber = 13,
                        this.errorObj = c,
                        !1;
                        if (f > this.dateValue(this.nextYearTime)) return this.errorNumber = 6,
                        this.errorObj = c,
                        !1
                    }
                    i.flightintl_backdate_single = c.value
                }
                return this.flight_multiple.find("li:gt(0) input").attr("disabled", "disabled"),
                !0
            },
            validateMore: function() {
                var a = (this.getFlightWay(), null),
                b = null,
                c = null,
                d = "",
                e = this.mult;
                success = !1,
                prevDateVal = null,
                len = online.children(this.flight_multiple[0]).length,
                this.errorNumber = 0,
                this.errorObj = null,
                this.validateDomesticCity.length = 0;
                for (var f = 1; f <= len && (a = $("#" + $(e[0] + f).value())[0], b = $("#" + $(e[1] + f).value())[0], c = $("#" + $(e[2] + f).value())[0], this.index = f, d = b.value, !(f > 2 && online.isNull(b))); f++) {
                    if (online.isNull(b)) {
                        this.errorNumber = 0,
                        this.errorObj = b;
                        break
                    }
                    if (this.addDomesticCity(d), d = c.value, online.isNull(c)) {
                        this.errorNumber = 1,
                        this.errorObj = c;
                        break
                    }
                    if (d == b.value) {
                        this.errorNumber = 2,
                        this.errorObj = c;
                        break
                    }
                    if (this.addDomesticCity(d), online.isNull(a)) {
                        this.errorNumber = 3,
                        this.errorObj = a;
                        break
                    }
                    if (!a.value.isDate()) {
                        this.errorNumber = 4,
                        this.errorObj = a;
                        break
                    }
                    if (d = a.value.toDate(), 1 == f) {
                        var g = $(a).data("MinDate");
                        if (g = g ? g.toDate() : this.dateValue(this.nowTime), g > d) {
                            this.errorNumber = 5,
                            this.errorObj = a;
                            break
                        }
                    }
                    if (prevDateVal && d < prevDateVal) {
                        this.errorNumber = 7,
                        this.errorObj = a,
                        this.second = f - 1;
                        break
                    }
                    if (d > this.dateValue(this.nextYearTime)) {
                        this.errorNumber = 6,
                        this.errorObj = a;
                        break
                    }
                    prevDateVal = d,
                    this.errorObj = null
                }
                return ! this.errorObj && 0 == this.validateDomesticCity.length && (this.errorNumber = 8, this.errorObj = $("#" + $(e[2] + 1).value())[0]),
                this.errorObj || (success = !0),
                success
            },
            getValidate: function(a) {
                var b = this.getFlightWay(),
                c = this.msg;
                if (! ("m" == b ? this.validateMore() : this.validateSingle(b, a)) && this.errorObj) return online.registerMod.validate(this.errorObj, c.ERROR_FLIGHT[this.errorNumber].replace(/{number}/, c.numberList[this.index - 1]).replace(/{second}/, c.numberList[this.second - 1])),
                !1;
                if (a) return ! 0;
                var d = this;
                if (this.submitBtn && (setTimeout(function() {
                    d.submitBtn.disabled = !0
                },
                25), setTimeout(function() {
                    d.submitBtn.disabled = !1
                },
                2e3)), this.scheduleBtn && (setTimeout(function() {
                    d.scheduleBtn.disabled = !0
                },
                25), setTimeout(function() {
                    d.scheduleBtn.disabled = !1
                },
                2e3)), this.callback.call(this), "m" == b) for (var e = this.flight_multiple.find("li"), f = "", g = 1; g < e.length; g++) $(e[g]).find("input").each(function(a) {
                    f = a.attr("mod_save_id"),
                    f && online.registerMod.clearSearchBoxVals(f)
                });
                return $("#hdIsRequery").value("T"),
                this.showWait && setTimeout(function() {
                    this.pageShowWindow()
                }.bind(this), 1),
                !0
            },
            pageShowWindow: function() {
                if (0 != $("#maskshowdiv").length) {
                    var a = null,
                    b = "",
                    c = this.mult,
                    d = this.msg,
                    e = this.single,
                    f = this.getFlightWay();
                    d.MASK = d.MASK ? d.MASK: ["\u51fa\u53d1\u7684", "\u591a\u7a0b(\u542b\u7f3a\u53e3\u7a0b)", " \u822a\u73ed", "\u7684", " \u5f80\u8fd4 ", " \u5355\u7a0b ", " \u822a\u73ed ", "\u4ece", "\u5230", "\u51fa\u53d1\u65e5\u671f", "\u8ba2\u7968\u6570\u91cf", "\u8fd4\u56de\u65e5\u671f"],
                    "m" == f ? (a = $("#" + $(c[0] + "1").value()).value(), b = d.MASK[7] + " <strong style='color:#E56700'>" + $("#" + $(c[1] + "1").value()).value() + "</strong> " + d.MASK[0] + " <strong style='color:#E56700'>" + d.MASK[1] + "</strong> " + d.MASK[2]) : (a = e.txtDDatePeriod1.value, b = d.MASK[7] + " <strong style='color:#E56700'>" + e.txtDCity.value + "</strong> " + d.MASK[8] + " <strong style='color:#E56700'>" + e.dest_city_1.value + "</strong> " + d.MASK[3] + " <strong style='color:#E56700'>" + ("d" == f ? d.MASK[4] : d.MASK[5]) + "</strong> " + d.MASK[6]);
                    var g = online.$get("txtADatePeriod1", !0) || online.$get("txtADatePeriod1") || $("#ADate")[0],
                    h = $("#ctl00_MainContentPlaceHolder_drpQuantity").value() || $("#ctl00_MainContentPlaceHolder_QuickSearchControl_drpQuantity").value() || $("#Quantity").value();
                    $("#alterContent").html(b),
                    $("#DTimeContent").html(d.MASK[9] + ":<strong style='color:#E56700'>" + a.toDate().toFormatString("yyyy-MM-dd") + "</strong>"),
                    $("#tictekQuantity").html(d.MASK[10] + ":<strong style='color:#E56700'>" + h + "</strong>"),
                    "d" == f && g && $("#ATimeContent").html(d.MASK[11] + ":<strong style='color:#E56700'>" + g.value.toDate().toFormatString("yyyy-MM-dd") + "</strong>"),
                    online.maskShow($("#maskshowdiv"), !0, {
                        color: "#FFF",
                        opacity: 1
                    })
                }
            },
            bindEvent: function() {}
        }
    }),
    online.validateMultiQuantity = function(a) {
        a = a || {};
        var b = $("#Quantity"),
        c = $("#ChildQuantity"),
        d = $("#InfantQuantity"),
        e = $("#InfantTip"),
        f = +b.value(),
        g = +c.value(),
        h = +d.value(),
        i = !0,
        j = "";
        return $("#noAdultTip").hide(),
        e.hide(),
        a.isResult && $("#popTips").remove(),
        0 === f && 0 === h && g > 0 && $("#noAdultTip").show(),
        0 === f && 0 === g && 0 === h && (j = "\u8bf7\u9009\u62e9\u5b9e\u9645\u51fa\u884c\u4eba\u6570\u3002", i = !1),
        0 === f && 0 === g && h > 0 && (j = "\u5982\u9700\u5355\u72ec\u9884\u8ba2\u5a74\u513f\u7968\uff0c\u8bf7\u81f4\u7535\u643a\u7a0b" + (window.intlBookTelInfo || {}).Normal + "\u3002", i = !1),
        0 === f && g > 0 && h > 0 && (j = pageGlobal.MultiPassengerTypeSwitch ? "\u513f\u7ae5\u5a74\u513f\u987b\u6709\u6210\u4eba\u966a\u4f34\u4e58\u673a\u3002": "\u9884\u8ba2\u65b9\u5f0f\u4ec5\u652f\u6301\u201c\u6210\u4eba+\u513f\u7ae5\u201d\u3001\u201c\u6210\u4eba+\u5a74\u513f\u201d\u3002", i = !1),
        pageGlobal.MultiPassengerTypeSwitch ? (f > 0 && (h > f || g > 2 * f) && (j = '\u6bcf\u540d\u6210\u4eba\u6700\u591a\u53ef\u643a\u5e262\u540d\u513f\u7ae5\u548c1\u540d\u5a74\u513f\u4e58\u673a\uff0c\u5982\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u8bf7\u81f3<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u63d0\u4ea4\u7533\u8bf7\u3002', i = !1), f > 0 && h > 4 && f >= h && (j = '\u540c\u884c\u6210\u4eba\u603b\u5171\u53ef\u643a\u5e26\u4e0d\u8d85\u8fc74\u540d\u5a74\u513f\uff0c\u5982\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u8bf7\u81f3<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u63d0\u4ea4\u7533\u8bf7\u3002', i = !1), f + g > 9 && (j = '\u4e58\u5ba2\u603b\u6570\uff08\u4e0d\u542b\u5a74\u513f\uff09\u591a\u4e8e9\u4eba\uff0c\u8bf7\u586b\u5199<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u8fdb\u884c\u9884\u8ba2\u3002', i = !1)) : (f > 0 && g > 0 && h > 0 && (j = "\u9884\u8ba2\u65b9\u5f0f\u4ec5\u652f\u6301\u201c\u6210\u4eba+\u513f\u7ae5\u201d\u3001\u201c\u6210\u4eba+\u5a74\u513f\u201d\u3002", i = !1), f > 0 && g > 0 && g - 2 * f > 0 && 0 === h && (j = '\u76ee\u524d\u4ec5\u652f\u6301 1 \u4f4d\u6210\u4eba\u6700\u591a\u643a\u5e26 2 \u540d\u513f\u7ae5\uff0c\u5982\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u8bf7\u81f3<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u63d0\u4ea4\u7533\u8bf7\u3002', i = !1), f > 0 && h > 0 && h - f > 0 && 0 === g && (j = '\u76ee\u524d\u4ec5\u652f\u6301 1 \u4f4d\u6210\u4eba\u6700\u591a\u643a\u5e26 1 \u540d\u5a74\u513f\uff0c\u5982\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u8bf7\u81f3<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u63d0\u4ea4\u7533\u8bf7\u3002', i = !1), f + g + h > 9 && (j = '\u4e58\u5ba2\u603b\u6570\u591a\u4e8e 9 \u4eba\uff0c\u8bf7\u586b\u5199<a href="FlightQuery.aspx" target="_blank">\u673a\u7968\u9700\u6c42\u5355</a>\u9884\u8ba2\u3002', i = !1)),
        a.isResult && (j = '<span class="alert-box alert-termalert-box search-alert-box"><i class="icon-warn-12"></i>' + j + "</span>"),
        i === !1 && e.html('<i class="ico_warn"></i>' + j).show().find("a").bind("click",
        function(a) {
            try {
                a.stop()
            } catch(a) {}
            var b = $(this).parents("form")[0],
            c = b.action;
            return b.action = this.href,
            b.target = "_blank",
            b.submit(),
            b.target = "",
            b.action = c,
            !1
        }),
        i
    };
    var TFlightWay = {
        S: "",
        D: "\u5f80\u8fd4",
        M: "\u591a\u7a0b"
    };
    online.getPriceInfo = function(a, b, c, d, e, f, g, h) {
        var i = "Price" == resultService.curType ? !1 : !0;
        if ($("#ChildQuantity").length > 0) {
            if (0 == $("#tip-tmpl-showPriceInfo").length) {
                var j = document.createElement("div");
                j.id = "tip-tmpl-showPriceInfo",
                j.innerHTML = "${txt1}",
                document.body.appendChild(j)
            }
            
            if (!a.isRender) {
                var k = '<div class="tooltip-table"><table class="title-left">	<tbody><tr>	<th ${!flightWay?"":"style=\'width:115px;\'"}>\u6210\u4eba{{if priceType == "tax"}}\u7a0e\u8d39{{/if}}</th>	<td><span class="price"><dfn>\xa5</dfn><strong>${adu}</strong></span></td>	{{if !hasTax}}<td><span>+<dfn>\xa5</dfn>${aduTax}\u7a0e\u8d39</span></td>{{/if}}	<td class="last right"><strong>\xd7${quantity}</strong>\u4eba</td></tr>{{if hasChild ^ hasInf}}<tr class="border-bottom2">	<th>${childType}{{if priceType == "tax"}}\u7a0e\u8d39{{/if}}</th>	<td><span class="price"><dfn>\xa5</dfn><strong>${chi}</strong></span></td>	{{if !hasTax}}<td><span>+<dfn>\xa5</dfn>${chiTax}\u7a0e\u8d39</span></td>{{/if}}	<td class="last right"><strong>\xd7${ChildQuantity || InfQuantity}</strong>\u4eba</td></tr>{{/if}}{{if pageGlobal.MultiPassengerTypeSwitch && hasChild && hasInf}}<tr>	  <th>\u513f\u7ae5{{if priceType == "tax"}}\u7a0e\u8d39{{/if}}</th>	  <td><span class="price"><dfn>\xa5</dfn><strong>${chi}</strong></span></td>	  {{if !hasTax}}<td><span>+<dfn>\xa5</dfn>${chiTax}\u7a0e\u8d39</span></td>{{/if}}     <td class="last right"><strong>\xd7${ChildQuantity}</strong>\u4eba</td></tr>   <tr class="border-bottom2">	  <th>\u5a74\u513f{{if priceType == "tax"}}\u7a0e\u8d39{{/if}}</th>	  <td><span class="price"><dfn>\xa5</dfn><strong>${inf}</strong></span></td>	  {{if !hasTax}}<td><span>+<dfn>\xa5</dfn>${infTax}\u7a0e\u8d39</span></td>{{/if}}	  <td class="last right"><strong>\xd7${InfQuantity}</strong>\u4eba</td></tr>{{/if}}<tr class="total-price">	<th>${flightWay}\u4eba\u5747{{if priceType == "tax"}}\u7a0e\u8d39{{else}}{{if hasTax}}\u542b\u7a0e\u4ef7{{else}}\u7968\u4ef7{{if !hasTax}}+\u7a0e\u8d39{{/if}}{{/if}}{{/if}}	</th>	<td class="last" colspan="${hasTax?2:1}"><span class="price"><dfn>\xa5</dfn><strong>${avgPrice}</strong></span></td>   {{if !hasTax}}<td colspan="2"><span><strong>+</strong><dfn>\xa5</dfn>${avgTax}\u7a0e\u8d39</span></td>{{/if}}</tr></tbody></table></div>';
                setTimeout(function() {
                    var j = condition.ChildQuantity > 0 && "\u513f\u7ae5" || condition.InfantQuantity > 0 && "\u5a74\u513f",
                    l = (condition.ChildQuantity || 0) > 0,
                    m = (condition.InfantQuantity || 0) > 0,
                    n = 0;
                    n = pageGlobal.MultiPassengerTypeSwitch && l && m ? (condition.Quantity || 0) + (condition.ChildQuantity || 0) + (pageGlobal.MultiPassengerTypeSwitch ? condition.InfantQuantity || 0 : 0) : (condition.Quantity || 0) + (condition.ChildQuantity || 0) + (condition.InfantQuantity || 0);
                    var o = 0;
                    o = pageGlobal.MultiPassengerTypeSwitch && l && m ? (b * (condition.Quantity || 0) + c * (condition.ChildQuantity || 0) + d * (condition.InfantQuantity || 0)) / n: (b * (condition.Quantity || 0) + c * (condition.ChildQuantity || condition.InfantQuantity || 0)) / n;
                    var p = 0;
                    p = pageGlobal.MultiPassengerTypeSwitch && l && m ? (e * (condition.Quantity || 0) + f * (condition.ChildQuantity || 0) + g * (condition.InfantQuantity || 0)) / n: (e * (condition.Quantity || 0) + f * (condition.ChildQuantity || condition.InfantQuantity || 0)) / n,
                    i ? (b += e, c += f, d += g, avgPrice = o + p) : avgPrice = o,
                    p = Math.ceil(Math.ceil(100 * p) / 100),
                    avgPrice = Math.ceil(Math.ceil(100 * avgPrice) / 100),
                    k = $.tmpl.render(k, {
                        flightWay: TFlightWay[condition.FlightWay],
                        hasTax: i,
                        adu: b,
                        chi: c,
                        childType: j,
                        inf: d,
                        aduTax: e,
                        chiTax: f,
                        infTax: g,
                        hasChild: l,
                        hasInf: m,
                        quantity: condition.Quantity,
                        ChildQuantity: condition.ChildQuantity || 0,
                        InfQuantity: condition.InfantQuantity || 0,
                        avgPrice: avgPrice,
                        avgTax: p,
                        curType: resultService.curType,
                        priceType: h || ""
                    }),
                    this.data.txt1 = k,
                    $(a).find(".tooltip-combine").html(k),
                    a.isRender = !0;
                    try {
                        this._calcPos()
                    } catch(q) {}
                }.bind(this), 50)
            }
        }
    },
    online.create("util.SeoSearchUrl", {
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this._bindEvent()
            },
            generate: function() {
                var a, b, c = online.registerMod.searchBoxVals || {},
                d = $("#selflightType").value() || $("#search_type input[name=FlightWay]:checked").value() || $("#ctl00_MainContentPlaceHolder_QuickSearchControl_selflightType").value() || $('#search_type input[name="ctl00$MainContentPlaceHolder$drpFlightWay"]:checked').value() || c.multipleRound || "";
                if ("S" === d || "D" === d) try {
                    var e = c.flightintl_startcity_single.replace(/-/g, "").split("|"),
                    f = c.flightintl_arrivalcity_single.replace(/-/g, "").split("|");
                    return a = [e[0].replace(/[^a-zA-Z]/g, ""), f[0].replace(/[^a-zA-Z]/g, ""), e[3], f[3]],
                    b = [c.flightintl_startdate_single],
                    "D" === d && b.push(c.flightintl_backdate_single),
                    b.push($("#drpSubClass").value() || $("#ctl00_MainContentPlaceHolder_drpSubClass").value()),
                    (online.siteName + "international/" + ("D" === d ? "round-": "") + a.join("-") + "?" + b.join("&")).replace(/\s*/g, "").toLowerCase()
                } catch(g) {}
                return ""
            },
            onsubmit: function() {
                var a = this.generate();
                "" !== a && (this.form[0].action = a + (window.keepHash ? location.hash || "": ""), "submit" !== this.button[0].type.toLowerCase() && this.form[0].submit())
            },
            _bindEvent: function() {
                this.button && this.form && (this.button = $(this.button), this.form = $(this.form), this.button.bind("click", this.onsubmit.bind(this)))
            }
        }
    }),
    online.$c("util.SeoSearchUrl", window.pageGlobal && window.pageGlobal.SeoSearchUrl ? window.pageGlobal.SeoSearchUrl: {}),
    $.extend($.fn, {
        onn: function(a, b, c) {
            var d, e, f, g, h, i = this;
            return i.length < 1 ? i: ((d = this.events) || (d = this.events = {}), (e = this.handle) || (e = this.handle = function(a) {
                $(i).dispatch(a)
            }), (f = d[a]) || (f = d[a] = [], $(i).bind(a, e)), c.handler && (h = c, c = h.handler, b = h.selector), g = $.extend({
                type: a,
                handler: c,
                selector: b
            },
            h), f.push(g), this)
        },
        dispatch: function(a) {
            if (this.events[a.type]) for (var b, c = this.events[a.type], d = 0; b = c[d++];) try {
                var e = this[0];
                if (b.selector) {
                    for (var f = a.target; f && f !== e;) {
                        if ($(f).hasClass(b.selector)) {
                            e = f;
                            break
                        }
                        f = f.parentNode
                    }
                    f = $(f),
                    f.length > 0 && f.hasClass(b.selector) && b.handler.apply(e, arguments)
                } else b.handler.apply(e, arguments)
            } catch(a) {}
        },
        toggleClass: function(a) {
            return this.length > 0 && ($(this).hasClass(a) ? $(this).removeClass(a) : $(this).addClass(a)),
            this
        }
    });
    var defaultTmpl = '{{enum (k, v) keys}}<div class="filter-option" data-value="${k}"><a href="#" class="best-price"> {{if value[v][curType]!==99999999}} <dfn>&yen;</dfn><span>${value[v][curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${names[k]}</label></span></div>{{/enum}}',
    uconfig = {
        OwnerAirline: {
            id: "OwnerAirline",
            extValKey: ["TransferCount", "OwnerAirline", "OwnerAirlineName"],
            getName: function(a) {
                return "trn" === a.OwnerAirline ? "": a.value + "_" + (a.TransferCount > 2 ? 2 : a.TransferCount - 1)
            },
            fakeValues: {
                OwnerAirline: "AirlineCode",
                OwnerAirlineName: "AirlineName"
            }
        },
        OwnerAirlineName: {
            id: "OwnerAirlineName",
            extKey: ["TransferCount"],
            extValKey: ["OwnerAirline"],
            getSpecValue: function() {
                return this.TransferCount > 2 ? 2 : this.TransferCount - 1
            },
            getName: function(a) {
                return "trn" === a.OwnerAirline ? "": a.value
            },
            needSort: !0,
            fakeValues: {
                OwnerAirline: "AirlineCode",
                OwnerAirlineName: "AirlineName"
            }
        },
        Alliance: {
            id: "Alliance",
            extKey: ["OwnerAirlineName"],
            getName: function(a) {
                return a.Alliance
            },
            extValKey: ["Alliance", "OperatingAlliance"],
            fakeValues: {
                OwnerAirline: "AirlineCode",
                OwnerAirlineName: "AirlineName"
            },
            needSort: !0
        },
        TransferCount: {
            id: "TransferCount",
            names: ["\u76f4\u98de", "1\u7a0b\u4e2d\u8f6c", "2\u7a0b\u4e2d\u8f6c\u53ca\u4ee5\u4e0a", "\u7a7a\u94c1\u7ec4\u5408"],
            extKey: ["OwnerAirlineName"],
            extValKey: ["HasTrain"],
            getSpecValue: function() {
                return this.OwnerAirlineName
            },
            getName: function(a) {
                return a.HasTrain ? 3 : a.value > 2 ? 2 : a.value - 1
            },
            tmpl: defaultTmpl,
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        DepartTime: {
            id: "DepartTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        DDepartTime: {
            id: "DDepartTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        ADepartTime: {
            id: "ADepartTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        ArrivalTime: {
            id: "ArrivalTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        DArrivalTime: {
            id: "DArrivalTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        AArrivalTime: {
            id: "AArrivalTime",
            names: ["\u51cc\u6668(0:00 - 6:00)", "\u4e0a\u5348(6:00 - 12:00)", "\u4e0b\u5348(12:00 - 18:00)", "\u665a\u4e0a(18:00 - 24:00)"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(new Date(a.value.replace(/-/g, "/")).getHours() / 6) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        TransferTime: {
            id: "TransferTime",
            extValKey: ["ACityName", "TransferTime", "StopCityName"],
            getName: function(a) {
                return ("undefined" == typeof a.TransferTime ? void 0 : a.ACityName) || (a.StopCityName ? a.StopCityName: void 0)
            },
            needSort: !0,
            fakeValues: {
                OwnerAirlineName: "AirlineName",
                ACityName: "ACityName",
                TransferTime: "TransferTime",
                StopCityName: "StopCityName"
            }
        },
        DurationTime: {
            id: "DurationTime",
            names: ["0-4\u5c0f\u65f6", "4\u81f38\u5c0f\u65f6", "8\u81f312\u5c0f\u65f6", "12\u5c0f\u65f6\u4ee5\u4e0a"],
            getName: function(a) {
                return void 0 !== a.value ? parseInt(a.value / 4) > 2 ? 3 : parseInt(a.value / 4) : void 0
            },
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        DPort: {
            id: "DPort",
            extValKey: ["DDistance", "DDistanceName", "DPortName"],
            extKey: ["DCityName"],
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        APort: {
            id: "APort",
            extValKey: ["ADistance", "ADistanceName", "APortName"],
            extKey: ["ACityName"],
            fakeValues: {
                OwnerAirlineName: "AirlineName"
            }
        },
        ClassGradeFilterSection: {
            id: "ClassGradeFilterSection"
        }
    },
    utmpl = {
        OwnerAirlineName: {
            tmpl: '{{each (k, v) value}}<div class="filter-option" data-value="${value}" data-ind="${k}"><a href="#" class="best-price">{{if v[curType]!==99999999}}<dfn>&yen;</dfn><span>${v[curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${value}&nbsp;</label></span></div>{{/each}}'
        },
        TransferCount: {
            tmpl: defaultTmpl
        },
        Alliance: {
            tmpl: '{{each (k, v) value}}<div class="filter-option" data-value="${value}"><a href="#" class="best-price">{{if v[curType]!==99999999}}<dfn>&yen;</dfn><span>${v[curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${value}</label></span></div>{{/each}}'
        },
        DepartTime: {
            tmpl: defaultTmpl
        },
        ArrivalTime: {
            tmpl: defaultTmpl
        },
        DDepartTime: {
            tmpl: defaultTmpl
        },
        DArrivalTime: {
            tmpl: defaultTmpl
        },
        ADepartTime: {
            tmpl: defaultTmpl
        },
        AArrivalTime: {
            tmpl: defaultTmpl
        },
        TransferTime: {
            tmpl: '{{each (k, v) value}}<div class="filter-option" data-value="${StopCityName || ACityName}"><a href="#" class="best-price">{{if v[curType]!==99999999}}<dfn>&yen;</dfn><span>${v[curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${StopCityName || ACityName}</label></span></div>{{/each}}'
        },
        DurationTime: {
            tmpl: defaultTmpl
        },
        DPort: {
            tmpl: '<h5 class="filter-sub-header">${DCityName}</h5>{{each (k, v) value}}<div class="filter-option" data-value="${value}"><a href="#" class="best-price">{{if v[curType]!==99999999}}<dfn>&yen;</dfn><span>${v[curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${DPortName}</label></span>{{if DDistance && DDistanceName && DDistance > 0}}<label class="checkbox-label checkbox-label-tip">(\u8ddd${ DDistanceName }\u76f4\u7ebf${DDistance}km)</label>{{/if}}</div>{{/each}}'
        },
        APort: {
            tmpl: '<h5 class="filter-sub-header">${ACityName}</h5>{{each (k, v) value}}<div class="filter-option" data-value="${value}"><a href="#" class="best-price">{{if v[curType]!==99999999}}<dfn>&yen;</dfn><span>${v[curType] | 0}</span>{{/if}}</a><span class="checkbox-wrapper"><a href="#" class="checkbox-icon"><input type="checkbox" class="checkbox-input"></a><label class="checkbox-label">${APortName}</label></span>{{if ADistance && ADistanceName && ADistance > 0}}<label class="checkbox-label checkbox-label-tip">(\u8ddd${ ADistanceName }\u76f4\u7ebf${ADistance}km)</label>{{/if}}</div>{{/each}}'
        },
        ClassGradeFilterSection: {
            tmpl: '{{each (k, v) value}}<div class="filter-option" data-value="${v.extInfo.actualValue}" ><a href="#" class="best-price">{{if v[curType]!=99999999}}<dfn>&yen;</dfn><span>${v[curType]}</span>{{/if}}</a><span class="radio-wrapper"><a href="#" class="radio-icon {{if v.extInfo.classGrade==v.value}}radio-icon-checked{{/if}}"><input type="radio"  class="radio-input"></a><label class="radio-label">${v.value}&nbsp;</label></span></div>{{/each}}'
        }
    },
    RECOMMENDTYPE_TWO_CLASS_DOWNGRADE = "\u4e24\u8231\u964d\u8231\u63a8\u8350",
    RECOMMENDTYPE_ONECITY_MULTIPORTS = "\u540c\u4e00\u57ce\u5e02\u591a\u673a\u573a\u63a8\u8350",
    RECOMMENDTYPE_YS_SWAP = "\u7ecf\u6d4e\u8d85\u7ecf\u6362\u8231\u63a8\u8350",
    NoResultRecommendUbt = {
        hasNetworkException: !1,
        pageNoResult: !1,
        check: function(a, b) {
            pageGlobal.NewUbt[a] = pageGlobal.NewUbt[a] || b
        },
        addType: function(a) {
            switch (this.check("RecommendType", []), pageGlobal.NewUbt.RecommendType.push(a), this.check("NoResultReason", []), a) {
            case RECOMMENDTYPE_TWO_CLASS_DOWNGRADE:
                pageGlobal.NewUbt.NoResultReason.push("\u4e24\u8231\u65e0\u822a\u73ed");
                break;
            case RECOMMENDTYPE_ONECITY_MULTIPORTS:
            case RECOMMENDTYPE_YS_SWAP:
                pageGlobal.NewUbt.NoResultReason.push("\u67e5\u8be2\u65e0\u7ed3\u679c")
            }
        },
        beforeReport: function() {
            this.addIsRecommended(),
            this.hasNetworkException && (this.pageNoResult || pageGlobal.NewUbt.RecommendType && pageGlobal.NewUbt.RecommendType.length) && this.addIsFailed(!0, !0),
            pageGlobal.NewUbt.NoResultReason = this.uniq(pageGlobal.NewUbt.NoResultReason || []),
            pageGlobal.NewUbt.RecommendType = this.uniq(pageGlobal.NewUbt.RecommendType || [])
        },
        addIsRecommended: function() {
            pageGlobal.NewUbt.IsRecommended = pageGlobal.NewUbt.RecommendType && pageGlobal.NewUbt.RecommendType.length > 0 ? "Y": "N"
        },
        uniq: function(a) {
            if (a.length <= 1) return a;
            for (var b = [], c = {},
            d = 0, e = a.length; e > d; d++) {
                var f = a[d];
                c[f] || (c[f] = 1, b.push(f))
            }
            return b
        },
        networkException: function(a) {
            if (!this.hasNetworkException) {
                var b = $.parseJSON(a);
                b && -1 == b.ReturnCode || b && (!b.hasOwnProperty("FlightList") || !b.FlightList || b.FlightList && b.FlightList.length) && (this.hasNetworkException = !0)
            }
        },
        setPageNoResult: function() {
            this.pageNoResult = !0
        },
        addIsFailed: function(a, b) {
            this.check("NoResultReason", []),
            a ? pageGlobal.NewUbt.IsFailed = "Y": pageGlobal.NewUbt.IsFailed = "N",
            b && 0 == pageGlobal.NewUbt.NoResultReason.length && pageGlobal.NewUbt.NoResultReason.push("\u7f51\u7edc\u5f02\u5e38")
        }
    },
    IS_SUPER_FLIGHT = "IsSuperFlight",
    FLT_OVERSEA_FLOAT_CLICK_KEY = "flt_oversea_float_click",
    superFlyerLocalUbt = [],
    SuperFlyerUbt = {
        currentUbt: {},
        hasSuperFlyerUbt: function() {
            1 !== pageGlobal.NewUbt[IS_SUPER_FLIGHT] && (pageGlobal.NewUbt[IS_SUPER_FLIGHT] = 1)
        },
        check: function(a, b) {
            pageGlobal.NewUbt[a] = pageGlobal.NewUbt[a] || b
        },
        set: function(a, b) {
            this.currentUbt[a] = b
        },
        popBox: function() {
            this.currentUbt = {},
            this.set("SuperFloat", 1),
            superFlyerLocalUbt.push(this.currentUbt)
        },
        clear: function(a) {
            this.currentUbt[a] && delete this.currentUbt[a]
        },
        book: function() {
            this.clear("SuperReSearch"),
            this.set("SuperConfirm", 1),
            this.currentUbt = {}
        },
        back: function() {
            this.clear("SuperConfirm"),
            this.set("SuperReSearch", 1),
            this.currentUbt = {}
        },
        canReport: function() {
            return superFlyerLocalUbt.length >= 1
        }
    },
    nearDateDirectRecommend = {
        NEARDATE_RECOMMEND_TIMESTEP: 7,
        initSearchCondition: {},
        currentSearchCondition: {},
        isOutofThreeWeeksRange: !1,
        isBeforeNow: !1,
        ONE_DAY: 864e5,
        TIME_RANGE_THREE_WEEKS: 18144e5,
        calendarPanel: null,
        startDate: null,
        dataTobeRendered: [],
        reset: function() {
            this.initSearchCondition = {},
            this.currentSearchCondition = {},
            this.isOutofThreeWeeksRange = !1,
            this.isBeforeNow = !1,
            this.dataTobeRendered = []
        },
        renderNearDateRecommendFlights: function(a, b) {
            var c = "D" === condition.FlightWay && a[0].ReturnDate,
            d = this,
            e = function(a) {
                var b = {
                    data: f(a),
                    isShowBtn: a.length <= 2,
                    isShowSlideArrow: a.length > 5,
                    isNoSlide: a.length >= 3 && a.length <= 5
                };
                return "S" !== condition.FlightWay || a[0].ReturnDate ? c ? $.tmpl.render(this.nearDateRecommendTmpl.nearDateRecommendRoundTripTmpl, b) : void 0 : $.tmpl.render(this.nearDateRecommendTmpl.nearDateRecommendOneWayTmpl, b)
            },
            f = function(a) {
                var b = [],
                c = function(a) {
                    var b = a.split("-");
                    return "" + b[1] + "-" + b[2]
                };
                return a.each(function(a) {
                    var d = {
                        DepartureDate: c(a.DepartureDate),
                        DepartYear: a.DepartureDate.split("-")[0],
                        HasDirect: a.HasDirect,
                        ReturnHasDirect: a.ReturnHasDirect
                    };
                    d.DateOfWeek = a.DateOfWeek,
                    a.ReturnDate && (d.ReturnDate = c(a.ReturnDate), d.ReturnYear = a.ReturnDate.split("-")[0]),
                    a.ReturnDateOfWeek && (d.ReturnDateOfWeek = a.ReturnDateOfWeek),
                    b.push(d)
                }),
                b
            };
            $("#neardate_recom_box") && $("#neardate_recom_box").remove();
            var g = document.createElement("div");
            g.id = "neardate_recom_box",
            g.style.display = "none";
            var h = $(g);
            h.insertBefore($("#flightList")),
            h.html(e.call(b, a));
            var i = function(a) {
                var b = (condition.SegmentList[0].DCity, condition.SegmentList[0].ACity, condition.SegmentList[0].ClassGrade, a.find(".fdc-trip")[0].getElementsByTagName("span")[0]),
                c = a.find(".fdc-trip")[1],
                d = c && c.getElementsByTagName("span")[0],
                e = b.getAttribute("data-dyear") + "-" + b.innerText,
                f = d ? d.getAttribute("data-ryear") + "-" + d.innerText: "";
                0 != $("#btnSearch").length && ($("#DDate").value(e), "" != f && $("#ADate").value(f), $("#Airline").value(""), $("#txtAirline").value(""), $("#btnSearch")[0].click())
            };
            d.calendarMask = $(".flight-direct-calendar").find(".mask"),
            h.find(".check-btn").length ? h.onn("click", "check-btn",
            function(a) {
                a.stop(),
                InternationalRecommend.handleClickNearDate(this.parentNode, b),
                i($(this.parentNode))
            }) : h.find(".fdc-item").length && h.onn("click", "fdc-item",
            function(a) {
                a.stop(),
                InternationalRecommend.handleClickNearDate(this, b),
                i($(this))
            });
            var j = h.find(".pre-btn"),
            k = h.find(".next-btn"),
            l = 5,
            m = (a.length - l, 0),
            n = function(b, c, d, e, f) {
                if (b.stop(), !c.hasClass("arrow_left_disable") && !c.hasClass("arrow_right_disable")) {
                    var g = -1 !== c[0].className.indexOf("next"),
                    h = a.length - l;
                    if (! (g && m >= h || !g && 1 > m)) {
                        m += g ? l: -l;
                        var i = e.find(".next-btn"),
                        j = e.find(".pre-btn");
                        g ? j.hasClass("arrow_left_disable") && j.removeClass("arrow_left_disable") : (0 > m && (m = 0), i.hasClass("arrow_right_disable") && i.removeClass("arrow_right_disable")),
                        d.animate({
                            marginLeft: -m * (f ? 156 : 161)
                        }),
                        g ? m === h && c.addClass("arrow_right_disable") : 0 === m && c.addClass("arrow_left_disable")
                    }
                }
            };
            $(".neardate-calendar-btn")[0] && h.onn("click", "neardate-calendar-btn",
            function(a) {
                d.reset(),
                b.getNearDateOnlineFlights("", !0),
                $("#dirCalendarLoading")[0] ? $("#dirCalendarLoading").show() : jQuery("#neardate_recom_box").append('<div class="loading-wrapper" id="dirCalendarLoading" style="display: block;">                    <div class="loading-animate"></div>                </div>')
            }),
            (j.length || k.length) && h.onn("click", "pre-btn",
            function(a) {
                a.stop(),
                n(a, $(this), $(".fdc-items"), h, c)
            }).onn("click", "next-btn",
            function(a) {
                a.stop(),
                n(a, $(this), $(".fdc-items"), h, c)
            })
        },
        filterNearDateRecommend: function(a, b) {
            var c, d = [],
            e = this.formatDate(condition.SegmentList[0].DepartDate, !0),
            f = this;
            return "half" === b.freeStyleHasBothDirectFlag && a.ReturnList ? (c = this.formatDate(condition.SegmentList[1].DepartDate, !0), a.DepartList.length && a.ReturnList.each(function(a) {
                a.HasDirect && c !== a.DepartureDate && new Date(a.DepartureDate).getTime() - new Date(e).getTime() >= 864e5 && d.push({
                    ArrivalCity: a.DepartureCity,
                    DateOfWeek: f.getWeekday(e),
                    DepartureCity: a.ArrivalCity,
                    DepartureDate: e,
                    HasDirect: !0,
                    ReturnDate: a.DepartureDate,
                    ReturnDateOfWeek: a.DateOfWeek,
                    ReturnHasDirect: !0
                })
            })) : a.DepartList.each(function(a) {
                switch (b.freeStyleHasBothDirectFlag) {
                case "half":
                    a.HasDirect && a.ReturnHasDirect && d.push(a);
                    break;
                case "":
                    a.HasDirect && d.push(a);
                    break;
                case "both":
                }
            }),
            d
        },
        renderNearDateRecommendCalendar: function(a, b) {
            var c = this,
            d = (c.formatDate(condition.SegmentList[0].DepartDate.replace(/\//g, "-"), !0), c.formatDate(condition.SegmentList[1] && condition.SegmentList[1].DepartDate.replace(/\//g, "-"), !0),
            function(a) {
                if (a.DepartList.each(function(a) {
                    a.DepartureDateWithYear = c.formatDate(a.DepartureDate, !0),
                    a.DepartureDate = c.formatDate(a.DepartureDate),
                    a.isDateBeforeNow = c.isDateBeforeNow(a.DepartureDateWithYear)
                }), a.ReturnList.each(function(a) {
                    a.DepartureDateWithYear = c.formatDate(a.DepartureDate, !0),
                    a.DepartureDate = c.formatDate(a.DepartureDate),
                    a.isDateBeforeNow = c.isDateBeforeNow(a.DepartureDateWithYear)
                }), a = c.paddingData(a, c.currentSearchCondition.departDate, c.currentSearchCondition.returnDate), 0 === a.ReturnList.length || 0 === a.DepartList.length) return ! 1;
                for (var b = {
                    DepartureCity: c.initSearchCondition.dCity,
                    ArrivalCity: c.initSearchCondition.aCity,
                    daysBetween: 0,
                    ReturnDate: "",
                    DepartureDate: "",
                    DepartList: a.DepartList,
                    ReturnList: a.ReturnList,
                    HasDirect: !1,
                    ReturnHasDirect: !1,
                    trMatrix: [],
                    defaultIndex: []
                },
                d = a.DepartList, e = a.ReturnList, f = 0, g = e.length; g > f; f++) {
                    var h = e[f].HasDirect.toString();
                    b.trMatrix[f] = [],
                    e[f].DepartureDateWithYear === c.currentSearchCondition.returnDate && (b.defaultIndex[0] = f, b.ReturnDate = c.padMMdd(e[f].DepartureDate), b.ReturnDateWithYear = c.currentSearchCondition.returnDate, b.ReturnHasDirect = e[f].HasDirect);
                    for (var i = 0,
                    j = d.length; j > i; i++) {
                        var k = d[i].HasDirect.toString(),
                        l = k + "-" + h,
                        m = (d[i].isDateBeforeNow || e[f].isDateBeforeNow, c.dateIsBefore(e[f].DepartureDateWithYear, d[i].DepartureDateWithYear) || !!e[f].disable || !!d[i].disable),
                        n = Math.round(( + new Date(e[f].DepartureDateWithYear.toDate()) - +new Date(d[i].DepartureDateWithYear.toDate())) / c.ONE_DAY);
                        if (d[i].DepartureDateWithYear === c.currentSearchCondition.departDate && (b.defaultIndex[1] = i, b.DepartureDate = c.padMMdd(d[i].DepartureDate), b.DepartureDateWithYear = c.currentSearchCondition.departDate, b.HasDirect = d[i].HasDirect), m) b.trMatrix[f].push({
                            directFlag: "",
                            txt: "-",
                            className: "disable"
                        });
                        else switch (l) {
                        case "true-true":
                            b.trMatrix[f].push({
                                directFlag:
                                "dot-both",
                                txt: "\u5f80\u8fd4\u76f4\u98de"
                            });
                            break;
                        case "true-false":
                            b.trMatrix[f].push({
                                directFlag:
                                "dot-depart",
                                txt: "\u53bb\u7a0b\u76f4\u98de"
                            });
                            break;
                        case "false-true":
                            b.trMatrix[f].push({
                                directFlag:
                                "dot-return",
                                txt: "\u8fd4\u7a0b\u76f4\u98de"
                            });
                            break;
                        case "false-false":
                            b.trMatrix[f].push({
                                directFlag:
                                "",
                                txt: "\u65e0\u76f4\u98de"
                            });
                            break;
                        default:
                            b.trMatrix[f].push({
                                directFlag:
                                "",
                                txt: "\u67e5\u770b",
                                className: "gray"
                            })
                        }
                        b.trMatrix[f][i].daysBetween = n,
                        b.trMatrix[f][i].index = f + "-" + i
                    }
                }
                return b.daysBetween = Math.round((new Date(b.ReturnDateWithYear.replace(/-/g, "/")) - new Date(b.DepartureDateWithYear.replace(/-/g, "/"))) / c.ONE_DAY) || 0,
                b.daysBetween < 0 && (b.daysBetween = -b.daysBetween),
                b
            }),
            e = d(a);
            if (e) {
                c.dataTobeRendered = e,
                c.startDate = {
                    departDate: e.DepartList[0].DepartureDateWithYear,
                    returnDate: e.ReturnList[0].DepartureDateWithYear
                };
                var f = $("#near_date_rec_container");
                if (f[0]) f.html($.tmpl.render(b.nearDateRecommendTmpl.calendarTmpl, e)),
                c.showCalendar();
                else {
                    var g = document.createElement("div");
                    g.id = "near_date_rec_container";
                    var h = $(g);
                    h.html($.tmpl.render(b.nearDateRecommendTmpl.calendarTmpl, e)),
                    c.calendarPanel = h,
                    c.showCalendar(),
                    jQuery(h[0]).insertAfter(jQuery(".neardate-calendar-btn")),
                    h.onn("click", "selectDirCalendar",
                    function(a) {
                        var b = h.find("tr .active"),
                        c = jQuery(this);
                        if (!c.hasClass("active")) {
                            b && b.removeClass("active"),
                            c.addClass("active");
                            var d = c.closest("tr").find("th"),
                            e = Number(c.attr("tdColIndex")),
                            f = c.closest("tbody").find("tr:first th").eq(e + 1),
                            g = "\u8fd4\uff1a" + d.find("span").html().split(" ")[0],
                            i = d.find("i").hasClass("tag-fd-blue"),
                            j = "\u53bb\uff1a" + f.find("span").html().split(" ")[0],
                            k = f.find("i").hasClass(" tag-fd-orange"),
                            l = jQuery(".calendar-subtitle").children();
                            $(l[2]).find("span").html(g);
                            var m = $(l[2]).find("i");
                            i ? m.addClass("tag-fd-blue") : m.removeClass("tag-fd-blue"),
                            $(l[0]).find("span").html(j);
                            var n = $(l[0]).find("i");
                            k ? n.addClass("tag-fd-orange") : n.removeClass("tag-fd-orange");
                            var o = c.attr("daysBetween");
                            $(l[1]).html("\u95f4\u9694" + o + "\u5929")
                        }
                    }).onn("click", "pre-week",
                    function(a) {
                        b.getNearDateOnlineFlights("prev", !0)
                    }).onn("click", "next-week",
                    function(a) {
                        b.getNearDateOnlineFlights("next", !0)
                    }).onn("click", "jq-search-btn",
                    function(a) {
                        var d = h.find(".active")[0],
                        e = d.getAttribute("index").split("-"),
                        f = c.dataTobeRendered.ReturnList[e[0]].DepartureDateWithYear,
                        g = c.dataTobeRendered.DepartList[e[1]].DepartureDateWithYear;
                        InternationalRecommend.handleClickCalendar(f, g, b),
                        c.autoSearch(g, f)
                    }).onn("click", "jq-close-calendar",
                    function(a) {
                        c.hideCalendar()
                    })
                }
            }
        },
        autoSearch: function(a, b) {
            0 != $("#btnSearch").length && ($("#DDate").value(a), "" != b && $("#ADate").value(b), $("#Airline").value(""), $("#txtAirline").value(""), $("#btnSearch")[0].click())
        },
        setOutofRangeFlag: function(a) {
            var b = +new Date(a.replace(/-/g, "/")),
            c = +new Date(this.initSearchCondition.departDate.replace(/-/g, "/"));
            this.abs(b - c) > this.TIME_RANGE_THREE_WEEKS ? this.isOutofThreeWeeksRange = !0 : this.isOutofThreeWeeksRange = !1
        },
        setIsBeforeNowFlag: function(a) {
            this.isBeforeNow = this.isDateBeforeNow(a)
        },
        abs: function(a) {
            return 0 > a ? -a: a
        },
        showCalendar: function() {
            this.calendarPanel.show(),
            this.calendarMask[0].style.display = "block"
        },
        hideCalendar: function() {
            this.calendarPanel.hide(),
            this.calendarMask[0].style.display = "none"
        },
        successCallback: function(a, b, c, d, e) {
            e && !d && $("#dirCalendarLoading").hide();
            var f = this;
            if (c.loadNearOnlineFinished = !0, b = $.parseJSON(b), null != b && "" != b) {
                try { ! e && b && (b.hasOwnProperty("DepartList") && b.DepartList.length || b.length) && (b = f.filterNearDateRecommend(b, c), b && b.length && f.renderNearDateRecommendFlights(b, c)),
                    e && b.hasOwnProperty("DepartList") && b.hasOwnProperty("ReturnList") && f.renderNearDateRecommendCalendar(b, c)
                } catch(g) {
                    console.log(g)
                }
                "array" != $.type(pageGlobal.NewUbt.RecommendProduct) && (pageGlobal.NewUbt.RecommendProduct = []),
                b && b.length && InternationalRecommend.firstRecommendProd(b, "5");
                var h = $.storage.get("nearOnlineByRecommendUbt"); (null == h || h.RecommendProduct.ToDate != $("#DDate").value()) && (Array.isArray(c.nearOnlineFlightsUbt.RecommendProduct) || (c.nearOnlineFlightsUbt.RecommendProduct = []), pageGlobal.NewUbt.RecommendProduct = c.nearOnlineFlightsUbt.RecommendProduct.concat({
                    Type: "5",
                    IsClick: "N",
                    ToDate: b.DepartureDate,
                    BackDate: b.ReturnDate
                }), pageGlobal.NewUbt.HasDirect = "N"),
                c.showNearDateOnlineFlight()
            }
        },
        showLookupTable: function(a, b, c) {
            for (var d = {
                DepartList: [],
                ReturnList: []
            },
            e = 0; 7 > e; e++) {
                var f = a(this.startDate.departDate, e + ("prev" == c ? -this.NEARDATE_RECOMMEND_TIMESTEP: this.NEARDATE_RECOMMEND_TIMESTEP));
                d.DepartList.push(this.isBeforeNow ? {
                    DepartureCity: this.initSearchCondition.dCity,
                    ArrivalCity: this.initSearchCondition.aCity,
                    DepartureDate: f,
                    DateOfWeek: this.getWeekday(f),
                    HasDirect: "",
                    disable: !0
                }: {
                    DepartureCity: this.initSearchCondition.dCity,
                    ArrivalCity: this.initSearchCondition.aCity,
                    DepartureDate: f,
                    DateOfWeek: this.getWeekday(f),
                    HasDirect: "",
                    lookupFlag: !0
                })
            }
            for (var g = 0; 7 > g; g++) {
                var h = a(this.startDate.returnDate, g + ("prev" == c ? -this.NEARDATE_RECOMMEND_TIMESTEP: this.NEARDATE_RECOMMEND_TIMESTEP));
                d.ReturnList.push(this.isBeforeNow ? {
                    DepartureCity: this.initSearchCondition.aCity,
                    ArrivalCity: this.initSearchCondition.dCity,
                    DepartureDate: h,
                    DateOfWeek: this.getWeekday(h),
                    HasDirect: "",
                    disable: !0
                }: {
                    DepartureCity: this.initSearchCondition.aCity,
                    ArrivalCity: this.initSearchCondition.dCity,
                    DepartureDate: h,
                    DateOfWeek: this.getWeekday(h),
                    HasDirect: "",
                    lookupFlag: !0
                })
            }
            this.successCallback(void 0, JSON.stringify(d), b, c)
        },
        getWeekday: function(a) {
            var b;
            switch (new Date(a.replace(/-/g, "/")).getDay()) {
            case 1:
                b = "\u5468\u4e00";
                break;
            case 2:
                b = "\u5468\u4e8c";
                break;
            case 3:
                b = "\u5468\u4e09";
                break;
            case 4:
                b = "\u5468\u56db";
                break;
            case 5:
                b = "\u5468\u4e94";
                break;
            case 6:
                b = "\u5468\u516d";
                break;
            case 7:
                b = "\u5468\u65e5";
                break;
            default:
                b = "\u5468\u4e00"
            }
            return b
        },
        isDateBeforeNow: function(a) {
            var b = new Date,
            c = +new Date(a.replace(/-/g, "/")),
            d = +new Date(b.getFullYear() + "/" + this.pad(b.getMonth() + 1) + "/" + this.pad(b.getDate()));
            return 0 > c - d
        },
        pad: function(a) {
            return 10 > ~~a ? "0" + a: a
        },
        formatDate: function(a, b) {
            return a ? ("string" == typeof a && (a = a.replace(/\//g, "-"), a = a.toDate()), b ? a.getFullYear() + "-" + this.pad(a.getMonth() + 1) + "-" + this.pad(a.getDate()) : a.getMonth() + 1 + "-" + a.getDate()) : ""
        },
        paddingData: function(a, b, c) {
            var d = {
                DepartList: [],
                ReturnList: []
            };
            return d.DepartList = this.paddingHelper(a.DepartList, b),
            d.ReturnList = this.paddingHelper(a.ReturnList, c),
            d
        },
        paddingHelper: function(a, b) {
            var c = this,
            d = a.length,
            e = a[d - 1],
            f = a[0],
            g = [],
            h = [];
            return a.each(function(i, j) {
                if (i.DepartureDateWithYear === b) {
                    var k = d - j - 1;
                    if (k >= 3) h = a.slice(j, j + 4);
                    else {
                        h = a.slice(j);
                        for (var l = 0; 3 - k > l; l++) {
                            var m = c.addDateOffset(e.DepartureDateWithYear, l + 1);
                            h.push({
                                DepartureCity: c.initSearchCondition.dCity,
                                ArrivalCity: c.initSearchCondition.aCity,
                                DepartureDate: c.formatDate(m),
                                DepartureDateWithYear: c.formatDate(m, !0),
                                DateOfWeek: c.getWeekday(m),
                                HasDirect: "",
                                disable: !0
                            })
                        }
                    }
                    if (j >= 3) g = a.slice(j - 3, j);
                    else {
                        g = a.slice(0, j);
                        for (var n = 0; 3 - j > n; n++) {
                            var o = c.addDateOffset(f.DepartureDateWithYear, -(n + 1));
                            g.unshift({
                                DepartureCity: c.initSearchCondition.dCity,
                                ArrivalCity: c.initSearchCondition.aCity,
                                DepartureDate: c.formatDate(o),
                                DepartureDateWithYear: c.formatDate(o, !0),
                                DateOfWeek: c.getWeekday(o),
                                HasDirect: "",
                                disable: !0
                            })
                        }
                    }
                }
            }),
            g.concat(h)
        },
        addDateOffset: function(a, b) {
            var c = new Date(a.replace(/-/g, "/"));
            return c.setDate(c.getDate() + b),
            this.formatDate(c, !0)
        },
        dateIsBefore: function(a, b) {
            var c = +new Date(a.replace(/-/g, "/")),
            d = +new Date(b.replace(/-/g, "/"));
            return d > c
        },
        padMMdd: function(a) {
            return this.pad(a.split("-")[0]) + "-" + this.pad(a.split("-")[1])
        }
    };
    IntlFlightAdvertiseUBT = {
        hasUploaded: !1,
        uploadDisplayUbt: function(a) {
            if (!this.hasUploaded) {
                this.hasUploaded = !0;
                var b = {
                    FlightClass: pageGlobal.NewUbt.FlightClass,
                    FlightWay: pageGlobal.NewUbt.FlightWay,
                    Sequence: pageGlobal.NewUbt.Sequence,
                    IsDisplayed: a ? 1 : 0
                };
                window.__bfi.push(["_tracklog", "flt_oversea_advertisement", $.stringifyJSON(b)])
            }
        },
        uploadClickUbt: function() {
            window.__bfi.push(["_tracklog", "flt_oversea_search_click", $.stringifyJSON({
                advertisement: 1
            })])
        }
    },
    NewcomparePrice.prototype.sortFareListByComparePrice = function(a) {
        var b = [],
        c = [],
        d = this;
        if (pageGlobal.OWIntelligenceRecSwitch) for (var e = 0; e < a.length; e++) {
            var f = a[e];
            f.IsOWIntelligenceRec && (c.push(f), a.splice(e, 1), e--)
        }
        var g = d.comparePriceByCatagoryAndPrice(a);
        for (var h in g) b.push(g[h].Item);
        this.setStandardFarePrice(a);
        var i = d.comparePriceByPriceAttribute(a);
        return i.each(function(a, c) {
            a.IsNeedDel || b.push(a)
        }),
        c.length && c.each(function(a) {
            b.push(a)
        }),
        b
    },
    NewcomparePrice.prototype.comparePriceByCatagoryAndPrice = function(a) {
        for (var b, c = {},
        d = 0; d < a.length; d++) {
            var e = a[d];
            if (pageGlobal.FlagShipStoreComparePriceByPriceAttribute) {
                if (!e.PlanCategory || 3 != e.PlanCategory) continue;
                b = e.PlanCategory
            } else {
                if (!e.PlanCategory || 3 != e.PlanCategory && 4 != e.PlanCategory) continue;
                b = e.PlanCategory,
                4 == e.PlanCategory && (b += e.ClassGrade)
            }
            c[b] ? e.SortCost < c[b].SortCost && (c[b].SortCost = e.SortCost, c[b].Item.IsNeedDel = !0, c[b].Item = e) : c[b] = {
                SortCost: e.SortCost,
                Item: e
            },
            e.IsCompared = !0
        }
        return c
    },
    NewcomparePrice.prototype.comparePriceByPriceAttribute = function(a) {
        for (var b, c, d = [], e = 0; e < a.length; e++) {
            var f = a[e];
            if (!f.IsNeedDel) {
                if (pageGlobal.FlagShipStoreComparePriceByPriceAttribute) {
                    if (f.PlanCategory && 3 == f.PlanCategory) continue
                } else if (f.PlanCategory && (3 == f.PlanCategory || 4 == f.PlanCategory)) continue;
                if (f.StandardPriceFare) d.push(f);
                else {
                    b = f.ClassGrade;
                    for (var g = 0; g < a.length; g++) if (g != e) {
                        var h = a[g];
                        if (c = h.ClassGrade, b == c) {
                            if (pageGlobal.FlagShipStoreComparePriceByPriceAttribute) {
                                if (h.PlanCategory && 3 == h.PlanCategory) continue;
                                if (4 == f.PlanCategory && 4 != h.PlanCategory || 4 != f.PlanCategory && 4 == h.PlanCategory) continue
                            } else if (h.PlanCategory && (3 == h.PlanCategory || 4 == h.PlanCategory)) continue;
                            if (!h.IsNeedDel) {
                                for (var i = !0,
                                j = 0,
                                k = 0; k < this.PriceAttributeCompareKey.length; k++) {
                                    var l = this.PriceAttributeCompareKey[k];
                                    if (f.ComparePriceInfo.PriceAttributeDict[l].Rank < h.ComparePriceInfo.PriceAttributeDict[l].Rank) {
                                        i = !1;
                                        break
                                    }
                                    f.ComparePriceInfo.PriceAttributeDict[l].Rank == h.ComparePriceInfo.PriceAttributeDict[l].Rank && (j += 1)
                                }
                                if (i) {
                                    var m = f.SortCost - (f.ComparePriceInfo ? f.ComparePriceInfo.DisCountPrice: 0),
                                    n = h.SortCost - (h.ComparePriceInfo ? h.ComparePriceInfo.DisCountPrice: 0);
                                    if (m > n) {
                                        f.IsNeedDel = !0;
                                        break
                                    }
                                    if (m == n) {
                                        if (j < this.PriceAttributeCompareKey.length) {
                                            f.IsNeedDel = !0;
                                            break
                                        }
                                        var o = f.TotalPrice,
                                        p = h.TotalPrice;
                                        if (p > o) {
                                            h.IsNeedDel = !0;
                                            continue
                                        }
                                        if (o > p) {
                                            f.IsNeedDel = !0;
                                            break
                                        }
                                        if (f.ComparePriceInfo.ChannelPriority < h.ComparePriceInfo.ChannelPriority) {
                                            h.IsNeedDel = !0;
                                            continue
                                        }
                                        f.IsNeedDel = !0;
                                        break
                                    }
                                    if (j == this.PriceAttributeCompareKey.length) {
                                        h.IsNeedDel = !0;
                                        continue
                                    }
                                }
                            }
                        }
                    }
                    f.IsNeedDel || (f.IsCompared = !0, d.push(f))
                }
            }
        }
        return d
    },
    NewcomparePrice.prototype.setStandardFarePrice = function(a) {
        for (var b, c, d = {},
        e = 0,
        f = 0,
        g = 0,
        h = 0,
        i = 0; i < a.length; i++) {
            var j = a[i];
            if ((!j.IsCompared || j.StandardPriceFare) && (!pageGlobal.FlagShipStoreComparePriceByPriceAttribute || 4 != j.PlanCategory)) if (c = j.ClassGrade, b = j.ComparePriceInfo.PriceAttributeDict, e = b.Restriction.CompareWeight, f = b.Penalties.CompareWeight, g = b.Baggageallowance.CompareWeight, h = j.SortCost, d[c]) {
                var k = d[c],
                l = this.comparePriceAttributeToFindStandardFare(j, k.item);
                l && (k.Restriction = e, k.Penalties = f, k.Baggageallowance = g, k.SortCost = h, k.item.StandardPriceFare && (delete k.item.StandardPriceFare, delete k.item.IsCompared), k.item = j)
            } else {
                var m = {};
                m.Restriction = e,
                m.Penalties = f,
                m.Baggageallowance = g,
                m.SortCost = h,
                m.item = j,
                d[c] = m
            }
        }
        for (var n in d) d[n].item.IsCompared = !0,
        d[n].item.StandardPriceFare = !0
    },
    NewcomparePrice.prototype.comparePriceAttributeToFindStandardFare = function(a, b) {
        var c = a.ComparePriceInfo.PriceAttributeDict,
        d = c.Restriction.CompareWeight,
        e = c.Penalties.CompareWeight,
        f = c.Baggageallowance.CompareWeight,
        g = a.SortCost,
        h = b.ComparePriceInfo.PriceAttributeDict,
        i = h.Restriction.CompareWeight,
        j = h.Penalties.CompareWeight,
        k = h.Baggageallowance.CompareWeight,
        l = b.SortCost,
        m = function(a, b) {
            return b >= a
        },
        n = function(a, b) {
            return a == b
        };
        if (i > d) return ! 1;
        if (d > i) return ! 0;
        if (d == i && 0 == d) {
            var o = n(g, l);
            return o ? this.standardFareComparePrice(a, b) : m(g, l)
        }
        if (e >= 0) {
            if (0 > j) return ! 0
        } else if (j >= 0) return ! 1;
        if (f >= 0) {
            if (0 > k) return ! 0
        } else if (k >= 0) return ! 1;
        var o = n(g, l);
        return o ? this.standardFareComparePrice(a, b) : m(g, l)
    },
    NewcomparePrice.prototype.standardFareComparePrice = function(a, b) {
        for (var c = 0; c < this.PriceAttributeCompareKey.length; c++) {
            var d = this.PriceAttributeCompareKey[c];
            if (a.ComparePriceInfo.PriceAttributeDict[d].Rank < b.ComparePriceInfo.PriceAttributeDict[d].Rank) return ! 0
        }
        var e = a.SortCost - (a.ComparePriceInfo ? a.ComparePriceInfo.DisCountPrice: 0),
        f = b.SortCost - (b.ComparePriceInfo ? b.ComparePriceInfo.DisCountPrice: 0);
        return f > e ? !0 : e == f ? a.TotalPrice < b.TotalPrice ? !0 : a.TotalPrice > b.TotalPrice ? !1 : a.ComparePriceInfo.ChannelPriority < b.ComparePriceInfo.ChannelPriority: !1
    },
    NewcomparePrice.prototype.getTheLowestPriceFareByCategoryAndClassGrade = function(a) {
        for (var b, c = [], d = {},
        e = 0; e < a.length; e++) {
            var f = a[e];
            if (b = f.PlanCategory + f.ClassGrade, f.ComparePriceInfo && f.ComparePriceInfo.PriceAttributeDict.ForcedDisplay) {
                var g = f.ComparePriceInfo.PriceAttributeDict.ForcedDisplay.PriceAttributeValue;
                g && "Y" == g && (b += "_ForcedDisplay")
            }
            f.PlanCategory && 3 == f.PlanCategory && (b = f.PlanCategory),
            f.PlanCategory && 4 == f.PlanCategory && f.PassengerRestriction && (b = b + f.PassengerRestriction.MaxPassengerCount + f.PassengerRestriction.MinPassengerCount),
            d[b] ? f.TotalPrice < d[b].TotalPrice && (d[b] = f) : d[b] = f
        }
        for (var h in d) c.push(d[h]);
        return c = this.processForceDisplayFare(c)
    },
    NewcomparePrice.prototype.processForceDisplayFare = function(a) {
        for (var b = 0; b < a.length; b++) {
            var c = a[b];
            if (!c.isRemove && c.ComparePriceInfo && c.ComparePriceInfo.PriceAttributeDict.ForcedDisplay && "Y" == c.ComparePriceInfo.PriceAttributeDict.ForcedDisplay) for (var d = c.PlanCategory + c.ClassGrade,
            e = 0; e < a.length; e++) if (e != b) {
                var f = a[e];
                if (!f.PlanCategory || 3 != f.PlanCategory && 4 != f.PlanCategory) {
                    var g = f.PlanCategory + f.ClassGrade;
                    d == g && c.TotalPrice <= f.TotalPrice && (f.isRemove = !0)
                }
            }
        }
        for (var h = [], b = 0; b < a.length; b++) a[b].isRemove || h.push(a[b]);
        return h
    },
    Uniq.prototype.getName = function(a) {
        return a.value
    },
    Uniq.prototype.sort = function(a) {
        a = a || this.curType,
        this.value.sort(function(b, c) {
            return b[a] - c[a]
        });
        var b = this;
        this.value.each(function(a, c) {
            b.keys[a.value] = c
        })
    },
    Uniq.prototype.clear = function() {
        this.value = [],
        this.keys = {},
        this.filter = {},
        this.length = 0
    },
    Uniq.prototype.isSameGrade = function(a) {
        switch (condition.ClassGrade) {
        case "C_F":
            return "C" === a.classGrade || "F" === a.classGrade;
        case "C":
        case "F":
            return a.classGrade === condition.ClassGrade;
        default:
            return ! 0
        }
    },
    Uniq.prototype.setPriceIfSameGrade = function(a) {
        return this.isSameGrade(a) || (a.Price = 99999999, a.TotalPrice = 99999999),
        a
    },
    Uniq.prototype.push = function(a, b, c, d) {
        b = b || this.curType;
        var e = this.getName(a); ! d && pageGlobal.BusinessClassFilterPriceSwitch && (a = this.setPriceIfSameGrade(a)),
        void 0 !== e && "" !== e && ("undefined" == typeof this.filter[e] && (this.filter[e] = {}), "undefined" == typeof this.keys[e] && (this.value[this.keys[e] = this.length++] = a), this.value[this.keys[e]].Price > a.Price && (this.value[this.keys[e]].Price = a.Price), this.value[this.keys[e]].TotalPrice > a.TotalPrice && (this.value[this.keys[e]].TotalPrice = a.TotalPrice), a.extInfo && (this.value.extInfo = a.extInfo), void 0 === this.filter[e][a.key] && (this.filter[e][a.key] = []), this.getSpecValue && this.filter[e][a.key].push(this.getSpecValue(a)), c && this.sort(b))
    },
    online.create("service.NewResult.Filter", {
        options: {
            resultService: null,
            panel: "#filterPanel",
            loading: "#filtersLoading",
            moreFilter: "#moreFilter",
            toggleBtn: "#toggleMoreAirline",
            resetBtn: "showAllResult",
            searchAllCityBtn: "searchAllCity",
            airlineList: "#OwnerAirlineName",
            allianceList: "#Alliance",
            disStyle: "option-disabled",
            combineClassGradeName: "",
            filterList: null,
            curFilter: [],
            keys: [],
            key: {}
        },
        methods: {
            initialize: function(a) {
                if (this.info(), this.extend(this, a), null !== this.resultService && (this.panel = $(this.panel), !(this.panel.length < 1 || null === this.filterList))) {
                    this.loading = $(this.loading),
                    this.airlineList = $(this.airlineList),
                    this.allianceList = $(this.allianceList),
                    this.toggleBtn = $(this.toggleBtn),
                    this.reportData = this.resultService.filterUBTData = {};
                    for (var b in this.filterList) this.reportData[this.filterList[b]] = 0;
                    this.init(),
                    this.resultService.filterService = this,
                    this.bindEvent()
                }
            },
            init: function() {
                if (this.keys.length = 0, uconfig && utmpl) for (var a in uconfig) if ((!this.isClassGradeSection(a) || pageGlobal.IsOpenSingleClassGradeSearch) && (this.key[a] = this.keys.length, this.keys.push(new Uniq($.extend($.copy(uconfig[a]), utmpl[a]))), this.isClassGradeSection(a))) {
                    var b = this.keys[this.keys.length - 1];
                    this.initClassGradeSection(b)
                }
                pageGlobal.IsOpenSingleClassGradeSearch ? this.panel.find(".filter-expend-tips").html(this.resultService.flightWay && "builtUp" === this.resultService.flightType ? "\u5f80\u8fd4\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u8231\u4f4d\u7b49\u7ea7\u3001\u4e58\u5ba2\u8d44\u8d28": "\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u673a\u573a\u3001\u8231\u4f4d\u7b49\u7ea7\u3001\u4e58\u5ba2\u8d44\u8d28") : this.panel.find(".filter-expend-tips").html(this.resultService.flightWay && "builtUp" === this.resultService.flightType ? "\u5f80\u8fd4\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u4e58\u5ba2\u8d44\u8d28": "\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u673a\u573a\u3001\u4e58\u5ba2\u8d44\u8d28"),
                this.applyDefaultFilter()
            },
            isClassGradeSection: function(a) {
                return "ClassGradeFilterSection" == a
            },
            initClassGradeSection: function(a) {
                if (condition) {
                    var b, c = condition.ClassGrade;
                    "Y" == c || "S" == c || "Y_S" == c ? (b = ["\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231", "\u8d85\u7ea7\u7ecf\u6d4e\u8231", "\u7ecf\u6d4e\u8231"], this.isQueryEconomicClassGrade = !0) : (b = ["\u516c\u52a1/\u5934\u7b49\u8231", "\u516c\u52a1\u8231", "\u5934\u7b49\u8231"], this.isQueryEconomicClassGrade = !1),
                    this.combineClassGradeName = b[0];
                    var d = {
                        Y: "\u7ecf\u6d4e\u8231",
                        S: "\u8d85\u7ea7\u7ecf\u6d4e\u8231",
                        Y_S: "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231",
                        C: "\u516c\u52a1\u8231",
                        F: "\u5934\u7b49\u8231",
                        C_F: "\u516c\u52a1/\u5934\u7b49\u8231",
                        "\u7ecf\u6d4e\u8231": "Y",
                        "\u8d85\u7ea7\u7ecf\u6d4e\u8231": "S",
                        "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231": "Y_S",
                        "\u516c\u52a1\u8231": "C",
                        "\u5934\u7b49\u8231": "F",
                        "\u516c\u52a1/\u5934\u7b49\u8231": "C_F"
                    },
                    e = d[c];
                    b.each(function(b) {
                        a.push({
                            key: "classgrade",
                            extInfo: {
                                classGrade: e,
                                actualValue: d[b]
                            },
                            value: b,
                            Price: 99999999,
                            TotalPrice: 99999999
                        })
                    })
                }
            },
            isOWIntelligenceRec: function(a) {
                return "OWIntelligenceRec" == a
            },
            initOWIntelligenceRec: function(a) {},
            bindEvent: function() {
                var a = this;
                if (this.panel.onn("click", "filter-option",
                function(b) {
                    b.stop(),
                    a.resultService.marketChangeFilter = !1;
                    var c = $(this),
                    d = $(this.parentNode);
                    if (!c.hasClass(a.disStyle)) {
                        var e = d.attr("data-type"),
                        f = c.attr("data-value");
                        if ("undefined" != typeof a.key[e] || "OWIntelligenceRec" === e) {
                            "3" == c.attr("data-value") && online.setNewUbtSpecial("flightandtrainfiter"),
                            c.find("a.checkbox-icon").toggleClass("checkbox-icon-checked");
                            var g = !1,
                            h = c.find("a.checkbox-icon");
                            h && h.length > 0 && (g = h.hasClass("checkbox-icon-checked"));
                            for (var i = this; $(i).hasClass("filter-section") === !1 && (i = i.parentNode, i !== document););
                            if (i = $(i), i.length > 0 && i.hasClass("filter-section")) {
                                var j = i.find(".checkbox-icon-checked").length;
                                i.find(".checked-count").html(j),
                                j > 0 ? i.addClass("filter-section-selected") : i.removeClass("filter-section-selected")
                            }
                            a.resultService.needHideDowngradeTip = !0,
                            a.filterMain(e, g, f)
                        }
                    }
                }), $(".container").onn("click", this.resetBtn,
                function(b) {
                    b.stop(),
                    a.clearAllFilter(!0),
                    a.reportUBT("ClearAllTimes")
                }), $(".container").onn("click", this.searchAllCityBtn,
                function(b) {
                    b.stop(),
                    a.clearAllFilter(!0),
                    $(".subairport-recmd-banner").css("display", "none")
                }), this.toggleBtn.bind("click",
                function(b) {
                    try {
                        b && b.stop()
                    } catch(b) {}
                    a.airlineList.toggleClass("filter-section-expended"),
                    $(this).find("span").html(a.toggleIcon(this) ? "\u6536\u8d77": "\u66f4\u591a")
                }), this.panel.find("a.filter-expend-toggle").bind("click",
                function(b) {
                    try {
                        b && b.stop()
                    } catch(b) {}
                    a.toggleFilterExpand($(this))
                }), this.panel.find(".filter-section").bind("mouseover",
                function() {
                    document.documentElement.clientWidth >= 1180 || $(this).find(".filter-options").css("display", "block")
                }).bind("mouseout",
                function() {
                    document.documentElement.clientWidth >= 1180 || $(this).find(".filter-options").css("display", "")
                }), $.browser.isIE6 && 1 == $(".about-ctrip").length && $(".about-ctrip").bind("mouseover",
                function() {
                    document.documentElement.clientWidth >= 1180 || $(".about-ctrip").find(".about-ctrip-wrapper").css("display", "block")
                }).bind("mouseout",
                function() {
                    document.documentElement.clientWidth >= 1180 || $(".about-ctrip").find(".about-ctrip-wrapper").css("display", "")
                }), Math.ceil(screen.width * ($.browser.isIE ? (screen.deviceXDPI || 1) / (screen.logicalXDPI || 1) : 1)) < 1180) $("body").addClass("tablet");
                else if ($.browser.isIE6 || $.browser.isIE7 || $.browser.isIE8) {
                    var b;
                    $(window).bind("resize",
                    function() {
                        b && clearTimeout(b),
                        b = setTimeout(function() {
                            $("body")[document.documentElement.clientWidth < 1180 ? "addClass": "removeClass"]("tablet")
                        },
                        250)
                    }).trigger("resize")
                }
            },
            applyDefaultFilter: function() {
                var a = this.resultService.cond;
                if (a.AirlineName && this.getFilterResult(this.key.OwnerAirlineName, !0, a.AirlineName), a.TransferCity && this.getFilterResult(this.key.TransferTime, !0, a.TransferCity), a.TransferTime && a.TransferTime >= 2 && this.getFilterResult(this.key.DurationTime, !0, a.TransferTime - 2), "T" === a.IsDirect && "M" !== this.resultService.flightWay && this.getFilterResult(this.key.TransferCount, !0, 0), "D" !== this.resultService.flightWay || "builtUp" !== this.resultService.flightType) {
                    this.airports = {
                        DPort: this.getAirPortCode(a.SegmentList[this.resultService.curSegment].DCity),
                        APort: this.getAirPortCode(a.SegmentList[this.resultService.curSegment].ACity)
                    };
                    for (var b in this.airports) this.airports[b] && this.getFilterResult(this.key[b], !0, this.airports[b])
                }
            },
            getAirPortCode: function(a) {
                return a && -1 !== a.indexOf("\u673a\u573a") && -1 !== a.indexOf(")(") && (a = a.match(/\)\((.+?)\)/), null !== a) ? a[1] : ""
            },
            getAirlineName: function(a) {
                return a && -1 !== a.indexOf("\u673a\u573a") && -1 !== a.indexOf(")(") && (a = a.match(/\((.+?)\)\(/), null !== a) ? a[1] : ""
            },
            toggleIcon: function(a) {
                return a = $(a).find(".icon-caret"),
                a.toggleClass("icon-caret-up"),
                a.hasClass("icon-caret-up")
            },
            loadCallback: function() {
                this.loading.hide(),
                this.update(),
                this.panel.show(),
                "none" === $(this.moreFilter).css("display") && this.toggleFilterExpand()
            },
            update: function(a, b) {
                var c = this,
                d = 0;
                if (this.keys.each(function(a, b) {
                    if (("DPort" === a.id || "APort" === a.id) && (d += a.length), a.length < 1 || c.resultService.curSegment > 0 && c.isClassGradeSection(a.id)) $("#" + a.id).hide();
                    else if (a.tmpl) {
                        $("#" + a.id).show(),
                        a.curType = c.resultService.curType,
                        a.needSort && a.sort();
                        var e = $("#" + a.id + " > .filter-options");
                        e.length < 1 && (e = $("#" + a.id));
                        var f = e.find("." + c.disStyle),
                        g = [],
                        h = e.find(".checkbox-icon-checked"),
                        i = [];
                        if (f.each(function(a) {
                            g.push("[data-value='" + a.attr("data-value") + "']")
                        }), h.each(function(a) {
                            a = $(a[0].parentNode.parentNode),
                            i.push("[data-value='" + a.attr("data-value") + "']")
                        }), "TransferTime" === a.id) {
                            for (var b = 0; b < a.value.length; b++) {
                                var j = a.value[b];
                                if (j.StopCityName) {
                                    var k = $.parseJSON($.stringifyJSON(j));
                                    j.StopCityName = "",
                                    k.ACityName = k.StopCityName,
                                    k.StopCityName = "",
                                    a.value.push(k),
                                    k.TransferTime || (a.value.splice(b, 1), b--)
                                }
                            }
                            for (var b = 0; b < a.value.length; b++) for (var j = a.value[b], l = b + 1; l < a.value.length; l++) {
                                var m = a.value[l];
                                j.ACityName === m.ACityName && (j.Price = j.Price < m.Price ? j.Price: m.Price, j.TotalPrice = j.TotalPrice < m.TotalPrice ? j.TotalPrice: m.TotalPrice, a.value.splice(l, 1), l--)
                            }
                        }
                        e.attr("data-index", b).attr("data-type", a.id).html($.tmpl.render(a.tmpl, a)),
                        "OwnerAirlineName" === a.id && a.length < 6 && e.css("height", 23 * a.length + "px"),
                        g.length > 0 && e.find(".filter-option").filter(g.join(",")).addClass(c.disStyle),
                        i.length > 0 && e.find(".filter-option").filter(i.join(",")).find(".checkbox-icon").addClass("checkbox-icon-checked")
                    }
                }), d > 0) {
                    this.filterCurSegmentTip(),
                    this.loading.hide(),
                    this.panel.show();
                    var e = $("#TransferCount");
                    e.find(".hide-on-notrain")[e.find('.filter-option[data-value="3"]').length ? "show": "hide"]()
                }
                if (a) {
                    $("#DPort").parentNode().parentNode()[1 > d ? "hide": "show"](),
                    1 > d && this.panel.find(".filter-expend-tips").html(this.panel.find(".filter-expend-tips").html().replace("\u3001\u673a\u573a", ""));
                    var f = this.airlineList.find(".filter-option").length,
                    g = this.airlineList.find(".filter-options:first");
                    7 > f ? ($(this.toggleBtn[0].parentNode).hide(), g.css("height", 23 * f + "px")) : ($(this.toggleBtn[0].parentNode).show(), g.css("height", ""), g.addClass("options-col" + Math.ceil(f / 10))),
                    $("#TransferTime .filter-option").length < 1 && this.panel.find(".filter-expend-tips").html(this.panel.find(".filter-expend-tips").html().replace("\u3001\u4e2d\u8f6c", ""));
                    var h = this.resultService.cond;
                    if ("T" === h.IsDirect && "M" !== this.resultService.flightWay && $("#TransferCount .filter-option[data-value=0]").length < 1 && (this.clearFilter("TransferCount", 0), this.resultService.showFriendlyTips()), "M" !== this.resultService.flightWay && (h.TransferCity && $("#TransferTime .filter-option[data-value=" + h.TransferCity + "]").length < 1 && (this.clearFilter("TransferTime", h.TransferCity), this.resultService.showFriendlyTips()), h.TransferTime && h.TransferTime >= 2 && $("#DurationTime .filter-option[data-value=" + (h.TransferTime - 2) + "]").length < 1 && (this.clearFilter("DurationTime", h.TransferTime - 2), this.resultService.showFriendlyTips())), this.airports) {
                        var i = 0,
                        j = !1;
                        for (var k in this.airports) this.airports[k] && ($("#" + k + " .filter-option[data-value='" + this.airports[k] + "']").length < 1 ? (j = !0, c.clearFilter(k, this.airports[k]), NoResultRecommendUbt.addType(RECOMMENDTYPE_ONECITY_MULTIPORTS)) : i++);
                        j && this.resultService.showFriendlyTips(),
                        i > 0 && "none" === $("#moreFilter").css("display") && ($("a.filter-expend-toggle").trigger("click"), $($("#DPort")[0].parentNode.parentNode).addClass("filter-section-selected").find(".checked-count").html(i))
                    }
                    var l, m = h.AirlineName;
                    "undefined" != typeof m && (l = this.airlineList.find(".filter-option[data-value='" + m + "']:first"), l.length > 0 && l.attr("data-ind") > 5 && this.airlineList.hasClass("filter-section-expended") === !1 && (this.toggleBtn.trigger("click"), this.airlineList.addClass("filter-section-selected").find(".checked-count").html(1))),
                    l = this.airlineList.find(".checkbox-icon-checked"),
                    l.length > 0 && l.parentNode().parentNode().attr("data-ind") > 5 && this.airlineList.hasClass("filter-section-expended") === !1 && this.toggleBtn.trigger("click")
                }
                this.filterMain(),
                this.updatePanel(),
                this.matrix && ("none" !== this.matrix.panel.css("display") && ("S" === this.resultService.flightWay || "D" === this.resultService.flightWay && "freeStyle" === this.resultService.flightType) ? this.matrix.makeLowKB() : this.matrix.closePanel()),
                a && setTimeout(function() {
                    c.resultService.filterLoadFinish = !0
                },
                700)
            },
            dispose: function() {
                this.panel.hide(),
                this.loading.hide(),
                $(".side-title:first").slideUp()
            },
            add: function(a, b) {
                a.ContainsVirtualFlight || this.analyzeDetail(a, this.keys, b)
            },
            analyzeDetail: function(a, b) {
                var c = this,
                d = a.FlightInfo || [a];
                b.each(function(b) {
                    d.each(function(d) {
                        d.FlightDetail.each(function(d) {
                            if (1 !== d.IsPartial) {
                                var e = {};
                                for (var f in b.fakeValues) d[b.fakeValues[f]] && (e[f] = d[b.fakeValues[f]]);
                                c.isClassGradeSection(b.id) && a.FareList ? a.FareList.each(function(d) {
                                    var e = {
                                        key: a.Key,
                                        value: c.getClassGradeName(d),
                                        Price: d.Price,
                                        TotalPrice: d.TotalPrice,
                                        classGrade: d.PrimaryClassGrade
                                    },
                                    f = -1 != e.value.indexOf("\u7ecf\u6d4e"),
                                    g = c.isQueryEconomicClassGrade && f || !c.isQueryEconomicClassGrade && !f;
                                    g && (b.push(e, void 0, void 0, !0), e.value = c.combineClassGradeName, b.push(e, void 0, void 0, !0))
                                }) : b.push(c.getUniqValue(a, b, e)),
                                "TransferTime" === b.id && d.StopCityName && (e.ACityName = d.StopCityName, b.push(c.getUniqValue(a, b, e))),
                                "Alliance" === b.id && a.Alliance && a.OperatingAlliance && a.OperatingAlliance.toUpperCase() != a.Alliance.toUpperCase() && (e.Alliance = a.OperatingAlliance, b.push(c.getUniqValue(a, b, e)))
                            }
                        })
                    })
                }),
                pageGlobal.OWIntelligenceRecSwitch && a.FareList && a.ContainsOWIntelligenceRec && a.FareList.each(function(a) {
                    if (a.IsOWIntelligenceRec) {
                        var b = $("#OWIntelligenceRecBestPrice"),
                        c = +b.attr("data-best-price"),
                        d = +b.attr("data-best-total-price"),
                        e = a.Price,
                        f = a.TotalPrice; (!c || c > e) && b.attr("data-best-price", e),
                        (!d || d > f) && b.attr("data-best-total-price", f)
                    }
                })
            },
            getClassGradeName: function(a) {
                if (a.ClassName) return "\u660e\u73e0\u7ecf\u6d4e\u8231" == a.ClassName ? "\u8d85\u7ea7\u7ecf\u6d4e\u8231": a.ClassName;
                if (a.ClassInfo) {
                    for (var b = 1,
                    c = 0; c < a.ClassInfo.length; c++) {
                        var d = a.ClassInfo[c];
                        b < d.SegmentNo && (b = d.SegmentNo)
                    }
                    for (var e = [], c = 1; b >= c; c++) e.push(online.getPrimarySegmentClassName(a.ClassInfo, c));
                    var f = function(a, b) {
                        for (var c = 0; c < a.length; c++) if (a[c] == b) return ! 0;
                        return ! 1
                    };
                    if (1 == e.length) {
                        var g = e[0];
                        return "\u660e\u73e0\u7ecf\u6d4e\u8231" == g ? "\u8d85\u7ea7\u7ecf\u6d4e\u8231": g
                    }
                    return f(e, "\u7ecf\u6d4e\u8231") ? "\u7ecf\u6d4e\u8231": f(e, "\u8d85\u7ea7\u7ecf\u6d4e\u8231") ? "\u8d85\u7ea7\u7ecf\u6d4e\u8231": f(e, "\u660e\u73e0\u7ecf\u6d4e\u8231") ? "\u8d85\u7ea7\u7ecf\u6d4e\u8231": f(e, "\u516c\u52a1\u8231") ? "\u516c\u52a1\u8231": "\u5934\u7b49\u8231"
                }
            },
            getUniqValue: function(a, b, c) {
                c = c || {};
                var d = {
                    key: a.Key,
                    value: c[b.id] || a[b.id],
                    Price: a.Price,
                    TotalPrice: a.TotalPrice,
                    classGrade: a.PrimaryClassGrade
                },
                e = this.resultService;
                if (b.extValKey && b.extValKey.each(function(b) { (c[b] || a[b]) && (d[b] = c[b] || a[b])
                }), b.extKey) {
                    var f = this.City4Code(e.curSegment);
                    b.extKey.each(function(c) {
                        var d = f[c] ? f: a;
                        d[c] && (b[c] = d[c])
                    })
                }
                return d
            },
            City4Code: function(a) {
                var b = this.cond.SegmentList[a],
                c = ["DCity", "ACity"],
                d = {};
                return c.each(function(a) {
                    var c = b[a + "Code"] || "";
                    4 === c.length && (d[a + "Name"] = (b[a] || "").split("|")[1])
                }),
                d
            },
            reportUBT: function(a) {
                void 0 !== this.filterList[a] && this.reportData[this.filterList[a]]++
            },
            uploadClassGradeFilterUbt: function(a) {
                try {
                    var b = {
                        TriggerType: "action",
                        "class": a
                    };
                    window.__bfi.push(["_tracklog", "c_class_radio", $.stringifyJSON(b)])
                } catch(c) {}
            },
            filterMain: function(a, b, c) {
                var d, e = this.key[a];
                if (a && this.reportUBT(a), this.isClassGradeSection(a)) {
                    if ("Y" == c || "S" == c) {
                        var f = "Y" == c ? "\u7ecf\u6d4e\u8231": "\u8d85\u7ea7\u7ecf\u6d4e\u8231";
                        document.getElementById("drpSubClass").options.add(new Option(f, c))
                    }
                    return this.uploadClassGradeFilterUbt(c),
                    $("#drpSubClass").value(c),
                    $("#drpSubClass").trigger("change"),
                    void document.getElementById("btnSearch").click()
                }
                try {
                    if (void 0 === a) d = this.getFilterResult();
                    else if (void 0 === (d = this.getFilterResult(e, b, c))) return ! 1;
                    return d !== !1 || pageGlobal.OWIntelligenceRecSwitch && this.hasCheckOWIntelligenceRec() ? ((d && d.length > 0 || pageGlobal.OWIntelligenceRecSwitch) && this.disableFilterResults(e, c, d), this.resultService.curFilterResult = d) : this.clearAllFilter(),
                    this.resultService.needUpdateFilter = !1,
                    this.resultService.update(),
                    this.resultService.needUpdateFilter = !0,
                    !0
                } finally {
                    b && this.updatePanel()
                }
            },
            updatePanel: function() {
                var a;
                this.panel.find(".checkbox-icon-checked:not(.ignore-when-update)").removeClass("checkbox-icon-checked");
                for (var b = this.curFilter.length; b--;) {
                    a = [];
                    for (var c in this.curFilter[b])"index" !== c && "length" !== c && a.push(".filter-option[data-value='" + c + "'] .checkbox-icon:not(.checkbox-icon-checked)");
                    a.length > 0 && $("#" + this.keys[this.curFilter[b].index].id).find(a.join(",")).addClass("checkbox-icon-checked")
                }
                var d = this.airlineList.find(".filter-option").length,
                e = this.airlineList.find(".filter-option:not(.option-disabled):first");
                d > 6 && 1 * e.attr("data-ind") > 5 && this.airlineList.hasClass("filter-section-expended") === !1 && this.toggleBtn.trigger("click");
                var f = $("#OWIntelligenceRecBestPrice"),
                g = +f.attr("data-best-price"),
                h = +f.attr("data-best-total-price");
                g && h ? ($("#OWIntelligenceRec").show(), "Price" === this.resultService.curType ? f.html(g) : f.html(h)) : $("#OWIntelligenceRec").hide()
            },
            disableFilterResults: function(a, b, c) {
                var d = this,
                e = c && c.length;
                if (e) for (var f in this.filterList) if (! ($("#" + f).length < 1)) {
                    var g = $("#" + f + " .filter-option");
                    if (! (g.length < 1)) {
                        var h = this.key[f];
                        g.each(function(c) {
                            var e = c.attr("data-value");
                            if (h !== a || e !== b) {
                                var f = d.getFilterResult(h, !0, e, !0).length < 1;
                                c[f ? "addClass": "removeClass"](d.disStyle)
                            }
                        })
                    }
                }
                if (pageGlobal.OWIntelligenceRecSwitch) {
                    var i = !1;
                    if (e) for (var a in c) if (c[a].ContainsOWIntelligenceRec) {
                        i = !0;
                        break
                    } ! i && e ? $("#OWIntelligenceRecOption").addClass(d.disStyle) : $("#OWIntelligenceRecOption").removeClass(d.disStyle)
                }
            },
            getFilterResult: function(a, b, c, d) {
                var e, f = !1,
                g = this;
                if ("undefined" != typeof a) {
                    if (this.curFilter.length > 0) for (var h = this.curFilter.length; h--;) if (this.curFilter[h].index === a) {
                        f = h;
                        break
                    }
                    if (b === !1 && f === !1) return;
                    if (f === !1) {
                        var i = {
                            index: a,
                            length: 1
                        };
                        i[c] = 1,
                        this.curFilter.push(i)
                    } else if (b) if (d) {
                        e = this.curFilter[f];
                        var i = {
                            index: a,
                            length: 1
                        };
                        i[c] = 1,
                        this.curFilter[f] = i
                    } else "undefined" == typeof this.curFilter[f][c] && (this.curFilter[f].length++, this.curFilter[f][c] = 1);
                    else if (this.curFilter[f].length--, this.curFilter[f].length < 1) {
                        if (this.curFilter.splice(f, 1), this.curFilter.length < 1) return ! 1
                    } else delete this.curFilter[f][c]
                }
                var j, k = "OWIntelligenceRecKey" == c,
                l = this.curFilter.length < 1,
                m = function(a) {
                    var b = a.slice();
                    if (pageGlobal.OWIntelligenceRecSwitch) for (var c = g.hasCheckOWIntelligenceRec(), d = c, e = 0; e < b.length; e++) {
                        var f = b[e];
                        f && (d ? f.OnlyOWIntelligenceRecFare ? (b.splice(e, 1), e--) : f.ContainsOWIntelligenceRec && (f.FareList = f.FareListWithoutOWIntelligenceRec) : f.ContainsOWIntelligenceRec && (f.FareList = f.FareListWithOWIntelligenceRec))
                    }
                    return b
                },
                n = [],
                o = {},
                p = this.resultService.getCurFlightList(),
                q = this.resultService.flightKey;
                if (!k && l) return this.hasCheckOWIntelligenceRec() ? m(p) : void 0;
                if (this.curFilter.length >= 1) {
                    var i = this.curFilter.shift(),
                    r = this.keys[i.index].filter;
                    for (var s in i) if ("length" !== s && "index" !== s) for (var t in r[s]) this.checkOtherFilter(t, b, d) && (j = q[t], void 0 === o[j] && n.push(p[o[j] = j]));
                    this.curFilter.unshift(i),
                    d && (f === !1 ? this.curFilter.pop() : b && e && (this.curFilter[f] = e))
                } else n = this.resultService.getCurFlightList();
                if (pageGlobal.VirtualFlightSwitch) for (var h = 0; h < p.length; h++) {
                    var u = p[h];
                    u && u.ContainsVirtualFlight && n.indexOf(u) < 0 && n.push(u)
                }
                return n = m(n)
            },
            hasCheckOWIntelligenceRec: function() {
                return $("#OWIntelligenceRecCheckBox").length && $("#OWIntelligenceRecCheckBox").hasClass("checkbox-icon-checked")
            },
            toggleFilterExpand: function(a) {
                a = a || this.panel.find("a.filter-expend-toggle"),
                $(this.moreFilter).slideToggle();
                var b = this.toggleIcon(a);
                a.find(".filter-expend-tips")[b ? "addClass": "removeClass"]("hide"),
                a.find(".filter-expend span").html(b ? "\u6536\u8d77": "\u663e\u793a\u5168\u90e8")
            },
            checkOtherFilter: function(a, b, c) {
                for (var d, e, f = 0,
                g = this.curFilter.length; g > f; f++) {
                    d = this.curFilter[f],
                    e = !0;
                    for (var h in d) if ("length" !== h && "index" !== h && ("undefined" == typeof this.keys[d.index].filter[h] || "undefined" != typeof this.keys[d.index].filter[h][a])) {
                        e = !1;
                        break
                    }
                    if (e) return ! 1
                }
                return ! 0
            },
            clearFilter: function(a, b) {
                this.getFilterResult(this.key[a], !1, b),
                this.resultService.update()
            },
            clearAllFilter: function(a) {
                delete this.resultService.curFilterResult,
                this.curFilter.length < 1 && !this.hasCheckOWIntelligenceRec() ? a = !1 : this.curFilter.length = 0,
                this.panel.find("." + this.disStyle).removeClass(this.disStyle),
                this.panel.find(".checkbox-icon-checked").removeClass("checkbox-icon-checked"),
                this.panel.find(".filter-section-selected").removeClass("filter-section-selected"),
                a && this.resultService.update()
            },
            reset: function() {
                this.clearAllFilter(),
                this.init(),
                this.resultService.loadFinish === !1 && (this.panel.hide(), this.loading.show()),
                this.matrix && "D" === this.resultService.flightWay && ("builtUp" === this.resultService.flightType ? (this.matrix.closePanel(), this.matrix.toggleBtn.parentNode().hide(), this.panel.find(".filter-expend-tips").html("\u5f80\u8fd4\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u4e58\u5ba2\u8d44\u8d28")) : (this.matrix.toggleBtn.parentNode().show(), this.panel.find(".filter-expend-tips").html("\u5230\u8fbe\u65f6\u95f4\u3001\u4e2d\u8f6c\u3001\u673a\u573a\u3001\u4e58\u5ba2\u8d44\u8d28"))),
                document.documentElement.clientWidth >= 1180 && $(".side-title:first").slideDown()
            },
            filterCurSegmentTip: function() {
                try {
                    if (this.resultService && this.resultService.flightWay && ("D" == this.resultService.flightWay && "freeStyle" === this.resultService.flightType || "M" == this.resultService.flightWay)) {
                        var a = function(a, b) {
                            0 == b ? a.attr("title") || a.attr("title", "\u7b5b\u9009\u53ea\u5e94\u7528\u4e8e\u5f53\u524d\u7a0b") : a.attr("title") && a.removeAttr("title")
                        };
                        this.resultService.isLastSegment || (this.airlineList && this.airlineList.find(".checkbox-wrapper,.best-price").each(function(b) {
                            a(b, 0)
                        }), this.allianceList && this.allianceList.find(".checkbox-wrapper,.best-price").each(function(b) {
                            a(b, 0)
                        })),
                        this.matrix && a(this.matrix.toggleBtn, this.resultService.isLastSegment ? 1 : 0)
                    }
                } catch(b) {
                    $.warning(b, "filterCurSegmentTip")
                }
            }
        }
    }),
    online.create("service.NewResult.Matrix", {
        options: {
            filterService: null,
            panel: "#flightsMatrix",
            toggleBtn: "#toggleMatrix",
            index: 0,
            tmpl: "",
            url: "AjaxRequest/AsyncResult/GetFlightDay.ashx"
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this.toggleBtn = $(this.toggleBtn),
                this.panel = $(this.panel),
                this.toggleBtn.length < 1 || this.panel.length < 1 || null !== this.filterService && (this.cond = this.filterService.resultService.cond, this.key = this.filterService.key, this.keys = this.filterService.keys, this.filterService.matrix = this, this.bindEvent())
            },
            bindEvent: function() {
                var a = this;
                this.panel.onn("click", "flight-mx-next",
                function(b) {
                    a.scrollPos(b, $(this))
                }).onn("click", "flight-mx-prev",
                function(b) {
                    a.scrollPos(b, $(this))
                }).onn("click", "flight-mx-close",
                function(b) {
                    b.stop(),
                    a.closePanel()
                }),
                this.toggleBtn.bind("click",
                function(b) {
                    b.stop(),
                    "" === a.panel.html() ? (a.makeLowKB(), a.toggleBtn.find(".hide-on-tablet:first").html("\u6536\u8d77")) : a.closePanel(),
                    a.filterService.reportUBT("MatrixTimes")
                });
                var b;
                $(window).bind("resize",
                function() {
                    b && clearTimeout(b),
                    b = setTimeout(function() {
                        0 !== a.index && "" !== a.panel.html() && a.panel.find(".mx-data-wrapper").animate({
                            left: -a.index * (document.documentElement.clientWidth < 1180 ? 109 : 119)
                        })
                    },
                    250)
                }).trigger("resize")
            },
            closePanel: function() {
                var a = this;
                a.panel.find(".flight-mx-close").animate({
                    opacity: 0
                },
                25,
                function() {
                    a.panel.slideUp(function() {
                        a.panel.html(""),
                        a.index = 0,
                        a.toggleBtn.find(".hide-on-tablet:first").html("\u5c55\u5f00")
                    })
                })
            },
            scrollPos: function(a, b) {
                if (a.stop(), !(b.hasClass("flight-mx-noscroll") || b.hasClass("flight-mx-prev-disabled") || b.hasClass("flight-mx-next-disabled"))) {
                    var c = -1 !== b[0].className.indexOf("next"),
                    d = this.panel.find(".mx-data-wrapper ul").length - 6;
                    if (! (c && this.index >= d || !c && this.index < 1)) {
                        this.index += c ? 6 : -6;
                        var e = this.panel.find(".flight-mx-next"),
                        f = this.panel.find(".flight-mx-prev");
                        c ? (this.index > d && (this.index = d), f.hasClass("flight-mx-prev-disabled") && f.removeClass("flight-mx-prev-disabled")) : (this.index < 0 && (this.index = 0), e.hasClass("flight-mx-next-disabled") && e.removeClass("flight-mx-next-disabled")),
                        this.panel.find(".mx-data-wrapper").animate({
                            left: -this.index * (document.documentElement.clientWidth < 1180 ? 109 : 119)
                        }),
                        c ? this.index === d && e.addClass("flight-mx-next-disabled") : 0 === this.index && f.addClass("flight-mx-prev-disabled")
                    }
                }
            },
            makeLowKB: function() {
                var a, b = this.keys[this.key.OwnerAirline],
                c = {
                    ALL: {}
                },
                d = this.filterService.resultService.curType;
                for (var e in b.keys) a = e.split("_"),
                "undefined" == typeof c[a[0]] && (c[a[0]] = {}),
                c[a[0]][a[1]] = b.value[b.keys[e]],
                ("undefined" == typeof c.ALL[a[1]] || c.ALL[a[1]][d] > c[a[0]][a[1]][d]) && (c.ALL[a[1]] = b.value[b.keys[e]]);
                var f = [],
                g = [];
                for (var h in c) c[h].name = h,
                "ALL" !== h && (f.push(c[h]), g.push(h + "$" + (c[h][0] ? 0 : 1)));
                if (g.length < 1) return void this.drawLowKB(c, f);
                var i = {
                    Airline: g.join("-"),
                    FlightWay: this.cond.FlightWay,
                    DCityCode: this.cond.SegmentList[0].DCityCode,
                    ACityCode: this.cond.SegmentList[0].ACityCode,
                    GoDate: this.cond.SegmentList[0].DepartDate
                };
                this.cond.SegmentList.length > 1 && (i.BackDate = this.cond.SegmentList[1].DepartDate);
                var j = this;
                $.ajax(online.getBaseUrl(this.url), {
                    method: "POST",
                    context: i,
                    onsuccess: function(a, b) {
                        b = $.parseJSON(b);
                        var d = [];
                        b && b.each(function(a, b) {
                            return "undefined" == typeof c.ALL[0] && (c.ALL[0] = {}),
                            "undefined" == typeof c[a.AirlineCode] ? void d.push({
                                0 : {
                                    OwnerAirline: a.AirlineCode,
                                    OwnerAirlineName: a.AirlineName,
                                    FlightDayMemo: a.FlightDayMemo
                                },
                                name: a.AirlineCode
                            }) : void("undefined" == typeof c[a.AirlineCode][0] && (c[a.AirlineCode][0] = {
                                OwnerAirline: a.AirlineCode,
                                OwnerAirlineName: a.AirlineName,
                                FlightDayMemo: a.FlightDayMemo
                            }))
                        }),
                        j.drawLowKB(c, f, d)
                    },
                    onerror: function() {
                        j.drawLowKB(c, f)
                    }
                })
            },
            drawLowKB: function(a, b, c) {
                c = c || [];
                var d = this.filterService.resultService.curType;
                b.sort(function(a, b) {
                    for (var c = 0; 3 > c; c++) {
                        if ("undefined" != typeof a[c]) {
                            if (a[c].FlightDayMemo) {
                                if (b[c] && !b[c].FlightDayMemo) return 1;
                                if (2 > c) continue;
                                return 1
                            }
                            if ("undefined" == typeof b[c]) return - 1;
                            var e = void 0 === a[c][d] ? 9999999 : a[c][d],
                            f = void 0 === b[c][d] ? 9999999 : b[c][d];
                            return e - f
                        }
                        if ("undefined" != typeof b[c]) {
                            if (b[c].FlightDayMemo) {
                                if (2 > c) continue;
                                return - 1
                            }
                            return 1
                        }
                    }
                    return 0
                });
                for (var e = [0, 0, 0], f = b.length; f--;) for (var g = 3; g--;) if (b[f][g] && "undefined" != typeof b[f][g].Price) {
                    b[f].hasValue = !0,
                    e[g]++;
                    break
                }
                for (var g = 3; g--;) a.ALL[g] && (a.ALL[g].hasValue = e[g] > 0);
                for (b.unshift(a.ALL), b = b.concat(c); b.length < 7;) b.push({});
                this.panel.html($.tmpl.render(this.tmpl, {
                    matrix: b,
                    curType: d
                })),
                this.index = 0,
                b.length > 7 ? (this.panel.find(".flight-mx-prev,.flight-mx-next").removeClass("flight-mx-noscroll"), this.panel.find("a.flight-mx-prev").addClass("flight-mx-prev-disabled")) : this.panel.find("a.flight-mx-prev,a.flight-mx-next").addClass("flight-mx-noscroll");
                var h = this.panel.find(".flights-mx-side li").length - 1,
                i = 36 * h + 44 + "px";
                this.panel.find("a.flight-mx-prev,.flight-mx-next").css("height", i),
                this.panel.css("height", i),
                this.panel.find(".mx-label:first li:first").css("height", "44px"),
                this.panel.find(".flights-mx-data:first").css("height", i);
                var j = this.panel.find(".flight-mx-close");
                this.panel.slideDown(function() {
                    j.animate({
                        opacity: 1
                    }),
                    j = null
                });
                var k = this,
                l = this.panel.find("li");
                l.bind("mouseover",
                function() {
                    if ($(this).hasClass("hasValue") !== !1) {
                        var a = $(this).attr("data-index");
                        a > 0 && l.filter("li[data-index=" + a + "]").addClass("mx-hover"),
                        null === $(this).attr("data-all") && $(this.parentNode).find("li").addClass("mx-hover")
                    }
                }),
                l.bind("mouseout",
                function() {
                    if ($(this).hasClass("hasValue") !== !1) {
                        var a = $(this).attr("data-index");
                        a > 0 && l.filter("li[data-index=" + $(this).attr("data-index") + "]").removeClass("mx-hover"),
                        null === $(this).attr("data-all") && $(this.parentNode).find("li").removeClass("mx-hover")
                    }
                }),
                l.filter(".hasValue").bind("click",
                function(a) {
                    a.stop();
                    var b = $(this).attr("data-index");
                    if (null !== b) {
                        k.filterService.clearAllFilter();
                        var c = $(this).attr("data-value");
                        0 == b ? (k.filterService.filterMain("OwnerAirlineName", !0, c), $("#OwnerAirlineName .filter-option[data-value=" + c + "] .checkbox-icon").addClass("checkbox-icon-checked")) : (k.filterService.filterMain("TransferCount", !0, b - 1 + ""), $("#TransferCount .filter-option[data-value=" + (b - 1) + "] .checkbox-icon").addClass("checkbox-icon-checked"), c && (k.filterService.filterMain("OwnerAirlineName", !0, c), $("#OwnerAirlineName .filter-option[data-value=" + c + "] .checkbox-icon").addClass("checkbox-icon-checked")))
                    }
                })
            }
        }
    });
    var Helper = function() {
        var a = Array.prototype,
        b = Object.prototype,
        c = b.hasOwnProperty,
        d = b.toString,
        e = a.reduce,
        f = Array.isArray;
        return {
            isArray: f ||
            function(a) {
                return "[object Array]" == d.call(a)
            },
            reduce: function(a, b, c) {
                var d = arguments.length > 2;
                if (null == a && (a = []), e && a.reduce === e) return d ? a.reduce(b, c) : a.reduce(b);
                if (a.each(function(a, e, f) {
                    d ? c = b.call(!0, c, a, e, f) : (c = a, d = !0)
                }), !d) throw new TypeError("Reduce of empty array with no initial value");
                return c
            },
            has: function(a, b) {
                return c.call(a, b)
            },
            matches: function(a) {
                return function(b) {
                    if (b === a) return ! 0;
                    for (var c in a) if (a[c] !== b[c]) return ! 1;
                    return ! 0
                }
            },
            where: function(a, b) {
                return a.filter(this.matches(b))
            }
        }
    } ();
    online.create("service.NewResult.AddtionService", {
        options: {
            addtionTmplVar: {
                hasLogin: pageGlobal.IsLogin,
                Cache3X: {},
                IsMustByAddtion: pageGlobal.IsMustByAddtion,
                addtionTmpl: '<div class="package-box">{{if f.AddtionShow===1}}<h3>{{if pageGlobal.Select3XTextSwitch === true}} \u5df2\u9009 {{else}} \u9009\u62e9\u5957\u9910\u4ea7\u54c1 {{/if}}\uff08\u53ef\u591a\u9009{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}}\uff0c\u81f3\u5c11\u9009\u4e00\u9879\u3002{{/if}}{{if !addtionTmplVar.hasLogin}}\u4f18\u60e0\u5238\u7c7b\u4ea7\u54c1\u9700\u53d1\u653e\u5230\u60a8\u7684\u643a\u7a0b\u8d26\u6237\uff0c\u5efa\u8bae\u6ce8\u518c\u767b\u5f55\u540e\u9884\u8ba2{{/if}}\uff09 </h3>{{else}}<h3>\u9009\u62e9\u8d8a\u591a\u9644\u52a0\u4ea7\u54c1\uff0c\u673a\u7968\u4ef7\u683c\u8d8a\u4f18\u60e0{{if !addtionTmplVar.hasLogin}}\uff08\u4f18\u60e0\u5238\u7c7b\u4ea7\u54c1\u9700\u53d1\u653e\u5230\u60a8\u7684\u643a\u7a0b\u8d26\u6237\uff0c\u5efa\u8bae\u6ce8\u518c\u767b\u5f55\u540e\u9884\u8ba2\uff09{{/if}}</h3>{{/if}}<div class="combo{{if f.AddtionShow===1}} combo_cz{{/if}}"><div class="combo_col1"><p class="base_price"><span{{if f.AddtionShow===2}} class="price J_AddtionPrice"{{/if}}><dfn>&yen;</dfn>${f[curType]}</span></p>{{if f.AddtionShow===1}}<i class="combo_icon1"></i>{{/if}}</div><div class="combo_col2"><i class="combo_plus">{{if f.AddtionShow===2}}+{{/if}}</i></div><div class="combo_col3"><ul class="clearfix">{{if f.AddtionList && f.AddtionList.length>0}}{{each(idx,item,len) f.AddtionList}}<li data-ubt-key="addtion_${item.ProductShortName}" data-id="${item.ID}" data-fid="${f.FID}" data-aid="${f.aid}" class="J_addtion_item{{if item.isSelected}} ${f.cssTag.activeItem}{{/if}}{{if flightWay=="D"}} ${f.cssTag.flightWay_D}{{/if}}"><div class="combo_price2"><i class="combo_chk"></i><span class="base_price"><dfn>&yen;</dfn>${item.SalesPrice}</span></div><div class="combo_class"><i class="${item.iconClassName}"></i><h4 class="combo_class_tit" data-role="jmp" data-params="{options:{showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},{{if idx===2}}position:\'bottomRight-topRight\',{{/if}}css:{maxWidth:500,minWidth:20},template:\'#jmp_text\',content:{\'txt1\':\'${online.fixSpecChar(item.Rule)}\'}}}">${item.ProductName}{{if item.ProductCategory=="0" && flightWay!=="S"}}<span>({{if flightWay==="D"}}\u5f80\u8fd4{{else flightWay==="M"}}\u5168\u7a0b{{/if}})</span>{{/if}}<i class="combo_dec"></i></h4><p>${item.Description}</p></div></li>{{/each}}{{/if}}</ul></div>{{if f.AddtionShow===2}}<div class="combo_col4"><i class="combo_equal">=</i></div><div class="combo_col5"><p>\u7ec4\u5408\u4ef7</p><div class="base_price"><span{{if f.AddtionShow===2}} class="price J_AddtionPrice"{{/if}}><dfn>&yen;</dfn>{{if f.AddtionShow===2}}${f[\'NewMult\'+curType]}{{else}}${f[curType]}{{/if}}</span></div><div class="package_tooltip" id="J_abandonAdd_${f.aid}" style="display:none;width:152px;{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}}top:-6px;{{/if}}">{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}}\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u9879\u5e76\u8fdb\u884c\u9884\u8ba2{{else}}\u60a8\u5df2\u653e\u5f03\u9009\u62e9\u9644\u52a0\u4ea7\u54c1\uff0c\u5c06\u4e0d\u518d\u4eab\u53d7\u673a\u7968\u964d\u4ef7\u4f18\u60e0{{/if}}<i class="ico_arrow"></i><a href="javascript:;" class="close J_abandonClose">\xd7</a></div></div>{{/if}}<div class="combo_col6"></div></div></div>'
            },
            flightCountID: 4096,
            countID: 1,
            addtionIDPrefix: "aid_",
            containerId: "#flightList",
            status: {
                KEY: "status",
                OPEN: "OPEN",
                CLOSE: "CLOSE"
            },
            flightWay: "",
            cssTag: {
                activeItem: "curr",
                activeArrow: "arrow-up",
                defaultArrow: "arrow-down",
                flightWay_D: "flightWay_D"
            },
            addtionFareListObj: {},
            FareItemIDPrefix: "FID_",
            slide_speed: 300,
            transIconTable: {
                13 : "combo_icon2",
                _INSURANCE_: "combo_icon3",
                14 : "combo_icon4",
                15 : "combo_icon5",
                16 : "combo_icon6",
                17 : "combo_icon10",
                18 : "combo_icon11",
                19 : "combo_icon12",
                265 : "combo_icon13",
                264 : "combo_icon14"
            },
            packagePriceTmpl: '{{if f.addtionSelectedNum>0}}<i class="plus">+</i><div class="package-info{{if f.addtionSelectedNum>1}} package-info-mid{{/if}}"><span class="price"><dfn>&yen;</dfn>${f.totalAddtionPrice}</span>${f.selectedName}</div>{{else}}<div class="package-info package-info-mid">${f.selectedName}</div>{{/if}}<i class="icon-caret-b{{if f.AddShowDetail}}up{{/if}} J_select_addtion" data-category="${f.PlanCategory}" data-rel="${f.FID}" data-ubt-key="ChooseX"></i>',
            lang: {
                UNSELECTED: "\u53ef\u9009\u4f18\u60e0\u5238",
                GROUP: "\u5957\u9910"
            },
            newUbtHandleConfig: {
                flt_oversea_search_result_online: function(a) {
                    var b = a.$target,
                    c = b.parentNode().find(".J_addtion_item").indexOf(b) + 1,
                    d = b.hasClass(a.activeItem),
                    e = pageGlobal.NewUbt.special;
                    e.XproductChoose["X" + c] += +d,
                    e.XproductCancel["X" + c] += +!d
                },
                unfold: function(a) {
                    online.setNewUbtSpecial(a.AddShowDetail ? "Xproductdown": "Xproductup")
                }
            }
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a);
                try {
                    this.TCXPrice = function(a) {
                        return a = 1 * a,
                        a = isNaN(a) ? 1 : a > 0 ? a: 0 === a ? 1 : -a,
                        1 > a ? a: a / 100
                    } (pageGlobal.TCXComparePrice)
                } catch(b) {
                    this.TCXPrice = .01
                }
                $.extend(this.addtionTmplVar, {
                    orderBtnTmpl: this.orderBtnTmpl
                }),
                this.curType = this.resultService.curType,
                this._init_()
            },
            _handleFareList_: function(a) {
                for (var b, c = this,
                d = 0,
                e = a.length; e > d; d++) if (b = a[d], c.addToFlag(b)) {
                    if (b.FID = c.FareItemIDPrefix + (++c.flightCountID).toString(16), b.IsNew3X) {
                        var f = "";
                        b.AddtionList && b.AddtionList.length > 0 && ["ID" + b.AddtionList[0].ID, "TYPE" + b.AddtionList[0].ProductType, "ID" + b.AddtionList[0].ID + "_TYPE" + b.AddtionList[0].ProductType].each(function(a) {
                            return window.pageGlobal.New3XTipTpl[a] ? (f = a, !1) : void 0
                        }),
                        f && (b.New3XInfo = window.pageGlobal.New3XTipTpl[f], b.New3XInfoJson = escape($.stringifyJSON(b.New3XInfo)), b.New3XDetailHTML = $.tmpl.render("<div>${content}</div>", {
                            content: $.tmpl.render(b.New3XInfo.DescTpl || "", {
                                data3X: b.AddtionList[0] || {}
                            })
                        })),
                        b.New3XInfo || (b.AddtionList = [], b.IsNew3X = !1)
                    }
                    b.aid = c.addtionIDPrefix + ++c.countID,
                    c.addtionFareListObj[b.FID] = b,
                    c.checkSameGroup(b),
                    c._handleAddtionInFareItemData_(b),
                    b.cssTag = c.cssTag,
                    c.addAidType(b)
                }
                return a
            },
            _transAddtionListIcon_: function(a) {
                var b = this;
                a.each(function(a) {
                    1 * a.ProductCategory === 0 ? a.iconClassName = b.transIconTable._INSURANCE_: a.iconClassName = b.transIconTable[a.ProductType]
                })
            },
            _getAddtionIdList_: function(a) {
                return Helper.reduce(this.addtionFareListObj[a].AddtionList,
                function(a, b) {
                    return b.isSelected && a.push(b.ID),
                    a
                },
                [])
            },
            _handleAddtionInFareItemData_: function(a) {
                var b = [],
                c = a.aid,
                d = this.addtionTmplVar.Cache3X;
                switch (abandonAdd = $("#J_abandonAdd_" + c), a.AddtionList && Helper.isArray(a.AddtionList) ? a.AddtionList.each(function(c) {
                    var d = "S" === condition.FlightWay || "D" === condition.FlightWay,
                    e = 2 === c.BindingType,
                    f = !1,
                    g = pageGlobal.ThreeChooseXUserPreferenceConfig;
                    d && (f = !0);
                    var h = !1;
                    if (pageGlobal.ThreeChooseXUserPreference && pageGlobal.ThreeChooseXUserPreference.length) for (var i = 0; i < pageGlobal.ThreeChooseXUserPreference.length; i++) {
                        var j = pageGlobal.ThreeChooseXUserPreference[i];
                        2 === j.ProductCode && "0" == j.DefaultSelect && "16" === c.ProductType && (h = !0)
                    }
                    var k = !pageGlobal.IsMustByAddtion && e && d && f && h && g;
                    k = k && !a.IgnoreCancelSelectX,
                    void 0 === c.isSelected && (c.isSelected = c.IsDefault),
                    c.isSelected && b.push(c),
                    c.Description && (c.Description = c.Description.replace(/\uffe5/g, "<dfn>&yen;</dfn>"))
                }) : $.log("handleAddtionList::fareItem error ,expect FareListItem.AddtionList is an Array"), a.addtionSelectedNum = b.length, a.addtionSelectedList = b, b.length) {
                case 0:
                    if (a.totalAddtionPrice = 0, a.selectedName = this.lang.UNSELECTED, 2 === a.AddtionShow && (a.prefer = 0, a["Orig" + this.curType] ? a["NewMult" + this.curType] = a[this.curType] = a["Orig" + this.curType] : a["NewMult" + this.curType] = a[this.curType], abandonAdd.length > 0)) {
                        var e = abandonAdd.data("AbTimer");
                        abandonAdd.fadeIn(),
                        clearTimeout(e),
                        e = setTimeout(function() {
                            abandonAdd.fadeOut()
                        },
                        5e3),
                        abandonAdd.data("AbTimer", e)
                    }
                    break;
                case 1:
                    b[0].SalesPrice = b[0].Quantity * b[0].UnitPrice,
                    a.totalAddtionPrice = b[0].SalesPrice,
                    a.selectedName = b[0].Description ? b[0].ProductShortName + '<span class="summary-tip">' + b[0].Description + "</span>": b[0].ProductShortName;
                    break;
                default:
                    a.totalAddtionPrice = Helper.reduce(b,
                    function(a, b, c) {
                        return b.SalesPrice = b.Quantity * b.UnitPrice,
                        a += b.SalesPrice
                    },
                    0),
                    a.selectedName = this.lang.GROUP
                }
                return b.length > 0 && 2 === a.AddtionShow && (abandonAdd.hide(), a.Cache3X && "undefined" != typeof d.prefer ? a.prefer = d.prefer: (a.prefer = 0, b.each(function(b, c) {
                    a.prefer += b.Quantity * (b.UnitPrice - b.AnticipatedIncome[c])
                })), "undefined" == typeof a["Orig" + this.curType] && (a["Orig" + this.curType] = a[this.curType]), a[this.curType] = a["Orig" + this.curType] - a.prefer, a["NewMult" + this.curType] = a[this.curType] + a.totalAddtionPrice),
                a
            },
            _init_: function() {
                this._bindEvent_()
            },
            _handler_: function(a, b) {
                var c = this.status,
                d = b[c.KEY],
                e = this,
                f = this.cssTag;
                switch (d) {
                case c.OPEN:
                    a.find(".J_arrow").removeClass(f.activeArrow).addClass(f.defaultArrow),
                    e._hide_(a),
                    a.attr(c.KEY, c.CLOSE),
                    b[c.KEY] = c.CLOSE;
                    break;
                case c.CLOSE:
                    a.find(".J_arrow").addClass(f.activeArrow).removeClass(f.defaultArrow),
                    e._show_(a),
                    a.attr(c.KEY, c.OPEN),
                    b[c.KEY] = c.OPEN;
                    break;
                default:
                    $.error("addtionService->_handler_:currentStatus \u53d6\u503c\u9519\u8bef")
                }
            },
            _bindEvent_: function() {
                var a = this,
                b = a.resultService;
                this.$container = $(this.containerId),
                this.$container.onn("click", "J_select_addtion",
                function(b) {
                    var c = $(this),
                    d = c.attr("data-rel"),
                    e = a.addtionFareListObj[d];
                    a.detToggle(c, e)
                }),
                this.$container.onn("click", "J_addtion_item",
                function(c, d, e) {
                    var f = a.cssTag.activeItem,
                    g = $(this),
                    h = g.attr("data-fid"),
                    i = $("#" + h),
                    j = i.find('button[data-fid="' + h + '"]'),
                    k = function(a) {
                        switch (a) {
                        case 0:
                            j.addClass("btn-disabled J_disabled");
                            break;
                        case 1:
                            j.addClass("btn-disabled");
                            break;
                        case 2:
                        default:
                            j.removeClass("btn-disabled J_disabled")
                        }
                    };
                    g[g.hasClass(f) ? "removeClass": "addClass"](f);
                    var l = a._updateData_(h, g.attr("data-id"));
                    b.updateAllPriInfo(),
                    a._renderPackagePrice_(g, l),
                    k(l.addtionSelectedNum < 1 ? 1 === pageGlobal.IsMustByAddtion ? 0 : l.BindingType: 2),
                    a.newUbtHandleConfig.flt_oversea_search_result_online({
                        $target: g,
                        activeItem: f
                    })
                }),
                this.$container.onn("click", "J_abandonClose",
                function(a) {
                    a.stop();
                    var b = $(this.parentNode);
                    b.fadeOut()
                })
            },
            _updateData_: function(a, b) {
                var c, d = this.addtionFareListObj[a],
                e = Helper.where(d.AddtionList, {
                    ID: +b
                });
                return e.length > 0 ? (c = e[0], c.isSelected = !c.isSelected) : $.error("addtionService->_updateData_ error"),
                this._handleAddtionInFareItemData_(d)
            },
            _renderPackagePrice_: function(a, b) {
                var c = a.attr("data-fid"),
                d = a.attr("data-aid"),
                e = $("#" + c),
                f = $("#" + d),
                g = e.find(".J_package_price"),
                h = e.find(".J_AddtionPrice"),
                i = f.find(".combo_col1 .J_AddtionPrice"),
                j = f.find(".combo_col5 .J_AddtionPrice");
                g.html($.tmpl.render(this.packagePriceTmpl, {
                    f: b
                })),
                this.dynamicPri(h, i, j, b)
            },
            _show_: function(a) {
                var b = $("#" + a.attr("data-rel-aid"));
                b.slideDown(this.slide_speed)
            },
            _hide_: function(a) {
                var b = $("#" + a.attr("data-rel-aid"));
                b.slideUp(this.slide_speed)
            },
            resetAllSelect: function() {
                var a, b;
                for (a in this.addtionFareListObj) b = this.addtionFareListObj[a],
                b.AddtionList && b.AddtionList.each(function(a) {
                    a.isSelected = void 0
                }),
                this._handleAddtionInFareItemData_(b)
            },
            updateFlightListData: function(a) {
                var b = this,
                c = this.resultService;
                a.each(function(a) {
                    b._handleFareList_(a.FareList);
                    var d = c.findLowPrice(a.FareList);
                    c.updatePriceInfo(a, d)
                })
            },
            handleMoreFlight: function(a) {
                this._handleFareList_(a)
            },
            getSaveData: function(a) {
                var b = a && this.addtionFareListObj[a];
                if (b) {
                    var c = this.addtionTmplVar,
                    d = {};
                    return b.Cache3X ? (d.addtionIdList = c.Cache3X.addtionIdList, d.fullAddtionList = c.Cache3X.fullAddtionList, d.addtionList = c.Cache3X.AddtionList) : (d.addtionIdList = this.getCurIdList(a, !0), d.fullAddtionList = this.getFullAddtionList(a), d.addtionList = b.AddtionList),
                    d
                }
            },
            saveData: function(a) {
                var b = a && this.addtionFareListObj[a];
                if (b) {
                    var c = this.addtionTmplVar.Cache3X;
                    if (!b.Cache3X) {
                        switch (b.AddtionShow) {
                        case 1:
                        case 2:
                            c.totalAddtionPrice = b.totalAddtionPrice || 0,
                            c.selectedName = b.selectedName || "",
                            c.addtionIdList = this.getCurIdList(a, !0),
                            c.fullAddtionList = this.getFullAddtionList(a),
                            c.AddtionList = b.AddtionList,
                            c.AddtionShow = b.AddtionShow
                        }
                        2 === b.AddtionShow && (c.prefer = b.prefer || 0)
                    }
                }
            },
            getAddtionList: function(a) {
                var b = this.addtionFareListObj[a];
                return b ? b.AddtionList || [] : []
            },
            clearSaveData: function(a) {
                var b = this.resultService;
                a && b && b.curSegment > 0 || (this.addtionTmplVar.Cache3X = {})
            },
            compareRule: function(a) {
                var b = this;
                this.curType = this.resultService.curType,
                pageGlobal.NewUbt.Showwifi = pageGlobal.NewUbt.Showwifi || 0,
                a.each(function(a) {
                    for (var c, d = 0,
                    e = 0,
                    f = a.FareList.length; f > e; e++) {
                        var g = a.FareList[e];
                        if (g.Force && d++, g.superpose && (delete g.superpose, delete g.AddtionShow), g.isReduce && (delete g.isReduce, delete g.AddtionShow), g.isWiFiCopy && pageGlobal.WifiPackageSwitch) a.FareList.splice(e, 1),
                        e--,
                        f--,
                        pageGlobal.NewUbt.Showwifi--;
                        else {
                            if ("array" === $.type(g.AddtionList) && g.AddtionList.length > 0) if (b.TCXReformSwitch)(1 === g.PlanCategory || 2 === g.PlanCategory || 7 === g.PlanCategory) && (g.isReduce = 1);
                            else {
                                var h = b.getCurIdList(g.AddtionList,
                                function(a) {
                                    return a.IsDefault ? a: void 0
                                });
                                if (h.length > 0) {
                                    var i = h[0];
                                    i.AnticipatedIncome[0] < i.UnitPrice ? g.isReduce = 1 : g.superpose = 1
                                } else g.superpose = 1
                            }
                            g.WifiPackage && pageGlobal.WifiPackageSwitch && (c = $.copy(g))
                        }
                    }
                    if (c && pageGlobal.WifiPackageSwitch) {
                        var j = b.resultService.cond;
                        subs = a.FareList.length,
                        delete c.PlanCategory,
                        delete c.AddtionList,
                        c.isWiFiCopy = 1,
                        c.WifiPackage.DayGap = (online.showTime(j.SegmentList[1].DepartDate, "yyyy-MM-dd").toDate() - online.showTime(j.SegmentList[0].DepartDate, "yyyy-MM-dd").toDate()) / 864e5 + 1,
                        c.WifiPackage.TotalSalePrice = c.WifiPackage.SalePrice * c.WifiPackage.DayGap,
                        c[b.curType] += c.WifiPackage.TotalSalePrice,
                        c.WifiPackage.Tips = online.replaceWith(c.WifiPackage.Tips, {
                            totalsaleprice: c.WifiPackage.PrintPrice,
                            daygap: c.WifiPackage.DayGap
                        }),
                        c.Tips.each(function(a, b) { ("\u65c5\u884c\u5957\u9910" === a.Text || "BUSS" === a.Type) && c.Tips.splice(b, 1)
                        }),
                        a.FareList.splice(subs, 0, c),
                        pageGlobal.NewUbt.Showwifi++
                    }
                }),
                this.updateFlightListData(a)
            },
            packing: function(a, b) {
                var c, d, e = this;
                if (! (a.length < 1)) {
                    if (1 === a.length) e.IsCreatePreferred ? c = $.copy(a[0]) : a[0].isReduce = 1;
                    else {
                        var f, g;
                        b[2] ? (f = b[2], g = b[1] || b[7]) : b[1][e.curType] > b[7][e.curType] ? (f = b[1], g = b[7]) : (f = b[7], g = b[1]),
                        d = (f[e.curType] - g[e.curType]) / g[e.curType],
                        e.IsCreatePreferred ? c = $.copy(d <= e.TCXPrice ? f: g) : d <= e.TCXPrice ? f.isReduce = 1 : g.isReduce = 1
                    }
                    return c
                }
            },
            filterCateg: function(a) {
                var b = [];
                return a.each(function(a) { (1 === a.PlanCategory || 2 === a.PlanCategory || 7 === a.PlanCategory) && b.push(a)
                }),
                b
            },
            getLowest: function(a, b) {
                var c = 9999999999,
                d = -1;
                return a.each(function(a, e) {
                    c > a[b] && (c = a[b], d = e)
                }),
                a[d]
            },
            detToggle: function(a, b) {
                var c = this,
                d = b.aid,
                e = b.FID,
                f = $("#" + e),
                g = (f.find(".seat-price"), f.find(".seat-bonus"), $("#" + d)),
                h = this.getCurIdList(e),
                i = b.AddShowDetail === !0;
                if (!a.data("loading")) if (i ? a.removeClass("icon-caret-bup").addClass("icon-caret-b") : a.removeClass("icon-caret-b").addClass("icon-caret-bup"), i = !i, g.html().length < 1) {
                    if (h.length < 1) return;
                    a.data("loading", 1),
                    $.ajax(online.getBaseUrl("AjaxRequest/AsyncResult/GetAddtionDetail.ashx"), {
                        method: "POST",
                        context: {
                            Data: h,
                            Uid: pageGlobal.Ubt.UID
                        },
                        onsuccess: function(d, e) {
                            return a.removeData("loading"),
                            e = $.parseJSON(e),
                            e && "array" === $.type(e.AddtionList) && e.AddtionList.length > 0 ? (e.AddtionList = c.updateData(b.AddtionList, e.AddtionList), b.AddtionList = $.extend(b.AddtionList, e.AddtionList), c._transAddtionListIcon_(b.AddtionList), void c.renderDetAddtion(a, g, b)) : (a.html("\u9009\u62e9"), a.removeClass("icon-caret-bup").addClass("icon-caret-b"), b.AddShowDetail = !1, void online.log("3+X\u6570\u636e\u4e3a\u7a7a"))
                        },
                        onerror: function() {
                            a.removeData("loading"),
                            a.html("\u9009\u62e9"),
                            a.removeClass("icon-caret-bup").addClass("icon-caret-b"),
                            b.AddShowDetail = !1,
                            online.log("3+X\u8bf7\u6c42\u51fa\u9519")
                        }
                    })
                } else g.slideToggle(function() {
                    b.AddShowDetail = "block" === $(this).css("display"),
                    c.newUbtHandleConfig.unfold(b)
                })
            },
            expandAddtion: function(a, b, c, d) {
                2 === d.AddtionShow && (d.AddShowDetail ? (b.css("visibility", "hidden"), c.css("visibility", "hidden")) : (b.removeAttr("style"), c.removeAttr("style")))
            },
            renderDetAddtion: function(a, b, c) {
                var d, e = this.addtionTmplVar,
                f = "builtUp" === this.resultService.flightType ? 1 : 0;
                d = $.tmpl.render(e.addtionTmpl, {
                    addtionTmplVar: e,
                    f: c,
                    flightWay: this.resultService.flightWay,
                    curType: this.resultService.curType,
                    lowPrice: this.resultService.lowPrice,
                    isLastSegment: this.resultService.isLastSegment,
                    isRoundTrip: f
                }),
                b.html(d).slideDown(),
                c.AddShowDetail = !0,
                this.newUbtHandleConfig.unfold(c)
            },
            dynamicPri: function(a, b, c, d) {
                var e, f, g = function(a) {
                    try {
                        a.css("position", "relative"),
                        a.animate({
                            left: "-3px"
                        },
                        80).animate({
                            left: "3px"
                        },
                        80).animate({
                            left: "-3px"
                        },
                        80).animate({
                            left: "3px"
                        },
                        80).animate({
                            left: "-3px"
                        },
                        80).animate({
                            left: "3px"
                        },
                        80).animate({
                            left: "-3px"
                        },
                        80).animate({
                            left: "3px"
                        },
                        80).animate({
                            left: "0"
                        },
                        30,
                        function() {
                            $(this).removeAttr("style")
                        })
                    } catch(b) {}
                };
                2 === d.AddtionShow && (e = "<dfn>&yen;</dfn>" + d[this.curType], f = "<dfn>&yen;</dfn>" + d["NewMult" + this.curType], a.html(e), b.html(e), c.html(f), [b, c].each(function(a) {
                    g(a)
                }))
            },
            getDeprePrice: function(a) {
                var b, c, d = 0;
                return b = this.getCurIdList(a.AddtionList,
                function(a) {
                    return a.IsDefault ? a: void 0
                }),
                b.each(function(a, b) {
                    d += a.Quantity * (a.UnitPrice - a.AnticipatedIncome[b])
                }),
                c = a[this.curType] - d
            },
            updateData: function(a, b) {
                return a.each(function(a, c) {
                    b[c].Quantity = a.Quantity,
                    b[c].IsDefault = a.IsDefault,
                    b[c].isSelected = a.isSelected,
                    b[c].BindingType = a.BindingType,
                    b[c].SalesPrice = b[c].Quantity * b[c].UnitPrice
                }),
                b
            },
            checkSameGroup: function(a) {
                var b = this.addtionTmplVar.Cache3X,
                c = !1,
                d = this.resultService;
                try {
                    if (d && d.curSegment > 0 && b.AddtionList && b.AddtionList.length > 0) {
                        for (var e = b.AddtionList,
                        f = a.AddtionList,
                        g = f.length; g--;) if (e[g]) {
                            var h = f[g];
                            if (h.ID !== e[g].ID || h.Quantity !== e[g].Quantity) {
                                c = !1;
                                break
                            }
                            c = !0
                        }
                        var i = "D" === this.resultService.flightWay && "freeStyle" === this.resultService.flightType && 1 === this.resultService.curSegment;
                        a.IgnoreCancelSelectX = i && c,
                        c && (a.Cache3X = 1, 1 === b.AddtionShow && 2 === a.AddtionShow && b.addtionIdList.each(function(b) {
                            a.AddtionList.each(function(a) {
                                a.ID === b && (a.IsDefault = !0)
                            })
                        }))
                    }
                } catch(j) {
                    online.log("\u68c0\u6d4b\u662f\u5426\u76f8\u540c\u76843+X\u51fa\u9519 " + j)
                }
            },
            checkAddtionList: function(a, b) {
                try {
                    var c = a.AddtionList,
                    d = b.AddtionList,
                    e = c.length,
                    f = d.length,
                    g = !1;
                    if (e !== f) return;
                    for (; e--;) {
                        var h = c[e];
                        if (h.ID !== d[e].ID || h.Quantity !== d[e].Quantity) {
                            g = !1;
                            break
                        }
                        g = !0
                    }
                    g && ($.extend(c, d), a.AddShowDetail = b.AddShowDetail)
                } catch(i) {
                    online.log("\u5206\u6279\u67e5\u8be2\u6bd4\u5bf93+X\u8282\u70b9\u903b\u8f91\u51fa\u9519 " + i)
                }
            },
            getCurIdList: function(a, b) {
                var c, d;
                if ("array" === $.type(a)) d = a;
                else {
                    if (c = a && this.addtionFareListObj[a], !c) return;
                    d = c.AddtionList
                }
                var e = [];
                return "array" === $.type(d) && d.length > 0 ? (d.each(function(a, c) {
                    if ("function" === $.type(b)) {
                        var d = b(a, c);
                        d && e.push(d)
                    } else "boolean" === $.type(b) && b ? a.isSelected && e.push(a.ID) : e.push(a.ID)
                }), e) : []
            },
            getFullAddtionList: function(a) {
                var b, c;
                if (b = a && this.addtionFareListObj[a], !b) return [];
                c = b.AddtionList;
                var d = [];
                return "array" === $.type(c) && c.length > 0 ? (c.each(function(a, b) {
                    d.push({
                        ProductType: +a.ProductType,
                        Quantity: a.Quantity,
                        Price: +a.SalesPrice,
                        UserSelect: a.isSelected,
                        ID: a.ID,
                        IsDefault: a.IsDefault,
                        ProductName: a.ProductName,
                        UnitPrice: a.UnitPrice
                    })
                }), d) : []
            },
            addToFlag: function(a) {
                if ("array" === $.type(a.AddtionList) && a.AddtionList.length > 0) {
                    if (a.isReduce) return a.AddtionShow = 2,
                    !0;
                    if (this.TCXReformSwitch) {
                        if (3 === a.PlanCategory || 4 === a.PlanCategory) return a.AddtionShow = 1,
                        !0
                    } else if (a.superpose) return a.AddtionShow = 1,
                    !0
                }
                return ! 1
            },
            addAidType: function(a) {
                a.AddtionShow && a.AddtionList.each(function(b) {
                    b.IsDefault && (a.BindingType = b.BindingType)
                })
            }
        }
    }),
    function(a, b, c, d) {
        "function" == typeof a[c] && d(b).bind("mousedown",
        function(b) {
            if (d(b.target).length && d(b.target)[0].getAttribute) {
                var e = d(b.target).attr("id");
                if ("c_ph_login" === e || "myctripButton" === e || "mkt_login_single" === e) {
                    try {
                        a[c](null, 1),
                        b.stop()
                    } catch(b) {}
                    return ! 1
                }
            }
        })
    } (window, document, "__SSO_booking", window.cQuery),
    online.handleLongPortName = function(a, b, c) {
        c = (c || "").toUpperCase();
        var d, e = 0,
        f = b,
        g = !1;
        e = "I" == c ? 11 : c.length + 1;
        for (var h = 0; h < b.length; ++h) {
            d = h;
            var i = b.charCodeAt(h);
            if (i > 255 ? e += 2 : e++, e > 28) {
                g = !0,
                d = h;
                break
            }
        }
        return g && (f = a ? "..." + f.slice(0, d) : f.slice(0, d) + "..."),
        f
    },
    online.getFlightTime = function(a, b) {
        try {
            var c = ["d", "h", "m"],
            d = [parseInt(a / 60 / 24), parseInt(a / 60 % 24), a % 60],
            e = [];
            return b && (c = ["\u5929", "\u5c0f\u65f6", "\u5206\u949f"]),
            d.each(function(a, b) {
                1 > a || e.push(a + c[b])
            }),
            e.join("")
        } catch(f) {
            return "\u672a\u77e5"
        }
    },
    online.checkIsRedEye = function(a, b, c) {
        return a = new Date(a.replace(/-/g, "/")),
        !c.ContainsVirtualFlight && (a.getHours() >= 22 || a.getHours() < 6)
    },
    online.fixSpecChar = function(a) {
        return (a || "").replace(/'/g, "\\'").replace(/"/g, "&quot;")
    },
    online.getOWIntelligenceRecPopHeaderWrapperOf = function(a, b) {
        var c = a.OWIntelligenceRecFlightInfo[b];
        if (!c) return {};
        var d = c.FlightDetail[0].DCityName,
        e = c.FlightDetail[0].DepartDateStr,
        f = c.FlightDetail[0].DepartTime,
        g = c.FlightDetail[c.FlightDetail.length - 1].ACityName,
        h = c.DurationStr;
        return {
            dCityName: d,
            dDate: e,
            dTime: f,
            aCityName: g,
            duration: h
        }
    },
    online.getOWIntelligenceRec2ndPopHeaderWrapper = function(a) {
        return online.getOWIntelligenceRecPopHeaderWrapperOf(a, 1)
    },
    online.getOWIntelligenceRec2ndPopHeader = function(a) {
        var b = online.getOWIntelligenceRec2ndPopHeaderWrapper(a),
        c = b.dCityName,
        d = b.dDate,
        e = b.aCityName,
        f = b.duration;
        return encodeURIComponent('<div class="title">\u7b2c\u4e8c\u7a0b\u6307\u5b9a\u822a\u73ed\uff1a' + d + "\u51fa\u53d1\uff0c" + c + " \u2014 " + e + '<span class="consume">\u98de\u884c\u603b\u65f6\u957f\uff1a' + f + "</span></div>")
    },
    online.getOWIntelligenceRec2ndPopBody = function(a) {
        for (var b = a.OWIntelligenceRecFlightInfo[1], c = (b.FlightDetail[0].DCityName, b.FlightDetail[0].DepartTimeStr, b.FlightDetail[b.FlightDetail.length - 1].ACityName, b.DurationStr, ""), d = 0; d < b.FlightDetail.length; d++) {
            var e = b.FlightDetail[d];
            if (c += '<div class="each-box">', c += '<div class="airline-box"><div class="airline"><img class="logo" src="https://pic.c-ctrip.com/flight_intl/airline_logo/32/' + e.AirlineCode + '.png"><span class="name">' + e.AirlineName + " " + e.FlightNo + "</span></div>", e.Carrier && (c += '<div class="shareline"><i class="arrow-share"></i><span class="name">\u5b9e\u9645\u627f\u8fd0 ' + e.Carrier + " " + e.CarrierFlightNo + "</span></div>"), c += "</div>", c += '<div class="trip-box"><div class="transfer"><i class="bg-dashed"></i><div class="time">' + e.DepartTimeStr + '</div><div class="airport">' + e.DPort + " " + e.DPortName + " " + (e.DTerminal || "") + "</div></div>", c.StopInfo) for (var f = 0; f < e.StopInfo.length; f++) {
                var g = e.StopInfo[f];
                c += '<div class="stopover"><div class="prompt" style="cursor:auto;">\u7ecf\u505c</div><div class="airport">' + g.City + " " + g.AirportName + "</div></div>"
            }
            if (d < b.FlightDetail.length - 1) {
                var h = b.FlightDetail[d].IsDifferentAirPort ? "\u4e0d\u540c\u822a\u7ad9\u697c\u4e2d\u8f6c": "",
                i = b.FlightDetail[d].CorssVisa ? "\u8fc7\u5883\u7b7e": "",
                j = b.LuggageDirectDict && b.LuggageDirectDict[e.ACityName] ? b.LuggageDirectDict[e.ACityName] : "",
                k = [];
                h && k.push(h),
                i && k.push(i),
                j && k.push(j),
                c += '<div class="transfer"><i class="bg-dashed"></i><div class="time">' + e.ArrivalTimeStr + '</div><div class="airport">' + e.APort + " " + e.APortName + " " + (e.ATerminal || "") + "</div></div>",
                c += '<div class="transfer-info"><div class="prompt" style="cursor:auto;">\u4e2d\u8f6c</div><div class="city">' + e.ACityName + '</div><div class="prompt" style="cursor:auto;">' + k.join(" | ") + '</div><div class="prompt" style="cursor:auto;"></div><div class="hint">\u505c\u7559 ' + e.TransferTime + "</div></div>"
            } else c += '<div class="arrive"><div class="time">' + e.ArrivalTimeStr + '</div><div class="airport">' + e.APort + " " + e.APortName + " " + (e.ATerminal || "") + "</div></div>";
            c += "</div></div>"
        }
        return encodeURIComponent(c)
    };
    var LastToken = [];
    online.ClassTmpl = ['<table class=title-left><tbody>{{each (i, c) data}}{{if c.SegmentNo === 1}}<tr><th>${c.CityName}</th><td class="last">${c.ClassName}</td></tr>{{/if}}{{/each}}</table>', '<table class=title-left><tbody>{{each (i, c) data}}<tr><th>${c.CityName}</th><td class="last">${c.ClassName}</td></tr>{{/each}}</table>'],
    online.SimpleClassTxt = function(a, b) {
        if (0 === b) for (var c = a.length; c--;) 1 != a[c].SegmentNo && a.splice(c, 1);
        for (var d = [], e = !1, c = 0; c < a.length; c++) {
            var f = a[c].ClassName;
            d.indexOf(f) < 0 && d.push(f),
            a[c].IsVirtualFlight && (e = !0)
        }
        if (2 === d.length) {
            var g = [];
            if (a[0] && a[1]) {
                if (e) {
                    for (var c = 0,
                    h = a.length; h > c; c++) {
                        var i = a[c],
                        j = i.ClassName || "";
                        i.IsVirtualFlight ? j = "\u706b\u8f66": "\u8d85\u7ea7\u7ecf\u6d4e\u8231" == j && (j = "\u8d85\u7ecf\u8231"),
                        g.indexOf(j) < 0 && g.push(j)
                    }
                    return g.join("+")
                }
                for (var c = 0,
                h = a.length; h > c; c++) {
                    var i = a[c],
                    j = i.ClassName.replace(/\u8231$/, "");
                    "\u8d85\u7ea7\u7ecf\u6d4e" == j && (j = "\u8d85\u7ecf"),
                    g.indexOf(j) < 0 && g.push(j)
                }
                return g.join("+") + "\u8231"
            }
        }
        return "\u591a\u79cd\u8231\u4f4d\u63d0\u9192"
    },
    online.getClassInfo = function(a, b) {
        if (! ("array" === $.type(a) && a.length > 0)) return "";
        "undefined" == typeof b && (b = 1);
        for (var c = "D" == resultService.flightWay && "builtUp" == resultService.flightType,
        d = resultService.curSegment,
        e = a.slice(), f = 0; f < e.length; f++) c || e[f].SegmentNo == d + 1 || (e.splice(f, 1), f--);
        for (var g = [], f = 0; f < e.length; f++) g.indexOf(e[f].ClassName) < 0 && g.push(e[f].ClassName);
        if (a = 1 == g.length && e.length > 1 ? [e[0]] : e, 0 === b || 1 == a.length) {
            for (var h = !1,
            i = "",
            f = 0; f < a.length; f++) {
                var j = a[f];
                j && (i = a[f].ClassName)
            }
            for (var f = 0,
            k = a.length; k > f; f++) if (1 === a[f].SegmentNo && a[f].ClassName !== i) {
                h = !0;
                break
            }
            if (h === !1) return i
        }
        return "<span class=\"abbr\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,css:{maxWidth:500},type:'jmp_table',classNames:{boxType:'jmp_table',tipContent:'tooltip-table'},template:'#jmp_title',content:{'txt2':'" + online.fixSpecChar($.tmpl.render(online.ClassTmpl[b], {
            data: a
        })) + "'}}}\">" + online.SimpleClassTxt(a, b) + "</span>"
    },
    online.generateGiftTagHtml = function(a) {
        if (!online.GIFT_TAG_CONFIGS || !a.GiftTagIdList || 0 == a.GiftTagIdList.length) return "";
        var b = ["TicketGift", "LoungePre"];
        if (a.Tips && a.Tips.length > 1) for (var c = 0; c < a.Tips.length; c++) if (b.indexOf(a.Tips[c].Type) >= 0) return "";
        var d = a.GiftTagIdList[0],
        e = online.GIFT_TAG_CONFIGS[d];
        if (!e) return "";
        var f = '	<span class="tag tag-hk" data-gift-tag="1" gift-tag-name="' + e.TagText + "\" data-role=\"jmp\" data-params=\"{			options:{				type: 'jmp_text',					css: {					maxWidth:'420'				},				showArrow: false,template:'#tip-tmpl-simple',					classNames:{					boxType:'tooltip-tmpl',tipContent:'tooltip'				},				content:{					'txt1':'" + e.GiftDesc + "&lt;br&gt;" + e.GiftDetail + "'				}			}		}\"><i>" + e.TagTitle + "</i>" + e.TagText + "</span>";
        return f
    },
    online.getPrimarySegmentClassName = function(a, b) {
        if (! ("array" === $.type(a) && a.length > 0)) return "";
        for (var c = a[0].ClassName, d = 1, e = a.length; e > d; d++) if (a[d].SegmentNo === b && a[d].PrimarySegment) {
            c = a[d].ClassName;
            break
        }
        return c
    },
    online.getClassNameIfDiffClass = function(a, b) {
        var c = window.condition && window.condition.ClassGrade || "Y_S";
        "undefined" == typeof b && (b = 1);
        var d = [],
        e = "D" == resultService.flightWay && "builtUp" == resultService.flightType,
        f = resultService.curSegment,
        g = "diff_seat";
        if (a.ClassInfo && a.ClassInfo.length) for (var h = 0; h < a.ClassInfo.length; h++) {
            var i = a.ClassInfo[h];
            i && (e || i.SegmentNo == f + 1) && i.ClassName && d.indexOf(i.ClassName) < 0 && d.push(i.ClassName)
        } else a.ClassName && a.ClassName && d.indexOf(a.ClassName) < 0 && d.push(a.ClassName);
        var j = c.split("_"),
        k = {
            "\u7ecf\u6d4e\u8231": "Y",
            "\u8d85\u7ea7\u7ecf\u6d4e\u8231": "S",
            "\u516c\u52a1\u8231": "C",
            "\u5934\u7b49\u8231": "F",
            "\u660e\u73e0\u7ecf\u6d4e\u8231": "S"
        };
        if (1 == d.length && "\u706b\u8f66" == d[0]) return g;
        if (d.length > 1) return g;
        for (var h = 0; h < d.length; h++) {
            var l = j.indexOf(k[d[h]]) >= 0;
            if (!l) return g
        }
        return ""
    },
    online.isUpgradeRecommendTagSwitchOpen = function() {
        return pageGlobal && pageGlobal.IsOpenUpgradeRecommendTag
    },
    online.getClassNameForUpgradeRecommendTag = function(a, b, c, d) {
        var e = online.getPrimarySegmentClassName(a, 1);
        if ("D" == b && (1 == d || "builtUp" == c)) {
            if ("\u516c\u52a1\u8231" == e) return e;
            var f = online.getPrimarySegmentClassName(a, 2);
            if ("\u516c\u52a1\u8231" == f || "\u5934\u7b49\u8231" == f) return f
        }
        return e
    },
    online.generateUpgradeClassRecommendTag = function(a, b, c, d, e, f) {
        if (online.isUpgradeRecommendTagSwitchOpen()) {
            var g = "";
            try {
                var h = window.condition && window.condition.ClassGrade;
                if (a.length <= 1 || "Y_S" != h && "Y" != h && "S" != h) return g;
                var i = a[b]; ! e && "D" == d && location.hash && (e = location.hash.substring(1));
                var j = i.ClassName || online.getClassNameForUpgradeRecommendTag(i.ClassInfo, d, e, f);
                if ("\u516c\u52a1\u8231" == j || "\u5934\u7b49\u8231" == j) {
                    for (var k = i[c], l = !0, m = !1, n = 0; n < a.length; n++) if (n != b) {
                        var o = a[n],
                        p = o.ClassName || online.getClassNameForUpgradeRecommendTag(o.ClassInfo, d, e, f),
                        q = p.indexOf("\u7ecf\u6d4e") >= 0;
                        if (q || p == j) {
                            var r = o[c];
                            if (k > r || k == r && p != j) {
                                l = !1;
                                break
                            }
                        }
                        q && (m = !0)
                    }
                    if (l && m) {
                        var s = "\u516c\u52a1\u8231" == j ? 2 : 3;
                        g = '<span class="tag tag-hk cur-dft" upgrade-tag="' + s + '"/> <i>\u60e0</i>' + j + "\u8d85\u4f4e\u4ef7</span>"
                    }
                }
            } catch(t) {}
            return g
        }
    },
    online.getRemark = function(a) {
        var b = this,
        c = b.elem,
        d = $(c).attr("data-remark");
        online.fltTrainUbt($(c)),
        !c.IsLoaded && d && $.ajax(online.getBaseUrl("AjaxRequest/trainservice.ashx?type=TransferRemark"), {
            method: "POST",
            context: {
                Data: decodeURIComponent(d)
            },
            onsuccess: function(d, e) {
                if (e && !c.IsLoaded) {
                    var f = $.parseJSON(e) || {};
                    b.data.txt1 = f.Context || "\u83b7\u53d6\u6362\u4e58\u63d0\u793a\u4fe1\u606f\u5931\u8d25,\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5",
                    $(a).find(".tooltip-content").html(b.data.txt1),
                    c.IsLoaded = !0;
                    try {
                        b._calcPos()
                    } catch(g) {}
                }
            }
        })
    },
    online.fltTrainUbt = function(a) {
        if (a && a.length > 0) {
            var b = $(online.getParentsByClass(a[0], "M" === this.flightWay ? "multidest-recommend-flights": "flight-item"));
            if (b && b.length > 0 && "1" === b.attr("data-train")) {
                var c = a.html(),
                d = "\u9884\u8ba2" === c ? "isbookingfltandtrain": "\u6362\u4e58" === c ? "fltandtrainchange": "flghtclassdetail";
                online.setNewUbtSpecial(d)
            }
        }
    };
    var skl = {
        Baggage: pageGlobal.DisplayBaggageSizeSwitch ? "\u884c\u674e\u89c4\u5b9a": "\u884c\u674e\u989d",
        ChildBaggage: (window.condition || window.pageGlobal).ChildQuantity ? "\u513f\u7ae5\u884c\u674e\u989d": "\u5a74\u513f\u884c\u674e\u989d",
        SharedFlight: "\u5171\u4eab\u822a\u73ed",
        TicketLimit: "\u8d2d\u7968\u9650\u5236",
        Note: "\u5907\u6ce8",
        AdjustDay: "\u505c\u7559\u5929\u6570",
        NoShow: "\u8bef\u673a\u8d39\uff08No Show\uff09"
    };
    online.getEndorseText = function(a, b, c, d) {
        var e = $.parseJSON(a);
        if (null === e) return a;
        var f = "";
        if (e.RebookNew) {
            $(b).css("width", "560px");
            var g = d.attr("data-dec"),
            h = [];
            if (g) {
                g = $.parseJSON(decodeURIComponent(g)) || {};
                var i, j, k = [];
                for (var l in g) if (i = skl[l], j = g[l], i && j) if ("string" == typeof j) k.push([i, online.fixSpecChar(j)]);
                else if ("Baggage" === l && g.NewBaggage && g.NewBaggage.length) h.push({
                    Type: "NewBaggage",
                    Title: i,
                    Data: g.NewBaggage,
                    HasBaggageService: g.HasBaggageService
                });
                else if (1 != j.length || j[0].Text) {
                    for (var m = [], n = 0, o = j.length; o > n; n++) m.push([j[n].Text, online.fixSpecChar(j[n].Content)]);
                    h.push({
                        Title: i,
                        Data: m
                    })
                } else h.push({
                    Title: i,
                    Text: online.fixSpecChar(j[0].Content)
                });
                k.length > 0 && h.push({
                    Title: "\u8d2d\u7968\u987b\u77e5",
                    Data: k
                })
            }
            if (h.length > 0) for (var n = 0,
            o = e.RebookNew.length; o > n; n++)"HCP" !== e.RebookNew[n].Type && e.RebookNew[n].Data && e.RebookNew[n].Data.push.apply(e.RebookNew[n].Data, h);
            f = BuildTGQ(e.RebookNew, e.SearchResultPage24RefundRemark)
        } else $(b).css("width", "400px"),
        f = $.tmpl.render('{{if TrainAndFlight}}${TrainAndFlight}{{else}}<h4>\u9000\u6539\u7b7e\u8bf4\u660e</h4><div class="tooltip-table"><table class="title-left"><tbody>{{each (k, v) Rebook}}<tr><th>${online.fixSpecChar(v.Text)}</th><td class="last">${online.fixSpecChar(v.Content)}</td></tr>{{/each}}</tbody></table></div>{{if NoShow}}<h4>\u8bef\u673a\u8d39\uff08No Show\uff09</h4><p>${NoShow}</p>{{/if}}{{/if}}', e),
        e.TrainAndFlight ? f = f.replace("<!---->", c) : f += c;
        return $(b).find(".undef").html(f),
        f
    },
    online.stringFormat = function(a, b) {
        return a && b ? 1 == arguments.length ?
        function() {
            var b = $.makeArray(arguments);
            return b.unshift(a),
            $.format.apply(this, b)
        }: (arguments.length > 2 && b.constructor != Array && (b = $.makeArray(arguments).slice(1)), b.constructor != Array && (b = [b]), b.each(function(b, c) {
            a = a.replace(new RegExp("\\{" + c + "\\}", "g"), b)
        }), a) : a
    };
    var kl = {
        Baggage: pageGlobal.DisplayBaggageSizeSwitch ? "\u884c\u674e\u89c4\u5b9a": "\u6258\u8fd0\u884c\u674e\u989d",
        ChildBaggage: condition.ChildQuantity ? "\u513f\u7ae5\u6258\u8fd0\u884c\u674e\u989d": "\u5a74\u513f\u6258\u8fd0\u884c\u674e\u989d",
        SharedFlight: "\u5171\u4eab\u822a\u73ed",
        TicketLimit: "\u8d2d\u7968\u9650\u5236",
        Note: "\u5907\u6ce8",
        AdjustDay: "\u505c\u7559\u5929\u6570",
        NoShow: "\u8bef\u673a\u8d39\uff08No Show\uff09"
    },
    groupBy = function(a, b) {
        for (var c = {},
        d = 0; d < a.length; d++) {
            var e = a[d]; (c[e[b]] = c[e[b]] || []).push(e)
        }
        return c
    };
    online.getBaggageTip = function(a, b) {
        Array.prototype.every || (Array.prototype.every = function(a) {
            var b = Object(this),
            c = b.length >>> 0;
            if ("function" != typeof a) throw new TypeError;
            for (var d = arguments.length >= 2 ? arguments[1] : void 0, e = 0; c > e; e++) if (e in b && !a.call(d, b[e], e, b)) return ! 1;
            return ! 0
        }),
        Array.prototype.some || (Array.prototype.some = function(a) {
            "use strict";
            if (void 0 === this || null === this) throw new TypeError;
            var b = Object(this),
            c = b.length >>> 0;
            if ("function" != typeof a) throw new TypeError;
            for (var d = arguments.length >= 2 ? arguments[1] : void 0, e = 0; c > e; e++) if (e in b && a.call(d, b[e], e, b)) return ! 0;
            return ! 1
        }),
        Object.keys || (Object.keys = function() {
            "use strict";
            var a = Object.prototype.hasOwnProperty,
            b = !{
                toString: null
            }.propertyIsEnumerable("toString"),
            c = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],
            d = c.length;
            return function(e) {
                if ("function" != typeof e && ("object" != typeof e || null === e)) throw new TypeError("Object.keys called on non-object");
                var f, g, h = [];
                for (f in e) a.call(e, f) && h.push(f);
                if (b) for (g = 0; d > g; g++) a.call(e, c[g]) && h.push(c[g]);
                return h
            }
        } ());
        var c = a.every(function(a) {
            return ! (a.AdultBaggage && a.AdultBaggage.CheckedBaggage && a.AdultBaggage.CheckedBaggage.HasSizeLimit || a.AdultBaggage && a.AdultBaggage.HandBaggage && a.AdultBaggage.HandBaggage.HasSizeLimit || a.ChildBaggage && a.ChildBaggage.CheckedBaggage && a.ChildBaggage.CheckedBaggage.HasSizeLimit || a.ChildBaggage && a.ChildBaggage.HandBaggage && a.ChildBaggage.HandBaggage.HasSizeLimit || a.InfantBaggage && a.InfantBaggage.CheckedBaggage && a.InfantBaggage.CheckedBaggage.HasSizeLimit || a.InfantBaggage && a.InfantBaggage.HandBaggage && a.InfantBaggage.HandBaggage.HasSizeLimit)
        }) ? "\u884c\u674e\u5c3a\u5bf8\u9650\u5236\u8bf7\u54a8\u8be2\u822a\u53f8": "",
        d = b ? "\u540e\u7eed\u9875\u9762\u63d0\u4f9b\u8d2d\u4e70\u884c\u674e\u989d\u670d\u52a1": "",
        e = c + (c && d ? "\uff0c": "") + d,
        f = (a.length + (e ? 1 : 0),
        function(a) {
            return {
                adult: a.AdultBaggage,
                child: a.ChildBaggage,
                infant: a.InfantBaggage
            }
        }),
        g = function(a) {
            return a.DCityName + " \u2014 " + a.ACityName
        },
        h = '<img class="ico-luggage" src="//pic.c-ctrip.com/fltcommon/icons/luggage-port.png" />',
        i = '<img class="ico-luggage" src="//pic.c-ctrip.com/fltcommon/icons/luggage.png" />',
        j = function(a, b, c) {
            var d = a[b].HandBaggage,
            e = d ? d.BaggageSizeLimit: null,
            f = a[b].CheckedBaggage,
            g = f ? f.BaggageSizeLimit: null,
            j = e && e === g;
            return a[b] ? (d ? '<tr>    <td class="col-1 caption" rowSpan="2">' + c + '</td>    <td class="col-1" colSpan="' + (e ? 1 : 2) + '" >        <div class="luggage-type">            ' + h + "\u624b\u63d0\uff1a" + d.BaggageContent + "        </div>    </td>    " + (e ? '<td rowSpan="' + (j ? 2 : 1) + '">            <div>' + e + "</div>        </td>": "") + "</tr>": "") + (f ? "<tr>    " + (d ? "": '<td class="col-1 caption">' + c + "</td>") + '    <td class="col-1" colSpan="' + (g ? 1 : 2) + '" >        <div class="luggage-type">            ' + (i + "\u6258\u8fd0\uff1a") + "            " + f.BaggageContent + "        </div>    </td>    " + (j || !g ? "": "<td>            <div>" + g + "</div>        </td>") + "</tr>": "") : ""
        },
        k = function(a) {
            var b = function(b, c, d) {
                var e = a[b].HandBaggage,
                f = a[b].CheckedBaggage;
                return {
                    data: JSON.stringify({
                        handBaggage: e,
                        checkedBaggage: f
                    }),
                    title: c,
                    passengerType: b,
                    seq: d
                }
            },
            c = [];
            a.adult && c.push(b("adult", "\u6210\u4eba", 1)),
            a.child && c.push(b("child", "\u513f\u7ae5", 2)),
            a.infant && c.push(b("infant", "\u5a74\u513f", 3));
            var d = groupBy(c, "data"),
            e = [];
            return Object.keys(d).each(function(a) {
                var b = d[a],
                c = b[0].passengerType,
                f = [];
                b.sort(function(a, b) {
                    return a.seq - b.seq
                }).each(function(a) {
                    f.push(a.title)
                }),
                e.push({
                    passengerType: c,
                    title: f.join("<br/>")
                })
            }),
            e.map(function(b) {
                return j(a, b.passengerType, b.title)
            }).join("")
        },
        l = function(a, b, c, d, e) {
            var h = a[b],
            i = ["SegmentNo", "SequenceNo", "DCityName", "ACityName"],
            j = function(a, b) {
                return i.indexOf(a) >= 0 ? "": b
            },
            l = function(a, c) {
                return c === b || JSON.stringify(a, j) === JSON.stringify(h, j)
            },
            m = a.some(function(a, c) {
                return b > c && l(a, c)
            }),
            n = a.filter(function(a, c) {
                return c >= b && l(a, c)
            }),
            o = n.map(function(a, b) {
                return g(a)
            }).join("<br/>");
            return m || 0 === n.length ? "": '<tr>    <td class="col-sub" style="width:80px;">' + o + '</td>    <td class="no-padding" style="padding:0;" >        <table>            <tbody>                ' + k(f(h)) + "            </tbody>        </table>    </td></tr>"
        },
        m = a.map(function(b, c) {
            var d = a[c],
            e = d.SegmentNo,
            f = d.SequenceNo;
            return "" + l(a, c, e, f)
        });
        e && (e = "\u6e29\u99a8\u63d0\u793a: " + e);
        var n = '<table class="luggage-rules"><tbody>' + m.join("") + (e ? '<tr><td colSpan="2">' + e + "</td></tr>": "") + "</tbody></table>";
        return n
    },
    online.getRR = function(a, b, c, d) {
        var e = [];
        if (a ? (a.URL === d && a.RemarkParameter === d && (c ? e.push("<h4>\u9000\u6539\u7b7e\u8bf4\u660e</h4><p>" + c + "</p>") : e.push($.tmpl.render('<h4>\u9000\u6539\u7b7e\u8bf4\u660e</h4>{{if typeof Rebook === "undefined" || Rebook.length < 1}}<p>\u9000\u6539\u7b7e\u89c4\u5219\u4ee5\u822a\u7a7a\u516c\u53f8\u4e3a\u51c6</p>{{else}}<div class="tooltip-table"><table class="title-left"><tbody>{{each (k, v) Rebook}}<tr><th>${online.fixSpecChar(v.Text)}</th><td class="last">${online.fixSpecChar(v.Content)}</td></tr>{{/each}}</tbody></table></div>{{/if}}', a))), a.NoShow && e.push("<h4>" + kl.NoShow + "</h4><p>" + online.fixSpecChar(a.NoShow) + "</p>")) : 1 === pageGlobal.RefundRebookHighLightSwitch && (c ? e.push("<h4>\u9000\u6539\u7b7e\u8bf4\u660e</h4><p>" + c + "</p>") : e.push("<h4>\u9000\u6539\u7b7e\u8bf4\u660e</h4><p>\u9000\u6539\u7b7e\u89c4\u5219\u4ee5\u822a\u7a7a\u516c\u53f8\u4e3a\u51c6</p>")), b) for (var f in b) if (kl[f] && b[f]) {
            var g = function() {
                e.push("<h4>" + kl[f] + "</h4>")
            };
            "string" == typeof b[f] ? (g(), e.push("<p>" + online.fixSpecChar(b[f]) + "</p>")) : c && 1 == b[f].length && "\u8bf4\u660e" == b[f][0].Text ? (g(), e.push("<p>" + online.fixSpecChar(b[f][0].Content) + "</p>")) : "Baggage" === f && b.NewBaggage && b.NewBaggage.length ? (e.push('<div class="tooltip-table tab-arrow"><div class="bd"><div class="flt-back">'), g(), e.push('<div class="tooltip-table">' + online.getBaggageTip(b.NewBaggage) + "</div>"), e.push("</div></div></div>")) : (g(), e.push($.tmpl.render('{{if data.length === 1 && !data[0].Text}}<p>${online.fixSpecChar(data[0].Content)}</p>{{else}}<div class="tooltip-table"><table class="title-left"><tbody>{{each (k, v) data}}<tr>{{if (!v.Text || v.Text.length == 0) && (v.Content && v.Content.length > 0)}}<td class="last" colspan="2">${online.fixSpecChar(v.Content)}</td>{{else}}<th>${online.fixSpecChar(v.Text)}</th><td class="last">${online.fixSpecChar(v.Content)}</td>{{/if}}</tr>{{/each}}</tbody></table></div>{{/if}}', {
                data: b[f]
            })))
        }
        return e.join("").replace(/"/g, "&quot;")
    },
    online.reportMultipleTickets = function(a) {
        "left" === a ? window.pageGlobal.NewUbt.multiple_tickets_protection_show = 1 : window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_show = 1
    },
    online.reportMultipleTicketsClick = function(a) {
        "YDBD" !== a.className ? window.pageGlobal.NewUbt.multiple_tickets_protection_click = 1 : window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_click = 1
    },
    online.reportBaggageSizeUbt = function(a) {
        var b = {};
        b.Endorse_luggage_tip = [];
        try {
            var c = $.parseJSON(decodeURIComponent(a));
            if (c && "array" == $.type(c) && c.length > 0) {
                for (var d = c.length,
                e = 0; d > e; e++) {
                    var f = {};
                    f.fromcity = c[e].FromCity,
                    f.tocity = c[e].ToCity,
                    f.flightno = c[e].FlightNo,
                    f.detail = [];
                    var g = {};
                    g.adult = c[e].HasAdultBaggage ? 1 : 0,
                    c[e].HasChild && (g.child = c[e].HasChildBaggage ? 1 : 0),
                    c[e].HasInfant && (g.infant = c[e].HasInfantBaggage ? 1 : 0),
                    f.detail.push(g),
                    b.Endorse_luggage_tip.push(f)
                }
                window.__bfi.push(["_tracklog", "flt_oversea_search_click", $.stringifyJSON(b)])
            }
        } catch(h) {
            $.error("flt_oversea_search_click", "\u884c\u674e\u989d\u5c3a\u5bf8\u57cb\u70b9\u4e0a\u62a5\u51fa\u9519: " + h + "\uff0c\u5f53\u524d\u7684jsonobj\u4e3a" + $.stringifyJSON(b), h)
        }
    };
    var Cache = {};
    online.create("service.NewResultService", {
        options: {
            curType: "TotalPrice",
            sortKey: "TransferCount",
            orderBy: "asc",
            lastSortType: "TransferCount_asc",
            loadFinish: !1,
            needUpdateFilter: !0,
            searchTimes: 0,
            searchMax: 10,
            searchFinishTimes: 0,
            curPage: 0,
            pageSize: 15,
            maxPage: 0,
            noStopLen: 0,
            flightKey: {},
            flightList: [],
            searchTokens: [],
            lowestPrice: [],
            aptPanel: "#Eligibility",
            aptitudeList: {},
            stayTime: 9e5,
            stayTimeout: !1,
            runTimes: 0,
            curSegment: 0,
            maxSegment: 1,
            reqSequence: 0,
            segmentPanel: "#segmentList",
            isDirectAndSameGrade: !1,
            dlen: 0,
            resultCount: 0,
            directFlightCount: 0,
            retLowTotalPrice: 99999,
            needCreateSuperFlyerBox: !0,
            segmentTmpl: '{{each (i, v, len) lists}}<div class="flight-selected-item{{if i+1 === len}} last-item{{/if}}"><h3 class="trip-title">${title[i]}</h3><p class="flight-selected-detail"><span class="selected-flight-no">${v.FlightNo}</span> | <span class="selected-depart">${v.DPortName}</span> <span class="selected-arrow">\u2192</span> <span class="selected-arrive">${v.APortName}</span> <span class="selected-depart-time">\u51fa\u53d1\uff1a<b>${online.showTime(v.DepartTime, "M\u6708d\u65e5 hh:mm")}</b></span> <span class="selected-arrive-time">\u5230\u8fbe\uff1a<b>${online.showTime(v.ArrivalTime, "M\u6708d\u65e5 hh:mm")}</b></span> | <span class="selected-stop">${v.Stop}</span></p><a href="#" class="selected-modify" data-token="${v.Token}" data-segment="${i}" data-ubt-key="FreeCombine_Change">\u4fee\u6539\u822a\u73ed</a></div>{{/each}}',
            segmentList: [],
            alGiftHash: {},
            alGiftIDList: [],
            segmentTitle: {
                S: ["\u5355\u7a0b"],
                D: ["\u53bb\u7a0b", "\u8fd4\u7a0b"],
                M: ["\u7b2c\u4e00\u7a0b", "\u7b2c\u4e8c\u7a0b", "\u7b2c\u4e09\u7a0b", "\u7b2c\u56db\u7a0b", "\u7b2c\u4e94\u7a0b", "\u7b2c\u516d\u7a0b"]
            },
            stepPanel: "#StepPanel",
            StepInfo: "#currentStep",
            isCache: !1,
            isLocked: !1,
            aptitudes: {
                INF: "\u5a74\u513f",
                CHD: "\u513f\u7ae5",
                TAI: "\u53f0\u5546",
                NOR: "\u666e\u901a",
                STU: "\u7559\u5b66\u751f",
                EMI: "\u79fb\u6c11",
                LAB: "\u52b3\u52a1\u4eba\u5458",
                NEW: "\u65b0\u79fb\u6c11",
                SEA: "\u6d77\u5458",
                SNR: "\u8001\u5e74\u4eba",
                YOU: "\u9752\u5e74"
            },
            loading: "#flightsLoading",
            loadStatus: "#loadingStatus",
            loadingList: "#flightListLoading",
            isLoadingHide: 2,
            sortControl: "#sortControls",
            sortUBTData: {
                SortWay: "Default",
                PriceDisplayWay: "Default"
            },
            UBTData: {
                ReturnType: "Free",
                MorePriceTimes: 0,
                PassengerFliter: 0,
                LockFirstFlightTimes: 0,
                LockSecondFlightTimes: 0,
                ClickFreeTimes: 0,
                ClickCombinationTimes: 0
            },
            container: "#flightList",
            morePriceTmpl: '{{each (idx, f) MorePriceFlight}}{{if typeof exKey[f.pkey] === "undefined"}}{{tmpl priceTmpl,{f:f,addtionTmplVar:addtionTmplVar, isRoundTrip:isRoundTrip, showDec:1, curType:curType, isLastSegment:isLastSegment, Key:Key}}}{{/if}}{{/each}}',
            priceTmpl: "",
            multLowPanel: "#multLowPanel",
            url: "AjaxRequest/UI2_0/SearchResultHandler.ashx",
            isMultiTrave: !1,
            sortUBT: {
                Default: {
                    ubt: "Default",
                    title: "\u76f4\u98de\u4f18\u5148"
                },
                DepartTime_asc: {
                    ubt: "Departure",
                    title: "\u8d77\u98de\u65f6\u95f4\u4ece\u65e9\u5230\u665a"
                },
                DepartTime_desc: {
                    ubt: "DepartureDesc",
                    title: "\u8d77\u98de\u65f6\u95f4\u4ece\u665a\u5230\u65e9"
                },
                ArrivalTime_asc: {
                    ubt: "Arrival",
                    title: "\u5230\u8fbe\u65f6\u95f4\u4ece\u65e9\u5230\u665a"
                },
                ArrivalTime_desc: {
                    ubt: "ArrivalDesc",
                    title: "\u5230\u8fbe\u65f6\u95f4\u4ece\u665a\u5230\u65e9"
                },
                FlightTime_asc: {
                    ubt: "FlightTime",
                    title: "\u822a\u7a0b\u65f6\u957f\u4ece\u77ed\u5230\u957f"
                },
                FlightTime_desc: {
                    ubt: "FlightTimeDesc",
                    title: "\u822a\u7a0b\u65f6\u957f\u4ece\u957f\u5230\u77ed"
                },
                Price_asc: {
                    ubt: "Price",
                    title: "\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8"
                },
                Price_desc: {
                    ubt: "PriceDesc",
                    title: "\u4ef7\u683c\u4ece\u9ad8\u5230\u4f4e"
                }
            },
            BSortUbt: {
                Price_asc: {
                    ubt: "Price",
                    title: "\u5f80\u8fd4\u603b\u4ef7\u4ece\u4f4e\u5230\u9ad8"
                },
                Price_desc: {
                    ubt: "PriceDesc",
                    title: "\u5f80\u8fd4\u603b\u4ef7\u4ece\u9ad8\u5230\u4f4e"
                }
            },
            lpSuggestUbt: {
                closecheaptime: 0,
                cheapinfo: {
                    lowestprice: {
                        time: 0,
                        flightdetail: 0,
                        isbooking: 0,
                        moreprice: 0
                    },
                    directprice: {
                        time: 0,
                        flightdetail: 0,
                        isbooking: 0,
                        moreprice: 0
                    },
                    dayprice: {
                        time: 0,
                        flightdetail: 0,
                        isbooking: 0,
                        moreprice: 0
                    }
                },
                lookothertime: 0
            },
            nearOnlineFlightsUbt: {
                RecommendProduct: [],
                HasDirect: "N",
                ACityCode: condition.SegmentList[0].ACityCode,
                DCityCode: condition.SegmentList[0].DCityCode
            },
            inlandAdPrice: {
                TriggerType: "Exit",
                NoTaxLowestPrice: "",
                ADprice: "",
                ADpageid: ""
            },
            selectComfortFlight: [],
            marketCurLowPrice: 999999999999,
            constNum: 999999999999,
            marketChangeFilter: !0,
            urlSortLoadTimes: 0,
            urlTaxLoadTimes: 0,
            loadNearOnlineFinished: !1,
            loadAggFinished: !1,
            isNearOnlineReported: !1,
            bookingLock: !1,
            fltTypeName: 0,
            hasTrain: !1,
            closeAirportrecommendCity: !1,
            hkTravelChooseProductTag: "",
            giftTagUbt: {
                selected: [],
                display: []
            },
            airportRecommendCity: {
                DCity: "",
                ACity: ""
            },
            needHideDowngradeTip: !1,
            downgradeStatus: -1,
            downgradeUBT: {
                isDowngrade: !1,
                onewayTrip: {
                    type: null,
                    quantity: 0
                },
                freeStyle: {
                    type: null,
                    quantity: 0
                },
                builtUp: {
                    type: null,
                    quantity: 0
                }
            },
            upgradeTagUBT: {
                roundTrip: {
                    freeStyle: {
                        stats: [],
                        selected: []
                    },
                    builtUp: {
                        stats: [],
                        selected: []
                    }
                },
                otherTrip: {
                    stats: [],
                    selected: []
                }
            },
            freeStyleHasBothDirectFlag: "",
            nearDateDirectRecommendCallback: null,
            recommendGroupData: null,
            recommendGroupDataUbt: {},
            recommendGroupDataTabTip: {
                OW: {
                    msg: null,
                    allHidden: !1
                },
                Free: {
                    msg: null,
                    allHidden: !1
                },
                Built: {
                    msg: null,
                    allHidden: !1
                }
            },
            YS_FOLD_GATE: pageGlobal.CFAddYSSingleTripDisplayLimit || 4,
            shouldFoldYS: !1,
            prevSortKey: "",
            models: {
                recommendFlightGroup: function() {
                    this.remark = "",
                    this.groupTitle = "",
                    this.flights = []
                },
                recommendGroupInfo: function() {
                    this.tip = "",
                    this.groupList = []
                },
                recommendGroupUbt: function() {
                    this.Type = "",
                    this.Quantity = 0,
                    this.PageLocation = ""
                }
            },
            SearchNearRecFltFlag: "",
            PriceAttributeCompareKey: ["Restriction", "Penalties", "Baggageallowance", "Invoicetype", "Travelrisk"],
            NewcomparePrice: new NewcomparePrice({})
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.cond = window.condition || {},
                this.extend(this, a),
                this.AllowMode = {
                    Search: 1,
                    TokenSearch: 1
                },
                -1 !== location.search.indexOf("entry=Rebook") && (pageGlobal.IsRebook = 1),
                pageGlobal.IsCompareCost = pageGlobal.IsCompareCost || 0,
                pageGlobal.IsCompareTotal = pageGlobal.IsCompareTotal || 0,
                this.PainExponent = pageGlobal.SortABTest || 0,
                this.isMultiTrave = this.cond.Quantity && (this.cond.ChildQuantity || this.cond.InfantQuantity),
                this.CKey = ["Price", "SortCost", "TotalPrice"][pageGlobal.IsCompareCost],
                this.SKey = ["Price", "TotalPrice"][pageGlobal.IsCompareTotal],
                this.isUpdateRemindtag = !0,
                this.hideMorePrice = !pageGlobal.ShowMorePrice,
                this.DifPrice = pageGlobal.DifPr >> 0,
                this.DifPrice < 0 && (this.DifPrice = 0),
                this.SotoThres = ("string" === $.type(pageGlobal.Single2DoublePriceGate) ? pageGlobal.Single2DoublePriceGate: "0.03|10").replace(/%/i, "").split("|"),
                Number(this.SotoThres[0]) && Number(this.SotoThres[1]) ? (this.SotoThres[0] > 1 ? this.SotoThres[0] = this.SotoThres[0] / 100 : this.SotoThres[0] < 0 && (this.SotoThres[0] = .03), this.SotoThres[1] < 1 && (this.SotoThres[1] = 10)) : this.SotoThres = [.03, 10],
                this.PIPOpen = 1 === pageGlobal.IsPlanInfoProjectOpened,
                this.allowReSort = 1 === pageGlobal.PlanInfoSortSwitch,
                this.ForceReSort = 1 === pageGlobal.ForceReSortSwitch,
                this.CombineClassCfg = pageGlobal.CombineClassConfig && pageGlobal.CombineClassConfig.split("|") || [],
                this.tmpl = '{{if isFirst === 1 && list.length < 1}}<div class="noresult-notice"><i class="icon-warn-32"></i>{{if isManCang}}<h2 class="notice-title">\u62b1\u6b49\uff0c\u60a8\u9009\u62e9\u7684\u822a\u73ed\u5df2\u552e\u5b8c\u3002</h2><p class="align-with-title">\u60a8\u53ef\u4ee5\uff1a <a href="###" class="reSearch">\u91cd\u65b0\u67e5\u8be2</a></p>{{else}}<h2 class="notice-title">\u62b1\u6b49\uff0c\u7b5b\u9009\u65e0\u7ed3\u679c\u3002</h2><p class="align-with-title">\u60a8\u53ef\u4ee5\u53bb\u6389\u4e00\u4e9b\u7b5b\u9009\u9879\u6216 <a href="#" class="showAllResult">\u67e5\u770b\u5168\u90e8\u7ed3\u679c</a></p>{{/if}}</div>{{else}}{{each (index, item) list}}{{if FlightInfo}}{{if item._recommendGroupRemark}} <!--\u4e24\u8231\u65e0\u76f4\u98de\u8865\u5145\u76f4\u98de\u4e0e\u4e2d\u8f6c\u5206\u9694\u7ebf\uff1a${item._recommendGroupRemark}--> {{/if}}{{if item._recommendGroupTitle}}<div class="banner-tip">${item._recommendGroupTitle}</div> {{/if}}<div data-utoken="${item.UToken}" class="flight-bundle{{if item.IsSuggestPrice === 1}}-suggest{{/if}}{{if item.IsTabGroup===1}} J_lowPriceTabGroup{{/if}}">{{if item.IsSuggestPrice === 1}}<h3 class="flight-bundle-title">{{if item.IsAppoint===1}}\u6307\u5b9a\u822a\u73ed\u63a8\u8350{{else}}{{if item.IsDirect === 1}}\u76f4\u98de{{else item.IsEgoHback}}\u65e9\u4e0a\u53bb\u665a\u4e0a\u56de{{else}}\u5f80\u8fd4{{/if}}\u4ec5 <dfn>&yen;</dfn>${item[curType]}\u8d77{{/if}}</h3>{{/if}}<div class="flight-item {{if item._YSfoldHide}} _YSfold  _YSfoldHide {{/if}}" start-index="${item.startIndex}" data-index="${item.Index}" {{if item.HasTrain}} data-train="1"{{/if}} data-validatetime="${item.FlightInfo[0].ValidateTime}"{{if item.IsSuggestPrice===1}} type="{{if item.IsAppoint}}APT{{else item.IsDirect}}DLP{{else item.IsEgoHback}}ELP{{else}}LP{{/if}}"{{/if}}><div class="flight-row-group flight-row-group-hover">{{each (ind, item) FlightInfo}}<div class="flight-row flight-row-${ind == 0 ? "depart" : "return"}">{{if list[index].Mode === 1 || (list[index].Mode === "Depart" && ind === 0) || (list[index].Mode === "Back" && ind === 1)}}<a data-ubt-key="${ind == 0 ? "DuplicateCombine_CheckTo" : "DuplicateCombine_CheckBack" }" href="#" mode="${ind}" class="checkbox-icon {{if list[index].Mode !== 1}} checkbox-icon-checked{{/if}}" param="${list[index].FareList[0].Parameter}"></a>{{/if}}' + this.flightBaseTmpl + '</div>{{/each}}</div><div class="flight-detail-row"><div class="flight-action-more"><a href="#" data-ubt-key="MoreFlight">\u822a\u73ed\u8be6\u60c5<i class="icon-caret"></i></a></div></div><div class="flight-detail-expend">{{each (ind, item) FlightInfo}}${(title=((ind < 1) ? "\u53bb" : "\u8fd4"),"")}' + this.detailTmpl + '{{/each}}</div><div class="seats-list" {{if item.PainExponent}} PainExponent="${item.PainExponent}"{{/if}}>{{each (idx, f) item.FareList}}{{tmpl priceTmpl, {f:f,addtionTmplVar:addtionTmplVar, isRoundTrip:1, showDec:1, curType:curType, flightWay:flightWay, isLastSegment:isLastSegment, curSegment: curSegment, Key:item.Key, lowPrice:lowPrice, fareList:item.FareList,fareIndex:idx,flightType:flightType}}}{{/each}}</div><div class="seat-row-more"></div><div class="price-row">{{if item.FlightGift && item.FlightGift.GiftIDList && item.FlightGift.GiftIDList.length>0}}<span class="price_gifts" data-role="jmp" data-params="{options: {showArrow:false,css:{minWidth:\'375\'},type:\'jmp_text\',classNames:{boxType:\'tooltip\',tipContent:\'tooltip-content\'},template:\'#gift_list_tmpl\',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,\'${item.FlightGift.GiftIDList.join()}\');}}}}"><img src="//pic.c-ctrip.com/fltcommon/icons/default-gift.png" class="tag tag_gift_img">\u9884\u8ba2\u8be5\u822a\u73ed\uff0c\u53ef\u4eab{{if item.FlightGift.GiftIDList.length>1}}${item.FlightGift.GiftIDList.length}\u91cd{{/if}}\u7cbe\u9009\u597d\u793c\uff01</span>{{/if}}<span class="price-tax">${newPriceTips}</span>{{if item.IsMorePrice}}<a href="#" class="btn-price-more" key="${item.Key}" param="${item.FareList[0].Parameter}"><span data-ubt-key="MorePrice">\u66f4\u591a\u4ef7\u683c<i class="icon-caret"></i></span></a>{{/if}}</div>{{if cheapFlight}}<div class="seat-row date-change-row"><div class="seat-special">\u540c\u822a\u73ed \u6362\u4e2a\u65e5\u671f\u66f4\u4fbf\u5b9c</div><div class="seat-date">\u53bb ${cheapFlight.DDepartDate}{{if cheapFlight.DDelay}}<span>\uff08${cheapFlight.DDelay}\u5929\uff09</span>{{/if}}&nbsp;&nbsp;\u8fd4 ${cheapFlight.ADepartDate}{{if cheapFlight.ADelay}}<span>\uff08${cheapFlight.ADelay}\u5929\uff09</span>{{/if}}</div><div class="seat-price"><span class="price"><dfn>&yen;</dfn>${cheapFlight[curType]}</span>{{if curType===\'Price\'}}+${cheapFlight.Tax}{{/if}}\u8d77</div><div class="seat-bonus"></div><div class="seat-action"><button class="btn-book J_cheakCheap" data-dep="${cheapFlight.TakeOffDateTime}" data-ret="${cheapFlight.ArrivalDateTime}" data-key="${cheapFlight.Key}" data-ubt-key="ChangeDate_Cheaper">\u67e5\u770b</button></div></div>{{/if}}</div></div>{{else}}{{if item.needVirtualFlightHeader}}' + this.virtualFlightHeaderTmpl + '{{/if}}{{if item._recommendGroupRemark}}<!--\u4e24\u8231\u65e0\u76f4\u98de\u8865\u5145\u76f4\u98de\u4e0e\u4e2d\u8f6c\u5206\u9694\u7ebf\uff1a${item._recommendGroupRemark}-->{{/if}}   {{if item._recommendGroupTitle}}<div class="banner-tip">${item._recommendGroupTitle}</div> {{/if}}<div {{if item.ContainsVirtualFlight}}data-virtualflight="1"{{/if}} data-utoken="${item.UToken}" class="flight-item {{if item.ContainsVirtualFlight}}virtual-flight{{/if}} ${item.virtualFlightTagClass} {{if item._YSfoldHide}} _YSfold  _YSfoldHide {{/if}}" data-index="${item.Index}" start-index="${item.startIndex}" {{if item.HasTrain}} data-train="1"{{/if}} data-validatetime="${item.ValidateTime}"><div class="flight-row">' + this.flightBaseTmpl + '<div class="flight-action-more"><a href="#" data-ubt-key="MoreFlight">${item.tripDetailText||"\u822a\u73ed\u8be6\u60c5"}<i class="icon-caret"></i></a></div></div><div class="flight-detail-expend">' + this.detailTmpl + '</div><div class="seats-list" {{if item.PainExponent}} PainExponent="${item.PainExponent}"{{/if}}>{{each (idx, f) item.FareList}}{{tmpl priceTmpl, {f:f, addtionTmplVar:addtionTmplVar,isRoundTrip:0, showDec:(typeof item.Declaration === "undefined" ? 1 : item.Declaration), curType:curType, flightWay:flightWay, isLastSegment:isLastSegment, curSegment: curSegment, Key:item.Key, lowPrice:lowPrice,fareList:item.FareList,fareIndex:idx,flightType:flightType}}}{{/each}}</div><div class="seat-row-more"></div><div class="price-row">{{if item.FlightGift && item.FlightGift.GiftIDList && item.FlightGift.GiftIDList.length>0}}<span class="price_gifts" data-role="jmp" data-params="{options: {showArrow:false,css:{minWidth:\'375\'},type:\'jmp_text\',classNames:{boxType:\'tooltip\',tipContent:\'tooltip-content\'},template:\'#gift_list_tmpl\',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,\'${item.FlightGift.GiftIDList.join()}\');}}}}"><img src="//pic.c-ctrip.com/fltcommon/icons/default-gift.png" class="tag tag_gift_img">\u9884\u8ba2\u8be5\u822a\u73ed\uff0c\u53ef\u4eab{{if item.FlightGift.GiftIDList.length>1}}${item.FlightGift.GiftIDList.length}\u91cd{{/if}}\u7cbe\u9009\u597d\u793c\uff01</span>{{/if}}<span class="price-tax">${newPriceTips}</span>{{if item.IsMorePrice}}<a href="#" class="btn-price-more" key="${item.Key}" param="${item.FareList[0].Parameter}"><span data-ubt-key="MorePrice">\u66f4\u591a\u4ef7\u683c<i class="icon-caret"></i></span></a>{{/if}}</div></div>{{if item.ContainsVirtualFlight&&item.IsLastVirtualFlight}}<div id="virtualFlightMore" class="virtual-flight-expand-row collapse"><span class="expand-text">\u67e5\u770b\u66f4\u591a</span>&nbsp;<span class="collapse-arrow icon-caret"></span></div>{{/if}}{{if cheapFlight}}<div class="seat-row date-change-row"><div class="seat-special">\u540c\u822a\u73ed \u6362\u4e2a\u65e5\u671f\u66f4\u4fbf\u5b9c</div><div class="seat-date">\u53bb ${cheapFlight.DDepartDate}{{if cheapFlight.DDelay}}<span>\uff08${cheapFlight.DDelay}\u5929\uff09</span>{{/if}}&nbsp;&nbsp;\u8fd4 ${cheapFlight.ADepartDate}{{if cheapFlight.ADelay}}<span>\uff08${cheapFlight.ADelay}\u5929\uff09</span>{{/if}}</div><div class="seat-price"><span class="price"><dfn>&yen;</dfn>${cheapFlight[curType]}</span>{{if curType===\'Price\'}}+${cheapFlight.Tax}{{/if}}\u8d77</div><div class="seat-bonus"></div><div class="seat-action"><button class="btn-book J_cheakCheap" data-dep="${cheapFlight.TakeOffDateTime}" data-ret="${cheapFlight.ArrivalDateTime}" data-key-key="${cheapFlight.Key}" data-ubt-key="ChangeDate_Cheaper">\u67e5\u770b</button></div></div>{{/if}}{{/if}}{{if item._appendShowMore}}				<div class="flights-direct-operate" id="showMoreYS" >					<a href="javascript:;" class="fdo-open showMoreYSLink" data-ubt-key="Show_more">\u67e5\u770b\u66f4\u591a\u7ecf\u6d4e\u8231\u76f4\u98de\u822a\u73ed<i class="icon-caret"></i></a>				</div>				<div style="display: none" class="flights-direct-operate" id="foldYS">					<a href="javascript:;" class="fdo-close foldYSLink" data-ubt-key="Close_more">\u6536\u8d77<i class="icon-caret icon-caret-up"></i></a>				</div>				{{/if}}{{/each}}{{/if}}',
                this.flightWay = this.cond.FlightWay || "S",
                this.fltChpKey = this.cond.AdjacentDateKey,
                this.init(),
                this.checkSegment(),
                this.addtionService = online.$c("service.NewResult.AddtionService", {
                    orderBtnTmpl: orderBtnTmpl,
                    resultService: this,
                    TCXReformSwitch: pageGlobal.TCXReformSwitch,
                    IsCreatePreferred: pageGlobal.IsCreatePreferred
                }),
                this.SearchNearRecFltFlag = "",
                this.SearchNearRecFltFlag = $.storage.get("SearchNearRecFltFlag"),
                "T" == this.SearchNearRecFltFlag && $.storage.remove("SearchNearRecFltFlag")
            },
            init: function() {
                this.loadStatus = $(this.loadStatus),
                this.bindEvent(),
                this.setTimer(),
                "M" == this.flightWay && (this.filterService && this.filterService.clearFilter("OwnerAirlineName", this.cond.AirlineName), delete this.cond.AirlineName),
                pageGlobal.NearDateDirectFlightRecommendSwitch ? this.getNearDateOnlineFlights() : this.getNearOnlineFlights()
            },
            getNearOnlineFlights: function() {
                if (pageGlobal.NearOnlineRecommendFlightSwitch) {
                    this.loadNearOnlineFinished = !0;
                    var a = function() {
                        var a = pageGlobal.NearOnlineRecommendFlightSearchNumberConfig,
                        b = new Date,
                        c = b.getFullYear(),
                        d = b.getMonth(),
                        e = b.getDate();
                        if (b = new Date(c, d, e), "" == $("#DDate").value()) return ! 1;
                        var f = $("#DDate").value().split("-");
                        if (f.length < 3) return ! 1;
                        var g = +f[0],
                        h = +f[1] - 1,
                        i = +f[2],
                        j = new Date(g, h, i),
                        k = parseInt((j - b) / 864e5) >= a;
                        return k
                    };
                    if (a()) {
                        var b = this,
                        c = {
                            url: "AjaxRequest/AsyncResult/GetNearOnlineRecommendFlight.ashx"
                        },
                        d = $.storage.get("nearOnlineByRecommendUbt"),
                        e = null != d && d.RecommendProduct.ToDate == $("#DDate").value() && d.ACityCode == condition.SegmentList[0].ACityCode && d.DCityCode == condition.SegmentList[0].DCityCode;
                        null == d || e || $.storage.remove("nearOnlineByRecommendUbt"),
                        "S" != condition.FlightWay && "D" != condition.FlightWay || "" != $("#txtAirline").value() || e || (this.loadNearOnlineFinished = !1, $.ajax(online.getBaseUrl(c.url), {
                            context: {
                                QueryData: condition
                            },
                            method: "POST",
                            onsuccess: function(a, c) {
                                if (b.loadNearOnlineFinished = !0, c = $.parseJSON(c), null != c && "" != c) {
                                    "array" != $.type(pageGlobal.NewUbt.RecommendProduct) && (pageGlobal.NewUbt.RecommendProduct = []);
                                    var d = {
                                        ArrivalCity: pageGlobal.NewUbt.Sequence[0].To.CityCode,
                                        DepartureCity: pageGlobal.NewUbt.Sequence[0].From.CityCode,
                                        DepartureDate: c.DepartureDate,
                                        Price: c.Price,
                                        IsRt: c.IsRt,
                                        ReturnDate: c.ReturnDate
                                    };
                                    InternationalRecommend.firstRecommendProd(d, "5");
                                    var e = $.storage.get("nearOnlineByRecommendUbt"); (null == e || e.RecommendProduct.ToDate != $("#DDate").value()) && (pageGlobal.NewUbt.RecommendProduct = b.nearOnlineFlightsUbt.RecommendProduct.concat({
                                        Type: "5",
                                        IsClick: "N",
                                        ToDate: c.DepartureDate,
                                        BackDate: c.ReturnDate
                                    }), pageGlobal.NewUbt.HasDirect = "N");
                                    var f = document.createElement("div");
                                    f.id = "rec_near_box",
                                    f.className = "rec_near_box rec_flt_box",
                                    f.style.display = "none",
                                    $(f).insertBefore($("#flightList"));
                                    var g = '<div class="rec-tit"><i class="ico-recomm">\u8350</i><h4>\u76f4\u98de\u63a8\u8350</h4></div><div class="rec-fromto">{{if isRt==true}}<div class="depart">${deptDate}&nbsp;<span class="base_txtgray">\u53bb</span></div><div class="gray-line"></div><div class="arrive">${rtDate}&nbsp;<span class="base_txtgray">\u56de</span></div>{{else}}<div class="depart">${deptDate}&nbsp;${dayOfWeek}&nbsp;<span class="base_txtgray base_txtgray1">\u51fa\u53d1</span></div><div class="arrow vsb-hide"></div><div class="arrive"></div>{{/if}}</div><div class="rec-date">\u76f4\u98de</div><div class="rec-price"></div><div class="rec-discount"></div><div class="rec-action"><button class="btn-book btn-near-book" type="button" data-time="${departureDate}" return-time="${returnDate}" data-ubt-key="NearLine_Detail">\u67e5\u770b</button></div>';
                                    $(f).html($.tmpl.render(g, {
                                        isRt: c.IsRt,
                                        deptDate: c.DeptDate,
                                        rtDate: c.RtDate,
                                        dayOfWeek: c.DateOfWeek,
                                        departureDate: c.DepartureDate,
                                        returnDate: c.ReturnDate
                                    }));
                                    var h = function(a) {
                                        var b = (condition.SegmentList[0].DCity, condition.SegmentList[0].ACity, condition.SegmentList[0].ClassGrade, a.attr("data-time")),
                                        c = a.attr("return-time");
                                        0 != $("#btnSearch").length && ($("#DDate").value(b), "" != c && $("#ADate").value(c), $("#Airline").value(""), $("#txtAirline").value(""), $("#btnSearch")[0].click())
                                    };
                                    $(f).onn("click", "btn-near-book",
                                    function(a) {
                                        a.stop();
                                        var c = $.extend(!0, {},
                                        b.nearOnlineFlightsUbt);
                                        c.DCityCode = pageGlobal.NewUbt.Sequence[0].From.CityCode,
                                        c.ACityCode = pageGlobal.NewUbt.Sequence[0].To.CityCode,
                                        InternationalRecommend.setClickedObj("5", c, b.flightWay),
                                        pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                                            a && "5" === a.Type && (a.IsClick = "Y", b.nearOnlineFlightsUbt.RecommendProduct = a)
                                        }),
                                        $.storage.set("nearOnlineByRecommendUbt", b.nearOnlineFlightsUbt, 30);
                                        var c = $.extend(!0, {},
                                        b.nearOnlineFlightsUbt);
                                        c.DCityCode = pageGlobal.NewUbt.Sequence[0].From.CityCode,
                                        c.ACityCode = pageGlobal.NewUbt.Sequence[0].To.CityCode,
                                        InternationalRecommend.setClickedObj("5", c, b.flightWay),
                                        h($(this))
                                    }),
                                    b.showNearOnlineFlight()
                                }
                            },
                            onerror: function() {
                                b.loadNearOnlineFinished = !0
                            }
                        }))
                    }
                }
            },
            getNearDateOnlineFlights: function(a, b) {
                this.loadNearOnlineFinished = !0;
                var c = function() {
                    var a = pageGlobal.NearOnlineRecommendFlightSearchNumberConfig,
                    b = new Date,
                    c = b.getFullYear(),
                    d = b.getMonth(),
                    e = b.getDate();
                    if (b = new Date(c, d, e), "" == $("#DDate").value()) return ! 1;
                    var f = $("#DDate").value().split("-");
                    if (f.length < 3) return ! 1;
                    var g = +f[0],
                    h = +f[1] - 1,
                    i = +f[2],
                    j = new Date(g, h, i),
                    k = parseInt((j - b) / 864e5) >= a;
                    return k
                };
                if (c()) {
                    var d = this,
                    e = {
                        url: "AjaxRequest/AsyncResult/GetNearDateDirectFlight.ashx"
                    },
                    f = $.storage.get("nearOnlineByRecommendUbt"),
                    g = null != f && f.RecommendProduct.ToDate == $("#DDate").value() && f.ACityCode == condition.SegmentList[0].ACityCode && f.DCityCode == condition.SegmentList[0].DCityCode;
                    if (null == f || g || $.storage.remove("nearOnlineByRecommendUbt"), !("S" != condition.FlightWay && "D" != condition.FlightWay || "" != $("#txtAirline").value() || g)) {
                        var h = function(a, b) {
                            var c = new Date(a.replace(/-/g, "/"));
                            return c.setDate(c.getDate() + b),
                            nearDateDirectRecommend.formatDate(c, !0)
                        },
                        i = nearDateDirectRecommend.formatDate(condition.SegmentList[0].DepartDate, !0),
                        j = nearDateDirectRecommend.formatDate(condition.SegmentList[1] && condition.SegmentList[1].DepartDate, !0); ! a && j && (nearDateDirectRecommend.initSearchCondition = {
                            departDate: i,
                            returnDate: j,
                            dCity: condition.SegmentList[0].DCity.split("(")[0].split("|")[1],
                            aCity: condition.SegmentList[0].ACity.split("(")[0].split("|")[1]
                        },
                        nearDateDirectRecommend.currentSearchCondition = {
                            departDate: i,
                            returnDate: j
                        }),
                        "prev" === a && j && (i = h(nearDateDirectRecommend.currentSearchCondition.departDate, 0 - nearDateDirectRecommend.NEARDATE_RECOMMEND_TIMESTEP), j = h(nearDateDirectRecommend.currentSearchCondition.returnDate, 0 - nearDateDirectRecommend.NEARDATE_RECOMMEND_TIMESTEP), nearDateDirectRecommend.currentSearchCondition = {
                            departDate: i,
                            returnDate: j
                        },
                        nearDateDirectRecommend.setOutofRangeFlag(i), nearDateDirectRecommend.setIsBeforeNowFlag(i)),
                        "next" === a && j && (i = h(nearDateDirectRecommend.currentSearchCondition.departDate, nearDateDirectRecommend.NEARDATE_RECOMMEND_TIMESTEP), j = h(nearDateDirectRecommend.currentSearchCondition.returnDate, nearDateDirectRecommend.NEARDATE_RECOMMEND_TIMESTEP), nearDateDirectRecommend.currentSearchCondition = {
                            departDate: i,
                            returnDate: j
                        },
                        nearDateDirectRecommend.setOutofRangeFlag(i), nearDateDirectRecommend.setIsBeforeNowFlag(i));
                        var k = {
                            FlightWay: condition.FlightWay || "",
                            DepartCityCode: condition.SegmentList[0].DCityCode || "",
                            ArrivalCitycode: condition.SegmentList[0].ACityCode || "",
                            DepartDate: i || "",
                            ReturnDate: j || "",
                            ClassGrade: condition.ClassGrade || "",
                            IsCalendar: b ? 1 : 0
                        };
                        this.loadNearOnlineFinished = !1,
                        nearDateDirectRecommend.isOutofThreeWeeksRange || nearDateDirectRecommend.isBeforeNow ? nearDateDirectRecommend.showLookupTable(h, d, a) : $.ajax(online.getBaseUrl(e.url), {
                            context: k,
                            method: "POST",
                            onsuccess: function(c, e) {
                                d.loadFinish ? nearDateDirectRecommend.successCallback(c, e, d, a, b) : d.nearDateDirectRecommendCallback = function() {
                                    nearDateDirectRecommend.successCallback(c, e, d, a, b)
                                }
                            },
                            onerror: function() {
                                d.loadNearOnlineFinished = !0
                            }
                        })
                    }
                }
            },
            lpSugUbt: function(a, b, c) {
                if (a && "D" === this.flightWay && "builtUp" === this.flightType && $(online.getParentsByClass(a, b)).length > 0) {
                    var d, e, f, g = {
                        LP: "lowestprice",
                        DLP: "directprice",
                        ELP: "dayprice"
                    };
                    "J_lowPriceTitle" === b ? (d = $(a), e = $(a.parentNode.parentNode)) : (d = $(online.getParentsByClass(a, b)), e = $(d[0].parentNode)),
                    /suggest/i.test(e.attr("class")) && (f = g[d.attr("type")], f && this.lpSuggestUbt.cheapinfo[f][c]++)
                }
            },
            getProductTypeID: function(a) {
                return "" == a.attr("data-category") && (a.attr("data-fid") || a.attr("data-rel")) ? "20": "" == a.attr("data-category") && "\u7279\u522b\u63a8\u8350" == a.parentNode().parentNode().find(".seat-special").text().trim() ? "21": "2" == a.attr("data-category") && 0 == a.parentNode().parentNode().find(".tag-business").length ? "0": a.attr("data-category") || ""
            },
            getProductType: function(a) {
                var b = a.find(".seat-special");
                return 0 == b.childNodes().length ? "\u65e0": "tag-business" == b.find("span:first-child").attr("class") ? "\u5546\u52a1\u4f18\u9009": 0 != b.find(".tag-text").length || "tag-onlyText" == b.find("span:first-child").attr("class") ? b.find("span:first-child").text() : 0 != b.find("img").length || "tag-hk" == b.find("span:first-child").attr("class") ? b.find(":first-child").attr("data-params").match(/[^\x00-\xff]/g).toString().replace(/,/g, "") : "\u672a\u77e5"
            },
            getPrice: function(a) {
                var b = a.find(".seat-price .price:first"),
                c = b[0],
                d = "";
                return c && (d = (c.textContent || c.innerText || "").replace(/\D/, "").trim()),
                d
            },
            reportFilterCond: function(a) {
                for (var b, c, d = {},
                e = 0,
                f = this.ubtReportFilters.length; f > e; e++) if (c = this.ubtReportFilters[e], b = $(c[0]).find(c[2]), 0 != b.length) {
                    d[c[1]] = [];
                    for (var g = 0,
                    h = b.length; h > g; g++) d[c[1]].push($(b[g]).nextSibling().text().trim())
                }
                return d
            },
            getCurrentSortText: function() {
                for (var a, b = $("#sortControls .sorts"), c = 0, d = b.length; d > c; c++) if (a = $(b[c]), "block" == a.css("display")) return a.find(".sort-item-active span").text().trim();
                return ""
            },
            ubtReportFilters: [["#OwnerAirlineName", "Airline", ".checkbox-icon-checked"], ["#Alliance", "Alliance", ".checkbox-icon-checked"], ["#TransferTime", "StopCity", ".checkbox-icon-checked"], ["#DurationTime", "StopHour", ".checkbox-icon-checked"], ["#Eligibility", "PassengerType", ".radio-icon-checked"], ["#DPort", "FromAirPort", ".checkbox-icon-checked"], ["#APort", "ToAirPort", ".checkbox-icon-checked"], ["#TransferCount", "IsDirect", ".checkbox-icon-checked"], ["#DepartTime", "DepartTime", ".checkbox-icon-checked"], ["#DDepartTime", "ToDepartTime", ".checkbox-icon-checked"], ["#ADepartTime", "BackDepartTime", ".checkbox-icon-checked"], ["#ArrivalTime", "ArrivalTime", ".checkbox-icon-checked"], ["#DArrivalTime", "ToArrivalTime", ".checkbox-icon-checked"], ["#AArrivalTime", "BackArrivalTime", ".checkbox-icon-checked"], ["#ClassGradeFilterSection", "ClassGradeFilter", ".radio-icon-checked"]],
            reportSearchUBT: function(a, b) {
                var c = this,
                d = {
                    ProductTags: []
                };
                if (this.AddtionList && this.AddtionList.length > 0) {
                    var e = [];
                    this.AddtionList.each(function(a) {
                        var b = {};
                        b.XProduct = a.ProductName,
                        b.XProductPrice = a.UnitPrice,
                        b.IsChecked = a.isSelected ? "Y": "N",
                        e.push(b)
                    }),
                    d.XProduct = e
                }
                try {
                    "1" === a.attr("data-lowprice") && d.ProductTags.push("LowestPrice"),
                    d.AggCode = a.attr("token") || "";
                    var f = $(online.getParentsByClass(a[0], "seat-row")),
                    g = $(online.getParentsByClass(a[0], "flight-item"));
                    if (d.FlightNoSort = 0 == g.length ? "": $("#flightList .flight-item").indexOf(g) + 1, d.PriceSort = 0 == f.length ? "": g.find(".seat-row").indexOf(f) + 1, InternationalRecommend.saveFlightSortNo(d.FlightNoSort, b), InternationalRecommend.updateSort(b), d.IsTax = $("#sortControls label[for=tax]").hasClass("switch-label-checked") ? "N": "Y", d.ProductPrice = c.getPrice(f), d.OrigFlightNoSort = parseInt(g.attr("data-index")) + 1 || "", InternationalRecommend.saveOrigSelFlightNoSort(parseInt(g.attr("start-index")) + 1 || "", b), d.ProductType = c.getProductType(f), d.ProductTypeID = c.getProductTypeID(a), d.ShowProduct = [], g.find(".seat-row").each(function(a) {
                        var b = {};
                        b.ProductType = c.getProductType(a),
                        b.ProductTypeID = c.getProductTypeID(a.find("button.btn-book")),
                        b.ProductPrice = c.getPrice(a),
                        d.ShowProduct.push(b)
                    }), "none" == g.find(".seat-row-more").css("display") && g.find(".seat-row").length > 0) for (var h = 0,
                    i = g.find(".seat-row-more").find(".seat-row").length; i > h; h++) d.ShowProduct.pop();
                    0 == d.ShowProduct.length && delete d.ShowProduct,
                    d.Sort = c.getCurrentSortText(),
                    d.OrigSort = c.OrigSort,
                    d.Condition = c.reportFilterCond(),
                    InternationalRecommend.saveFilterCond(this),
                    $.storage.set("isCurrentMUFareSelect", "", 30);
                    var j = f.find(".tag_fare_info");
                    if ($.storage.set("isCurrentMUFareSelect", j.length > 0 ? "T": "", 30), $("#flightList .flight-bundle-suggest").length > 0 && (d.FlightNoSort -= $("#flightList .flight-bundle-suggest .flight-item").length), d.PageSubLocation = 0 == $("#currentStep").length ? "\u5355\u7a0b": $("#currentStep").text().replace(/\u3010/i, "").replace(/\u3011/i, ""), "D" === c.flightWay && ("freeStyle" === c.flightType ? d.PageLocation = "\u81ea\u7531\u642d\u914d": d.PageLocation = d.PageSubLocation = "\u5f80\u8fd4\u7ec4\u5408"), a.parentNode().hasClass("multidest-col-action")) d.FlightNoSort = 1,
                    d.PriceSort = 1,
                    d.ProductPrice = a.parentNode().parentNode().find("span.price").text().replace(/\W/, ""),
                    d.PageLocation = $(online.getParentsByClass(a[0], "multidest-recommend")).find(".multidest-recommend-title").text();
                    else if (online.getParentsByClass(a[0], "flight-bundle-suggest").length > 0) {
                        d.FlightNoSort = 1;
                        var k = $(online.getParentsByClass(a[0], "flight-bundle-suggest"));
                        "" == k.find(".tab-cur").html() ? d.PageLocation = k.find(".flight-bundle-title").text() : d.PageLocation = k.find(".tab-cur").text()
                    }
                    if (d.FlightNoSort <= 0 || d.PriceSort <= 0) throw "\u672a\u77e5\u7279\u6b8a\u4f4d\u7f6e\uff01";
                    if (d.FlightNoSort > 1) {
                        var l = [],
                        m = d.FlightNoSort > 10 ? 10 : d.FlightNoSort - 1;
                        this.container.find("[data-utoken]:lt(" + m + ")").each(function(a) {
                            l.push(decodeURIComponent(decodeURIComponent($(a).attr("data-utoken"))))
                        }),
                        d.ACList = l,
                        l = null
                    }
                    d.TriggerType = "Action",
                    window.__bfi.push(["_tracklog", "FlightNo_Check", $.stringifyJSON(d)])
                } catch(n) {
                    $.error("doBooking_ubt", "\u9884\u5b9a\u6309\u94ae\u57cb\u70b9\u51fa\u9519\uff0c\u4e0a\u62a5Key\u4e3aFlightNo_Check" + n + "\uff0c\u5f53\u524d\u7684jsonobj\u4e3a" + $.stringifyJSON(d), n)
                }
                c.reportProductSelectUBT()
            },
            cacheHKChooseTag: function(a, b) {
                try {
                    var c = $(online.getParentsByClass(a[0], "seat-row"));
                    c.find("span.tag-green").each(function(a) {
                        var c = a.attr("data-freeType");
                        switch (c) {
                        case "3":
                            b.hkTravelChooseProductTag = "\u901a\u6e2f\u8239\u7968";
                            break;
                        case "4":
                            b.hkTravelChooseProductTag = "\u901a\u6e2f\u8f66\u7968";
                            break;
                        case "34":
                            b.hkTravelChooseProductTag = "\u901a\u6e2f\u8f66\u8239\u7968"
                        }
                    })
                } catch(d) {
                    $.error("cacheHKChooseTag", "\u9884\u5b9a\u6309\u94ae\u57cb\u70b9\u51fa\u9519\uff0c\u4e0a\u62a5Key\u4e3aflt_oversea_search_result_online_basic" + d + "\uff0c\u5f53\u524d\u7684jsonobj\u4e3a" + $.stringifyJSON(jsonObj), d)
                }
            },
            cacheSelectedGiftTag: function(a, b) {
                try {
                    b.giftTagUbt.selected[b.curSegment] = "";
                    var c = $(online.getParentsByClass(a[0], "seat-row"));
                    c.find("span[data-gift-tag='1']").each(function(a) {
                        var c = a.attr("gift-tag-name");
                        b.giftTagUbt.selected[b.curSegment] = c,
                        b.giftTagUbt.selected = b.giftTagUbt.selected.slice(0, b.curSegment + 1)
                    })
                } catch(d) {
                    $.error("cacheSelectedGiftTag", d)
                }
            },
            isRoundTrip: function() {
                return "D" == this.flightWay
            },
            isOnewayTrip: function() {
                return "S" == this.flightWay
            },
            isRoundTripCombination: function() {
                return this.isRoundTrip() && "builtUp" == this.flightType
            },
            cacheSelectedGiftTagUbt: function(a) {
                var b = this.giftTagUbt.selected;
                if (b && b.length > 0) {
                    var c = b.join(",");
                    c.length > 1 && $.storage.set("SelectedGiftTagUbt_" + a, c, 5)
                }
            },
            cacheSelectedUpgradeRecommendTagUBT: function(a) {
                try {
                    if (!online.isUpgradeRecommendTagSwitchOpen() || this.searchGradeClassEqualsCOrF()) return;
                    var b;
                    b = this.isRoundTrip() ? this.upgradeTagUBT.roundTrip[this.flightType].selected: this.upgradeTagUBT.otherTrip.selected;
                    for (var c = [], d = {},
                    e = 0; e < b.length; e++) {
                        var f = b[e];
                        f && f.length > 0 && f.each(function(a) {
                            var b = a.Seq + "_" + a.Type;
                            d[b] || (c.push(a), d[b] = 1)
                        })
                    }
                    c.length > 0 && $.storage.set("CUpgradeRecommendTagUBT_" + a, c, 5)
                } catch(g) {}
            },
            updateStopoverRemindUBT: function() {
                try {
                    window.stopoverRemind && window.stopoverRemind.calcStopoverRemindDisplay()
                } catch(a) {
                    $.error("updateStopoverRemindUBT", "\u884c\u674e\u76f4\u6302\u63d0\u9192\u57cb\u70b9" + a, a)
                }
            },
            updateUpgradeRecommendTagUBT: function(a) {
                try {
                    if (!online.isUpgradeRecommendTagSwitchOpen() || this.searchGradeClassEqualsCOrF()) return;
                    var b, c;
                    if (this.isRoundTrip() ? (c = this.upgradeTagUBT.roundTrip[this.flightType], b = this.isRoundTripCombination() ? "\u5f80\u8fd4\u7ec4\u5408": 0 == this.curSegment ? "\u53bb\u7a0b": "\u8fd4\u7a0b") : (c = this.upgradeTagUBT.otherTrip, b = this.isOnewayTrip() ? "\u5355\u7a0b": "\u7b2c" + (this.curSegment + 1) + "\u7a0b"), a) {
                        var d = $(online.getParentsByClass(a[0], "seat-row")),
                        e = d.find("span[upgrade-tag='2']").length > 0 ? 1 : 0,
                        f = d.find("span[upgrade-tag='3']").length > 0 ? 1 : 0;
                        c.selected[this.curSegment] = [{
                            Type: "2",
                            Count: e,
                            Seq: b
                        },
                        {
                            Type: "3",
                            Count: f,
                            Seq: b
                        }]
                    } else {
                        var g = $("span[upgrade-tag='2']").length,
                        h = $("span[upgrade-tag='3']").length;
                        c.stats[this.curSegment] = [{
                            Type: "2",
                            Count: g,
                            Seq: b
                        },
                        {
                            Type: "3",
                            Count: h,
                            Seq: b
                        }]
                    }
                    for (var i = Math.max(c.stats.length, c.selected.length), j = this.curSegment + 1; i > j; j++) c.stats[j] = null,
                    c.selected[j] = null
                } catch(k) {
                    $.error("updateUpgradeRecommendTagUBT", "\u5217\u8868\u9875\u641c\u4f4e\u8231\u51fa\u9ad8\u8231\u63a8\u8350\u6807\u7b7e\u57cb\u70b9" + k, k)
                }
            },
            bindEvent: function() {
                function a() {
                    if (b.allowLoad) {
                        var a = (document.documentElement.scrollTop || document.body.scrollTop) + document.documentElement.clientHeight,
                        c = b.container.find(".flight-item:last").offset().bottom + 25;
                        a > c && (clearTimeout(d), b.checkPageControl(), b.curPage < b.maxPage && b.loadingList.removeClass("hide"), d = setTimeout(b.autoAdd.bind(b), 456))
                    }
                }
                var b = this;
                if (this.T = [], this.TK = {},
                this.container = $(this.container), this.loadingTips = $(this.loading).ohtml(), this.sortControl = $(this.sortControl), this.loadingList = $(this.loadingList), this.aptPanel = $(this.aptPanel), this.aptPanel.hide(), $(window).bind("beforeunload",
                function() {
                    b.reportUBTData()
                }), "D" !== this.flightWay && (delete this.UBTData.ReturnType, delete this.UBTData.LockFirstFlightTimes, delete this.UBTData.LockSecondFlightTimes), this.segmentPanel = $(this.segmentPanel), this.StepPanel = $(this.stepPanel), this.StepInfo = $(this.StepInfo), "S" !== this.flightWay) switch (this.UBTData.LeaveSegment = 1, this.container.onn("click", "reSearch",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    return $("#btnSearch")[0].click(),
                    !1
                }), this.segmentPanel.onn("click", "selected-modify",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    if (!b.isBooking) {
                        var c = $(this);
                        if (b.curSegment = 1 * c.attr("data-segment"), b.checkSegment(), b.addtionService.clearSaveData(!0), $(".subairport-recmd-banner").css("display", "block"), 0 === b.curSegment) return b.reset(),
                        b.segmentList.length = 0,
                        b.lowestPrice.length = 0,
                        b.searchFlights("Search"),
                        b.segmentPanel.slideUp(456),
                        void online.log("\u4fee\u6539\u7b2c\u4e00\u7a0b\u7684\u6570\u636e,\u76f4\u63a5\u9690\u85cf\u8be5\u9762\u677f!");
                        b.segmentList.splice(b.curSegment),
                        b.renderSegmentList(),
                        b.searchNextSegment(c.attr("data-token"))
                    }
                }), this.flightWay) {
                case "D":
                    "#builtUp" === location.hash ? (this.flightType = "builtUp", this.UBTData.ReturnType = "Combination", window.keepHash = !0, $("#departDate").html("\u53bb " + $("#departDate").html())) : this.flightType = "freeStyle",
                    this.container.onn("click", "checkbox-icon",
                    function(a) {
                        try {
                            a.stop()
                        } catch(a) {}
                        var c = "checkbox-icon-checked",
                        d = $(this).hasClass(c);
                        return b.UBTData["0" === $(this).attr("mode") ? "LockFirstFlightTimes": "LockSecondFlightTimes"]++,
                        b.stayTimeout && d === !1 ? void b.showTimeoutTips() : ($(this).toggleClass(c), b.reset(), b.isLocked = $(this).hasClass(c), document.body.scrollTop = document.documentElement.scrollTop = 0, b.isLocked ? (b.runTimes = 1, b.searchFlights(!1, {
                            context: {
                                SearchMode: "MoreFlight",
                                DisplayMode: "RoundTripGroup",
                                LockMode: "0" === $(this).attr("mode") ? "Depart": "Back",
                                Parameter: $(this).attr("param"),
                                condition: b.cond
                            }
                        })) : (b.runTimes = 0, b.searchFlights(!1, {
                            context: {
                                SearchMode: "Search",
                                DisplayMode: "RoundTripGroup",
                                condition: b.cond
                            }
                        })), void b.checkPageControl())
                    }),
                    this.StepPanel.find("a").bind("click",
                    function(a) {
                        try {
                            a.stop()
                        } catch(a) {}
                        var c = $(this);
                        if (b.fltTypeName = 0, !c.hasClass("active")) {
                            b.StepPanel.find(".active").removeClass("active"),
                            c.addClass("active"),
                            b.flightType = c.attr("data-type"),
                            location.hash = b.flightType,
                            window.keepHash = "builtUp" === b.flightType,
                            b.callback && b.callback(function(a) {
                                a.renderTCP()
                            }),
                            $("#result-wrapper b.icon:first")[0].className = window.keepHash ? "icon icon-round": "icon icon-oneway",
                            b.UBTData.ReturnType = window.keepHash ? "Combination": "Free",
                            b.UBTData[window.keepHash ? "ClickCombinationTimes": "ClickFreeTimes"]++,
                            b.sortControl.find(".switch-label-on.switch-label-checked").removeClass("switch-label-checked"),
                            b.sortControl.find(".switch-label-off").addClass("switch-label-checked"),
                            b.sortControl.find(".switch-selection").removeClass("switch-selection-on");
                            var d = b.loadFinish || b.curSegment > 0 || b.isLocked;
                            b.curSegment = 0,
                            b.checkSegment(),
                            d ? b.reset() : b.reset(1),
                            window.keepHash ? (b.isLastSegment = !0, $(".subairport-recmd-banner").css("display", "none")) : $(".subairport-recmd-banner").css("display", "block"),
                            b.segmentList.length = 0,
                            $("#result-wrapper")[window.keepHash ? "addClass": "removeClass"]("round-group");
                            var e = b.sortControl.find("ul");
                            e[window.keepHash ? 0 : 1].style.display = "none",
                            e[window.keepHash ? 1 : 0].style.display = "block";
                            var f = $(e[window.keepHash ? 1 : 0]).find("li.sort-item-active:first").removeClass("sort-item-active");
                            if ($(e[window.keepHash ? 1 : 0]).find("li.sort-item:first").addClass("sort-item-active"), f.each(function(a) {
                                a = $(a),
                                a.removeData("orderby");
                                try {
                                    a = a.find(".sort-item-handler")[0].firstChild,
                                    a && (a.nodeValue = a.nodeValue.split("\u4ece").shift())
                                } catch(b) {}
                            }), b.StepInfo[window.keepHash ? "hide": "show"](), b.setSortControlStyle(), d) window.keepHash ? (b.searchFlights(!1, {
                                context: {
                                    SearchIndex: 0,
                                    SearchMode: "Search",
                                    DisplayMode: "RoundTripGroup",
                                    condition: b.cond
                                }
                            }), window.stopoverRemind && window.stopoverRemind.clearRemindList(), b.isUpdateRemindtag = !0) : (b.searchFlights("Search"), window.stopoverRemind && window.stopoverRemind.clearRemindList(), b.isUpdateRemindtag = !0);
                            else {
                                var g = b.getCurFlightList();
                                g.each(function(a, c) {
                                    b.addToFilter(a)
                                }),
                                b.update()
                            }
                            b.addtionService.clearSaveData(),
                            b.addtionService.compareRule(b.flightList),
                            b.flightList.each(function(a, c) {
                                b.addToFilter(a)
                            }),
                            b.filterService.update(),
                            b.segmentPanel.slideUp(456)
                        }
                    });
                    break;
                case "M":
                    var c = this.StepPanel.find(".step-in:last");
                    c.html(c.html() + "\uff08\u9884\u8ba2\uff09"),
                    $(window).bind("hashchange",
                    function() {
                        if (!b.stayTimeout) {
                            var a = location.hash.match(/Segment_(\d+)/);
                            if (null === a) return void(b.curSegment > 0 && b.segmentPanel.find("a.selected-modify:first").click());
                            setTimeout(function() {
                                document.body.scrollTop = document.documentElement.scrollTop = $("#StepPanel").offset().top
                            },
                            40),
                            a = a.pop() >> 0,
                            a >= b.curSegment || b.segmentPanel.find("a.selected-modify:last").click()
                        }
                    })
                }
                if (this.container.onn("mouseover", "pickup-tag",
                function(a) {
                    pageGlobal.HoverFreePickUpCount = (pageGlobal.HoverFreePickUpCount || 0) + 1
                }), this.container.onn("mouseover", "pickup-tag-free",
                function(a) {
                    pageGlobal.HoverPrePosePickUpCount = (pageGlobal.HoverPrePosePickUpCount || 0) + 1
                }), this.sortControl.find("li.sort-item").bind("mouseover",
                function() {
                    $(this).addClass("hover")
                }).bind("mouseout",
                function() {
                    $(this).removeClass("hover")
                }), this.sortControl.onn("click", "sort-item",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    var c = $(this);
                    b.setSortByStyle(c),
                    b.saveOrderBy()
                }).onn("click", "switch-label",
                function(a) {
                    var c, d = $(this),
                    e = "switch-label-checked";
                    if (!d.hasClass(e)) {
                        var f = $(this.parentNode);
                        f.find("." + e).removeClass(e),
                        d.addClass(e),
                        "\u542b\u7a0e\u4ef7\u683c" == d.html() ? ($("#multLowPanel").find(".tabPriceMore").css("display", "inline-block"), $("#multLowPanel").find(".tabNoPriceMore").css("display", "none"), $("#multLowPanel").find(".tabPriceTax").css("display", "none")) : ($("#multLowPanel").find(".tabPriceMore").css("display", "none"), $("#multLowPanel").find(".tabNoPriceMore").css("display", "inline-block"), $("#multLowPanel").find(".tabPriceTax").css("display", "inline-block"));
                        var g = d.hasClass("switch-label-on");
                        if (c = g ? "switch-label-on": "switch-label-off", f.find("span")[g ? "addClass": "removeClass"]("switch-selection-on"), $("#J_TopCalendar .switch").length > 0 && "none" !== $("#J_TopCalendar .switch").css("display")) {
                            var h = $("#J_TopCalendar").find("." + c);
                            $("#J_TopCalendar .switch-label").removeClass(e),
                            h.addClass(e),
                            $("#J_TopCalendar .switch-selection")[g ? "addClass": "removeClass"]("switch-selection-on")
                        }
                        b.curType = g ? "TotalPrice": "Price",
                        ("Price" === b.sortKey || "TotalPrice" === b.sortKey) && (b.sortKey = b.curType),
                        b.sortUBTData.PriceDisplayWay = g ? "Include": "Default",
                        b.filterService.init();
                        var i = b.getCurFlightList();
                        b.addtionService.compareRule(i),
                        i.each(function(a) {
                            a.FareList.length > 1 && (a.FareList.sort(function(a, c) {
                                return a[b.curType] - c[b.curType]
                            }), b.updatePriceInfo(a, a.FareList[0]), b.reSortFareList(a.FareList)),
                            b.addToFilter(a)
                        }),
                        b.filterService && b.filterService.curFilter.length > 0 ? b.filterService.update(b.loadFinish) : b.update(),
                        b.saveOrderBy(),
                        setTimeout(function() {
                            b.callback && b.callback(function(a) {
                                a.update()
                            })
                        },
                        300)
                    }
                }), this.setSortControlStyle(), this.OrigSort = this.getCurrentSortText(), this.container.length > 0) {
                    b.autoAdd = function() {
                        if (b.curPage++>=b.maxPage) return b.allowLoad = !1,
                        b.checkPageControl(),
                        b.loadingList.addClass("hide"),
                        void $("#rec_cheap_box").show();
                        var a = this.getCurFlightList(!0);
                        if (pageGlobal.VirtualFlightSwitch) {
                            for (var c = [], d = 0; d < a.length; d++) {
                                var e = a[d];
                                e.ContainsVirtualFlight || c.push(e)
                            }
                            a = c
                        }
                        a = this.initRecommendGroup(a),
                        pageGlobal.IsOpenRecFltOptimizeSwitch && (a = this.setLowPainExponentFlcToTop(a)),
                        a = a.slice(b.curPage * b.pageSize, (b.curPage + 1) * b.pageSize);
                        var f = b.commonDataHandler(b.travelInsurePreHandler(a));
                        pageGlobal.IsFilterFareByCategoryAndClassGrade && (f = b.sortFareByCategoryAndClassGrade(f)),
                        pageGlobal.IsOpenTransPU && b.renderTransPUConfigedText(f),
                        b.updateFlightImg(f),
                        fragment = document.createDocumentFragment(),
                        div = document.createElement("div"),
                        div.innerHTML = $.tmpl.render(b.tmpl, {
                            newPriceTips: ("S" == b.flightWay ? "": "D" == b.flightWay ? "\u5f80\u8fd4": "\u591a\u7a0b") + (b.isMultiTrave ? "\u4eba\u5747": "") + ("TotalPrice" === b.curType ? "\u542b\u7a0e\u4ef7": "\u7968\u4ef7"),
                            flightWay: b.flightWay,
                            priceTmpl: b.priceTmpl,
                            lowPrice: b.lowPrice,
                            isLastSegment: b.isLastSegment,
                            list: f,
                            curType: b.curType,
                            addtionTmplVar: b.addtionService.addtionTmplVar
                        }),
                        fragment.appendChild(div),
                        b.container[0].appendChild(fragment),
                        b.addCallback(div),
                        b.updateUpgradeRecommendTagUBT(),
                        b.updateStopoverRemindUBT(),
                        a.length < b.pageSize && (b.allowLoad = !1, b.checkPageControl(), b.loadingList.addClass("hide"), $("#rec_cheap_box").show()),
                        b.fixedFreeInsureStyle()
                    };
                    var d;
                    $(window).bind("scroll", a)
                }
                this.bindCFDowngradeYSFoldEvent(),
                $("body").onn("click", "J_SRBooking",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    if (!b.isBooking) {
                        b.isRoundTrip() && !b.isRoundTripCombination() && 0 == b.curSegment && $(".subairport-recmd-banner").css("display", "none");
                        try {
                            if (this && this.getAttribute) {
                                if ($.storage.set("hasChoosedOWIntelligenceRec", ""), "isSuperFlyer" === this.getAttribute("data-isSuperFlyer") && 0 === b.curSegment) return SuperFlyerUbt.popBox(),
                                void b.popSuperFlyerBox(this, SuperFlyerUbt);
                                "1" === this.getAttribute("data-isOWIntelligenceRec") && $.storage.set("hasChoosedOWIntelligenceRec", "1", 30)
                            }
                            0 == b.curSegment && $.storage.set("listBookVirtualFlight", "");
                            var c = "\u9884\u8ba2" == $(this).html(),
                            d = online.getParentsByClass(this, "flight-item");
                            d && d.length && d[0].getAttribute && "1" == d[0].getAttribute("data-virtualflight") && $.storage.set("listBookVirtualFlight", "1", 30);
                            var e = $.storage.get("listBookVirtualFlight");
                            if (c) {
                                if (e) return $.storage.set("listBookVirtualFlight", ""),
                                $.storage.set("hasChoosedVirtualFlight", "1", 30),
                                void b.popVirtualFlightShouldKnowBox(!0, this, {});
                                $.storage.set("hasChoosedVirtualFlight", "", 30)
                            }
                        } catch(a) {}
                        b.handleBooking.call(this, b)
                    }
                }).onn("click", "icon-gallery",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    var c = $(this).attr("data-url");
                    c && ( - 1 != c.indexOf(",,") && (c = c.split(",,")), b.showAirlineImage(c))
                }),
                this.container.onn("click", "flight-action-more",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    var c = $(this.parentNode.nextSibling),
                    d = jQuery(c).parents("[data-utoken]"),
                    e = jQuery(c).children(".flight-detail-section"),
                    f = b.getCurFlightList(!1),
                    g = d.attr("data-utoken");
                    c.slideToggle(234,
                    function() {
                        if ("block" === $(this).css("display")) {
                            b.lpSugUbt(this, "flight-item", "flightdetail");
                            var a = c.find(".flight-detail-section");
                            a.each(function(a) {
                                a.find(".flight-No")
                            });
                            for (var d = {},
                            h = 0; h < f.length; h++) f[h].UToken == g && (d = f[h]);
                            $(document.body).data("flightComfort") || $(document.body).data("flightComfort", []);
                            var i = $(document.body).data("flightComfort");
                            if (jQuery.inArray(g, i) < 0 && g) {
                                if (!pageGlobal.HistoryPunctualityArrABTest && !pageGlobal.ArrdelaytimeABTest) return;
                                var j = ["FlightNo", "DCityName", "ACityName", "DepartTime", "ArrivalTime"],
                                k = {},
                                l = [],
                                m = [],
                                n = [];
                                if (d.FlightDetail) {
                                    for (var h = 0; h < d.FlightDetail.length; h++) m.push(jQuery.Deferred());
                                    n = d.FlightDetail
                                }
                                if (d.FlightInfo) for (var h = 0; h < d.FlightInfo.length; h++) for (var o = 0; o < d.FlightInfo[h].FlightDetail.length; o++) m.push(jQuery.Deferred()),
                                n.push(d.FlightInfo[h].FlightDetail[o]);
                                n.each(function(a, b) {
                                    j.each(function(b) {
                                        "DepartTime" == b ? k[b] = a[b].split(" ")[0] : k[b] = a[b]
                                    }),
                                    k.ArrivalTime = k.DepartTime,
                                    a.CarrierFlightNo && (k.FlightNo = a.CarrierFlightNo),
                                    $.ajax(online.getBaseUrl("AjaxRequest/SearchFlights/SearchFlightComfort.ashx"), {
                                        method: "POST",
                                        context: k,
                                        onsuccess: function(a, c) {
                                            m[b].resolve(c)
                                        },
                                        onerror: function() {
                                            m[b].resolve({})
                                        }
                                    }),
                                    k = {}
                                }),
                                jQuery.when.apply(jQuery, m).then(function(a) {
                                    var c = 0;
                                    for (l = arguments; c < arguments.length && !arguments[c]; c++);
                                    return c >= arguments.length ? void("S" == b.cond.FlightWay && b.flightComfortUbt(l, g)) : (i.push(g), $(document.body).data("flightComfort", i), b.renderFlightComfort(n, e, l), void("S" == b.cond.FlightWay && b.flightComfortUbt(l, g)))
                                })
                            }
                        }
                    }),
                    online.fltTrainUbt($(this)),
                    $(this).find(".icon-caret").toggleClass("icon-caret-up")
                }).onn("click", "btn-price-more",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    if (b.stayTimeout) return void b.showTimeoutTips();
                    var c = $(this);
                    if (c.data("loading") !== !0) {
                        b.UBTData.MorePriceTimes++;
                        var d = {
                            SearchMode: "MorePrice",
                            condition: b.cond,
                            Parameter: c.attr("param")
                        },
                        e = c.attr("key"),
                        f = c.data("isexpand") === !0,
                        g = $(c[0].parentNode.parentNode),
                        h = g.find("div.seat-row-more");
                        if (c.find("span").html(f ? '\u66f4\u591a\u4ef7\u683c<i class="icon-caret"></i>': '\u6536\u8d77<i class="icon-caret icon-caret-up"></i>'), c.data("isexpand", !f), "" === h.html()) {
                            var i = document.createElement("i");
                            i.className = "icon-loading-18",
                            i = $(i),
                            i.insertAfter(c),
                            c.data("loading", !0),
                            c.find("span").html("\u66f4\u591a\u4ef7\u683c"),
                            b.searchFlights(!1, {
                                context: d,
                                onsuccess: function(a, d) {
                                    if (i.remove(), i = null, c.removeData("loading"), d = $.parseJSON(d), d && d.MorePriceFlight) {
                                        var f = g.find("div.seats-list>div.seat-row").length || 0;
                                        d.exKey = {},
                                        f > 0 && g.find("div.seats-list .btn-book").each(function(a) {
                                            d.exKey[$(a).attr("pkey")] = 1
                                        }),
                                        d.MorePriceFlight.length > 0 ? (b.fixPrice(d.MorePriceFlight), b.addtionService.handleMoreFlight(d.MorePriceFlight), d.MorePriceFlight.length > 1 && d.MorePriceFlight.sort(function(a, c) {
                                            if ("Price" === b.curType) return a.Price - c.Price;
                                            if (a.Tax < 0) {
                                                if (c.Tax >= 0) return 1
                                            } else if (c.Tax < 0) return - 1;
                                            return a.TotalPrice - c.TotalPrice
                                        }), b.lpSugUbt(c[0], "flight-item", "moreprice"), h.html($.tmpl.render(b.morePriceTmpl, $.extend({},
                                        d, {
                                            curType: b.curType,
                                            isRoundTrip: "builtUp" === b.flightType ? 1 : 0,
                                            priceTmpl: b.priceTmpl,
                                            isLastSegment: b.isLastSegment,
                                            curSegment: b.curSegment,
                                            Key: e,
                                            addtionTmplVar: b.addtionService.addtionTmplVar
                                        }))).slideDown(), c.find("span").html('\u6536\u8d77<i class="icon-caret icon-caret-up"></i>'), 0 === h.find(".seat-row:first").length && c.hide()) : c.hide()
                                    } else c.hide();
                                    c = h = null
                                },
                                onerror: function() {
                                    c.removeData("loading"),
                                    i.remove(),
                                    c.hide(),
                                    i = c = h = null
                                }
                            })
                        } else h.slideToggle(function() {
                            "block" === $(this).css("display") && b.lpSugUbt(this, "flight-item", "moreprice")
                        })
                    }
                }).onn("click", "virtualFlightBuyShouldKnow",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    b.popVirtualFlightShouldKnowBox(!1, this, {})
                }).onn("mouseover", "ow-intellignece-rec-detail",
                function(a) {
                    pageGlobal.NewUbt.abandon_sequence || (pageGlobal.NewUbt.abandon_sequence = []);
                    var b = JSON.parse(decodeURIComponent($(a.target).attr("data-info"))),
                    c = (b.dTime, /([^\s]+)\s([^\s]+)/),
                    d = c.test(b.dTime),
                    e = d ? b.dTime.match(c)[1] : "";
                    pageGlobal.NewUbt.abandon_sequence.push({
                        From: {
                            CityName: b.dCityName
                        },
                        To: {
                            CityName: b.aCityName
                        },
                        StartTime: e
                    })
                }),
                window.__SSO_submit = function(a) {
                    try {
                        if (null === a) {
                            try {
                                $("#btnSearch")[0].click()
                            } catch(c) {
                                location.reload()
                            }
                            return
                        }
                        var d = $("#" + a);
                        b.doBooking(d)
                    } catch(c) {
                        $.warning(c, "__SSO_submit doBooking error")
                    }
                }
            },
            flightComfortUbt: function(a, b) {
                var c = "",
                d = "",
                e = $.storage.get("SelecedFlightComfort");
                if (a.length > 0) {
                    c = a[0].HistoryPunctualityArr ? a[0].HistoryPunctualityArr: "100%",
                    d = a[0].Arrdelaytime;
                    for (var f = 1; f < a.length; f++) parseFloat(a[f].HistoryPunctualityArr) < parseFloat(c) && (c = a[f].HistoryPunctualityArr),
                    Math.abs(a[f].Arrdelaytime) > Math.abs(d) && (d = a[f].Arrdelaytime);
                    "100%" == c && (c = null),
                    d || (d = null)
                } else c = null,
                d = null;
                e || (e = []),
                (c || d) && this.selectComfortFlight.push({
                    Punctuality_rate: c,
                    delay_time: d,
                    Utoken: b
                }),
                e.push({
                    Punctuality_rate: c,
                    delay_time: d
                }),
                $.storage.set("SelecedFlightComfort", e)
            },
            renderFlightComfort: function(a, b, c) {
                for (var d = [], e = [], f = 0; f < c.length; f++) if (c[f]) {
                    var g = $.parseJSON(c[f]),
                    h = "",
                    i = "";
                    h = g.HistoryPunctualityArr ? "\u5230\u8fbe\u51c6\u70b9\u7387" + g.HistoryPunctualityArr: "\u5230\u8fbe\u51c6\u70b9\u7387--",
                    d.push(h),
                    i = g.Arrdelaytime ? g.Arrdelaytime >= 0 ? "\u5e73\u5747\u5ef6\u8bef" + g.Arrdelaytime + "\u5206\u949f": "\u5e73\u5747\u63d0\u524d" + Math.abs(g.Arrdelaytime) + "\u5206\u949f": "",
                    e.push(i),
                    c[f] = $.parseJSON(c[f])
                } else {
                    var j = "",
                    k = "\u5230\u8fbe\u51c6\u70b9\u7387--";
                    d.push(k),
                    e.push(j),
                    c[f] = {
                        HistoryPunctualityArr: null,
                        Arrdelaytime: null
                    }
                }
                for (var l = "",
                f = 0; f < a.length && !c[f].HistoryPunctualityArr; f++);
                f > a.length && pageGlobal.ArrdelaytimeABTest ? b.each(function(a, b) {
                    c[a].Arrdelaytime && jQuery(b).find("p span:last").append('<span class="section-duration">' + i[a] + "</span>")
                }) : b.each(function(a, b) {
                    pageGlobal.HistoryPunctualityArrABTest && pageGlobal.ArrdelaytimeABTest ? c[a].Arrdelaytime ? (l = d[a] + " " + e[a], jQuery(b).find("p span:last").append('<span class="section-duration">' + l + "</span>")) : (l = d[a], jQuery(b).find("p span:last").append('<span class="section-duration">' + l + "</span>")) : !pageGlobal.HistoryPunctualityArrABTest && pageGlobal.ArrdelaytimeABTest ? c[a].Arrdelaytime && (l = e[a], jQuery(b).find("p span:last").append('<span class="section-duration">' + l + "</span>")) : pageGlobal.HistoryPunctualityArrABTest && !pageGlobal.ArrdelaytimeABTest && (l = d[a], jQuery(b).find("p span:last").append('<span class="section-duration">' + l + "</span>"))
                })
            },
            fixPrice: function(a) {
                var b = this,
                c = this.cond.Quantity + (this.cond.ChildQuantity || 0) + (this.cond.InfantQuantity || 0),
                d = this.cond.ChildQuantity || this.cond.InfantQuantity,
                e = 0,
                f = this.cond.Quantity && this.cond.ChildQuantity && this.cond.InfantQuantity;
                pageGlobal.MultiPassengerTypeSwitch && f && (d = this.cond.ChildQuantity || 0, e = this.cond.InfantQuantity || 0),
                a.each(function(a) {
                    if (a.PickUpList && a.PickUpList.length > 0) {
                        var g, h, i, j, k, l, m = {
                            3217 : "\u63a5\u673a",
                            3218 : "\u9001\u673a"
                        },
                        n = pageGlobal.CarConfig,
                        o = pageGlobal.PickUpTextConfig,
                        p = $.parseJSON(pageGlobal.CarTypeConfig),
                        q = pageGlobal.PickUpTitleConfig,
                        r = pageGlobal.PickupBenzId || "",
                        s = pageGlobal.PickupEconomicCarId || "",
                        t = (pageGlobal.PickupSpecialPackageHover || "").split("|"),
                        u = pageGlobal.PickupPackageCarNameConfig || "";
                        "D" === b.flightWay && n && (h = a.PickUpList.length > 1 ? n.TakeAndSendStr: n.SendStr, i = a.PickUpList.length > 1 ? n.TakeAndSendHover: n.SendHover, a.PickUpTagBUP = {
                            Text: h,
                            Content: i
                        }),
                        a.PickUpList.length > 1 ? (k = a.PickUpList[b.isLastSegment ? 1 : 0].CarType, l = k == s ? "": p[k] || "", j = online.replaceWith(t.length > 0 ? t[1] : "", {
                            BenzPic: k == r ? t[0] : "",
                            CarType: online.replaceWith(u, {
                                CarType: p[k] || ""
                            })
                        }), "D" === b.flightWay && "builtUp" === b.flightType ? (g = online.replaceWith(q, {
                            PickUpType: k == r ? "\u5954\u9a70": "\u63a5\u9001\u673a"
                        }), h = online.replaceWith(o.TakeAndSendStr, {
                            CarType: l
                        }), i = online.replaceWith(o.TakeAndSendHover, {
                            CarType: p[k] || ""
                        })) : "\u63a5\u673a" == (m[a.PickUpList[b.isLastSegment ? 1 : 0].PickUpType] || "") ? (g = online.replaceWith(q, {
                            PickUpType: k == r ? "\u5954\u9a70": "\u63a5\u673a"
                        }), h = online.replaceWith(o.TakeStr, {
                            CarType: l
                        }), i = online.replaceWith(o.TakeHover, {
                            CarType: p[k] || ""
                        })) : (g = online.replaceWith(q, {
                            PickUpType: k == r ? "\u5954\u9a70": "\u9001\u673a"
                        }), h = online.replaceWith(o.SendStr, {
                            CarType: l
                        }), i = online.replaceWith(o.SendHover, {
                            CarType: p[k] || ""
                        })), a.PickUpTagNOR = {
                            Title: g,
                            Text: h,
                            Content: i,
                            HoverDes: j
                        }) : (3218 === a.PickUpList[0].PickUpType || 3217 === a.PickUpList[0].PickUpType) && (k = a.PickUpList[0].CarType, l = k == s ? "": p[k] || "", j = online.replaceWith(t.length > 0 ? t[1] : "", {
                            BenzPic: k == r ? t[0] : "",
                            CarType: online.replaceWith(u, {
                                CarType: p[k] || ""
                            })
                        }), "\u63a5\u673a" == m[a.PickUpList[0].PickUpType] ? (g = online.replaceWith(q, {
                            PickUpType: k == r ? "\u5954\u9a70": "\u63a5\u673a"
                        }), h = online.replaceWith(o.TakeStr, {
                            CarType: l + "\u8fd4\u7a0b"
                        }), i = online.replaceWith(o.TakeHover, {
                            CarType: p[k] || ""
                        })) : (g = online.replaceWith(q, {
                            PickUpType: k == r ? "\u5954\u9a70": "\u9001\u673a"
                        }), h = online.replaceWith(o.SendStr, {
                            CarType: l + "\u53bb\u7a0b"
                        }), i = online.replaceWith(o.SendHover, {
                            CarType: p[k] || ""
                        })), a.PickUpTagNOR = {
                            Title: g,
                            Text: h,
                            Content: i,
                            HoverDes: j
                        })
                    }
                    if (b.isMultiTrave) {
                        var v = 0;
                        a.AdultTax < 0 || a.ChildTax < 0 || (a.InfTax || 0) < 0 ? a.Tax = -1 : v = pageGlobal.MultiPassengerTypeSwitch && f ? (((a.AdultTax || 0) + (a.AdultOilFee || 0)) * b.cond.Quantity + ((a.ChildTax || 0) + (a.ChildOilFee || 0)) * d + ((a.InfTax || 0) + (a.InfOilFee || 0)) * e) / c: (((a.AdultTax || 0) + (a.AdultOilFee || 0)) * b.cond.Quantity + ((a.ChildTax || 0) + (a.ChildOilFee || 0)) * d) / c;
                        var w = 0;
                        w = pageGlobal.MultiPassengerTypeSwitch && f ? (a.AdultPrice * b.cond.Quantity + (a.ChildPrice || 0) * d + (a.InfPrice || 0) * e) / c: (a.AdultPrice * b.cond.Quantity + a.ChildPrice * d) / c;
                        var x = w + (0 > v ? 0 : v);
                        x = Math.ceil(Math.ceil(100 * x) / 100),
                        w = Math.ceil(Math.ceil(100 * w) / 100),
                        a.AdultTax < 0 || a.ChildTax < 0 || (a.InfTax || 0) < 0 || (v = Math.ceil(Math.ceil(100 * v) / 100), a.Tax = v),
                        a.Price = w,
                        a.TotalPrice = x
                    } else a.TotalPrice = a.Price + (a.Tax < 0 ? 0 : a.Tax + (a.OilFee || 0));
                    a.pkey = [a.Price, a.Tax, a.ClassName || "Mult"].join("_")
                }),
                a.length > 1 && a.sort(function(a, c) {
                    return a[b.curType] - c[b.curType]
                })
            },
            setSortByStyle: function(a) {
                var b = a.attr("data-sortby"),
                c = a.data("orderby");
                this.prevSortKey = this.sortKey;
                var d = this.sortUBT,
                e = this.BSortUbt,
                f = this;
                c = void 0 === c || "desc" === c ? "asc": "desc",
                f.orderBy = c;
                var g = "Default";
                if ("TransferCount" === b ? f.orderBy = "asc": (g = [b, c].join("_"), a.data("orderby", c)), f.sortUBTData.SortWay = d[g].ubt, a.hasClass("sort-item-active") === !1) {
                    var h = f.sortControl.find("li.sort-item-active").removeClass("sort-item-active");
                    h.each(function(a) {
                        a = $(a),
                        a.removeData("orderby");
                        try {
                            a = a.find(".sort-item-handler")[0].firstChild,
                            a && (a.nodeValue = a.nodeValue.split("\u4ece").shift()),
                            a = a.find("span i"),
                            a.length > 0 && (a[0].className = "icon-sort"),
                            h = h.find("span i"),
                            h.length > 0 && (h[0].className = "icon-sort")
                        } catch(b) {}
                    })
                }
                h = a.find(".sort-item-handler"),
                h.length > 0 && (h[0].firstChild.nodeValue = ("builtUp" === f.flightType && "Price" === b ? e: d)[g].title),
                a.addClass("sort-item-active");
                var i = a.find("span i");
                i.length > 0 && (i[0].className = "asc" === f.orderBy ? "icon-sort": "icon-reverse"),
                b && (("Price" === b || "TotalPrice" === b) && (b = f.curType), f.update(b)),
                InternationalRecommend.sortHelper(this, "Sort_Final", b)
            },
            saveOrderBy: function(a) {
                a = $.storage.get(window.name + "OrderBy") || {};
                var b = "";
                "D" === this.flightWay && "builtUp" === this.flightType && (b = "D"),
                a[b + "sortKey"] = this.sortKey,
                a[b + "orderBy"] = this.orderBy,
                a[b + "curType"] = this.curType,
                a[b + "id"] = this.getSegmentList(),
                $.storage.set(window.name + "OrderBy", a, 1440)
            },
            getSegmentList: function() {
                var a, b = [];
                return a = "M" !== this.cond.FlightWay ? [this.cond.SegmentList[0]] : this.cond.SegmentList,
                a.each(function(a, c) {
                    b.push(a.DCityCode),
                    b.push(a.ACityCode)
                }),
                b.join("-")
            },
            setSortControlStyle: function() {
                var a, b = this,
                c = !1,
                d = $.storage.get(window.name + "OrderBy") || {};
                a = "builtUp" === this.flightType && "D" === this.flightWay ? d.DsortKey || "": d.hasOwnProperty("sortKey") ? d.sortKey: d.DsortKey || "",
                InternationalRecommend.sortHelper(this, "Sort_Default", a || this.sortKey),
                InternationalRecommend.sortHelper(this, "Sort_Final", a || this.sortKey),
                "D" === this.flightWay && "builtUp" === this.flightType && (c = !0);
                var e = c ? "D": "";
                d[e + "id"] !== this.getSegmentList() && (e = "none"),
                this.curType = d[e + "curType"] || "TotalPrice",
                this.sortKey = d[e + "sortKey"] || "TransferCount",
                this.orderBy = d[e + "orderBy"] || "asc",
                this.lastSortType = [this.sortKey, this.orderBy].join("_");
                var f, g = this.sortControl.find("ul"),
                h = this.sortUBT,
                i = this.BSortUbt;
                $("#result-wrapper")[c ? "addClass": "removeClass"]("round-group"),
                g[c ? 0 : 1].style.display = "none",
                g[c ? 1 : 0].style.display = "block";
                var j = $(g[c ? 1 : 0]).find("li.sort-item-active:first").removeClass("sort-item-active"),
                k = $(g[c ? 1 : 0]);
                if (f = k.find('[data-sortby="' + this.sortKey + '"]'), ("TotalPrice" == this.sortKey || "Price" == this.sortKey) && (f = k.find('[data-sortby="Price"]')), "TotalPrice" == this.curType) {
                    var l = this.sortControl.find(".switch-label:eq(1)"),
                    m = "switch-label-checked";
                    this.sortControl.find(".switch-label-checked").removeClass("switch-label-checked"),
                    l.addClass(m);
                    var n = l.hasClass("switch-label-on"),
                    o = l.parentNode();
                    o.find("span")[n ? "addClass": "removeClass"]("switch-selection-on")
                }
                if (j = f.find(".sort-item-handler"), j.length > 0) {
                    var p = b.lastSortType;
                    p.indexOf("TotalPrice") > -1 && (p = p.replace("TotalPrice", "Price")),
                    j[0].firstChild.nodeValue = ("builtUp" !== b.flightType || "Price" !== this.sortKey && "TotalPrice" !== this.sortKey ? h: i)[p].title
                }
                f.addClass("sort-item-active"),
                f.data("orderby", b.orderBy);
                var q = f.find("span i");
                q.length > 0 && (q[0].className = "asc" === b.orderBy ? "icon-sort": "icon-reverse")
            },
            checkSegment: function() {
                var a;
                switch (this.flightWay) {
                case "D":
                    a = this.StepPanel.find(".roundtrip-status:first span"),
                    a.removeClass("status-active"),
                    $(a[this.curSegment]).addClass("status-active");
                    break;
                case "M":
                    a = this.StepPanel.find(".multidest-step"),
                    a.addClass("step-done").filter(":gt(" + this.curSegment + ")").removeClass("step-done")
                }
                this.StepInfo.length > 0 && this.segmentTitle[this.flightWay][this.curSegment] && this.StepInfo.html("\u3010" + this.segmentTitle[this.flightWay][this.curSegment] + "\u3011"),
                "S" !== this.flightWay && (this.UBTData.LeaveSegment = this.curSegment + 1),
                this.isLastSegment = this.curSegment + 1 >= this.maxSegment || "D" === this.flightWay && "builtUp" === this.flightType
            },
            checkPageControl: function() {
                this.pageControl && this.pageControl.panel[this.isLocked || this.allowLoad || this.curSegment > 0 || this.isLoadingHide > 0 ? "hide": "show"]()
            },
            getNextSegment: function(a) {
                this.hideDownGradeTip();
                var b = a.attr("key"),
                c = this.getCurFlightList();
                if (void 0 === this.flightKey[b]) return void online.log("\u83b7\u53d6\u4e0b\u4e00\u7a0b\u6570\u636e\u65f6,\u4f20\u9012\u7684key\u4e0d\u6b63\u786e." + b);
                var d = c[this.flightKey[b]];
                if (void 0 === d) return void online.log("\u83b7\u53d6\u4e0b\u4e00\u7a0b\u6570\u636e\u65f6,\u4f20\u9012\u7684key\u4e0d\u5b58\u5728\u4e8eflightList\u4e2d." + b);
                if (this.Depflight = d, 1 !== pageGlobal.IsRebook) {
                    var e = ["FlightNo", "DPortName", "APortName", "DepartTime", "ArrivalTime", "FlightTime"],
                    f = {};
                    e.each(function(a) {
                        f[a] = d[a]
                    }),
                    d.IsSingleAirline === !1 && (f.FlightNo = d.IsSameAirline ? "\u591a\u4e2a\u822a\u73ed": "\u591a\u4e2a\u822a\u53f8"),
                    f.Token = a.attr("token"),
                    f.Stop = d.TransferCount < 2 ? "\u76f4\u98de": d.TransferCount - 1 + "\u7a0b\u4e2d\u8f6c",
                    d.HasTrain && (f.FlightNo = "\u7a7a\u94c1\u7ec4\u5408", f.Stop = d.FlightDetail[0].ACityName + " \u6362\u4e58", f.DPortName = d.FlightDetail[0].DPortName + "\u706b\u8f66\u7ad9"),
                    this.segmentList.push(f),
                    this.renderSegmentList(),
                    this.curSegment++,
                    this.checkSegment(),
                    this.searchNextSegment(f.Token, a.attr("data-iswifipackage"), a.attr("data-TravelInsurePre"))
                } else try {
                    window.opener && window.opener.online && window.opener.online._searchFlight_ && (opener.online._searchFlight_.onCallBlack($.tmpl.render('{"airline":"${item.OwnerAirline}", "airlinenumber":"${item.FlightNo}", "deptime":"${item.DepartTime}", "arrtime":"${item.ArrivalTime}", "drpsubclass":"${ClassName}"}', {
                        item: d,
                        ClassName: a.attr("seatType")
                    })), self.close())
                } catch(g) {}
            },
            searchNextSegment: function(a, b, c) {
                c = c || "",
                "M" === this.flightWay ? location.hash = "Segment_" + this.curSegment: setTimeout(function() {
                    document.body.scrollTop = 0
                },
                30),
                this.reset();
                var d = {
                    SearchMode: "NextSegment",
                    SegmentNo: this.curSegment + 1,
                    condition: this.cond,
                    Parameter: a
                };
                "D" === this.flightWay && 1 === this.downgradeStatus && (d.condition = $.extend({},
                this.cond), d.condition.ClassGrade = "Y_S"),
                d.condition.IsWifiPackage = b ? 1 : 0,
                d.condition.TravelInsurePre = $.parseJSON(decodeURIComponent(c)),
                this.searchFlights(!1, {
                    context: d
                })
            },
            renderSegmentList: function() {
                this.segmentPanel.html($.tmpl.render(this.segmentTmpl, {
                    title: this.segmentTitle[this.flightWay],
                    lists: this.segmentList
                })),
                this.segmentPanel.slideDown(456),
                pageGlobal.NewUbt.TriggerType = "Load"
            },
            reportUBTData: function() {
                try {
                    var a = $.extend({},
                    pageGlobal.Ubt, this.UBTData, this.sortUBTData, this.filterUBTData),
                    b = [];
                    for (var c in a) a.hasOwnProperty(c) && b.push(c + "=" + a[c]);
                    b = b.join("&"),
                    window.__bfi.push(["_tracklog", "flt_oversea_lowerprice_module", $.stringifyJSON(this.lpSuggestUbt)]),
                    pageGlobal.NewUbt.TriggerType = "Exit",
                    InternationalRecommend.saveFilterCond(this),
                    InternationalRecommend.reportFirstRP("Exit", this),
                    online.setNewUbtSpecial("IsShowFlightAndTrain", "none" === $("#TransferCount .hide-on-notrain").css("display") ? 0 : 1);
                    var d = $("span[data-tipstype='LoungePre']").length;
                    d > 0 && (pageGlobal.NewUbt.ProductTags = [{
                        Type: 1,
                        Count: d
                    }]);
                    var e = $("span[data-freetype='3']").length,
                    f = $("span[data-freetype='4']").length,
                    g = $("span[data-freetype='34']").length,
                    h = $("span[data-freetype='5']").length,
                    i = $("span[data-freetype='6']").length;
                    if ((f > 0 || e > 0 || g > 0 || h > 0 || i > 0) && (pageGlobal.NewUbt.ShowProductTags = [{
                        Title: "\u901a\u6e2f\u8f66\u7968",
                        Amount: f
                    },
                    {
                        Title: "\u901a\u6e2f\u8239\u7968",
                        Amount: e
                    },
                    {
                        Title: "\u901a\u6e2f\u8f66\u8239\u7968",
                        Amount: g
                    },
                    {
                        Title: "\u514d\u8d39\u63a5\u9001\u673a\u5238",
                        Amount: i
                    },
                    {
                        Title: "\u514d\u8d39\u503c\u673a",
                        Amount: h
                    }], pageGlobal.NewUbt.ChooseProductTag = this.hkTravelChooseProductTag), this.cacheDisplayGiftTagUbt(), this.calcDisplayGiftTagUbt(), this.saveDowngradeUBT(), this.saveUpgradeRecommendTagUBT(), this.saveStopoverRemindUBT(), pageGlobal.NewUbt.FltTypeName = this.fltTypeName, pageGlobal.NewUbt.HoverFreePickUp = pageGlobal.HoverFreePickUpCount || 0, pageGlobal.NewUbt.HoverPrePosePickUpCount = pageGlobal.HoverPrePosePickUpCount || 0, pageGlobal.FreePickUpCount || (pageGlobal.FreePickUpCount = $(".pickup-package").length), pageGlobal.NewUbt.ContainFreePickUp = (pageGlobal.FreePickUpCount || 0) > 0 ? 1 : 0, this.recommendGroupDataUbt) for (var j in this.recommendGroupDataUbt) this.recommendGroupDataUbt[j] && this.recommendGroupDataUbt[j].length > 0 && (pageGlobal.NewUbt.RecommendProduct = (pageGlobal.NewUbt.RecommendProduct || []).concat(this.recommendGroupDataUbt[j]));
                    pageGlobal.VirtualFlightSwitch && ($("#virtualFlightHeader").length ? pageGlobal.NewUbt.virtual_flight = 1 : pageGlobal.NewUbt.virtual_flight = 0),
                    pageGlobal.OWIntelligenceRecSwitch && (pageGlobal.NewUbt.abandon_filter_checked = $("#OWIntelligenceRecCheckBox").hasClass("checkbox-icon-checked") ? 1 : 0),
                    NoResultRecommendUbt.beforeReport(),
                    pageGlobal.NewUbt.product_info = "",
                    pageGlobal.NewUbt.anniversary_sale = 0;
                    for (var k = this.getCurFlightList(), l = 0; l < k.length; l++) for (var m = k[l].FareList, n = 0; n < m.length; n++) m[n].ProductType && m[n].ProductType.indexOf("highSpeed") >= 0 && pageGlobal.NewUbt.product_info.indexOf("\u6781\u901f\u51fa\u7968") < 0 && (pageGlobal.NewUbt.product_info += "\u6781\u901f\u51fa\u7968"),
                    m[n].ProductType && m[n].ProductType.indexOf("todayRefund") >= 0 && pageGlobal.NewUbt.product_info.indexOf("\u7504\u9009\u670d\u52a1") < 0 && ("" != pageGlobal.NewUbt.product_info && (pageGlobal.NewUbt.product_info += ","), pageGlobal.NewUbt.product_info += "\u7504\u9009\u670d\u52a1"),
                    m[n].ProductType && m[n].ProductType.indexOf("anniversarySale") >= 0 && 0 == pageGlobal.NewUbt.anniversary_sale && (pageGlobal.NewUbt.anniversary_sale = 1);
                    this.reportMultipleTicketsUbt(),
                    window.__bfi.push(["_tracklog", "flt_oversea_search_result_online_basic", $.stringifyJSON(pageGlobal.NewUbt)]),
                    SuperFlyerUbt.canReport() && window.__bfi.push(["_tracklog", FLT_OVERSEA_FLOAT_CLICK_KEY, $.stringifyJSON(superFlyerLocalUbt)]),
                    this.loadFinish && "undefined" != typeof pageGlobal.Campaign && pageGlobal.Campaign && this.marketCurLowPrice != this.constNum && this.marketChangeFilter && window.__bfi.push(["_tracklog", "flt_overseas_adprice", $.stringifyJSON(this.inlandAdPrice)]),
                    b && window.__bfi.push(["_tracklog", pageGlobal.Ubt.Key, b]),
                    pageGlobal.HKMacaoAD && IntlFlightAdvertiseUBT.uploadDisplayUbt(0)
                } catch(o) {}
            },
            reportMultipleTicketsUbt: function() {
                var a = this.getCurFlightList(),
                b = !1;
                a.length > 0 ? a.forEach(function(a) {
                    a.FareList.forEach(function(a) {
                        a.TransMultiPUInfo ? b = !0 : void 0
                    })
                }) : void 0,
                window.pageGlobal.NewUbt.multiple_tickets = b ? 1 : 0,
                window.pageGlobal.NewUbt.multiple_tickets_protection_show = window.pageGlobal.NewUbt.multiple_tickets_protection_show || 0,
                window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_show = window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_show || 0,
                window.pageGlobal.NewUbt.multiple_tickets_protection_click = window.pageGlobal.NewUbt.multiple_tickets_protection_click || 0,
                window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_click = window.pageGlobal.NewUbt.multiple_tickets_protection_reserve_click || 0
            },
            cacheDisplayGiftTagUbt: function() {
                try {
                    var a = $("span[data-gift-tag='1']"),
                    b = {};
                    a && a.length > 0 && a.each(function(a) {
                        var c = a.attr("gift-tag-name");
                        b[c] ? b[c].Amount++:b[c] = {
                            Title: c,
                            Amount: 1
                        }
                    }),
                    this.giftTagUbt.display[this.curSegment] = b,
                    this.giftTagUbt.display = this.giftTagUbt.display.slice(0, this.curSegment + 1)
                } catch(c) {
                    $.error("cacheDisplayGiftTagUbt", c)
                }
            },
            calcDisplayGiftTagUbt: function() {
                try {
                    var a = this.giftTagUbt.display;
                    if (a && a.length > 0) {
                        for (var b = {},
                        c = !1,
                        d = 0; d < a.length; d++) {
                            var e = a[d];
                            for (var f in e) c = !0,
                            b[f] ? b[f].Amount += e[f].Amount: b[f] = e[f]
                        }
                        if (c) {
                            pageGlobal.NewUbt.ShowProductTags = pageGlobal.NewUbt.ShowProductTags || [];
                            for (var f in b) pageGlobal.NewUbt.ShowProductTags.push(b[f])
                        }
                    }
                } catch(g) {
                    $.error("calcDisplayGiftTagUbt", g)
                }
            },
            saveStopoverRemindUBT: function() {
                window.stopoverRemind && window.stopoverRemind.saveStopoverRemindUBT()
            },
            saveUpgradeRecommendTagUBT: function() {
                if (online.isUpgradeRecommendTagSwitchOpen() && !this.searchGradeClassEqualsCOrF()) {
                    pageGlobal.NewUbt.ProductTags || (pageGlobal.NewUbt.ProductTags = []);
                    var a = [this.upgradeTagUBT.roundTrip.freeStyle.stats, this.upgradeTagUBT.roundTrip.builtUp.stats, this.upgradeTagUBT.otherTrip.stats],
                    b = {};
                    a.each(function(a) {
                        for (var c = 0; c < a.length; c++) {
                            var d = a[c];
                            d && d.length > 0 && d.each(function(a) {
                                var c = a.Seq + "_" + a.Type;
                                b[c] || (pageGlobal.NewUbt.ProductTags.push(a), b[c] = 1)
                            })
                        }
                    })
                }
            },
            saveDowngradeUBT: function() {
                if (!this.isOpenCFNoDirectRecommendYS() && this.downgradeUBT.isDowngrade) {
                    var a = [];
                    if (this.downgradeUBT.onewayTrip.type) {
                        var b = "M" == this.flightWay ? "\u591a\u7a0b": "\u5355\u7a0b";
                        a.push({
                            Type: this.downgradeUBT.onewayTrip.type,
                            Quantity: this.downgradeUBT.onewayTrip.quantity,
                            PageLocation: b
                        })
                    } else this.downgradeUBT.freeStyle.type && a.push({
                        Type: this.downgradeUBT.freeStyle.type,
                        Quantity: this.downgradeUBT.freeStyle.quantity,
                        PageLocation: "\u81ea\u7531\u642d\u914d\u53bb\u7a0b"
                    }),
                    this.downgradeUBT.builtUp.type && a.push({
                        Type: this.downgradeUBT.builtUp.type,
                        Quantity: this.downgradeUBT.builtUp.quantity,
                        PageLocation: "\u5f80\u8fd4\u7ec4\u5408"
                    });
                    for (var c = 0; c < a.length; c++) pageGlobal.NewUbt.RecommendProduct.push(a[c]);
                    return void $.storage.set("_DowngradeUBT", a, 2)
                }
                if (this.recommendGroupDataUbt) {
                    var d = [];
                    for (var e in this.recommendGroupDataUbt) {
                        var f = this.recommendGroupDataUbt[e];
                        "array" === $.type(f) && f.length > 0 && (d = d.concat(f))
                    }
                    if (d.length > 0) return void $.storage.set("_DowngradeUBT", d, 2)
                }
                $.storage.set("_DowngradeUBT", null, 0)
            },
            setTimer: function(a) {
                clearTimeout(this.stayTimer),
                this.stayTimeout = !1,
                this.stayTimer = setTimeout(function() {
                    this.allowLoad = !1,
                    this.stayTimeout = !0,
                    this.loadingList.addClass("hide")
                }.bind(this), a || this.stayTime)
            },
            showTimeoutTips: function(a, b) {
                var c = $("#stayTimeoutTips");
                c.length > 0 && (c.unmask(), c.remove()),
                window.scrollTo(0, 0),
                c = document.createElement("div"),
                c.className = "modal-message",
                c.id = "stayTimeoutTips",
                c.style.display = "none",
                c.style.width = "490px",
                c.innerHTML = '<div class="modal-message-header"><h3>\u6e29\u99a8\u63d0\u793a</h3></div><div class="modal-message-body"><p><i class="icon-info-24"></i> ' + (a || "\u5f88\u62b1\u6b49\uff0c\u60a8\u7684\u505c\u7559\u65f6\u95f4\u8fc7\u957f\uff0c\u822a\u73ed\u53ca\u4ef7\u683c\u4fe1\u606f\u53ef\u80fd\u53d1\u751f\u53d8\u52a8\uff0c\u6b63\u5728\u8fdb\u884c\u91cd\u65b0\u641c\u7d22\uff01") + "</p></div><br/>",
                document.body.appendChild(c),
                c = $(c),
                c.mask(),
                setTimeout(function() {
                    c.unmask(),
                    c.remove(),
                    c = null;
                    try {
                        $("#btnSearch")[0].click()
                    } catch(a) {}
                },
                b || 2500)
            },
            showAirlineImage: function(a) {
                return this.showPictureService ? void this.showPictureService.show(a) : void $LAB.script(getUrl("NewResultShowPicture.js")).wait(function() {
                    this.showPictureService = online.$c("service.NewResult.ShowPicture"),
                    this.showAirlineImage(a)
                }.bind(this))
            },
            checkFlyTime: function(a, b, c, d) {
                var e = this.getBJTime(),
                f = function() {
                    online.registerMod.validateObj.method("show", {
                        $obj: a,
                        isScroll: !1,
                        errorClass: "",
                        data: online.msg.DATETIME_TIPS[0],
                        hideEvent: "blur",
                        isFocus: !1
                    })
                },
                g = new Date(b.replace(/-/g, "/")),
                h = g.getTime() - e.getTime(),
                i = h / 1e3 / 60;
                if (c && c >= i) return f(),
                !1;
                if (!d || -1 === ",1,2,30,32,".indexOf("," + d + ",")) {
                    var j = this.makeTime(0, 20, 30, e),
                    k = this.makeTime(0, 8, 0, e),
                    l = e >= j ? this.makeTime(1, 10, 0, e) : k >= e ? this.makeTime(0, 10, 0, e) : null;
                    if (l && l > g) return f(),
                    !1
                }
                return ! 0
            },
            makeTime: function(a, b, c, d) {
                return d.toDate().addDays(a).addHours(b).addMinutes(c)
            },
            getBJTime: function(a) {
                var b = new Date;
                return new Date(b.getTime() + 6e4 * b.getTimezoneOffset() + 36e5 * (a || 8))
            },
            extendAddList: function(a, b) {
                if (a && !(a.length < 1)) {
                    var c, d, e = a.attr("data-new3x-type") || "";
                    e && b && (b.New3xType = e);
                    var f = a.attr("data-new3x-fid");
                    c = a.attr("data-fid"),
                    d = {},
                    c ? (d = this.addtionService.getSaveData(c), "object" === $.type(d) && (d.addtionIdList && d.addtionIdList.length > 0 || d.fullAddtionList && d.fullAddtionList.length > 0) && (b.AddtionIdList = d.addtionIdList, b.FullAddtionList = d.fullAddtionList, b.ProductAddtionList = d.fullAddtionList, b.New3xType || (b.New3xType = "bangding"), a.data("c3x", d.addtionList), this.addtionService.clearSaveData())) : f && (d = this.addtionService.getSaveData(f), "object" === $.type(d) && (d.addtionIdList && d.addtionIdList.length > 0 || d.fullAddtionList && d.fullAddtionList.length > 0) && (b.ProductAddtionList = d.fullAddtionList)),
                    b.New3xType || (b.New3xType = "unbangding")
                }
            },
            CRateUBT: function(a, b) {
                if (a && !(a.length < 1) && b) {
                    var c, d = {};
                    if (c = a.data("c3x")) {
                        var e = [];
                        c.each(function(a) {
                            e.push({
                                XProduct: a.ProductType,
                                XProductPrice: a.SalesPrice,
                                XProductName: a.ProductName,
                                IsDefault: a.IsDefault,
                                IsChecked: a.isSelected
                            })
                        }),
                        d.addtionList = e,
                        c = null
                    }
                    $.storage.set("CRate_" + b, d, 10)
                }
            },
            doBooking: function(a) {
                var b = {
                    SearchMode: "Book",
                    condition: this.cond,
                    Parameter: a.attr("token") || LastToken[0] || !1
                };
                if (1 == this.downgradeStatus && (b.condition = $.extend({},
                this.cond), b.condition.ClassGrade = "Y_S"), b.Parameter && !this.bookingLock) {
                    this.bookingLock = !0,
                    "D" === this.flightWay && "builtUp" === this.flightType && (b.BookMode = "RoundTripGroup"),
                    (null !== a.attr("data-time") || LastToken[1]) && (b.IsFlayer = "T"),
                    a.attr("data-IsWifiPackage") ? b.condition.IsWifiPackage = 1 : b.condition.IsWifiPackage = 0;
                    var c = jQuery(a[0]).closest("div.seat-row");
                    b.condition.TravelInsurePre = $.parseJSON(decodeURIComponent(a.attr("data-TravelInsurePre"))),
                    b.condition.IsNewImpower = !1;
                    var d = jQuery(a[0]).closest("div.seat-row").find("div.seat-special img.newAirlineLogo");
                    d && d.length > 0 && (b.condition.IsNewImpower = !0),
                    b.condition.FreeInsure = null;
                    var e = c.attr("data-freeins-code"),
                    f = c.attr("data-freeins-typeid");
                    e && f && (b.condition.FreeInsure = {
                        ProductCode: e,
                        TypeID: f
                    }),
                    b.condition.IsLowPrice = !1,
                    a.attr("data-lowprice") && (b.condition.IsLowPrice = !0);
                    var g = this;
                    this.extendAddList(a, b.condition),
                    online.fltTrainUbt(a),
                    this.searchFlights(!1, {
                        context: b,
                        onsuccess: function(b, c) {
                            if (g.bookingLock = !1, c = $.parseJSON(c), c && c.isLogin === !1) return void online.checkLogin(a.attr("id"));
                            if (c && c.SearchStatus) if (0 === c.SearchStatus.Result) {
                                var d;
                                $("#mkt_header").value().length > 0 && c.OrderURL.indexOf(".aspx") >= 0 && (d = "&mkt_header=" + $("#mkt_header").value()),
                                pageGlobal && pageGlobal.NewUbt && (pageGlobal.NewUbt.ShowAD || pageGlobal.NewUbt.ViewAD) && $.storage.set("_SearchResultBannerADV", {
                                    ShowAD: pageGlobal.NewUbt.ShowAD,
                                    ViewAD: pageGlobal.NewUbt.ViewAD
                                },
                                30);
                                try {
                                    g.CRateUBT(a, c.OrderID),
                                    g.cacheSelectedUpgradeRecommendTagUBT(c.OrderID),
                                    g.cacheSelectedGiftTagUbt(c.OrderID)
                                } catch(e) {
                                    $.error("booking ubt error", e)
                                }
                                location.href = c.OrderURL + (d || "")
                            } else c.SearchStatus.ErrorMsg ? online.registerMod.validate(a, c.SearchStatus.ErrorMsg, {
                                errorClass: "xxxxx"
                            }) : (online.registerMod.validate(a, "\u7cfb\u7edf\u7e41\u5fd9,\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5.", {
                                errorClass: "xxxxx"
                            }), $.error("doBooking", $.stringifyJSON(c)))
                        },
                        onerror: function(b) {
                            g.bookingLock = !1,
                            online.registerMod.validate(a, "\u7cfb\u7edf\u7e41\u5fd9,\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5!", {
                                errorClass: "xxxxx"
                            }),
                            $.error("doBooking_onerror", b ? b.responseText: "")
                        }
                    })
                }
            },
            updateGiftTagConfigs: function(a) {
                if (!online.GIFT_TAG_CONFIGS && a && a.length > 0) {
                    online.GIFT_TAG_CONFIGS = {};
                    for (var b = 0; b < a.length; b++) {
                        var c = a[b];
                        online.GIFT_TAG_CONFIGS[c.k] = c.v
                    }
                }
            },
            searchFlights: function(a, b, c) {
                var d = this,
                e = {
                    method: "POST",
                    context: {
                        SearchMode: a || "TokenSearch",
                        condition: this.cond
                    },
                    onsuccess: function(a, c) {
                        d.searchCallback(b, c)
                    },
                    onerror: function(a) {
                        d.searchCallback(b)
                    }
                };
                switch (b = $.extend(e, b), "string" != typeof b.context.SearchMode && (b.context.SearchMode = "TokenSearch"), b.context.SearchMode) {
                case "Search":
                case "MoreFlight":
                case "NextSegment":
                    this.reqSequence++
                }
                if (b.SearchIndex = "number" == typeof a ? a: this.reqSequence, "Search" === b.context.SearchMode) {
                    if ("D" === this.flightWay && this.checkCache()) return void this.setTimer(this.stayTime - ((new Date).getTime() - Cache[this.flightType].t));
                    delete this.cond.MaxSearchCount
                }
                if ("D" === this.flightWay && ("builtUp" === this.flightType || this.curSegment < 1) && (b.context.DisplayMode = "RoundTripGroup"), "TokenSearch" === b.context.SearchMode) {
                    if (this.searchTimes >= this.searchTokens.length) return;
                    b.context.SearchToken = this.searchTokens[this.searchTimes++]
                }
                if ($("#ab_testing_tracker").length && (b.context.ABTString = $("#ab_testing_tracker").value()), $.ajax(online.getBaseUrl(this.url), b), "TokenSearch" === b.context.SearchMode && this.searchTimes < this.searchTokens.length && setTimeout(function() {
                    d.searchFlights(b.SearchIndex)
                },
                0), this.closeAirportrecommendCity && this.isRoundTrip() && 1 == this.curSegment) {
                    var f = this.airportRecommendCity;
                    this.changeCondition(f.ACity, f.DCity)
                }
            },
            searchCallback: function(a, b) {
                if (void 0 === a.context.SegmentNo && (a.context.SegmentNo = 0), a.SearchIndex === this.reqSequence) {
                    try {
                        NoResultRecommendUbt.networkException(b)
                    } catch(c) {}
                    if (b && null !== (b = $.parseJSON(b)) && b.SearchStatus) {
                        if (103 === b.SearchStatus.Result) return this.showTimeoutTips("\u5f88\u62b1\u6b49\uff0c\u60a8\u7684\u67e5\u8be2\u6761\u4ef6\u4e0d\u6b63\u786e\uff0c\u6b63\u5728\u8fdb\u884c\u91cd\u65b0\u641c\u7d22\uff01"),
                        void NoResultRecommendUbt.addIsFailed(!0);
                        0 === b.SearchStatus.Result && (NoResultRecommendUbt.addIsFailed(!1), b.PartitionToken && a.context.SearchMode in this.AllowMode && b.PartitionToken.length > 0 && this.searchTokens.length < this.searchMax && (this.searchTokens = this.searchTokens.concat(b.PartitionToken), this.searchTokens.splice(this.searchMax), this.searchFlights(a.SearchIndex)), this.needDropResultForDowngrade(b) && this.dropSearchResult(b), this.filterTransitFlightIfDowngrade(b), this.handleDowngradeForSingleClassSearch(b), this.updateGiftTagConfigs(b.GiftTagConfigDict), b.FlightList && b.FlightList.length > 0 && ("D" !== this.flightWay || "builtUp" !== this.flightType) ? this.updateFlightList(b.FlightList, a.context, b.AirlinePackageDic) : b.RoundTripFlightList && "D" === this.flightWay && this.updateFlightList(b.RoundTripFlightList, a.context, b.AirlinePackageDic, b), this.updateDowngradeStatus(b), b.LowestPriceGroup && this.lowestPriceCombination(b.LowestPriceGroup), b.AirlineGift && this.uniqueGift(b.AirlineGift), b.Eligibility && b.Eligibility.length > 0 && b.Eligibility.each(function(a) {
                            void 0 === this.aptitudeList[a] && this.aptitudes[a] && (this.aptitudeList[a] = this.aptitudes[a])
                        }.bind(this)))
                    }
                    "TokenSearch" === a.context.SearchMode && this.searchFinishTimes++,
                    this.checkIsLoadFinish()
                }
            },
            isSingleClassDowngradeStatus: function(a) {
                return a && 100 == a.ReturnCode
            },
            dropSearchResult: function(a) {
                delete a.FlightList,
                delete a.RoundTripFlightList,
                online.log("drop search result")
            },
            handleDowngradeForSingleClassSearch: function(a) {
                if (this.isSingleClassGradeSearchSwitchOpen() && (a.FlightList && a.FlightList.length > 0 || a.RoundTripFlightList && a.RoundTripFlightList.length > 0) && this.isSingleClassSearch()) {
                    var b = this.isSingleClassDowngradeStatus(a);
                    if ( - 1 == this.downgradeStatus) b ? (this.downgradeStatus = 2, this.downgradeUBT.isDowngrade = !0) : (this.downgradeStatus = 0, this.downgradeUBT.isDowngrade = !1);
                    else if (0 == this.downgradeStatus && b) this.dropSearchResult(a);
                    else if (2 == this.downgradeStatus && !b) {
                        var c = this.getCurFlightList();
                        c && c.length > 0 && (this.clearCurrentState(!0, !1), this.hideDownGradeTip(), this.downgradeStatus = 0, this.downgradeUBT.isDowngrade = !1)
                    }
                }
            },
            isOneWayOrRoundTrip: function() {
                return "D" == this.flightWay || "S" == this.flightWay
            },
            isSingleClassGradeSearchSwitchOpen: function() {
                return pageGlobal.IsOpenSingleClassGradeSearch
            },
            downgradePreCondition: function() {
                return this.isSingleClassGradeSearchSwitchOpen() && this.isSingleClassSearch() || this.isDowngradeSwitchOpen() && this.isOneWayOrRoundTrip() && this.searchGradeClassEqualsCOrF()
            },
            updateDowngradeStatus: function(a) {
                if (! ( - 1 != this.downgradeStatus || this.isSingleClassSearch() || this.curSegment > 0) && this.downgradePreCondition()) {
                    var b = this.getCurFlightList();
                    b && b.length > 0 && (this.isDowngradeReturnCode(a) ? (this.downgradeStatus = 1, this.downgradeUBT.isDowngrade = !0) : (this.downgradeStatus = 0, this.downgradeUBT.isDowngrade = !1))
                }
            },
            filterTransitFlightIfDowngrade: function(a) {
                if (this.downgradePreCondition()) {
                    var b = this.isDowngradeReturnCode(a);
                    if (b || "D" == this.flightWay && this.curSegment > 0 && 1 == this.downgradeStatus && (b = !0), b) if (a.FlightList && a.FlightList.length > 0) {
                        var c = [];
                        a.FlightList.each(function(a) {
                            a.TransferCount && 1 == a.TransferCount && c.push(a)
                        }),
                        a.FlightList = c
                    } else if (a.RoundTripFlightList && a.RoundTripFlightList.length > 0 && a.FlightInfoDic) for (var d in a.FlightInfoDic) {
                        var e = a.FlightInfoDic[d];
                        e && e.TransferCount && e.TransferCount > 1 && delete a.FlightInfoDic[d]
                    }
                }
            },
            searchGradeClassEqualsCOrF: function() {
                var a = window.condition && window.condition.ClassGrade || "Y_S";
                return "C_F" === a || "C" === a || "F" === a
            },
            searchGradeClassEqualsYOrS: function() {
                var a = window.condition && window.condition.ClassGrade || "Y_S";
                return "S" === a || "Y" === a
            },
            isSingleClassSearch: function() {
                var a = window.condition && window.condition.ClassGrade || "Y_S";
                return 1 == a.length
            },
            isDowngradeReturnCode: function(a) {
                return a && 3 == a.ReturnCode
            },
            isSingleClassDowngradeReturnCode: function(a) {
                return a && 100 == a.ReturnCode
            },
            needDropResultForDowngrade: function(a) {
                if (!this.downgradePreCondition()) return ! 1;
                if (this.curSegment > 0) return ! 1;
                var b = this.getCurFlightList();
                return b && 0 != b.length ? -1 == this.downgradeStatus ? !1 : 1 == this.downgradeStatus ? !this.isDowngradeReturnCode(a) : this.isDowngradeReturnCode(a) : !1
            },
            isOpenCFNoDirectRecommendYS: function() {
                return pageGlobal.IsOpenCFNoDirectRecommendYS && this.searchGradeClassEqualsCOrF()
            },
            showDownGradeTipIfDownGrade: function(a) {
                if (this.downgradePreCondition() && !(this.needHideDowngradeTip || 1 != this.downgradeStatus && 2 != this.downgradeStatus || this.isOpenCFNoDirectRecommendYS())) {
                    if (!this.isSingleClassSearch() && this.curSegment > 0) return void this.hideDownGradeTip();
                    if (a && a.length > 0) {
                        var b = window.condition.ClassGrade,
                        c = {
                            C_F: ["\u516c\u52a1/\u5934\u7b49\u8231", "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231"],
                            C: ["\u516c\u52a1\u8231", "\u5934\u7b49\u8231"],
                            F: ["\u5934\u7b49\u8231", "\u516c\u52a1\u8231"],
                            Y: ["\u7ecf\u6d4e\u8231", "\u8d85\u7ea7\u7ecf\u6d4e\u8231"],
                            S: ["\u8d85\u7ea7\u7ecf\u6d4e\u8231", "\u7ecf\u6d4e\u8231"]
                        } [b];
                        $("#downgradeFromClass").html(c[0]),
                        $("#downgradeToClass").html(c[1]),
                        $("#downgradeTip").show(),
                        ("Y" == b || "S" == b) && NoResultRecommendUbt.addType(RECOMMENDTYPE_YS_SWAP)
                    } else this.hideDownGradeTip()
                }
            },
            isDowngradeSwitchOpen: function() {
                return pageGlobal && pageGlobal.DowngradeRecommendSwitch
            },
            updateDowngradeUBT: function() {
                if (this.isDowngradeSwitchOpen() && !this.isOpenCFNoDirectRecommendYS() && this.downgradeUBT.isDowngrade && 0 == this.curSegment) {
                    var a = this.getCurFlightList(),
                    b = 0;
                    a && a.length > 0 && (b = a.length);
                    var c, d = window.condition.ClassGrade,
                    e = {
                        FC: "SY",
                        C: "F",
                        F: "C",
                        Y: "S",
                        S: "Y"
                    };
                    c = "C_F" == d ? "FC": d;
                    var f = e[c];
                    this.doUpdateDowngradeUBT(c, f, b)
                }
            },
            doUpdateDowngradeUBT: function(a, b, c) {
                var d;
                a && b && (this.downgradeUBT.isDowngrade = !0, d = "4_" + a + "_" + b),
                this.downgradeUBT.isDowngrade && ("S" == this.flightWay || "M" == this.flightWay ? (d && (this.downgradeUBT.onewayTrip.type = d), c && (this.downgradeUBT.onewayTrip.quantity = c)) : "D" == this.flightWay && this.downgradeUBT[this.flightType] && (d && (this.downgradeUBT[this.flightType].type = d), c && (this.downgradeUBT[this.flightType].quantity = c)))
            },
            hideDownGradeTip: function() {
                try {
                    $("#downgradeTip").hide()
                } catch(a) {}
            },
            lowestPriceCombination: function(a) {
                "M" === this.flightWay && this.curSegment >= 1 && this.lowestPrice && this.lowestPrice.length > 0 && (this.lowestPrice = []),
                a.Fare && (this.fixPrice([a.Fare]), this.lowestPrice.push(a))
            },
            sortNumber: function(a, b) {
                return a.Fare.TotalPrice - b.Fare.TotalPrice
            },
            updateFlightList: function(a, b, c, d) {
                var e = 0,
                f = this,
                g = this.PIPOpen,
                h = !(!d || !d.FlightInfoDic),
                i = "",
                j = "",
                k = null;
                if (a && a.length > 0 && a.each(function(a) {
                    if (! ("undefined" == typeof a.FareList || a.FareList.length < 1)) {
                        if (a.FareList.each(function(a) {
                            return a.PrimaryClassInfoList && 0 != a.PrimaryClassInfoList.length ? (i = "", 1 == a.PrimaryClassInfoList.length && (i = a.PrimaryClassInfoList[0].ClassGrade), a.PrimaryClassInfoList.length > 1 && (f.isRoundTripCombination() ? (j = a.PrimaryClassInfoList[0].ClassGrade + a.PrimaryClassInfoList[1].ClassGrade, j.indexOf("Y") >= 0 ? i = "Y": j.indexOf("S") >= 0 ? i = "S": j.indexOf("C") >= 0 ? i = "C": j.indexOf("F") >= 0 && (i = "F")) : f.isRoundTrip() ? a.PrimaryClassInfoList[f.curSegment] && (i = a.PrimaryClassInfoList[f.curSegment].ClassGrade) : a.PrimaryClassInfoList.each(function(a) {
                                return a.SegmentNo == f.curSegment + 1 ? (i = a.ClassGrade, !1) : void 0
                            })), void f.setFareClassGrade(a, i)) : !0
                        }), h && "undefined" != typeof a.FlightInfoKeys) {
                            a.FlightInfo = [];
                            for (var k; k = a.FlightInfoKeys.shift();) {
                                if (k = d.FlightInfoDic[k], "undefined" == typeof k) return;
                                a.FlightInfo.push(k)
                            }
                            delete a.FlightInfoKeys
                        }
                        "undefined" != typeof a.FlightInfo ? a.Key = a.FlightInfo[0].FlightNoRoute + a.FlightInfo[0].TimetNoRoute + "_" + (a.FlightInfo[1].FlightNoRoute + a.FlightInfo[1].TimetNoRoute) : a.Key = a.FlightNoRoute + a.TimetNoRoute,
                        1 === a.HasPartial && (a.Key += "P"),
                        f.fixPrice(a.FareList),
                        a.Mode = b.LockMode || 1,
                        a.Priority = a.Priority || 0,
                        f.parseFareClassGrade(a.FareList, a),
                        pageGlobal.IsOpenTransPU && f.formatFareTransCities(a.FareList);
                        var l = function(a) {
                            if (pageGlobal.OWIntelligenceRecSwitch && a && a.length) {
                                var b = [],
                                c = [],
                                d = 0;
                                return a.each(function(a) {
                                    a.IsOWIntelligenceRec ? c.push(a) : (b.push(a), a.IsGV || a.PassengerRestriction && (1 !== a.PassengerRestriction.MinPassengerCount || 9 !== a.PassengerRestriction.MaxPassengerCount) || d && !(a.TotalPrice < d) || (d = a.TotalPrice))
                                }),
                                c.length && c.each(function(a) {
                                    var c = !1;
                                    b.each(function(b) {
                                        return b.Parameter === a.Parameter ? void(c = !0) : void 0
                                    }),
                                    c || (b.length && !d || a.TotalPrice < d + (pageGlobal.OWIntelligenceRecComparePriceDelta || 0)) && b.push(a)
                                }),
                                b
                            }
                            return a
                        },
                        m = function(a) {
                            if (pageGlobal.OWIntelligenceRecSwitch && a && a.length) {
                                var b = [];
                                return a.each(function(a) {
                                    a.IsOWIntelligenceRec && b.push(a)
                                }),
                                b
                            }
                            return []
                        };
                        f.owIntelligenceRecFareDict || (f.owIntelligenceRecFareDict = {}),
                        f.owIntelligenceRecFareDict[a.Key] || (f.owIntelligenceRecFareDict[a.Key] = []);
                        var n = m(a.FareList),
                        o = $.extend(!0, [], a.FareList);
                        if ("undefined" == typeof f.flightKey[a.Key]) pageGlobal.ComparePriceByAttributeSwitch ? "M" == f.flightWay && 0 == f.curSegment && (a.FareList = f.NewcomparePrice.sortFareListByComparePrice(a.FareList)) : a.FareList = f.NewcomparePrice.getTheLowestPriceFareByCategoryAndClassGrade(a.FareList),
                        a.FareList = l(f.owIntelligenceRecFareDict[a.Key].concat(a.FareList)),
                        a.FareList && a.FareList.length && (f.flightList[f.flightKey[a.Key] = f.flightList.length] = a);
                        else {
                            f.flightList.each(function(a, b) {
                                f.flightKey[a.Key] = b
                            });
                            var p = f.flightList[f.flightKey[a.Key]];
                            f.fixFlightInfo(p, a),
                            pageGlobal.ComparePriceByAttributeSwitch ? (a.FareList = p.FareList.concat(a.FareList), 0 != f.curSegment || a.ContainsVirtualFlight || (a.FareList = f.NewcomparePrice.sortFareListByComparePrice(a.FareList))) : a.FareList = f.NewcomparePrice.getTheLowestPriceFareByCategoryAndClassGrade(p.FareList.concat(a.FareList)),
                            a.FareList = l(f.owIntelligenceRecFareDict[a.Key].concat(a.FareList)),
                            a.FareList && a.FareList.length ? f.flightList[f.flightKey[a.Key]] = a: (delete f.flightList[f.flightKey[a.Key]], delete f.flightKey[a.Key])
                        }
                        if (f.owIntelligenceRecFareDict[a.Key] = f.owIntelligenceRecFareDict[a.Key].concat(n), pageGlobal.OWIntelligenceRecSwitch) {
                            a.ContainsOWIntelligenceRec = !1,
                            a.FareListWithoutOWIntelligenceRec = [],
                            a.FareListWithOWIntelligenceRec = a.FareList;
                            for (var q = 0; q < a.FareList.length; q++) {
                                var r = a.FareList[q];
                                r && !r.IsOWIntelligenceRec && a.FareListWithoutOWIntelligenceRec.push(r)
                            }
                            a.ContainsOWIntelligenceRec = a.FareListWithoutOWIntelligenceRec.length < a.FareList.length,
                            a.OnlyOWIntelligenceRecFare = 0 === a.FareListWithoutOWIntelligenceRec.length
                        }
                        if (a.FareList = f.sortFareListByCurType(a.FareList), f.updatePriceInfo(a, a.FareList[0]), f.reSortFareList(a.FareList), f.getAirlinePackageInfo(a.FareList, c), g && a.IsMorePrice !== !0) for (var s = a.FareList.length; s--;) if (2 === a.FareList[s].PlanCategory) {
                            a.IsMorePrice = a.FareList[s].IsMorePrice || !1,
                            a.IsMorePrice && (a.MorePriceParameter = a.FareList[s].Parameter);
                            break
                        }
                        if (e++, "undefined" != typeof a.FlightInfo) {
                            var t = a.FlightInfo[0],
                            u = a.FlightInfo[1];
                            f.fixData(t),
                            f.fixData(u),
                            ["DepartTime", "ArrivalTime"].each(function(b) {
                                a["D" + b] = t[b],
                                a["A" + b] = u[b]
                            }),
                            t.Alliance && u.Alliance && t.Alliance === u.Alliance && (a.Alliance = t.Alliance),
                            t.OperatingAlliance && u.OperatingAlliance && t.OperatingAlliance === u.OperatingAlliance && (a.OperatingAlliance = t.OperatingAlliance),
                            a.TransferCount = Math.max(t.TransferCount, u.TransferCount),
                            a.HasTrain = t.HasTrain || u.HasTrain,
                            a.FlightTime = t.FlightTime + u.FlightTime,
                            a.PainExponent = t.PainExponent + u.PainExponent
                        } else f.fixData(a);
                        if (a.PainExponent += a.TotalPrice, a.TotalPainExponent = a.PainExponent, f.hideMorePrice && delete a.IsMorePrice, "D" === f.flightWay && f.runTimes < 1 && a.FlightInfo) {
                            var v = {},
                            w = "FlightGift,FareList,Price,Tax,OilFee,TotalPrice,IsFlayer,FlightPriority".split(",");
                            if (w.each(function(b) {
                                "FareList" == b ? v[b] = $.extend(!0, [], a[b]) : v[b] = a[b]
                            }), v.ContainsVirtualFlight = !1, a.FlightInfo[f.curSegment] && a.FlightInfo[f.curSegment].FlightDetail && a.FlightInfo[f.curSegment].FlightDetail.length) for (var x = 0; x < a.FlightInfo[f.curSegment].FlightDetail.length; x++) {
                                var y = a.FlightInfo[f.curSegment].FlightDetail[x];
                                if (y && y.IsVirtualFlight) {
                                    v.ContainsVirtualFlight = !0;
                                    break
                                }
                            }
                            if (pageGlobal.ComparePriceByAttributeSwitch && (v.FareList = o, v.FareList.each(function(a) {
                                a.IsNeedDel && delete a.IsNeedDel,
                                a.IsCompared && delete a.IsCompared,
                                a.StandardPriceFare && delete a.StandardPriceFare
                            })), v.FareList.each(function(a) {
                                a.Declaration && (a.Declaration.SharedFlight = a.Declaration.ShareFlightExtend),
                                a.AirLinePackageInfoDict && a.AirLinePackageInfoDict[2] && delete a.AirLinePackageInfoDict[2]
                            }), v.Dec = 0, v.Key = a.FlightInfo[0].FlightNoRoute + a.FlightInfo[0].TimetNoRoute, f.parseFareClassGrade(v.FareList), void 0 === f.TK[v.Key]) f.T[f.TK[v.Key] = f.T.length] = v;
                            else {
                                f.T.each(function(a, b) {
                                    f.TK[a.Key] = b
                                });
                                var p = f.T[f.TK[v.Key]];
                                v.TotalPainExponent = p.TotalPainExponent,
                                f.fixFlightInfo(p, v),
                                pageGlobal.ComparePriceByAttributeSwitch && !p.ContainsVirtualFlight ? v.FareList = f.NewcomparePrice.sortFareListByComparePrice(p.FareList.concat(v.FareList)) : v.FareList = f.NewcomparePrice.getTheLowestPriceFareByCategoryAndClassGrade(p.FareList.concat(v.FareList)),
                                f.T[f.TK[v.Key]] = v
                            }
                            v.FareList = f.sortFareListByCurType(v.FareList),
                            f.updatePriceInfo(v, v.FareList[0]),
                            f.reSortFareList(v.FareList),
                            f.getAirlinePackageInfo(v.FareList, c),
                            w = "FlightDetail,CrossDay,IsShowFlyer,FlightTime,TransferCount,OwnerAirline,OwnerAirlineName,Priority".split(","),
                            w.each(function(b) {
                                v[b] = a.FlightInfo[0][b]
                            }),
                            f.fixData(v),
                            v.PainExponent += v.TotalPrice,
                            v.TotalPainExponent ? v.TotalPainExponent > a.PainExponent && (v.TotalPainExponent = a.PainExponent) : v.TotalPainExponent = a.PainExponent
                        }
                    }
                }), pageGlobal.OWIntelligenceRecSwitch) {
                    pageGlobal.NewUbt.flight_sum = 0,
                    pageGlobal.NewUbt.flight_abandon_sum = 0,
                    pageGlobal.NewUbt.lowest_abandon_price = 0,
                    pageGlobal.NewUbt.lowest_abandon_total_price = 0,
                    pageGlobal.NewUbt.lowest_price_without_abandon = 0,
                    pageGlobal.NewUbt.lowest_total_price_without_abandon = 0;
                    var l = f.flightList;
                    pageGlobal.NewUbt.flight_sum = l.length;
                    for (var m = 0; m < l.length; m++) for (var n = l[m].FareList, o = !1, p = 0; p < n.length; p++) {
                        var q = n[p];
                        q.IsOWIntelligenceRec ? (o || (o = !0, pageGlobal.NewUbt.flight_abandon_sum++), (!pageGlobal.NewUbt.lowest_abandon_price || q.Price < pageGlobal.NewUbt.lowest_abandon_price) && (pageGlobal.NewUbt.lowest_abandon_price = q.Price), (!pageGlobal.NewUbt.lowest_abandon_total_price || q.Price < pageGlobal.NewUbt.lowest_abandon_total_price) && (pageGlobal.NewUbt.lowest_abandon_total_price = q.TotalPrice)) : ((!pageGlobal.NewUbt.lowest_price_without_abandon || q.Price < pageGlobal.NewUbt.lowest_price_without_abandon) && (pageGlobal.NewUbt.lowest_price_without_abandon = q.Price), (!pageGlobal.NewUbt.lowest_total_price_without_abandon || q.Price < pageGlobal.NewUbt.lowest_total_price_without_abandon) && (pageGlobal.NewUbt.lowest_total_price_without_abandon = q.TotalPrice))
                    }
                }
                if (pageGlobal.IsOpenCFNoDirectRecommendYS && (this.flightList && this.flightList.length > 0 && (k = this.initRecommendGroup(this.flightList, {
                    isOnlyFilter: !0
                }), this.flightList != k && (this.flightList = k, this.flightList.each(function(a, b) {
                    var c = f.findLowPrice(a.FareList);
                    c && f.updatePriceInfo(a, c),
                    f.flightKey[a.Key] = b
                }))), this.T && this.T.length > 0 && (k = this.initRecommendGroup(this.T, {
                    isOnlyFilter: !0
                }), this.T != k && (this.T = k, this.T.each(function(a, b) {
                    var c = f.findLowPrice(a.FareList);
                    c && f.updatePriceInfo(a, c),
                    f.TK[a.Key] = b
                })))), e > 0) if (this.filterService) {
                    this.filterService.init();
                    var r = [];
                    "D" === f.flightWay && "freeStyle" === f.flightType && 0 === f.curSegment && (r = this.getCurFlightList(void 0, !0));
                    var s = this.getCurFlightList();
                    if (this.isRoundTripCombination() && (r = s), this.hasTrain) {
                        var t = 999999999,
                        u = [];
                        s.each(function(a, b) {
                            return a.HasTrain ? void u.push(b) : void(a.TransferCount < 3 && a.TotalPrice < t && (t = a.TotalPrice))
                        });
                        for (var m = u.length,
                        p = m; m--;) t < s[u[m]].TotalPrice && (s.splice(u[m], 1), u.pop());
                        this.hasTrain = u.length > 0,
                        u.length != p && s.each(function(a, b) {
                            f.flightKey[a.Key] = b
                        })
                    }
                    this.addtionService.compareRule(s),
                    s.each(function(a) {
                        f.DrecommendService && "S" === f.flightWay && f.DrecommendService.addOption(a),
                        f.addToFilter(a)
                    }),
                    this.dlen = 0;
                    var v = function(a) {
                        if (!f.isDirectAndSameGrade) switch (condition.ClassGrade) {
                        case "Y":
                        case "S":
                        case "Y_S":
                            a.FareList[0].IsYorS && (f.isDirectAndSameGrade = !0);
                            break;
                        case "C_F":
                            a.FareList[0].IsCorF && (f.isDirectAndSameGrade = !0);
                            break;
                        case "C":
                            a.FareList[0].IsC && (f.isDirectAndSameGrade = !0);
                            break;
                        case "F":
                            a.FareList[0].IsF && (f.isDirectAndSameGrade = !0)
                        }
                    };
                    if (pageGlobal.NearDateDirectFlightRecommendSwitch && r.length) {
                        for (var w = "",
                        x = 0,
                        y = r.length; y > x; x++) if (1 === r[x].FlightInfo[0].TransferCount && "both" !== w && (w = "half"), 1 === r[x].FlightInfo[1].TransferCount && "half" === w) {
                            w = "both",
                            v(r[x]),
                            f.dlen++;
                            break
                        }
                        f.freeStyleHasBothDirectFlag = w
                    } else s.each(function(a, b) {
                        1 === a.TransferCount && (f.dlen++, v(a))
                    });
                    this.filterService.curFilter.length > 0 ? this.filterService.update(this.loadFinish, this.curSegment) : this.update()
                } else this.update()
            },
            parseFareClassGrade: function(a, b) {
                if (a && 0 != a.length) for (var c = 0; c < a.length; c++) {
                    var d = a[c];
                    d.ClassGrade = (b ? d.ClassGradeKey: d.ClassGradeKey.split(";")[0]) || ""
                }
            },
            sortFareListByCurType: function(a) {
                var b = this;
                return a && a.length > 0 && a.sort(function(a, c) {
                    return a[b.curType] - c[b.curType]
                }),
                a
            },
            findLowPrice: function(a) {
                var b, c = this,
                d = 999999999999;
                return a.each(function(a, e) {
                    d > a[c.curType] && (d = a[c.curType], b = e)
                }),
                a[b]
            },
            updatePriceInfo: function(a, b) {
                "object" == typeof b && (a.Price = b.Price, a.Tax = b.Tax || 0, a.OilFee = b.OilFee || 0, a.TotalPrice = b.TotalPrice, a.IsFlayer = b.IsFlayer, a.UToken = b.Parameter, a.PrimaryClassGrade = b.PrimaryClassGrade, a.FlightInfo && 2 == a.FlightInfo.length && (a.FlightInfo[0].PrimaryClassGrade = b.PrimaryClassGrade, a.FlightInfo[1].PrimaryClassGrade = b.PrimaryClassGrade))
            },
            updateAllPriInfo: function() {
                var a = this,
                b = this.getCurFlightList(!0);
                b.each(function(b) {
                    var c = a.findLowPrice(b.FareList);
                    c && a.updatePriceInfo(b, c)
                })
            },
            fixFlightInfo: function(a, b) {
                "undefined" != typeof b.FlightInfo ? b.FlightInfo = a.FlightInfo: b.FlightDetail = a.FlightDetail,
                b.FlightTime = a.FlightTime,
                b.TransferCount = a.TransferCount,
                b.CrossDay = a.CrossDay
            },
            fixData: function(a) {
                var b, c = a.FlightDetail.length - 1;
                for (b = a.FlightDetail[0], a.DCityName = b.DCityName, a.DepartTime = b.DepartTime, a.DPort = b.DPort, a.DPortName = b.DPortName, a.DTerminal = b.DTerminal, a.DPortEnName = b.DPortEnName, a.DDistance = b.DDistance, a.DDistanceName = b.DDistanceName, a.FlightNo = b.FlightNo, a.Alliance = b.Alliance, a.OperatingAlliance = b.OperatingAlliance, a.HasTrain = !1, !a.PrimaryClassGrade && a.FareList.length > 0 && (a.PrimaryClassGrade = a.FareList[0].PrimaryClassGrade), a.PainExponent = parseInt(a.FlightTime * (pageGlobal.PainExponentConfig[a.PrimaryClassGrade] || 0) * 1e4) / 1e4; 1 === a.FlightDetail[c].IsPartial;) c--;
                a.LastSegment = c;
                for (var d = [], e = [], f = 0, g = function(a) {
                    if ("undefined" == typeof a) return 0;
                    var b = a.split("m")[0].split("h"),
                    c = b[0],
                    d = b[1];
                    return 60 * c + 1 * d
                },
                h = pageGlobal.TrainSwitch ? 0 : a.FlightDetail[0].AirlineCode || 0, i = 0; c >= i; i++) b = a.FlightDetail[i],
                "undefined" != typeof b.StopInfo && (b.StopCityName = b.StopInfo[0].City),
                1 === b.PrimarySegment && (a.PrimaryAirlineName = b.AirlineName, a.PrimaryAirlineCode = b.AirlineCode),
                a.HasTrain === !1 && 1 === b.SegementType && (a.HasTrain = !0, this.hasTrain = !0),
                0 === h && 0 === b.SegementType && (h = b.AirlineCode),
                b.AirlineImage && d.push([b.AirlineName, b.FlightNo, b.CraftType, b.AirlineImage].join("|")),
                (b.Carrier || b.CarrierFlightNo) && e.push([b.AirlineName, b.FlightNo, b.CarrierFlightNo ? "\u4e0e<strong>" + b.CarrierFlightNo + "</strong>\u5171\u4eab": "", b.Carrier ? "\uff0c\u5b9e\u9645\u7531<strong>" + b.Carrier + "</strong>\u627f\u8fd0": ""].join("")),
                f += g(b.TransferTime);
                if (d.length > 0 && (a.AirlineImage = d.join(",,")), e.length > 0 && (a.shareIdent = e.join("\uff1b<br>") + "\u3002"), f > 0 && (a.DurationTime = parseInt(f / 60)), b = a.FlightDetail[c], a.ACityName = b.ACityName, a.ArrivalTime = b.ArrivalTime, a.APort = b.APort, a.APortName = b.APortName, a.APortEnName = b.APortEnName, a.ATerminal = b.ATerminal, a.ADistance = b.ADistance, a.ADistanceName = b.ADistanceName, pageGlobal.TrainSwitch && a.HasTrain && (a.TrainWay = 1 === a.FlightDetail[0].SegementType, a.TrainWay ? (b = a.FlightDetail[1], a.TDPortName = a.DPortName, a.DCityName = b.DCityName, a.DPortName = b.DPortName, a.DTerminal = b.DTerminal, a.FlightNo = b.FlightNo, a.Alliance = b.Alliance, a.OperatingAlliance = b.OperatingAlliance) : (b.HideTransferTime = !0, b = a.FlightDetail[c - 1], b.IsLastFlight = !0, b.TDCityName = a.FlightDetail[c].DCityName, b.TransferTime = a.FlightDetail[c].TransferTime, a.TAPortName = a.APortName, a.ACityName = b.ACityName, a.APortName = b.APortName, a.ATerminal = b.ATerminal)), a.IsSameAirline = !0, a.IsSingleAirline = !0, a.FlightTime || (a.FlightTime = 9999999), a.FlightLen = a.FlightDetail.length, a.FlightLen > 1) {
                    var j = {},
                    k = [];
                    a.FlightLen = 0,
                    a.IsSingleAirline = !1;
                    for (var l = 0,
                    m = a.FlightDetail.length; m > l; l++) b = a.FlightDetail[l],
                    1 !== b.SegementType ? 1 !== b.IsPartial ? (j[b.AirlineCode] || (k.push({
                        Code: b.AirlineCode,
                        Name: b.AirlineName
                    }), j[b.AirlineCode] = 1), a.FlightLen++, a.IsSameAirline && h != b.AirlineCode && (a.IsSameAirline = !1), a.Alliance && a.Alliance != b.Alliance && delete a.Alliance, a.OperatingAlliance && a.OperatingAlliance != b.OperatingAlliance && delete a.OperatingAlliance) : (1 !== a.hasPartial && (a.hasPartial = 1, b.isFirst = 1), delete a.IsMorePrice) : a.FlightLen++;
                    a.AirlineCompanies = k,
                    j = null
                }
                1 === a.FlightLen && (a.IsSingleAirline = !0),
                a.IsSingleAirline && a.HasTrain && (a.IsSingleAirline = !1)
            },
            addToFilter: function(a) {
                this.filterService && this.filterService.add(a)
            },
            checkCache: function() {
                if (this.isCache = "D" === this.flightWay && Cache[this.flightType] && ("freeStyle" === this.flightType && this.curSegment < 1 || "builtUp" === this.flightType && this.runTimes < 1), this.isCache) {
                    this.flightList = Cache[this.flightType].flightList,
                    this.aptitudeList = Cache[this.flightType].aptitudeList,
                    this.alGiftIDList = Cache.alGiftIDList;
                    var a = this;
                    this.flightList.each(function(b, c) {
                        a.flightKey[b.Key] = c,
                        a.addToFilter(b)
                    }),
                    this.checkIsLoadFinish()
                }
                return this.isCache
            },
            checkIsLoadFinish: function() {
                if (this.renderEligibility(), this.loadFinish = this.searchFinishTimes === this.searchTokens.length, this.progressBar(), this.loadFinish) {
                    this.lowestPrice.length > 0 && (this.lowestPrice.sort(this.sortNumber), this.showLowerPrice(this.lowestPrice[0]));
                    var a = this;
                    if (this.showWiFiAdv(), this.showAirlineGift(), this.closeAirportrecommendCity && $(".subairport-recmd-banner").css("display", "none"), this.closeAirportrecommendCity && this.isRoundTrip() && 1 == this.curSegment && this.filterService.clearAllFilter(!0), this.curSegment < 1 && this.runTimes < 1 && this.flightList.length < 1) return "S" !== this.flightWay && this.StepPanel.hide(),
                    clearTimeout(this.stayTimer),
                    this.allowLoad = !1,
                    this.filterService && this.filterService.dispose(),
                    this.cond.Quantity && (this.cond.ChildQuantity || this.cond.InfantQuantity) ? (online.log("\u8be5\u822a\u7ebf\u4e0d\u652f\u6301\u6210\u4eba\u548c\u513f\u7ae5\u4e00\u8d77\u8ba2\u7968\u3002\u5f53\u524d\u5df2\u4e3a\u60a8\u663e\u793a\u6210\u4eba\u7968\u4ef7 "), a.copyCond = $.copy(a.cond, !0), delete a.cond.ChildQuantity, delete a.cond.InfantQuantity, a.isMultiTrave = !1, a.reset(), a.searchFlights("Search"), a.MultiTraveSearchNoData = !0, $("#ChildQuantity").value(0), $("#ChildQuantity").trigger("change"), $("#InfantQuantity").value(0), $("#InfantQuantity").trigger("change"), "S" === this.flightWay && (ticketRecommendService = online.$c("service.NewResult.TicketRecommend", {
                        resultService: a,
                        flag: this.cond.RecommendedFlightSwitch || !1,
                        recommendTmpl: recommendTmpl,
                        recFltBoxTmpl: recFltBoxTmpl,
                        calendarTmpl: calendarTmpl,
                        RecCheapTmpl: RecCheapTmpl,
                        RelevantFltTmpl: RelevantFltTmpl,
                        condition: a.cond
                    })), this.callback && "D" === this.flightWay && this.callback(function(a) {
                        a.isMultiTrave = !1,
                        a.request()
                    })) : (pageGlobal.NewUbt.Isresult = "0", "undefined" == typeof pageGlobal.HasRCP_NRB ? this.hasNoResult() : 3 != pageGlobal.HasRCP_NRB && this.nearCompen()),
                    void this.updateDowngradeUBT();
                    this.T && this.T.each(function(a, b) {
                        a.Index = b
                    }),
                    this.flightList.each(function(a, b) {
                        a.Index = b
                    }),
                    !this.isCache && "D" === this.flightWay && ("freeStyle" === this.flightType && this.curSegment < 1 || "builtUp" === this.flightType && this.runTimes < 1) && (Cache.builtUp = {
                        t: +new Date,
                        flightList: this.flightList,
                        aptitudeList: this.aptitudeList
                    },
                    Cache.freeStyle = {
                        t: +new Date,
                        flightList: this.T,
                        aptitudeList: this.aptitudeList
                    },
                    Cache.alGiftIDList = this.alGiftIDList, "freeStyle" === this.flightType && (this.flightList = this.T, this.flightList.each(function(b, c) {
                        a.flightKey[b.Key] = c
                    })), this.callback && (setTimeout(function() {
                        a.callback(function(a) {
                            a.update()
                        })
                    },
                    400), this.fltChpKey || a.callback(function(a) {
                        a.cheapFlight(Cache.builtUp.flightList, 1)
                    }))),
                    "D" === this.flightWay && "freeStyle" === this.flightType && 1 === this.curSegment && this.callback && this.callback(function(b) {
                        b.cheapFlight(a.flightList, 0)
                    }),
                    this.filterService && this.filterService.update(!0),
                    this.loadStatus.find(".loading-status").hide(),
                    this.loadStatus.find(".loading-complete").fadeIn(function() {
                        a.loadStatus.find(".loading-status").hide()
                    })
                }
            },
            checkHasLoad: function() {
                this.loadFinish && this.curSegment < 1 && this.runTimes < 1 && this.flightList.length < 1 ? this.hasNoResult() : delete pageGlobal.HasRCP_NRB
            },
            hasNoResult: function() {
                var a = this;
                ticketRecommendService && ticketRecommendService.clearDom(),
                lowReturnRecommendService && lowReturnRecommendService.callGC(!0),
                $LAB.script(getUrl("NoResult.js")).wait(function() {
                    online.$c("service.result.Noresult", {
                        target: $("#result-wrapper"),
                        data: a.copyCond || a.cond
                    })
                }),
                NoResultRecommendUbt.setPageNoResult(),
                $("#page_id").value("104023"),
                window.__bfi.push(["_asynRefresh", {
                    page_id: "104023",
                    url: location.href
                },
                null]),
                pageGlobal.NewUbt && (pageGlobal.NewUbt.page_id = 104023, pageGlobal.NewUbt.NoResultType = "noairline", window.__bfi.push(["_tracklog", "fltintl.searchnoresult", $.stringifyJSON(pageGlobal.NewUbt)]))
            },
            nearCompen: function() {
                if ("M" !== this.flightWay) {
                    var a = [".side-wrapper", "#result-wrapper"]; - 1 === pageGlobal.HasRCP_NRB && (pageGlobal.HasRCP_NRB = online.noResCompen(this, this.flightWay)),
                    1 === pageGlobal.HasRCP_NRB ? (a.each(function(a) {
                        var b = $(a);
                        b && b.remove()
                    }), $("#J_BomRecommend").show(), $("#J_TopContainer").length > 0 && $("#J_TopContainer").remove()) : this.hasNoResult()
                }
            },
            reSortFareList: function(a) {
                if (! (a.length < 2)) {
                    var b = this,
                    c = null;
                    a.each(function(a) {
                        a.IsNewImpower && (a.Force = 0, a.IsY && !a.IsGV && "NOR" == a.Eligibility && a.IsImpowerTop && (null == c && (c = a), a[b.curType] < c[b.curType] && (c = a)))
                    }),
                    c && (c.Force = 1);
                    var d = function(b) {
                        return a.length > b && pageGlobal.VirtualFlightSwitch && a[b].ContainsVirtualFlight
                    };
                    if ("undefined" != typeof pageGlobal.Sort && "number" == typeof pageGlobal.Sort && 31 !== pageGlobal.Sort) {
                        for (var e = [], f = 0, g = a.length; g > f; f++) a[f].PlanCategory !== pageGlobal.Sort || d(f) || (e.push(a.splice(f--, 1).pop()), g--);
                        for (var g = e.length; g--;) a.unshift(e.pop())
                    }
                    for (var e = [], f = 0, g = a.length, h = null; g > f; f++) {
                        if (h = a[f], h.IsMatchForce) if ("\u7ecf\u6d4e\u8231" == h.ClassName) h.Force = 1;
                        else if (null != h.ClassInfo && h.ClassInfo.length > 0) for (var i = 0; i < h.ClassInfo.length && ("Y" != h.ClassInfo[i].ClassGrade || (b.isRoundTripCombination() ? h.Force = 1 : h.ClassInfo[i].SegmentNo == b.curSegment + 1 && (h.Force = 1), 1 != h.Force)); i++);
                        a[f].Force && !d(f) && (e.push(a.splice(f--, 1).pop()), g--)
                    }
                    if (g = e.length, g > 0) for (this.ForceReSort && e.sort(function(a, b) {
                        return b.Force - a.Force
                    }); g--;) a.unshift(e.pop());
                    if (this.allowReSort) {
                        for (var e = [], f = 0, g = a.length; g > f; f++) 1 !== a[f].PlanCategory || d(f) || (e.push(a.splice(f--, 1)[0]), g--);
                        for (; e.length > 0;) a.push(e.shift())
                    }
                }
            },
            showLowerPrice: function(a) {
                var b = [],
                c = [];
                a.FlightDetail.each(function(a, b) {
                    var d = a.SegmentNo - 1;
                    void 0 === c[d] && (c[d] = {
                        FlightDetail: []
                    }),
                    c[d].FlightDetail.push(a)
                }),
                c.each(function(a, c) {
                    var d = {};
                    a = a.FlightDetail,
                    d.FlightNo = a[0].FlightNo,
                    d.DPortName = a[0].DPortName,
                    d.DepartTime = a[0].DepartTime;
                    var e = a.length - 1;
                    d.APortName = a[e].APortName,
                    d.ArrivalTime = a[e].ArrivalTime,
                    a.IsSingleAirline = !0,
                    a.IsSameAirline = !0;
                    var f = a.length;
                    if (a.length > 1) {
                        f = 1,
                        a.IsSingleAirline = !1;
                        for (var g = a[0].AirlineCode, h = 1, i = a.length; i > h; h++) 1 !== a[h].IsPartial && (f++, a.IsSameAirline && g != a[h].AirlineCode && (a.IsSameAirline = !1))
                    }
                    1 === f && (a.IsSingleAirline = !0),
                    a.IsSingleAirline === !1 && (d.FlightNo = a.IsSameAirline ? "\u591a\u4e2a\u822a\u73ed": "\u591a\u4e2a\u822a\u53f8"),
                    d.Stop = a.length < 2 ? "\u76f4\u98de": a.length - 1 + "\u7a0b\u4e2d\u8f6c",
                    b.push(d)
                }),
                a.list = b,
                a.list.length > 0 && ("string" == typeof this.multLowPanel && (this.multLowPanel = $(this.multLowPanel), this.multLowPanel.onn("click", "multidest-recommend-showdetail",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    var b = $(this),
                    c = b.parentNode().find(".flight-detail-expend-mult:first");
                    c.slideToggle(function() {
                        b.find(".icon-caret")["block" === c.css("display") ? "addClass": "removeClass"]("icon-caret-up")
                    })
                })), a.detail = $.tmpl.render('{{each (index, item, IL) list}}<div class="flight-detail-expend{{if index+1 === IL}} last{{/if}}"><div class="multidest-num">\u7b2c${K[index]}\u7a0b</div>' + this.detailTmpl + "</div>{{/each}}", {
                    list: c,
                    K: ["\u4e00", "\u4e8c", "\u4e09", "\u56db", "\u4e94", "\u516d", "\u4e03"]
                }), this.multLowPanel.html($.tmpl.render(this.multTmpl, a)).slideDown(), this.multLowPanel.find(".flight-detail-expend-mult").css("display", "none"), this.multLowPanel.find(".flight-detail-expend").css("display", "block"), "\u4e0d\u542b\u7a0e\u4ef7\u683c" == $(this.sortControl).find(".switch-label-checked").html() && ($("#multLowPanel").find(".tabPriceMore").css("display", "none"), $("#multLowPanel").find(".tabNoPriceMore").css("display", "inline-block"), $("#multLowPanel").find(".tabPriceTax").css("display", "inline-block")))
            },
            renderEligibility: function() {
                if (this.aptPanel.length > 0) try {
                    var a = this.aptPanel.find(".filter-options"),
                    b = $("#filterPanel .filter-expend-tips");
                    if (a.html($.tmpl.render('{{if list}}{{enum (k,v) list}}<div class="filter-option ${k}" data-value="${k}"><span class="radio-wrapper"><a href="#" class="radio-icon"><input type="radio" value="${k}" name="Passagetype" class="radio-input"/></a><label class="radio-label">${v}</label></span></div>{{/enum}}{{/if}}', {
                        list: this.aptitudeList
                    })), "" === a.html()) this.aptPanel.hide(),
                    b.html(b.html().replace("\u3001\u4e58\u5ba2\u8d44\u8d28", ""));
                    else {
                        this.aptPanel.show(),
                        -1 === b.html().indexOf("\u4e58\u5ba2\u8d44\u8d28") && b.html(b.html() + "\u3001\u4e58\u5ba2\u8d44\u8d28"),
                        a.find(".filter-option[data-value=NOR]:first").prependTo(this.aptPanel.find(".filter-options:first"));
                        var c = this.cond.Eligibility || "NOR";
                        if (a.find("." + c + " .radio-icon").addClass("radio-icon-checked"), "NOR" !== c && this.filterService && "none" === $("#moreFilter").css("display") && this.filterService.toggleFilterExpand(), a.find(".radio-icon-checked").length < 1 && a.find(".filter-option:first .radio-icon").addClass("radio-icon-checked"), a.data("binded") !== !0) {
                            a.data("binded", !0);
                            var d = this;
                            a.onn("click", "filter-option",
                            function(a) {
                                try {
                                    a.stop()
                                } catch(a) {}
                                "D" === d.flightWay && null !== location.hash.match(/#(freeStyle|builtUp)/) && (window.keepHash = !0);
                                var b = $(this).find(".radio-icon");
                                if (!b.hasClass("radio-icon-checked")) {
                                    $(this.parentNode).find(".radio-icon-checked").removeClass("radio-icon-checked"),
                                    b.addClass("radio-icon-checked");
                                    var c = $(this).attr("data-value");
                                    $("#hidEligibility").value(c),
                                    d.UBTData.PassengerFliter++,
                                    $("#btnSearch")[0].click()
                                }
                            })
                        }
                    }
                } catch(e) {
                    $.warning(e, "renderEligibility:" + $.stringifyJSON(this.aptitudeList)),
                    this.aptPanel.hide()
                }
            },
            compareValues: function(a, b, c) {
                if ("string" == typeof a) return this.compareValues([a], b, c);
                for (var d, e, f = 0,
                g = a.length; g > f; f++) {
                    if (e = a[f], "DepartTime" === e && "builtUp" === this.flightType && (e = "DDepartTime"), d = [this.fixValue(b[e]), this.fixValue(c[e])], "TotalPrice" === e) if (b.Tax < 0) {
                        if (c.Tax >= 0) return 1
                    } else if (c.Tax < 0) return - 1;
                    if (d[0] !== d[1]) return d[0] > d[1] ? 1 : -1
                }
                return 0
            },
            fixValue: function(a) {
                return /^\d+$/.test(a) ? parseInt(a, 10) : /^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}.*$/.test(a) ? new Date(a.replace(/-/g, "/")).getTime() : a
            },
            update: function(a) {
                this.needHideDowngradeTip && this.hideDownGradeTip();
                var b = pageGlobal.OWIntelligenceRecSwitch,
                c = $("#OWIntelligenceRecCheckBox").length && $("#OWIntelligenceRecCheckBox").hasClass("checkbox-icon-checked"),
                d = this,
                e = function() {
                    if (void 0 != pageGlobal.Tax && "" != pageGlobal.Tax) {
                        var a = pageGlobal.Tax;
                        "1" == a ? d.sortControl.find("label[data-ubt-key='PriceWithTax']").click() : "0" == a && d.sortControl.find("label[data-ubt-key='PriceNoTax']").click()
                    }
                };
                this.loadFinish && 0 == this.urlTaxLoadTimes && (this.urlTaxLoadTimes++, e());
                var f = function() {
                    if (void 0 != pageGlobal.Sort && "" != pageGlobal.Sort) {
                        var a = ["Price", "TransferCount", "DepartTime", "ArrivalTime", "FlightTime"],
                        b = pageGlobal.Sort.split(","),
                        c = "",
                        d = "";
                        if (2 == b.length ? (c = b[0], d = b[1]) : (c = b[0], d = "asc"), -1 != a.indexOf(c)) {
                            var e = {
                                sortKey: c,
                                orderBy: d,
                                urlSort: !0
                            };
                            return e
                        }
                    }
                };
                if (this.loadFinish && 0 == this.urlSortLoadTimes) {
                    var g = f();
                    this.urlSortLoadTimes++,
                    g && g.urlSort && (this.sortKey = a = g.sortKey, this.orderBy = g.orderBy);
                    var h = !1;
                    "D" === this.flightWay && "builtUp" === this.flightType && (h = !0);
                    var i = this.sortControl.find("li[data-sortby='" + a + "']:eq(" + (h ? 1 : 0) + ")");
                    if (i && i.length > 0 && i.hasClass("sort-item-active") === !1) {
                        this.sortControl.find("li.sort-item-active").removeClass("sort-item-active");
                        i.addClass("sort-item-active");
                        var j = i.find("span i");
                        j.length > 0 && (j[0].className = "asc" === g.orderBy ? "icon-sort": "icon-reverse")
                    }
                }
                this.sortKey = a || this.sortKey;
                var k = [this.sortKey, this.orderBy].join("_"),
                l = this.getCurFlightList(!0),
                m = this,
                n = l === this.flightList || l === this.T;
                if (!a || k !== this.lastSortType && 1 !== l.length) {
                    this.lastSortType = k;
                    var o = "TransferCount" === m.sortKey ? l.filter(function(a) {
                        return ! (pageGlobal.VirtualFlightSwitch && a.ContainsVirtualFlight || 1 !== a.TransferCount)
                    }).length: 0;
                    if (this.lowPainExponent = 9999999, l.each(function(a) {
                        a.TotalPainExponent < m.lowPainExponent && (m.lowPainExponent = a.TotalPainExponent)
                    }), b && l.each(function(a) {
                        var b, d;
                        a[c ? "FareListWithoutOWIntelligenceRec": "FareListWithOWIntelligenceRec"].each(function(a) { (!b || a.Price < b) && (b = a.Price),
                            (!d || a.TotalPrice < d) && (d = a.TotalPrice)
                        }),
                        b && (a.Price = b),
                        d && (a.TotalPrice = d)
                    }), l.sort(function(a, b) {
                        var c = [m.fixValue(a[m.sortKey]), m.fixValue(b[m.sortKey])];
                        if ("TotalPrice" === m.sortKey) if (a.Tax < 0) {
                            if (b.Tax >= 0) return "asc" === m.orderBy ? 1 : -1
                        } else if (b.Tax < 0) return "asc" === m.orderBy ? -1 : 1;
                        if (c[0] > c[1]) return "asc" === m.orderBy ? 1 : -1;
                        if (c[0] < c[1]) return "asc" === m.orderBy ? -1 : 1;
                        var d = [];
                        switch (m.sortKey) {
                        case "TransferCount":
                            1 === c[0] ? d = 5 >= o || o > 5 && window.IsSortByDepartTimeDefault ? ["DepartTime", m.curType, "FlightTime", "ArrivalTime", "Tax"] : [m.curType, "DepartTime", "FlightTime", "ArrivalTime", "Tax"] : (d = m.PainExponent > 0 ? ["PainExponent", "DepartTime", "ArrivalTime"] : [m.curType, "FlightTime", "DepartTime", "ArrivalTime", "Tax"], 2 === c[0] && "builtUp" !== m.flightType && d.unshift("FlightLen"));
                            break;
                        case "DepartTime":
                            d = ["ArrivalTime", m.curType, "FlightTime"];
                            break;
                        case "ArrivalTime":
                            d = ["DepartTime", m.curType, "FlightTime"];
                            break;
                        case "FlightTime":
                            d = ["DepartTime", "ArrivalTime", m.curType];
                            break;
                        case "Price":
                        case "TotalPrice":
                            d = ["DepartTime", "ArrivalTime", "FlightTime"]
                        }
                        return d.length > 0 ? m.compareValues(d, a, b) : 0
                    }), n && l.each(function(a, b) {
                        m.flightKey[a.Key] = b
                    }), this.checkPageControl(), $(document.body).data("flightComfort", []), this.loadFinish === !1 && this.filterService && this.filterService.curFilter.length > 0 && l.length < 1) return void online.log("\u672a\u52a0\u8f7d\u5b8c\u6210, \u4e14\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c, \u5219\u4e0d\u505arender!\u5f53\u524d\u5df2\u83b7\u5f97\u7684\u6570\u636e:" + this.flightList.length);
                    if (! (this.flightList.length < 1)) if (this.isLoadingHide > 0) {
                        if (1 === this.isLoadingHide) return;
                        this.isLoadingHide = 1,
                        "M" === this.flightWay && this.StepPanel && this.StepPanel.slideDown(),
                        m.sortControl.slideDown(123,
                        function() {
                            m.isLoadingHide = 0,
                            m.render()
                        }),
                        m.filterService && m.filterService.loadCallback()
                    } else this.render(),
                    this.filterService && this.needUpdateFilter && this.filterService.update()
                }
            },
            removeFriendlyTips: function() {
                $("#result-wrapper .alert-box").remove()
            },
            getCurFlightList: function(a, b) {
                if (a && this.curFilterResult) return this.curFilterResult;
                var c = this,
                d = this.flightList;
                return b ? d: ("D" === this.flightWay && "freeStyle" == this.flightType && this.curSegment < 1 && this.loadFinish === !1 && (d = this.T), d.each(function(a, b) {
                    c.flightKey[a.Key] = b
                }), d)
            },
            showWiFiAdv: function() {
                $.storage.remove("_SearchResultBannerADV");
                var a = pageGlobal.WifiADV,
                b = a && a.Pic && a.Link,
                c = pageGlobal.HKMacaoAD && pageGlobal.HKMacaoAD.ImageUrl && pageGlobal.HKMacaoAD.AdLink;
                if (! ($("#J_showWiFiAdv").length > 0 || !b && !c) && (!c || (IntlFlightAdvertiseUBT.uploadDisplayUbt(pageGlobal.HKMacaoAdSwitch), pageGlobal.HKMacaoAdSwitch))) {
                    var d = b ? a.Link: pageGlobal.HKMacaoAD.AdLink,
                    e = b ? a.Pic: pageGlobal.HKMacaoAD.ImageUrl,
                    f = document.createElement("a");
                    f.id = "J_showWiFiAdv",
                    f.target = "_blank",
                    f.style.cssText = "display:block;height:80px;margin-bottom:10px;background:url('" + e + "') no-repeat center top;",
                    f.href = d,
                    b && a.Link.indexOf("=") >= 0 ? (pageGlobal.NewUbt.ShowAD = a.Link.substring(a.Link.indexOf("=") + 1), $(f).bind("click",
                    function() {
                        pageGlobal.NewUbt.ViewAD = pageGlobal.NewUbt.ShowAD
                    })) : c && $(f).bind("click",
                    function() {
                        IntlFlightAdvertiseUBT.uploadClickUbt()
                    }),
                    $("#result-wrapper").prepend(f)
                }
            },
            showFriendlyTips: function(a) {
                if (! ($("#NoMatchTips").length > 0 || this.loadFinish && this.flightList.length < 1)) {
                    var b = this.cond.SegmentList[this.curSegment].DCity.split("(")[0].split("|")[1],
                    c = this.cond.SegmentList[this.curSegment].ACity.split("(")[0].split("|")[1],
                    d = document.createElement("div");
                    d.id = "NoMatchTips",
                    d.className = "alert-box alert-term",
                    d.innerHTML = '<i class="icon-warn-12"></i>\u672a\u67e5\u8be2\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u822a\u73ed\uff0c\u4e3a\u60a8\u627e\u5230 ' + [b, c].join("-") + " \u7684\u6240\u6709\u822a\u73ed\u3002",
                    $("#result-wrapper").prepend(d)
                }
            },
            uniqueGift: function(a) {
                if (a.GiftIDList && a.GiftIDList.length > 0) for (var b = a.GiftIDList,
                c = 0,
                d = b.length; d > c; c++) this.alGiftHash[b[c]] || (this.alGiftIDList[this.alGiftIDList.length] = b[c], this.alGiftHash[b[c]] = !0)
            },
            showAirlineGift: function() {
                if (! (this.alGiftIDList.length < 1)) {
                    var a, b, c = this.cond.SegmentList[this.curSegment].DCity.split("|")[1].replace(/\([a-z]+\)/gi, ""),
                    d = this.cond.SegmentList[this.curSegment].ACity.split("|")[1].replace(/\([a-z]+\)/gi, ""),
                    e = '<div class="help_term help_term_gift"><img src="//pic.c-ctrip.com/fltcommon/icons/airline-gift.png">\u9884\u8ba2${dCityName}-${aCityName}\u673a\u7968\uff0c\u53ef\u4eab{{if GiftIDList.length>1}}<em class="num">${GiftIDList.length}</em>\u91cd\u5927{{else}}\u7cbe\u9009\u597d{{/if}}\u793c\uff0c\u6570\u91cf\u6709\u9650\uff0c\u5148\u5230\u5148\u5f97!<a href="javascript:;" class="readDetail" data-id="${GiftIDList.join()}" data-ubt-key="Gift">\u67e5\u770b\u793c\u76d2</a></div>';
                    if ($("#airlineGift").length < 1) {
                        var f = document.createElement("div");
                        f.id = "airlineGift",
                        $(f).insertBefore($("#flightsMatrix"))
                    }
                    b = $("#airlineGift"),
                    a = {
                        dCityName: c,
                        aCityName: d,
                        GiftIDList: this.alGiftIDList
                    },
                    b.html($.tmpl.render(e, a)),
                    $("#airlineGift .readDetail").bind("click",
                    function(a) {
                        try {
                            a.stop()
                        } catch(a) {}
                        var b = $(this).attr("data-id"),
                        c = this;
                        $("#giftTplDiv").length < 1 && initGiftTpl(),
                        this.gfID || (this.gfID = $.uid()),
                        online.GiftCache[this.gfID] && online.showGiftInfoBox(this.gfID),
                        this.ajax || (this.ajax = !0, $.ajax(online.getBaseUrl("AjaxRequest/UI2_0/GetGifts.ashx?GiftID=" + b), {
                            cache: !0,
                            async: !0,
                            onsuccess: function(a, b) {
                                b = $.parseJSON(b),
                                b && b.GiftDetailList && b.GiftDetailList.length > 0 && (online.GiftCache[c.gfID] = b, online.showGiftInfoBox(c.gfID))
                            },
                            onerror: function() {}
                        }))
                    })
                }
            },
            progressBar: function() {
                var a, b, c = this,
                d = this.searchFinishTimes,
                e = this.searchTokens.length;
                try {
                    if ($("#FI_progBar").length < 1) {
                        var f = document.createElement("div");
                        f.className = "search_loading",
                        f.id = "FI_progBar",
                        f.innerHTML = '<div class="line"></div>',
                        $(f).insertBefore(this.sortControl),
                        this.PB_Contanier = $("#FI_progBar")
                    }
                    1 > d ? (a = "30%", b = 1500) : d >= e ? (a = "100%", b = 300) : (a = "+=15%", b = 2e3),
                    this.PB_Contanier.find(".line").animate({
                        width: a
                    },
                    {
                        speed: b,
                        step: function() {
                            $(this).css("overflow", "visible")
                        },
                        complete: function() {
                            d >= e && c.PB_Contanier.remove()
                        }
                    })
                } catch(g) {}
            },
            clear: function() {
                this.filterLoadFinish && (this.loadingList.addClass("hide"), this.container.html(this.loadingTips))
            },
            reset: function() {
                0 === arguments.length && this.setTimer();
                var a = this.cond.SegmentList[this.curSegment].DCity.split("|"),
                b = this.cond.SegmentList[this.curSegment].ACity.split("|");
                a[1].indexOf("\u706b\u8f66\u7ad9") >= 0 ? $("#departCity").html(this.cond.SegmentList[this.curSegment].DCityName) : $("#departCity").html(a[1].replace(/\([a-z]+\)/gi, "")),
                b[1].indexOf("\u706b\u8f66\u7ad9") >= 0 ? $("#arrivalCity").html(this.cond.SegmentList[this.curSegment].ACityName) : $("#arrivalCity").html(b[1].replace(/\([a-z]+\)/gi, "")),
                $("#departDate").html(("builtUp" === this.flightType ? "\u53bb ": "") + online.showTime(this.cond.SegmentList[this.curSegment].DepartDate, "M\u6708d\u65e5")),
                $("#arrivalDate")["builtUp" === this.flightType ? "show": "hide"]();
                var c = 0 == arguments.length;
                this.clearCurrentState(c, !0)
            },
            clearCurrentState: function(a, b) {
                this.removeFriendlyTips(),
                this.loadStatus.find(".loading-status b").html("0"),
                this.loadFinish && (this.loadStatus.find(".loading-complete").hide(), this.loadStatus.find(".loading-status").fadeIn()),
                a && (b && (this.searchTokens.length = 0, this.searchFinishTimes = 0, this.loadFinish = !1, this.runTimes = 0, this.searchTimes = 0), this.flightList = [], this.T = [], this.TK = {},
                this.flightKey = {},
                this.isCache = !1, this.hasTrain = !1, this.isLocked = !1, this.noStopLen = 0, this.lastSortType = "", this.aptitudeList = {},
                this.alGiftHash = {},
                this.alGiftIDList = [], $("#airlineGift").length > 0 && $("#airlineGift").html("")),
                this.curPage = 0,
                this.maxPage = 0,
                this.isLoadingHide = 2,
                this.filterLoadFinish = !0,
                this.clear(),
                this.checkPageControl(),
                this.filterLoadFinish = !1,
                this.needHideDowngradeTip = !1,
                this.filterService && this.filterService.reset()
            },
            render: function() {
                if ("undefined" == typeof this.rTimer) {
                    this.clear();
                    var a = this;
                    this.rTimer = setTimeout(function() {
                        a.draw(),
                        delete a.rTimer
                    },
                    100)
                }
            },
            draw: function() {
                var a = this,
                b = this.getCurFlightList(!0);
                if (this.loadFinish) b.length < 1 && "undefined" != typeof this.cond.AirlineName && (this.showFriendlyTips(), this.filterService && this.filterService.clearFilter("OwnerAirlineName", this.cond.AirlineName), b = this.getCurFlightList()),
                pageGlobal.NewUbt.Isresult = "1";
                else if (b.length < 1) return;
                var c = null;
                if (pageGlobal.VirtualFlightSwitch) {
                    c = [];
                    for (var d = 0; d < b.length; d++) {
                        var e = b[d];
                        if (e.FlightInfo && e.FlightInfo.length) for (i = 0; i < e.FlightInfo.length; i++) if (e.FlightInfo[i].ContainsVirtualFlight) {
                            e.ContainsVirtualFlight = !0;
                            break
                        }
                        if (e.ContainsVirtualFlight) {
                            var f = 0,
                            g = 0,
                            h = "";
                            if (e.FlightDetail && e.FlightDetail.length) {
                                for (var i = 0; i < e.FlightDetail.length; i++) e.FlightDetail[i].IsVirtualFlight ? (g++, h || (h = e.FlightDetail[i].Carrier)) : f++;
                                e.firstVirtualFlightCarrierName = h,
                                e.virtualFlightSequenceCnt = g,
                                e.notVirtualFlightSequenceCnt = f;
                                var j = "";
                                f && (j = f + "\u7a0b\u822a\u73ed + "),
                                g && (j = j + g + "\u7a0b\u94c1\u8def"),
                                e.sequenceText = j;
                                var k = "\u884c\u7a0b\u8be6\u60c5",
                                l = "";
                                f && g ? (k = "\u884c\u7a0b\u8be6\u60c5", l = "\u884c\u7a0b") : g > 1 ? (k = "\u6362\u4e58\u8be6\u60c5", l = "\u884c\u9a76") : 1 == g && (k = "\u94c1\u8def\u8be6\u60c5", l = "\u884c\u9a76"),
                                e.tripDetailText = k,
                                e.totalDurationText = l
                            }
                            c.push(e)
                        }
                    }
                    for (var i = 0; i < c.length; i++) {
                        var m = b.indexOf(c[i]);
                        m >= 0 && b.splice(m, 1)
                    }
                }
                this.curPage = 0,
                this.maxPage = Math.ceil(b.length / this.pageSize),
                this.allowLoad = this.maxPage > 1,
                this.checkPageControl(),
                "undefined" == typeof a.lowPrice && (a.lowTotalPrice = a.lowPrice = 999999999999),
                (b === this.flightList || b === this.T) && (a.lowTotalPrice = a.lowPrice = 999999999999, b.each(function(b, c) {
                    a.flightKey[b.Key] = c
                }));
                var n = -1,
                o = 0,
                p = 999999999999,
                q = -1,
                r = 0,
                s = -1,
                t = null,
                u = !1;
                if (b.each(function(b, c) {
                    if (delete b.IsSuggestPrice, 1 === b.TransferCount && (o++, a.loadFinish)) if (b.FlightDetail && b.FlightDetail.length)("" == b.FlightDetail[0].CraftType || "" != b.FlightDetail[0].CraftType && "" == b.FlightDetail[0].CraftTypeName) && a.fltTypeName++;
                    else if (b.FlightInfo && b.FlightInfo.length) for (var d = 0; d < b.FlightInfo.length; d++) b.FlightInfo[d].FlightDetail && b.FlightInfo[d].FlightDetail.length && 1 == b.FlightInfo[d].TransferCount && ("" == b.FlightInfo[d].FlightDetail[0].CraftType || "" != b.FlightInfo[d].FlightDetail[0].CraftType && "" == b.FlightInfo[d].FlightDetail[0].CraftTypeName) && a.fltTypeName++;
                    "TotalPrice" === a.curType && b.Tax < 0 || (a.lowPrice > b[a.curType] && (a.lowPrice = b[a.curType], n = c), a.lowTotalPrice > b.TotalPrice && (a.lowTotalPrice = b.TotalPrice, t = decodeURIComponent(decodeURIComponent(b.UToken || "")).match(/ShoppingToken":"\{(.+?),/)), b.TransferCount < 2 && p > b[a.curType] && (p = b[a.curType], q = c))
                }), this.loadFinish && "undefined" != typeof pageGlobal.Campaign && pageGlobal.Campaign && this.marketCurLowPrice == this.constNum && (this.marketCurLowPrice = this.lowPrice), this.loadFinish && b === this.flightList && 0 === this.curSegment && (b[n] && (pageGlobal.NewUbt.LowPrice.NoTaxLowestPrice = b[n].Price), pageGlobal.NewUbt.LowPrice.SearchRealLowestPrice = a.lowTotalPrice, pageGlobal.NewUbt.LowPrice.SearchRealLowestPriceChannel = null === t ? "": t[1]), this.loadFinish && void 0 != b[0] && "undefined" != typeof pageGlobal.Campaign && pageGlobal.Campaign && this.marketCurLowPrice == this.lowPrice) {
                    b === this.flightList ? this.inlandAdPrice.NoTaxLowestPrice = pageGlobal.NewUbt.LowPrice.NoTaxLowestPrice: this.inlandAdPrice.NoTaxLowestPrice = this.lowPrice;
                    var v = location.search.match(/&Pageid=\w+/) || location.search.match(/\?Pageid=\w+/);
                    if (null != v) {
                        var w = v[0].split("=");
                        2 == w.length && (this.inlandAdPrice.ADpageid = w[1])
                    }
                    var x = location.search.match(/&Price=\d+/) || location.search.match(/\?Price=\d+/);
                    if (null != x) {
                        var y = x[0].split("=");
                        2 == y.length && (this.inlandAdPrice.ADprice = y[1])
                    }
                }
                if (this.loadFinish) switch (this.flightWay) {
                case "S":
                    ticketRecommendService && ticketRecommendService.update();
                    break;
                case "D":
                    lowReturnRecommendService && lowReturnRecommendService.renderRecFlt(),
                    pageGlobal.NearDateDirectFlightRecommendSwitch ? this.showNearDateOnlineFlight() : this.showNearOnlineFlight()
                }
                if (this.loadFinish && b === this.flightList && "D" === this.flightWay && "builtUp" === this.flightType && b.length) {
                    if (this.clearBuiltUpSign(b), this.fltChpKey) b.unshift(b.splice(this.flightKey[this.fltChpKey], 1)[0]),
                    b[0].IsSuggestPrice = 1,
                    b[0].IsAppoint = 1;
                    else {
                        if (this.filterService) {
                            var z, A, B;
                            A = 1 * $("#DDepartTime [data-type=DDepartTime]").attr("data-index"),
                            B = 1 * $("#ADepartTime [data-type=ADepartTime]").attr("data-index"),
                            z = this.filterService.getFilterResult(A, !0, 1),
                            z.length > 0 && (z = this.filterService.getFilterResult(B, !0, 3), this.filterService.getFilterResult(B, !1, 3), z.length > 0 && (r = z[0][this.curType], s = this.flightKey[z[0].Key])),
                            this.filterService.getFilterResult(A, !1, 1)
                        }
                        n > 0 && b.unshift(b.splice(n, 1)[0]),
                        b[0].IsSuggestPrice = 1,
                        q > -1 && s > -1 && n !== q && n !== s && q !== s ? (n > q && n > s ? (q++, s++) : n > q ? q++:n > s && s++, b.splice(1, 0, b.splice(q, 1)[0]), q > s && s++, b.splice(2, 0, b.splice(s, 1)[0]), b[1].IsSuggestPrice = 1, b[1].IsDirect = 1, b[2].IsSuggestPrice = 1, b[2].IsEgoHback = 1, b[0].IsTabGroup = 1, b[1].IsTabGroup = 1, b[2].IsTabGroup = 1) : (n === q || 0 > q) && s > -1 && n !== s ? (n > s && s++, b.splice(1, 0, b.splice(s, 1)[0]), b[1].IsSuggestPrice = 1, b[1].IsEgoHback = 1, b[0].IsTabGroup = 1, b[1].IsTabGroup = 1) : q > -1 && n !== q && (n > q && q++, b.splice(1, 0, b.splice(q, 1)[0]), b[1].IsSuggestPrice = 1, b[1].IsDirect = 1, b[0].IsTabGroup = 1, b[1].IsTabGroup = 1),
                        u = !0,
                        online.log(["\u6240\u6709\u6700\u4f4e\u4ef7: ", n, this.lowPrice].join("	")),
                        online.log(["\u76f4\u98de\u6700\u4f4e\u4ef7: ", q, p].join("	")),
                        online.log(["\u65e9\u53bb\u665a\u56de\u6700\u4f4e\u4ef7: ", s, r].join("	"))
                    }
                    b.each(function(b, c) {
                        a.flightKey[b.Key] = c
                    })
                }
                pageGlobal.AllowAddTag = !1,
                b = this.initRecommendGroup(b),
                pageGlobal.IsOpenRecFltOptimizeSwitch && (b = this.setLowPainExponentFlcToTop(b)),
                InternationalRecommend.bIsClicked() && InternationalRecommend.recommendProdAfterClick(this, b),
                SuperFlyerUbt.check(IS_SUPER_FLIGHT, 0),
                pageGlobal.NewUbt.hasOwnProperty("IsNewMultiPU") && delete pageGlobal.NewUbt.IsNewMultiPU;
                var C = !1;
                b.each(function(b, c) {
                    b.hasOwnProperty("startIndex") || (b.startIndex = c),
                    b.FareList && 0 === a.curSegment && b.FareList.each(function(a, c) {
                        a.IsSuperFlyer && (SuperFlyerUbt.hasSuperFlyerUbt(), Array.isArray(b.FlightInfo) && 2 === b.FlightInfo.length ? (b.FlightInfo[0].IsSuperFlyer = 1, b.FlightInfo[0].IsShowFlyer = void 0, b.FlightInfo[1].IsShowFlyer = void 0) : b.IsSuperFlyer = 1)
                    }),
                    b.FareList && 0 === a.curSegment && b.FareList.each(function(a, b) {
                        a.IsSuperFlyer && SuperFlyerUbt.hasSuperFlyerUbt()
                    }),
                    !C && "M" == a.flightWay && a.isLastSegment && b.FareList && b.FareList.length > 0 && b.FareList.each(function(a) {
                        return a.IsDomesticIntlPU ? (C = !0, !1) : void 0
                    })
                }),
                "M" == a.flightWay && a.isLastSegment && (pageGlobal.NewUbt.IsNewMultiPU = C ? 1 : 0);
                var D = a.commonDataHandler(a.travelInsurePreHandler(b.slice(0, this.pageSize)));
                pageGlobal.IsFilterFareByCategoryAndClassGrade && (D = a.sortFareByCategoryAndClassGrade(D)),
                pageGlobal.IsOpenTransPU && a.renderTransPUConfigedText(D);
                var E = !1;
                if (("D" != this.flightWay || "builtUp" != this.flightType) && c && c.length) {
                    for (var F = 0; F < c.length; F++) c[F].IsLastVirtualFlight = !1,
                    c.length > 1 ? 0 == F ? c[F].virtualFlightTagClass = "first": F == c.length - 1 ? (c[F].virtualFlightTagClass = "last", c[F].IsLastVirtualFlight = !0, E = !0) : c[F].virtualFlightTagClass = "middle": c[F].virtualFlightTagClass = "first only",
                    c[F].needVirtualFlightHeader = !1,
                    this.flightList && this.flightList.indexOf(c[F]) < 0 && this.flightList.push(c[F]),
                    this.T && this.T.indexOf(c[F]) < 0 && this.T.push(c[F]);
                    c[0].needVirtualFlightHeader = !0,
                    D = c.concat(D)
                }
                a.loadFinish && "function" == typeof a.nearDateDirectRecommendCallback && a.nearDateDirectRecommendCallback(),
                this.updateFlightImg(D);
                var G = (this.curSegment > 0 || this.runTimes > 0) && this.flightList.length < 1;
                if (this.container.html($.tmpl.render(this.tmpl, {
                    newPriceTips: ("S" == this.flightWay ? "": "D" == this.flightWay ? "\u5f80\u8fd4": "\u591a\u7a0b") + (this.isMultiTrave ? "\u4eba\u5747": "") + ("TotalPrice" === this.curType ? "\u542b\u7a0e\u4ef7": "\u7968\u4ef7"),
                    flightWay: this.flightWay,
                    priceTmpl: this.priceTmpl,
                    curSegment: this.curSegment,
                    isLastSegment: this.isLastSegment,
                    isFirst: 1,
                    isManCang: G,
                    lowPrice: this.lowPrice,
                    list: D,
                    curType: a.curType,
                    addtionTmplVar: a.addtionService.addtionTmplVar
                })), E) {
                    var H = jQuery("#virtualFlightMore");
                    H.unbind("click").bind("click",
                    function(a) {
                        var b = H.find(".icon-caret-up").length,
                        c = H.find(".expand-text");
                        if (b) {
                            c.text("\u67e5\u770b\u66f4\u591a");
                            var d = H.find(".collapse-arrow");
                            d.removeClass("icon-caret-up"),
                            jQuery(".virtual-flight:gt(0)").slideUp("normal",
                            function() {
                                jQuery(window).scrollTop(jQuery(".flights-header").offset().top)
                            })
                        } else {
                            c.text("\u6536\u8d77");
                            var d = H.find(".collapse-arrow");
                            d.addClass("icon-caret-up"),
                            jQuery(".virtual-flight:gt(0)").slideDown("normal")
                        }
                    })
                }
                if (this.loadFinish && this.isUpdateRemindtag && (this.isUpdateRemindtag = !1, window.stopoverRemind && window.stopoverRemind.remindTipsUBT(a.commonDataHandler(a.travelInsurePreHandler(b)))), u && a.combineToTab(), a.MultiTraveSearchNoData && 0 == $("#MultiTraveSearchNoDataTip").length) {
                    var I = "";
                    a.copyCond && a.copyCond.ChildQuantity > 0 && (I = '<h2 class="notice-title" style="margin-bottom:0;">\u8be5\u822a\u7ebf\u4e0d\u652f\u6301\u6210\u4eba\u548c\u513f\u7ae5\u4e00\u8d77\u8ba2\u7968\u3002\u5f53\u524d\u5df2\u4e3a\u60a8\u663e\u793a\u6210\u4eba\u7968\u4ef7\u3002<br>\u5982\u9700\u513f\u7ae5\u7968\uff0c\u8bf7\u5206\u5f00\u67e5\u8be2\u3002<a class="MultiTraveSearch link" href="javascript:;">\u67e5\u8be2\u513f\u7ae5\u7968</a></h2>'),
                    a.copyCond && a.copyCond.InfantQuantity > 0 && (I = '<h2 class="notice-title" style="margin:12px 0 0 0;">\u8be5\u822a\u7ebf\u4e0d\u652f\u6301\u6210\u4eba\u548c\u5a74\u513f\u4e00\u8d77\u8ba2\u7968\u3002\u5f53\u524d\u5df2\u4e3a\u60a8\u663e\u793a\u6210\u4eba\u7968\u4ef7\u3002</h2>'),
                    a.copyCond && a.copyCond.ChildQuantity > 0 && a.copyCond.InfantQuantity > 0 && (I = '<h2 class="notice-title" style="margin:12px 0 0 0;">\u8be5\u822a\u7ebf\u4e0d\u652f\u6301\u6210\u4eba\u513f\u7ae5\u5a74\u513f\u4e00\u8d77\u8ba2\u7968\u3002\u5f53\u524d\u5df2\u4e3a\u60a8\u663e\u793a\u6210\u4eba\u7968\u4ef7\u3002</h2>');
                    var J = document.createElement("div");
                    J.id = "MultiTraveSearchNoDataTip",
                    J.style.marginBottom = "12px",
                    J.innerHTML = '<div class="noresult-notice"><i class="icon-warn"></i>' + I + "</div>",
                    $(J).prependTo($("#result-wrapper")),
                    $("#MultiTraveSearchNoDataTip").onn("click", "MultiTraveSearch",
                    function(b) {
                        b.stop(),
                        location.hash = "ctm_ref=fli_sr_child_sr",
                        window.keepHash = !0,
                        $("#Quantity").value(0),
                        $("#Quantity").trigger("change"),
                        $("#fmResultPage").attr("target", "_blank"),
                        $("#ChildQuantity").value(a.copyCond.ChildQuantity),
                        $("#ChildQuantity").trigger("change"),
                        $("#btnSearch")[0].click(),
                        $("#fmResultPage").attr("target", ""),
                        $("#Quantity").value(a.copyCond.Quantity),
                        $("#Quantity").trigger("change"),
                        $("#ChildQuantity").value(0),
                        $("#ChildQuantity").trigger("change"),
                        window.keepHash = !1
                    })
                }
                G && this.filterService && (this.filterService.dispose(), this.segmentPanel.hide(), "M" === this.flightWay && this.StepPanel.hide(), this.sortControl.hide(), Cache = {}),
                this.addCallback(this.container),
                this.loadingList[this.allowLoad ? "removeClass": "addClass"]("hide"),
                this.loadStatus.find(".loading-status b, .loading-complete b:first").html(b.length),
                this.loadStatus.find(".loading-complete b:last").html(o),
                this.loadAggFinished = this.loadFinish,
                pageGlobal.NearDateDirectFlightRecommendSwitch ? this.showNearDateOnlineFlight(b.length > 0, this.dlen > 0 && this.isDirectAndSameGrade) : this.showNearOnlineFlight(b.length > 0, this.dlen > 0 && this.isDirectAndSameGrade),
                this.showDownGradeTipIfDownGrade(b),
                this.updateDowngradeUBT(),
                this.updateUpgradeRecommendTagUBT(),
                this.updateStopoverRemindUBT(),
                this.loadFinish && (this.allowLoad && (clearInterval(a.interVal), a.interVal = setInterval(function() {
                    return a.allowLoad === !1 ? ($(".flights-list .plane-type").bind("mouseenter",
                    function() {
                        window.__bfi.push(["_tracklog", "c_flttypename_list", $.stringifyJSON(1)])
                    }), void clearInterval(a.interVal)) : void a.autoAdd()
                },
                1e3)), pageGlobal.AirportRecommendCitySwitch && (this.isOnewayTrip() || this.isRoundTrip() || this.isRoundTripCombination() && 0 == this.curSegment) && this.showAirportRecommendCity()),
                pageGlobal.NewUbt.Pre_Insurance = pageGlobal.NewUbt.Pre_Insurance || [];
                var K = $("button.btn-book[data-travelinsurepre]").length > 0 ? "Y": "N",
                L = function(a) {
                    var b = null;
                    return pageGlobal.NewUbt.Pre_Insurance.each(function(c) {
                        c.pagelocation == a && (b = c)
                    }),
                    b
                },
                M = null;
                "freeStyle" == a.flightType && 0 == this.curSegment && (M = L("\u81ea\u7531\u642d\u914d\u53bb\u7a0b"), M ? M.has_pre_insurance = K: pageGlobal.NewUbt.Pre_Insurance.push({
                    pagelocation: "\u81ea\u7531\u642d\u914d\u53bb\u7a0b",
                    has_pre_insurance: K
                })),
                "builtUp" == a.flightType && (M = L("\u5f80\u8fd4\u7ec4\u5408"), M ? M.has_pre_insurance = K: pageGlobal.NewUbt.Pre_Insurance.push({
                    pagelocation: "\u5f80\u8fd4\u7ec4\u5408",
                    has_pre_insurance: K
                })),
                a.fixedFreeInsureStyle()
            },
            reportNearOnlineUbt: function(a, b, c) {
                var d = this;
                if (pageGlobal.NearOnlineRecommendFlightSwitch && b && c && !this.isNearOnlineReported) {
                    var e = this.getNearOnlineUbtDataFromUbt(),
                    f = !1;
                    if (pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                        return a && "5" === a.Type ? (f = !0, void(d.nearOnlineFlightsUbt.RecommendProduct = a)) : void 0
                    }), f && !a) return e.RecommendProduct.push(d.nearOnlineFlightsUbt.RecommendProduct),
                    e.HasDirect = d.nearOnlineFlightsUbt.HasDirect,
                    this.isNearOnlineReported = !0,
                    void window.__bfi.push(["_tracklog", "flt_oversea_recommend_online", $.stringifyJSON(e)]);
                    var g = $.storage.get("nearOnlineByRecommendUbt");
                    if (null != g && g.RecommendProduct.ToDate == $("#DDate").value() && g.ACityCode == condition.SegmentList[0].ACityCode && !this.isNearOnlineReported) {
                        pageGlobal.NewUbt.RecommendProduct.push(g.RecommendProduct),
                        pageGlobal.NewUbt.HasDirect = g.HasDirect;
                        var h = !1;
                        pageGlobal.NewUbt.RecommendProduct.each(function(b) {
                            return b && "5" === b.Type && "Y" == b.IsClick ? (h = !0, a && (pageGlobal.NewUbt.HasDirect = "Y", d.nearOnlineFlightsUbt.HasDirect = "Y"), d.nearOnlineFlightsUbt.RecommendProduct = b, void $.storage.set("nearOnlineByRecommendUbt", d.nearOnlineFlightsUbt || {},
                            30)) : void 0
                        }),
                        h && (e.RecommendProduct.push(d.nearOnlineFlightsUbt.RecommendProduct), e.HasDirect = d.nearOnlineFlightsUbt.HasDirect, this.isNearOnlineReported = !0, window.__bfi.push(["_tracklog", "flt_oversea_recommend_online", $.stringifyJSON(e)]))
                    }
                }
            },
            getNearOnlineUbtDataFromUbt: function() {
                var a = {};
                return a.Sequence = [],
                a.RecommendProduct = [],
                a.FlightClass = pageGlobal.NewUbt.FlightClass,
                a.FlightWay = pageGlobal.NewUbt.FlightWay,
                a.AirLine = pageGlobal.NewUbt.AirLine,
                a.Class = pageGlobal.NewUbt.Class,
                a.PassengerType = pageGlobal.NewUbt.PassengerType,
                a.Sequence.push(pageGlobal.NewUbt.Sequence),
                a.UId = pageGlobal.NewUbt.UId,
                a.TriggerType = "Load",
                a
            },
            showAirportRecommendCity: function() {
                if (! ($(".subairport-recmd-banner") && $(".subairport-recmd-banner").length > 0)) {
                    for (var a = this.loadStatus.find(".loading-status b, .loading-complete b:first").text(), b = this.getCurFlightList(), c = [], d = [], e = 0; e < b.length; e++) {
                        var f = b[e];
                        pageGlobal.VirtualFlightSwitch && f.ContainsVirtualFlight || (c.push(f), 1 === f.TransferCount && d.push(f))
                    }
                    if (c.length > 0 && 0 == $("#NoMatchTips").length) {
                        var g = this;
                        g.resultCount += c.length,
                        g.directFlightCount += c.filter(function(a) {
                            return ! (pageGlobal.VirtualFlightSwitch && a.ContainsVirtualFlight || 1 !== a.TransferCount)
                        }).length,
                        c.each(function(a, b) {
                            a.FareList.each(function(a, b) {
                                g.retLowTotalPrice > a.Price + a.Tax && (g.retLowTotalPrice = a.Price + a.Tax)
                            })
                        });
                        var h = $("#filterPanel"),
                        i = jQuery(h).find("#DPort"),
                        j = jQuery(h).find("#APort"),
                        k = jQuery(i).find(".filter-option"),
                        l = jQuery(j).find(".filter-option");
                        if (c.length > a) {
                            if (jQuery(i).find(".checkbox-icon-checked").length > 0 && k.length >= 2) {
                                var m = jQuery(i).find(".filter-sub-header").text();
                                m = m.length > 6 ? m.substr(0, 6) + "...": m
                            }
                            if (jQuery(j).find(".checkbox-icon-checked").length > 0 && l.length >= 2) {
                                var n = jQuery(j).find(".filter-sub-header").text();
                                n = n.length > 6 ? n.substr(0, 6) + "...": n
                            }
                            if (m || n) {
                                var o = $.tmpl.render('<div class="subairport-recmd-banner"><div class="srb-info"><div class="srb-title"><i class="decorate"></i>\u67e5\u770b{{if DCityName && ACityName}}<span class="address">${DCityName}</span>\u5230<span class="address">${ ACityName }</span>\u7684\u6240\u6709\u673a\u573a\u7684\u822a\u73ed{{else}}{{if DCityName && !ACityName}}<span class="address">${DCityName}</span>\u6240\u6709\u673a\u573a\u51fa\u53d1\u7684\u822a\u73ed{{else}}{{if !DCityName && ACityName}}\u5230\u8fbe<span class="address">${ ACityName }</span>\u6240\u6709\u673a\u573a\u7684\u822a\u73ed{{/if}}{{/if}}{{/if}}</div><div class="srb-amount">\u5171${ resultCount }\u4e2a\u822a\u73ed{{if directFlightCount>0}}\uff0c${directFlightCount}\u4e2a\u76f4\u98de{{/if}}</div><div class="srb-price"><dfn>\xa5</dfn>${ retLowTotalPrice }<span class="hint">\uff08\u542b\u7a0e\uff09\u8d77</span></div></div><button class="btn-book searchAllCity">\u67e5\u770b</button><a href="javascript:;" class="close" data-ubt-key="Close_moreairport">\xd7</a></div>', {
                                    DCityName: m,
                                    ACityName: n,
                                    resultCount: this.resultCount,
                                    directFlightCount: this.directFlightCount,
                                    retLowTotalPrice: this.retLowTotalPrice
                                });
                                jQuery("#result-wrapper").prepend(o)
                            }
                            $.storage.set("airportRecommendCityType", null, 0),
                            $(".subairport-recmd-banner").onn("click", "close",
                            function(a) {
                                $(".subairport-recmd-banner").css("display", "none"),
                                g.closeAirportrecommendCity = !0
                            }),
                            $(".filter-option").onn("click", "",
                            function(a) {
                                "none" == $(".subairport-recmd-banner").css("display") && $(".subairport-recmd-banner").css("display", "block")
                            }),
                            $("#DPort,#APort").onn("click", "",
                            function(a) {
                                $(".subairport-recmd-banner").css("display", "none")
                            }),
                            $(".searchAllCity").onn("click", "",
                            function(a) {
                                InternationalRecommend.airportRecommendCityClick(),
                                g.changeCondition(m, n),
                                g.closeAirportrecommendCity = !0,
                                g.airportRecommendCity.DCity = m,
                                g.airportRecommendCity.ACity = n,
                                document.title = document.title.replace(/\([^\)]*\)/g, "")
                            }),
                            "array" != $.type(pageGlobal.NewUbt.RecommendProduct) && (pageGlobal.NewUbt.RecommendProduct = []),
                            pageGlobal.NewUbt.RecommendProduct.push({
                                Type: "7"
                            }),
                            this.directFlightCount > 0 && InternationalRecommend.existHasDirect(),
                            InternationalRecommend.firstRecommendProd({},
                            "7")
                        }
                    }
                }
            },
            changeCondition: function(a, b) {
                var c = $("#homeCity").attr("mod_change_value") || "",
                d = $("#destCity").attr("mod_change_value") || "";
                if (a) {
                    if (!this.closeAirportrecommendCity) {
                        var e = c.split("|"),
                        f = a + "(" + condition.SegmentList[0].DCityCode + ")";
                        e[1] = f;
                        var g = e.join("|");
                        $("#homeCity").attr("mod_change_value", g),
                        $("#homeCity").value(f),
                        condition.SegmentList[0].DCity = g
                    }
                    $("#departCity").html(a)
                }
                if (b) {
                    if (!this.closeAirportrecommendCity) {
                        var h = d.split("|"),
                        i = b + "(" + condition.SegmentList[0].ACityCode + ")";
                        h[1] = i;
                        var g = h.join("|");
                        $("#destCity").attr("mod_change_value", g),
                        $("#destCity").value(i),
                        condition.SegmentList[0].ACity = g
                    }
                    $("#arrivalCity").html(b)
                }
            },
            showNearOnlineFlight: function(a, b) {
                if (pageGlobal.NearOnlineRecommendFlightSwitch) {
                    var c = 0 == $("#rec_flt_box").length || "none" === $("#rec_flt_box").css("display");
                    if (this.nearOnlineRecommendInitialized) return void(c ? $("#rec_near_box").show() : $("#rec_near_box").hide());
                    if (void 0 == a || null == a) {
                        var d = $("#loadingStatus").find(".loading-status b, .loading-complete b:first").text();
                        a = "" != d && d.toInt() > 0
                    } (void 0 == b || null == b) && (b = this.isDirectAndSameGrade),
                    a && !b && c ? 1 == $("#rec_near_box").length && ($("#rec_near_box").show(), this.loadFinish && (this.nearOnlineRecommendInitialized = !0)) : 1 == $("#rec_near_box").length && $("#rec_near_box").hide(),
                    this.reportNearOnlineUbt(b, this.loadNearOnlineFinished, this.loadAggFinished)
                }
            },
            showNearDateOnlineFlight: function(a, b) {
                if (pageGlobal.NearDateDirectFlightRecommendSwitch) {
                    var c = 0 == $("#rec_flt_box").length || "none" === $("#rec_flt_box").css("display");
                    if (this.nearOnlineRecommendInitialized) return void(c ? $("#neardate_recom_box").show() : $("#neardate_recom_box").hide());
                    if (void 0 == a || null == a) {
                        var d = $("#loadingStatus").find(".loading-status b, .loading-complete b:first").text();
                        a = "" != d && d.toInt() > 0
                    } (void 0 == b || null == b) && (b = this.isDirectAndSameGrade),
                    a && !b && c ? 1 == $("#neardate_recom_box").length && ($("#neardate_recom_box").show(), this.loadFinish && (this.nearOnlineRecommendInitialized = !0)) : 1 == $("#neardate_recom_box").length && $("#neardate_recom_box").hide(),
                    this.reportNearOnlineUbt(b, this.loadNearOnlineFinished, this.loadAggFinished)
                }
            },
            updateSequence: function() {
                var a = pageGlobal.NewUbt.Sequence[this.curSegment];
                if (a) {
                    a.IsFilter = this.filterService.curFilter.length ? "Y": "N",
                    a.TotalCnt = this.container.find(".seat-row ").length;
                    for (var b in a) - 1 !== b.indexOf("Shop") && (a[b] = 0);
                    this.container.find(".flagship-store").each(function(b) {
                        var c = b.attr("data-airline");
                        if (c) {
                            var d = c + "Shop";
                            a[d] = (a[d] || 0) + 1
                        }
                    })
                }
            },
            clearBuiltUpSign: function(a) {
                var b = ["IsSuggestPrice", "IsAppoint", "IsDirect", "IsEgoHback", "IsTabGroup"];
                a.each(function(a) {
                    b.each(function(b) {
                        a[b] && delete a[b]
                    })
                })
            },
            combineToTab: function() {
                try {
                    if ($(".J_lowPriceTabGroup").length >= 1) {
                        var a = $(".J_lowPriceTabGroup:eq(0)"),
                        b = a.find("h3.flight-bundle-title"),
                        c = [];
                        if ($(".J_lowPriceTabGroup").each(function(a) {
                            c.push({
                                type: a.find(".flight-item").attr("type"),
                                text: a.find(".flight-bundle-title").html()
                            })
                        }), b && (b.removeClass("flight-bundle-title").addClass("flight-title-tab J_lowPriceTitle"), b.html(""), b.html($.tmpl.render('{{each(i,v) list}}<span{{if i<1}} class="tab-cur"{{/if}} data-index="${i}" type="${v.type}" data-ubt-key="PriceSuggestion_${v.type === "LP"?"LowestPrice":(v.type === "DLP"?"DirectPrice":"FIFO")}">${v.text}</span>{{/each}}', {
                            list: c
                        }))), $(".J_lowPriceTabGroup").length >= 2) {
                            var d = this,
                            e = $(".J_lowPriceTabGroup").slice(1),
                            f = e.find(".flight-item");
                            f.appendTo(a),
                            e.remove(),
                            $(".J_lowPriceTabGroup").find(".flight-item").slice(1).css("display", "none"),
                            $(".J_lowPriceTitle span").bind("click",
                            function() {
                                var a = $(this),
                                b = $(this.parentNode).find("span"),
                                c = $(this.parentNode.parentNode),
                                e = a.attr("data-index");
                                a.hasClass("tab-cur") || (d.lpSugUbt(this, "J_lowPriceTitle", "time"), b.removeClass("tab-cur"), a.addClass("tab-cur"), c.find(".flight-item").css("display", "none"), c.find(".flight-item:eq(" + e + ")").css("display", "block"))
                            })
                        }
                    }
                } catch(g) {}
            },
            addCallback: function(a) {
                var b = this;
                if ("D" === this.flightWay && "builtUp" === this.flightType && this.isLocked === !1 && 1 !== $.storage.get("builtUpTips")) {
                    var c = $("#builtUpTips");
                    c.length < 1 && (c = document.createElement("div"), c.className = "tooltip-once", c.style.position = "absolute", c.style.zIndex = "20", c.style.display = "none", c.id = "builtUpTips", document.body.appendChild(c), c = $(c), c.onn("click", "tooltip-dismiss",
                    function(a) {
                        try {
                            a.stop()
                        } catch(a) {}
                        $.storage.set("builtUpTips", 1),
                        c.hide()
                    }), c.bind("mouseover",
                    function() {
                        clearTimeout(b.builtUpTimer)
                    }).bind("mouseout",
                    function() {
                        clearTimeout(b.builtUpTimer),
                        b.builtUpTimer = setTimeout(function() {
                            c.hide()
                        },
                        234)
                    })),
                    $(a).find(".flight-row-group .checkbox-icon").bind("mouseover",
                    function(a) {
                        var d = $(this);
                        if (1 !== $.storage.get("builtUpTips") && !d.hasClass("checkbox-icon-checked")) {
                            clearTimeout(b.builtUpTimer);
                            var e = d.offset();
                            c.css({
                                left: Math.ceil(e.left - 12) + "px",
                                top: Math.ceil(e.top + 27) + "px"
                            });
                            var f = "0" === d.attr("mode") ? "\u9501\u5b9a\u53bb\u7a0b\uff0c\u63a8\u8350\u66f4\u591a\u8fd4\u7a0b": "\u9501\u5b9a\u8fd4\u7a0b\uff0c\u63a8\u8350\u66f4\u591a\u53bb\u7a0b";
                            c.html('<div class="tooltip-content"><p>' + f + '\u3002<a href="#" class="tooltip-dismiss">\u6211\u77e5\u9053\u4e86</a></p><i class="tooltip-arrow-b" style="top:-6px;"></i></div>'),
                            c.show()
                        }
                    }).bind("mouseout",
                    function(a) {
                        1 !== $.storage.get("builtUpTips") && (clearTimeout(b.builtUpTimer), b.builtUpTimer = setTimeout(function() {
                            c.hide()
                        },
                        234))
                    }).bind("click",
                    function() {
                        c.hide()
                    })
                }
            },
            travelInsurePreHandler: function(a) {
                if ("D" != this.flightWay || !a || 0 == a.length || !pageGlobal.IsOpenTravelInsurePre) return a;
                var b = window.condition && condition.TravelInsurePre && "builtUp" != this.flightType && 0 != this.curSegment,
                c = this;
                return a.each(function(a) {
                    if (!a.FareList || 0 == a.FareList.length) return ! 0;
                    for (var d = 0; d < a.FareList.length; d++) if (a.FareList[d].TravelInsurePreAddtionList && 0 != a.FareList[d].TravelInsurePreAddtionList.length) {
                        var e = a.FareList[d].TravelInsurePreAddtionList[0];
                        a.FareList[d].TravelInsureExtend = {
                            hasSelectedTravelInsurePre: b,
                            ins: e,
                            insurePrice: e.UnitPrice,
                            price: a.FareList[d][c.curType] - e.InsuranceDiscountPrice,
                            jsonStr: encodeURIComponent($.stringifyJSON({
                                ID: e.ID,
                                ProductSerialNo: e.ProductSerialNo,
                                ProductShortName: e.ProductShortName,
                                OriginUnitPrice: e.UnitPrice,
                                UnitPrice: e.UnitPrice * e.Quantity,
                                DiscountPrice: e.InsuranceDiscountPrice,
                                OldPrice: a.FareList[d].Price,
                                OldTax: a.FareList[d].Tax
                            }))
                        }
                    }
                }),
                a
            },
            commonDataHandler: function(a) {
                if (!a || 0 == a.length) return a;
                var b = this,
                c = function() {
                    pageGlobal.IsOpenKEAirlineGodMark && a.each(function(a) {
                        return a.FareList && 0 != a.FareList.length ? void a.FareList.each(function(c) {
                            return "boolean" != typeof c.IsNeedMarkKEAirlineGodOrigin ? !0 : (c.IsNeedMarkKEAirlineGod = c.IsNeedMarkKEAirlineGodOrigin, ("D" == b.flightWay || "M" == b.flightWay) && !c.IsNeedMarkKEAirlineGod && c.IsGDSWSChannel && 2 == c.PlanCategory && !a.shareIdent && ("KE" == a.PrimaryAirlineCode || a.FlightDetail && a.FlightDetail.length > 0 && "KE" == a.FlightDetail[0].AirlineCode) && (c.IsNeedMarkKEAirlineGod = !0), c.IsNeedMarkKEAirlineGod && c.Tips && c.Tips.length > 0 && c.Tips.each(function(a) {
                                "BUSS" == a.Type && (a.Content = pageGlobal.KEAirlineGodMarkMessage)
                            }), void(c.IsNeedMarkKEAirlineGod && (c.ProductShowName = "\u5927\u97e9\u822a\u7a7a\u5b98\u65b9\u6388\u6743\u5e97")))
                        }) : !0
                    })
                };
                return c(),
                a
            },
            getCityObjectByTxt: function(a) {
                var b = {};
                if (!a) return b;
                if (a = a.split("|"), a.length >= 2) {
                    var c = a[1].match("(.+)\\(");
                    c && c.length >= 2 && (b.cityName = c[1])
                }
                return a.length >= 3 && (b.cityId = parseInt(a[2]) || 0),
                b
            },
            getFlightPriceListFromDOM: function(a) {
                var b = this,
                c = $(a ? "div#flightList .flight-item:lt(" + a + ")": "div#flightList .flight-item"),
                d = [],
                e = b.isRoundTripCombination(),
                f = 0,
                g = 0,
                h = "",
                i = null,
                j = function() {
                    this.FltName = [],
                    this.FlightNo = [],
                    this.Class = [],
                    this.Price = 0,
                    this.TripType = "",
                    this.ProductType = ""
                },
                k = function() {
                    this.Inbound = new j,
                    this.Outbound = new j
                };
                return c.each(function(a) {
                    var c = (a.find(".flight-row"), a.find(".flight-detail-expend")),
                    l = a.find(".seats-list .seat-row"),
                    m = c.find(".flight-detail-section"),
                    n = null;
                    e ? (n = new k, m.each(function(a) {
                        switch (f = parseInt(a.attr("segmentNo")), g = parseInt(a.attr("transfercount")), f) {
                        case 1:
                            n.Inbound.FltName.push(a.attr("airlineName") || ""),
                            n.Inbound.FlightNo.push(a.attr("flightNO") || ""),
                            n.Inbound.TripType = 1 == g ? "D": "T";
                            break;
                        case 2:
                            n.Outbound.FltName.push(a.attr("airlineName") || ""),
                            n.Outbound.FlightNo.push(a.attr("flightNO") || ""),
                            n.Outbound.TripType = 1 == g ? "D": "T"
                        }
                    })) : (n = new j, m.each(function(a) {
                        g = parseInt(a.attr("transfercount")),
                        n.FltName.push(a.attr("airlineName") || ""),
                        n.FlightNo.push(a.attr("flightNO") || ""),
                        n.TripType = 1 == g ? "D": "T"
                    })),
                    l.each(function(a) {
                        var c = $.extend(!0, {},
                        n);
                        h = b.classNameMap[a.attr("className") || ""] || "",
                        h ? e ? (c.Inbound.FlightNo.each(function() {
                            c.Inbound.Class.push(h)
                        }), c.Outbound.FlightNo.each(function() {
                            c.Outbound.Class.push(h)
                        })) : c.FlightNo.each(function() {
                            c.Class.push(h)
                        }) : (i = $.parseJSON(decodeURIComponent(a.attr("classInfo") || "")) || [], i.each(function(a) {
                            e ? (1 == a.SegmentNo && c.Inbound.Class.push(a.ClassGrade.toUpperCase()), 2 == a.SegmentNo && c.Outbound.Class.push(a.ClassGrade.toUpperCase())) : a.SegmentNo == b.curSegment + 1 && c.Class.push(a.ClassGrade.toUpperCase())
                        }), e && i && i.length > 0 && 0 == c.Outbound.Class.length && (c.Outbound.Class = c.Inbound.Class)),
                        e ? (c.Inbound.Price = c.Outbound.Price = parseFloat(a.attr("totalprice")) || 0, c.Inbound.ProductType = c.Outbound.ProductType = a.attr("productShowName") || "") : (c.Price = parseFloat(a.attr("totalprice")) || 0, c.ProductType = a.attr("productShowName") || ""),
                        d.push(c)
                    })
                }),
                d
            },
            reportFarePriceAttributeUBT: function() {
                try {
                    var a = this,
                    b = pageGlobal.FltUBTMaxCount,
                    c = {};
                    c.TriggerType = "Exit",
                    c.FltProductList = a.getAllFarePriceAttributeUBT(b),
                    c.SearchRealLowestPrice = a.lowTotalPrice || 0,
                    c.UId = pageGlobal.NewUbt.UId,
                    c.PassengerType = {
                        Adult: a.cond.Quantity || 0,
                        Children: a.cond.ChildQuantity || 0,
                        Infant: a.cond.InfantQuantity || 0
                    },
                    c.Sequence = [],
                    (a.cond.SegmentList || []).each(function(b) {
                        var d = a.getCityObjectByTxt(b.ACity),
                        e = a.getCityObjectByTxt(b.DCity);
                        c.Sequence.push({
                            From: {
                                CityName: e.cityName || "",
                                CityCode: b.DCityCode,
                                CityID: e.cityId
                            },
                            To: {
                                CityName: d.cityName || "",
                                CityCode: b.ACityCode,
                                CityID: d.cityId
                            },
                            StartTime: b.DepartDate
                        })
                    }),
                    window.__bfi.push(["_tracklog", "flt_oversea_search_result_online_fltpricerule", $.stringifyJSON(c)])
                } catch(d) {
                    $.error("reportFarePriceAttributeUBT", "flt_oversea_search_result_online_fltpricerule\u57cb\u70b9\u51fa\u9519", d)
                }
            },
            getAllFarePriceAttributeUBT: function(a) {
                var b = $(a ? "div#flightList .flight-item:lt(" + a + ")": "div#flightList .flight-item"),
                c = [];
                return b.each(function(a) {
                    for (var b = a.find(".seats-list .seat-row"), d = 0; d < b.length; d++) {
                        var e, f = b[d],
                        g = {},
                        h = $(f).find(".seat-price:first");
                        if (h) {
                            if (!h.attr("SeatPriceTag")) continue;
                            e = h.attr("priceattributecombinecode")
                        }
                        g.rule = e || "",
                        g.producttype = $(f).attr("productShowName") || "",
                        g.reimbursement = $(f).attr("invoicetypes") || "",
                        g.BookingChannel = $(f).attr("BookingChannel") || "",
                        c.push(g)
                    }
                }),
                c
            },
            reportProductSelectUBT: function() {
                $.storage.set("hasClickNext", "", 30);
                var a = this,
                b = {};
                if ("S" == a.flightWay || "D" == a.flightWay) if (pageGlobal.CASpecialInvite) {
                    b.ProductTags || (b.ProductTags = []);
                    var c = $(".ca_special_invite").length;
                    b.ProductTags.push({
                        Type: 4,
                        Count: c
                    }),
                    $.storage.set("CASpecialInviteSearchExist", c ? "T": "", 30)
                } else $.storage.set("CASpecialInviteSearchExist", "", 30);
                else $.storage.set("CASpecialInviteSearchExist", "", 30);
                if (pageGlobal.MUSpecialInvite) {
                    b.ProductTags || (b.ProductTags = []);
                    var d = $(".mu_special_invite").length;
                    b.ProductTags.push({
                        Type: 6,
                        Count: d
                    }),
                    $.storage.set("MUSpecialInviteSearchExist", d ? "T": "", 30)
                } else $.storage.set("MUSpecialInviteSearchExist", "", 30);
                if (pageGlobal.IsOpenMUFareTagSwitch) {
                    b.ProductTags || (b.ProductTags = []);
                    var e = $(".tag_fare_info").length;
                    b.ProductTags.push({
                        Type: 5,
                        Count: e
                    }),
                    $.storage.set("MUFareInfoSearchExist", e ? "T": "", 30)
                } else $.storage.set("MUFareInfoSearchExist", "", 30);
                try {
                    if (pageGlobal.IsOpenFlightProductStatistic) {
                        b.FlightClass = "I",
                        b.FlightWay = a.cond.FlightWay,
                        b.Class = a.cond.ClassGrade || "N",
                        b.AirLine = a.cond.Airline || "N",
                        b.PassengerType = {
                            Adult: a.cond.Quantity || 0,
                            Children: a.cond.ChildQuantity || 0,
                            Infant: a.cond.InfantQuantity || 0
                        },
                        b.Sequence = [],
                        (a.cond.SegmentList || []).each(function(c) {
                            var d = a.getCityObjectByTxt(c.ACity),
                            e = a.getCityObjectByTxt(c.DCity);
                            b.Sequence.push({
                                From: {
                                    CityName: e.cityName || "",
                                    CityCode: c.DCityCode,
                                    CityID: e.cityId
                                },
                                To: {
                                    CityName: d.cityName || "",
                                    CityCode: c.ACityCode,
                                    CityID: d.cityId
                                },
                                StartTime: c.DepartDate
                            })
                        }),
                        b.UId = pageGlobal.NewUbt.UId,
                        b.TriggerType = "Exit",
                        b.FlightList = a.getFlightPriceListFromDOM(200);
                        var f = a.commonDataHandler(a.getCurFlightList(!0) || []),
                        g = {};
                        f.each(function(b) {
                            return b && b.FareList && 0 != b.FareList.length ? void b.FareList.each(function(b) {
                                var c = "";
                                if (b.ClassName) c = a.classNameMap[b.ClassName] + "|" + b.ProductShowName;
                                else {
                                    var d = []; (b.ClassInfo || []).each(function(b) {
                                        a.isRoundTripCombination() ? d.push(b.ClassGrade.toUpperCase()) : b.SegmentNo == a.curSegment + 1 && d.push(b.ClassGrade.toUpperCase())
                                    }),
                                    c = d.sort() + "|" + b.ProductShowName
                                }
                                g[c] >= 0 ? g[c]++:g[c] = 1
                            }) : !0
                        }),
                        b.FlightAll = [];
                        for (var h in g) b.FlightAll.push({
                            Class: h.split("|")[0],
                            ProductType: h.split("|")[1],
                            Count: g[h]
                        });
                        a.isOnewayTrip() && (b.PageLocation = "\u5355\u7a0b"),
                        a.isRoundTrip() && (b.PageLocation = a.curSegment > 0 ? "\u8fd4\u7a0b": "\u53bb\u7a0b"),
                        a.isRoundTripCombination() && (b.PageLocation = "\u5f80\u8fd4\u7ec4\u5408"),
                        "M" == a.flightWay && (b.PageLocation = "\u7b2c" + (a.curSegment + 1) + "\u7a0b")
                    }
                    window.__bfi.push(["_tracklog", "flt_oversea_search_result_online_fltlist", $.stringifyJSON(b)])
                } catch(i) {
                    $.error("productSelectUBT", "flt_oversea_search_result_online_fltlist\u57cb\u70b9\u51fa\u9519", i)
                }
            },
            classNameMap: {
                "\u7ecf\u6d4e\u8231": "Y",
                "\u516c\u52a1\u8231": "C",
                "\u5934\u7b49\u8231": "F",
                "\u8d85\u7ea7\u7ecf\u6d4e\u8231": "S"
            },
            setFareClassGrade: function(a, b) {
                a && (a.IsC = "C" == b, a.IsF = "F" == b, a.IsY = "Y" == b, a.IsS = "S" == b, a.IsCorF = a.IsC || a.IsF, a.IsYorS = a.IsY || a.IsS, a.PrimaryClassGrade = b)
            },
            filterVirtualFlightList: function(a) {
                var b = [],
                c = a;
                if (pageGlobal.VirtualFlightSwitch) {
                    c = a.slice(0);
                    for (var d = 0; d < c.length; d++) {
                        var e = c[d];
                        e.ContainsVirtualFlight && (b.push(e), c.splice(d, 1), d--)
                    }
                }
                return {
                    virtual: b,
                    list: c
                }
            },
            initRecommendGroup: function(a, b) {
                var c = "C_F" == window.condition.ClassGrade || "C" == window.condition.ClassGrade || "F" == window.condition.ClassGrade,
                d = "C_F" == window.condition.ClassGrade,
                e = "F" == window.condition.ClassGrade,
                f = "C" == window.condition.ClassGrade;
                if (b = b || {},
                !pageGlobal.IsOpenCFNoDirectRecommendYS) return a;
                var g = this,
                h = $("#divCFNoDirectRecommendYS"),
                i = h.find(".notice-title"),
                j = [],
                k = [],
                l = null,
                m = [],
                n = [],
                o = [],
                p = [],
                q = [],
                r = [],
                s = [],
                t = [],
                u = [],
                v = [],
                w = null,
                x = [],
                y = [],
                z = [],
                A = [],
                B = [],
                C = [],
                D = [],
                E = 0,
                F = 0,
                G = 0,
                H = 0,
                I = 0,
                J = !1,
                K = !1,
                L = !1,
                M = !1,
                N = "",
                O = "",
                P = "",
                Q = [],
                R = "",
                S = "",
                T = "",
                U = [],
                V = this.isRoundTrip() && 1 == this.curSegment,
                W = "TransferCount" == this.sortKey,
                X = "TransferCount" !== this.sortKey,
                Y = this.filterService && this.filterService.curFilter && this.filterService.curFilter.length > 0,
                Z = [],
                _ = [],
                aa = !1;
                this.isOnewayTrip() && (T = "\u5355\u7a0b", S = "OW"),
                this.isRoundTrip() && !this.isRoundTripCombination() && 0 == this.curSegment && (T = "\u81ea\u7531\u642d\u914d\u53bb\u7a0b", S = "Free"),
                this.isRoundTripCombination() && (T = "\u5f80\u8fd4\u7ec4\u5408", S = "Built");
                var ba = this.recommendGroupDataTabTip[S] || {};
                if (!a || 0 == a.length) return a;
                if ("M" == this.flightWay) return a;
                if (!c) return a;
                var ca = this.filterVirtualFlightList(a),
                da = ca.virtual;
                if (a = ca.list, a.each(function(a) {
                    if (!a) return ! 0;
                    var b = [],
                    c = [],
                    h = [],
                    i = [],
                    k = [];
                    return a._recommendGroupRemark && (a._recommendGroupRemark = null),
                    a._recommendGroupTitle && (a._recommendGroupTitle = null),
                    a._appendShowMore && (a._appendShowMore = null),
                    a._YSfoldHide && (a._YSfoldHide = null, g.shouldFoldYS = !1),
                    a.FareList.each(function(a) {
                        a.IsCorF && b.push(a),
                        a.IsC && c.push(a),
                        a.IsF && h.push(a),
                        a.IsY && i.push(a),
                        a.IsS && k.push(a)
                    }),
                    d && b.length > 0 && (a.FareList = b),
                    f && c.length > 0 && (a.FareList = c),
                    f && 0 == c.length && h.length > 0 && (a.FareList = h),
                    f && 0 == b.length && k.length > 0 && (a.FareList = k),
                    f && 0 == b.length && 0 == k.length && (a.FareList = i),
                    e && h.length > 0 && (a.FareList = h),
                    e && 0 == h.length && c.length > 0 && (a.FareList = c),
                    e && 0 == b.length && k.length > 0 && (a.FareList = k),
                    e && 0 == b.length && 0 == k.length && (a.FareList = i),
                    a.FareList && 0 != a.FareList.length ? void j.push(a) : !0
                }), j.each(function(a) {
                    var b = !1,
                    c = !1,
                    d = !1,
                    e = !1,
                    f = !1;
                    a.FareList.each(function(a) {
                        a.IsC && (e = !0),
                        a.IsF && (f = !0),
                        a.IsYorS && (b = !0),
                        a.IsY && (c = !0),
                        a.IsS && (d = !0)
                    }),
                    e && E++,
                    f && F++,
                    b && G++,
                    c && H++,
                    d && I++
                }), a = j, !a || 0 == a.length || b.isOnlyFilter) return a.concat(da);
                if (h.hide(), this.recommendGroupData = new this.models.recommendGroupInfo, this.recommendGroupData.tip = "", this.recommendGroupData.groupList = [], V) return a.concat(da);
                if (d && G > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_FC_SY", l.Quantity = G, l.PageLocation = T, k.push(l)), e && (E > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_F_C", l.Quantity = E, l.PageLocation = T, k.push(l)), G > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_F_SY", l.Quantity = G, l.PageLocation = T, k.push(l)), H > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_F_Y", l.Quantity = H, l.PageLocation = T, k.push(l)), I > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_F_S", l.Quantity = I, l.PageLocation = T, k.push(l))), f && (F > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_C_F", l.Quantity = F, l.PageLocation = T, k.push(l)), G > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_C_SY", l.Quantity = G, l.PageLocation = T, k.push(l)), H > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_C_Y", l.Quantity = H, l.PageLocation = T, k.push(l)), I > 0 && (l = new this.models.recommendGroupUbt, l.Type = "4_C_S", l.Quantity = I, l.PageLocation = T, k.push(l))), k && k.length > 0 && (this.recommendGroupDataUbt[T] = k), a.each(function(a, b) {
                    if (!a) return ! 0;
                    var c = !1,
                    d = !1,
                    e = !1,
                    f = !1,
                    h = !1,
                    i = !1;
                    return a.FareList && 0 != a.FareList.length ? (a.FareList.each(function(a) {
                        c || (c = a.IsCorF),
                        e || (e = a.IsC),
                        f || (f = a.IsF),
                        d || (d = a.IsYorS),
                        h || (h = a.IsY),
                        i || (i = a.IsS),
                        J || (J = a.IsC),
                        K || (K = a.IsF),
                        L || (L = a.IsY),
                        M || (M = a.IsS)
                    }), g.isRoundTripCombination() ? (1 == a.FlightInfo[0].TransferCount && 1 == a.FlightInfo[1].TransferCount && (c && m.push(a), d && o.push(a), e && x.push(a), f && y.push(a), h && p.push(a), i && q.push(a)), a.FlightInfo[0].TransferCount > 1 && a.FlightInfo[1].TransferCount > 1 && (c && n.push(a), e && z.push(a), f && A.push(a), e && Q.push("\u516c\u52a1"), f && Q.push("\u5934\u7b49")), (1 == a.FlightInfo[0].TransferCount && a.FlightInfo[1].TransferCount > 1 || a.FlightInfo[0].TransferCount > 1 && 1 == a.FlightInfo[1].TransferCount) && (c && r.push(a), e && s.push(a), f && t.push(a))) : (1 == a.TransferCount && (c && m.push(a), e && x.push(a), f && y.push(a), d && o.push(a), h && p.push(a), i && q.push(a)), a.TransferCount > 1 && (c && n.push(a), e && z.push(a), f && A.push(a), e && Q.push("\u516c\u52a1"), f && Q.push("\u5934\u7b49"))), e && B.push(a), f && C.push(a), void((e || f) && D.push(a))) : !0
                }), o.length > 0 && (L && M ? N = "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e": L ? N = "\u7ecf\u6d4e": M && (N = "\u8d85\u7ea7\u7ecf\u6d4e")), n.length > 0 && (J && K ? O = "\u516c\u52a1/\u5934\u7b49": J ? O = "\u516c\u52a1": K && (O = "\u5934\u7b49")), N && O ? P = N + "/" + O: N ? P = N: O && (P = O), R = Q.unique().join("/"), d && (aa = B.length > 0 || C.length > 0), f && (aa = B.length > 0), e && (aa = C.length > 0), g.isRoundTripCombination() && (d && (W = !0, X ? D.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = D, w.remark = "CF\u76f4\u98de\u548c\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)) : (m.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = m, w.remark = "CF\u76f4\u98de", this.recommendGroupData.groupList.push(w)), r.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = r, w.remark = "CF\u76f4\u98de\u6216\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), n.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = n, w.remark = "CF\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w))), o.length > 0 && (p.length > 0 && U.push("\u7ecf\u6d4e"), q.length > 0 && U.push("\u8d85\u7ea7\u7ecf\u6d4e"), w = new this.models.recommendFlightGroup, w.groupTitle = '<div class="banner-tip"><img src="//pic.c-ctrip.com/fltcommon/icons/circle-heart.png" class="icon-circle-heart">\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u4ee5\u4e0b\u8865\u5145 <span class="mr5">' + N + "\u8231</span> \u76f4\u98de\u822a\u73ed</div>", w.flights = o, w.remark = "YS\u76f4\u98de", this.recommendGroupData.groupList.push(w)), 0 == B.length && 0 == C.length && o.length > 0 && (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u516c\u52a1/\u5934\u7b49\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + N + "\u8231</strong> \u76f4\u98de\u822a\u73ed", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE))), e && (Z = [], y.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = y, w.remark = "F\u76f4\u98de", this.recommendGroupData.groupList.push(w)), x.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = x, w.remark = "C\u76f4\u98de", this.recommendGroupData.groupList.push(w), Z.push("\u516c\u52a1")), o.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = o, w.remark = "YS\u76f4\u98de", this.recommendGroupData.groupList.push(w), p.length > 0 && Z.push("\u7ecf\u6d4e"), q.length > 0 && Z.push("\u8d85\u7ea7\u7ecf\u6d4e")), t.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = t, w.remark = "F\u76f4\u98de\u6216\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), s.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = s, w.remark = "C\u76f4\u98de\u6216\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w), Z.push("\u516c\u52a1")), A.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = A, w.remark = "F\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), z.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = z, w.remark = "C\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w), Z.push("\u516c\u52a1")), U = Z.unique(), U.length > 0 && (C.length > 0 ? this.recommendGroupData.tip = '\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u5df2\u8865\u5145\u90e8\u5206 <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed": (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u5934\u7b49\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE)))), f && (Z = [], x.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = x, w.remark = "C\u76f4\u98de", this.recommendGroupData.groupList.push(w)), y.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = y, w.remark = "F\u76f4\u98de", this.recommendGroupData.groupList.push(w), Z.push("\u5934\u7b49")), o.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = o, w.remark = "YS\u76f4\u98de", this.recommendGroupData.groupList.push(w), p.length > 0 && Z.push("\u7ecf\u6d4e"), q.length > 0 && Z.push("\u8d85\u7ea7\u7ecf\u6d4e")), s.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = s, w.remark = "C\u76f4\u98de\u6216\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), t.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = t, w.remark = "F\u76f4\u98de\u6216\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w), Z.push("\u5934\u7b49")), z.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = z, w.remark = "C\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), A.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = A, w.remark = "F\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w), Z.push("\u5934\u7b49")), U = Z.unique(), U.length > 0 && (B.length > 0 ? this.recommendGroupData.tip = '\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u5df2\u8865\u5145\u90e8\u5206 <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed": (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u516c\u52a1\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE))))), !g.isRoundTripCombination()) {
                    if (d) {
                        W = !0,
                        0 == g.curSegment && D.length > 0 && (this.shouldFoldYS = o.length > this.YS_FOLD_GATE);
                        var ea;
                        Y ? ea = ba.noResultFlag: (ba.noResultFlag = 0 == m.length && 0 == n.length && o.length > 0, ea = ba.noResultFlag),
                        X ? (D.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = D, w.remark = "CF\u76f4\u98de\u548c\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), o.length > 0 && (p.length > 0 && U.push("\u7ecf\u6d4e"), q.length > 0 && U.push("\u8d85\u7ea7\u7ecf\u6d4e"), w = new this.models.recommendFlightGroup, D.length > 0 && (w.groupTitle = '<div class="banner-tip"><img src="//pic.c-ctrip.com/fltcommon/icons/circle-heart.png" class="icon-circle-heart">\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u8865\u5145 <span class="mr5">' + N + "\u8231</span> \u76f4\u98de\u822a\u73ed</div>"), w.flights = o, w.remark = "YS\u76f4\u98de", this.recommendGroupData.groupList.push(w)), ea || this.prevSortKey === this.sortKey || (this.prevSortKey = this.sortKey, ba.allHidden = !0)) : (this.prevSortKey !== this.sortKey && (this.prevSortKey = this.sortKey, ba.allHidden = !1), m.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = m, w.remark = "CF\u76f4\u98de", this.recommendGroupData.groupList.push(w)), o.length > 0 && (p.length > 0 && U.push("\u7ecf\u6d4e"), q.length > 0 && U.push("\u8d85\u7ea7\u7ecf\u6d4e"), w = new this.models.recommendFlightGroup, m.length > 0 ? w.groupTitle = '<div class="banner-tip"><img src="//pic.c-ctrip.com/fltcommon/icons/circle-heart.png" class="icon-circle-heart">\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u4ee5\u4e0b\u8865\u5145 <span class="mr5">' + N + "\u8231</span> \u76f4\u98de\u822a\u73ed</div>": w.groupTitle = '<div class="banner-tip"><span class="mr5">' + N + "\u8231</span>\u76f4\u98de\u822a\u73ed</div>", w.flights = o, w.remark = "YS\u76f4\u98de", this.recommendGroupData.groupList.push(w)), n.length > 0 && (w = new this.models.recommendFlightGroup, o.length > 0 && (w.groupTitle = '<div class="banner-tip"><span class="mr5">' + R + "\u8231</span>\u4e2d\u8f6c\u822a\u73ed</div>"), w.flights = n, w.remark = "CF\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w))),
                        0 == m.length && n.length > 0 && o.length > 0 && !X && (this.recommendGroupData.tip = '\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u516c\u52a1/\u5934\u7b49\u8231\u65e0\u76f4\u98de\uff0c\u4e3a\u60a8\u63a8\u8350\u90e8\u5206 <strong class="f-orange">' + N + "\u8231</strong> \u76f4\u98de\u822a\u73ed\u3002"),
                        ea && (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u516c\u52a1/\u5934\u7b49\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + N + "\u8231</strong> \u822a\u73ed\u3002", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE)),
                        m.length > 0 && o.length > 0 && W && (ba.allHidden = !0)
                    }
                    e && (y.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = y, w.remark = "F\u76f4\u98de", this.recommendGroupData.groupList.push(w)), Z = [], x.length > 0 && Z.push("\u516c\u52a1"), q.length > 0 && Z.push("\u8d85\u7ea7\u7ecf\u6d4e"), p.length > 0 && Z.push("\u7ecf\u6d4e"), U = U.concat(Z), Z.length > 0 && (w = new this.models.recommendFlightGroup, w.groupTitle = '<div class="banner-tip"><span class="mr5">' + Z.join("/") + "\u8231</span>\u76f4\u98de\u822a\u73ed</div>", y.length > 0 && (w.groupTitle = '<div class="banner-tip">	<img src="//pic.c-ctrip.com/fltcommon/icons/circle-heart.png" class="icon-circle-heart">\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u4ee5\u4e0b\u8865\u5145\u66f4\u591a\u8231\u4f4d\u822a\u73ed</div>' + w.groupTitle), w.flights = [].concat(x, q, p), w.remark = "C/S/Y\u76f4\u98de", this.recommendGroupData.groupList.push(w)), Z = [], A.length > 0 && Z.push("\u5934\u7b49"), z.length > 0 && (Z.push("\u516c\u52a1"), U.push("\u516c\u52a1")), Z.length > 0 && (w = new this.models.recommendFlightGroup, w.groupTitle = '<div class="banner-tip"><span class="mr5">' + Z.join("/") + "\u8231</span>\u4e2d\u8f6c\u822a\u73ed</div>", w.flights = [].concat(A, z), w.remark = "F/C\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), U.length > 0 && (U = U.unique(), C.length > 0 ? y.length > 0 ? this.recommendGroupData.tip = "\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u5df2\u8865\u5145\u66f4\u591a\u8231\u4f4d\u822a\u73ed": this.recommendGroupData.tip = '\u62b1\u6b49\uff0c\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u5934\u7b49\u8231\u65e0\u76f4\u98de\uff0c\u4e3a\u60a8\u63a8\u8350\u90e8\u5206 <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed": (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u5934\u7b49\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE))), y.length > 0 && U.length > 0 && (W ? ba.allHidden = !0 : ba.allHidden = !1)),
                    f && (x.length > 0 && (w = new this.models.recommendFlightGroup, w.flights = x, w.remark = "C\u76f4\u98de", this.recommendGroupData.groupList.push(w)), Z = [], y.length > 0 && Z.push("\u5934\u7b49"), q.length > 0 && Z.push("\u8d85\u7ea7\u7ecf\u6d4e"), p.length > 0 && Z.push("\u7ecf\u6d4e"), U = U.concat(Z), Z.length > 0 && (w = new this.models.recommendFlightGroup, w.groupTitle = '<div class="banner-tip"><span class="mr5">' + Z.join("/") + "\u8231</span>\u76f4\u98de\u822a\u73ed</div>", x.length > 0 && (w.groupTitle = '<div class="banner-tip">	<img src="//pic.c-ctrip.com/fltcommon/icons/circle-heart.png" class="icon-circle-heart">\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u4ee5\u4e0b\u8865\u5145\u66f4\u591a\u8231\u4f4d\u822a\u73ed</div>' + w.groupTitle), w.flights = [].concat(y, q, p), w.remark = "F/S/Y\u76f4\u98de", this.recommendGroupData.groupList.push(w)), Z = [], z.length > 0 && Z.push("\u516c\u52a1"), A.length > 0 && (Z.push("\u5934\u7b49"), U.push("\u5934\u7b49")), Z.length > 0 && (w = new this.models.recommendFlightGroup, w.groupTitle = '<div class="banner-tip"><span class="mr5">' + Z.join("/") + "\u8231</span>\u4e2d\u8f6c\u822a\u73ed</div>", w.flights = [].concat(z, A), w.remark = "C/F\u4e2d\u8f6c", this.recommendGroupData.groupList.push(w)), U.length > 0 && (U = U.unique(), B.length > 0 ? x.length > 0 ? this.recommendGroupData.tip = "\u4e3a\u60a8\u7684\u51fa\u884c\u63d0\u4f9b\u66f4\u591a\u65f6\u95f4\u548c\u822a\u53f8\u9009\u62e9\uff0c\u5df2\u8865\u5145\u66f4\u591a\u8231\u4f4d\u822a\u73ed": this.recommendGroupData.tip = '\u62b1\u6b49\uff0c\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u516c\u52a1\u8231\u65e0\u76f4\u98de\uff0c\u4e3a\u60a8\u63a8\u8350\u90e8\u5206 <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed": (this.recommendGroupData.tip = '\u5f88\u62b1\u6b49\uff01\u60a8\u6240\u67e5\u8be2\u7684\u822a\u7ebf\u65e0\u516c\u52a1\u8231\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b <strong class="f-orange">' + U.join("/") + "\u8231</strong> \u822a\u73ed", NoResultRecommendUbt.addType(RECOMMENDTYPE_TWO_CLASS_DOWNGRADE))), x.length > 0 && U.length > 0 && (W ? ba.allHidden = !0 : ba.allHidden = !1))
                }
                return 0 == this.recommendGroupData.groupList.length && (a = [], this.recommendGroupData = null),
                W && this.recommendGroupData && this.recommendGroupData.groupList && this.recommendGroupData.groupList.length > 0 && (a = [], this.recommendGroupData.groupList.each(function(a) {
                    a.groupTitle && _.push(a.groupTitle)
                }), (1 == this.recommendGroupData.groupList.length || 0 == U.length) && this.recommendGroupData.groupList.each(function(a) {
                    a.groupTitle = null
                }), !aa && this.recommendGroupData.groupList.length >= 2 && 1 == _.length && this.recommendGroupData.groupList.each(function(a) {
                    a.groupTitle = null
                }), this.recommendGroupData.groupList.each(function(b) {
                    b.flights && b.flights.length > 0 && (b.flights[0]._recommendGroupRemark = b.remark, b.flights[0]._recommendGroupTitle = b.groupTitle, "YS\u76f4\u98de" === b.remark && g.shouldFoldYS && b.flights.each(function(a, c) {
                        c > g.YS_FOLD_GATE - 1 && (a._YSfoldHide = !0, b.flights[b.flights.length - 1]._appendShowMore = !0)
                    }), g.isRoundTripCombination() && !Y ? b.flights.each(function(a, c) {
                        if (a.IsSuggestPrice || a.IsTabGroup) {
                            var d = b.flights[c + 1];
                            b.flights[c + 1] && (d._recommendGroupRemark = a._recommendGroupRemark, d._recommendGroupTitle = a._recommendGroupTitle),
                            u.push(a),
                            delete a._recommendGroupRemark,
                            delete a._recommendGroupTitle
                        } else v.push(a)
                    }) : a = a.concat(b.flights))
                }), (u.length > 0 || v.length > 0) && (a = u.concat(v))),
                this.loadFinish && this.recommendGroupData && !ba.allHidden && (ba.msg && (this.recommendGroupData.tip = ba.msg), ba.msg = this.recommendGroupData.tip, ba.msg || (ba.allHidden = !0), this.recommendGroupData.tip && (i.html(this.recommendGroupData.tip), h.show())),
                a.concat(da)
            },
            setLowPainExponentFlcToTop: function(a) {
                if (!a || 0 == a.length) return a;
                var b = a.slice(0);
                if (this.SearchNearRecFltFlag && "T" == this.SearchNearRecFltFlag && "TransferCount" == this.sortKey) {
                    var c = 9999999,
                    d = -1;
                    b.each(function(a, b) {
                        a.PainExponent < c && (c = a.PainExponent, d = b)
                    }),
                    this.LowPainExponentFlcCache = [b[d]],
                    b.splice(d, 1),
                    b = this.LowPainExponentFlcCache.concat(b || [])
                }
                return b
            },
            sortFareByCategoryAndClassGrade: function(a) {
                if (!a || 0 == a.length) return a;
                var b = this;
                if (!b.isLastSegment) {
                    var a = $.extend(!0, [], a);
                    if (a && a.length > 0) for (var c = 0; c < a.length; c++) {
                        var d = a[c];
                        d.FareList = b.NewcomparePrice.getTheLowestPriceFareByCategoryAndClassGrade(d.FareList),
                        b.sortFareListByCurType(d.FareList),
                        b.reSortFareList(d.FareList)
                    }
                }
                return a
            },
            popSuperFlyerBox: function(a, b) {
                var c = "superFlyerContainer",
                d = function() {
                    var a = '				<div class="basic-popups popup-tips" style="margin:0 20px;display: inline-block;">					<i class="ico-warn"></i>					<div class="popup-body">						<div class="popup-info">							\u3010\u7279\u6b8a\u4ea7\u54c1\u3011\u822a\u73ed\u4e34\u8fd1\u8d77\u98de\u65f6\u95f4\uff0c\u8bf7\u5148\u5230\u822a\u53f8\u67dc\u53f0\u786e\u8ba4\u4ecd\u53ef\u503c\u673a\u540e\u518d\u9884\u8ba2\uff0c\u56e0\u8bef\u673a\u4ea7\u751f\u7684\u635f\u5931\u9700\u81ea\u884c\u627f\u62c5\u3002						</div>						<div class="popup-hint">\u652f\u4ed8\u6210\u529f5\u5206\u949f\u5185\u786e\u8ba4\u51fa\u7968\u7ed3\u679c\uff0c\u82e5\u51fa\u7968\u5931\u8d25\uff0c\u8ba2\u5355\u81ea\u52a8\u53d6\u6d88\u5e76\u9000\u6b3e\u3002</div>					</div>					<div class="popup-footer">						<div class="btn-group">							<a href="#" data="book" class="button">\u540c\u610f\u5e76\u9884\u5b9a</a>							<a href="#" data="back" class="button basic">\u91cd\u65b0\u9009\u62e9\u822a\u73ed</a>						</div>					</div>				</div>',
                    b = document.createElement("div");
                    b.id = c,
                    b.innerHTML = a,
                    b.style.display = "none",
                    document.body.appendChild(b),
                    this.needCreateSuperFlyerBox = !1
                };
                this.needCreateSuperFlyerBox && d.call(this);
                var e = $("#" + c);
                e.mask();
                var f = function(a, b, c) {
                    var d = c.target.getAttribute("data"); ("book" === d || "back" === d) && ("book" === d ? (this.handleBooking.call(a, this), b.book()) : b.back(), e.unmask())
                };
                e.bind("click", f.bind(this, a, b))
            },
            popVirtualFlightShouldKnowBox: function(a, b, c) {
                var d = a ? '<div class="popup-footer">						<div class="btn-group">							<a href="#" data="search" class="button">\u91cd\u65b0\u9009\u62e9\u822a\u73ed</a>							<a href="#" data="book" class="button basic" style="width: 180px;">\u6211\u5df2\u9605\u8bfb\u5e76\u7406\u89e3\u9884\u8ba2\u987b\u77e5</a>						</div>					</div>': '<div class="popup-footer">						<div class="btn-group">							<a href="#" data="cancel" class="button">\u6211\u77e5\u9053\u4e86</a>						</div>					</div>',
                e = "virtualFlightShouldKnow",
                f = function() {
                    var a = '				<div class="basic-popups popup-tips" style="margin:0 20px;display: inline-block;width:550px;">					<i class="ico-warn"></i>					<div class="popup-body">						<h3>' + pageGlobal.VirtualFightBuyShowKnow_Title + '</h3><br/>						<div class="popup-info">							' + pageGlobal.VirtualFightBuyShowKnow_TopPart + '						</div>						<div class="popup-hint">							' + pageGlobal.VirtualFightBuyShowKnow_BottomPart + "						</div>					</div>" + d + "</div>";
                    $("#" + e).remove();
                    var b = document.createElement("div");
                    b.id = e,
                    b.innerHTML = a,
                    b.style.display = "none",
                    document.body.appendChild(b)
                };
                f.call(this);
                var g = $("#" + e);
                g.mask();
                var h = function(a, b, c) {
                    var d = c.target.getAttribute("data");
                    if ("cancel" == d) g.unmask();
                    else if ("search" == d) try {
                        g.unmask(),
                        $("#btnSearch")[0].click()
                    } catch(e) {
                        location.reload()
                    } else "book" == d && (g.unmask(), this.handleBooking.call(a, this))
                };
                g.bind("click", h.bind(this, b, c))
            },
            handleBooking: function(a) {
                var b = this,
                c = a;
                if (c.stayTimeout) return void c.showTimeoutTips();
                var d = "\u9884\u8ba2" === $(b).html() || "1" === $(b).attr("data-booking"),
                e = jQuery.Deferred(),
                f = $(b).attr("data-new3x-fid") || "";
                if (d && f) {
                    $(b).removeAttr("data-fid");
                    var g = jQuery.parseJSON(unescape($(b).attr("data-new3x-infoJson") || "{}")),
                    h = (c.addtionService.getAddtionList(f) || [])[0] || {},
                    i = '<div class="popup-coupon" id="divNew3XDialog">	                                                    <a href="javascript:void(0);" class="close">\xd7</a>	                                                    <p class="popup-coupon-title">${title}</p>		                                                ${content}	                                                    <div class="popup-coupon-operation">		                                                    <a href="javascript:;" class="popup-coupon-button btn3XGiveUp">\u5fcd\u75db\u653e\u5f03</a>		                                                    <a href="javascript:;" class="popup-coupon-button primary btn3XGet">\u6293\u4f4f\u4f18\u60e0</a>	                                                    </div>                                                    </div>';
                    i = $.tmpl.render(i, {
                        content: $.tmpl.render(g.RemindTipTpl || "", {
                            data3X: h
                        }),
                        title: "\u60a8\u786e\u8ba4\u653e\u5f03&yen;" + h.UnitPrice * h.Quantity + h.ProductShortName + "\uff1f"
                    });
                    var j = dialog({
                        fixed: !0,
                        content: i
                    }).showModal();
                    window.pageGlobal.NewUbt.HoverTime.showstay = (window.pageGlobal.NewUbt.HoverTime.showstay || 0) + 1;
                    var k = $("#divNew3XDialog");
                    k.find(".btn3XGiveUp").bind("click",
                    function() {
                        $(b).attr("data-new3x-type", "alterabandon"),
                        e.resolve(),
                        j.remove(),
                        window.pageGlobal.NewUbt.HoverTime.staybandon = (window.pageGlobal.NewUbt.HoverTime.staybandon || 0) + 1
                    }),
                    k.find(".btn3XGet").bind("click",
                    function() {
                        $(b).attr("data-fid", $(b).attr("data-new3x-fid")),
                        $(b).attr("data-new3x-type", "alertreceive"),
                        e.resolve(),
                        j.remove(),
                        window.pageGlobal.NewUbt.HoverTime.stayreceive = (window.pageGlobal.NewUbt.HoverTime.stayreceive || 0) + 1
                    }),
                    k.find(".close").bind("click",
                    function() {
                        e.reject(),
                        j.remove()
                    })
                } else e.resolve();
                jQuery.when(e).then(function() {
                    var a = $(b),
                    d = a.attr("data-time");
                    if (!a.hasClass("J_disabled")) {
                        if (null !== d) {
                            d = parseInt(d, 10);
                            var e = a.attr("data-cityid"),
                            f = a.attr("data-validatetime");
                            if (null === f && (f = a.parentNode().parentNode().parentNode().parentNode().attr("data-validatetime")), null !== f && c.checkFlyTime(a, f, d, e) === !1) return
                        }
                        var g = a.html(),
                        h = a.attr("data-fid");
                        if (h) if (c.addtionService.saveData(h), c.AddtionList) {
                            var i = c.addtionService.getAddtionList(h);
                            "" !== i[0].ProductName && (c.AddtionList = i)
                        } else c.AddtionList = c.addtionService.getAddtionList(h);
                        else c.addtionService.clearSaveData(),
                        c.AddtionList = null;
                        if (c.reportSearchUBT(a, g), c.cacheHKChooseTag(a, c), c.updateUpgradeRecommendTagUBT(a), c.cacheSelectedGiftTag(a, c), c.cacheDisplayGiftTagUbt(), c.reportFarePriceAttributeUBT(), pageGlobal.FreePickUpCount = (pageGlobal.FreePickUpCount || 0) > 0 ? pageGlobal.FreePickUpCount: $(".pickup-package").length, "\u9884\u8ba2" === g || "1" === a.attr("data-booking")) {
                            c.lpSugUbt(b, "flight-item", "isbooking"),
                            c.isBooking = 1,
                            LastToken = [a.attr("token"), null !== d],
                            setTimeout(function() {
                                delete c.isBooking
                            },
                            2e3);
                            var j = a[0].id;
                            j || (j = "bookingBtn_" + Math.random().toString().substr(4), a[0].id = j);
                            try {
                                __SSO_booking(j, 1)
                            } catch(k) {
                                $.error(k, "__SSO_booking \u65b0\u7248\u641c\u7d22\u7ed3\u679c\u9875[" + a.attr("token") + "]"),
                                online.checkLogin(j)
                            }
                            var l = jQuery(b).parents(".flight-item");
                            if (l.attr("data-utoken") && c.selectComfortFlight.length > 0 && "S" == c.cond.FlightWay) {
                                for (var m = 0; m < c.selectComfortFlight.length; m++) if (l.attr("data-utoken") == c.selectComfortFlight[m].Utoken) {
                                    var n = {
                                        Punctuality_rate: c.selectComfortFlight[m].Punctuality_rate,
                                        delay_time: c.selectComfortFlight[m].delay_time
                                    };
                                    $.storage.set("FlightComfortResult", n, 30);
                                    break
                                }
                                m >= c.selectComfortFlight.length && (n = [], $.storage.set("FlightComfortResult", n))
                            } else n = [],
                            $.storage.set("FlightComfortResult", n)
                        } else c.isUpdateRemindtag = !0,
                        c.getNextSegment($(b))
                    }
                })
            },
            bindCFDowngradeYSFoldEvent: function() {
                $("body").onn("click", "showMoreYSLink",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    $("._YSfold").removeClass("_YSfoldHide"),
                    $("#showMoreYS").hide(),
                    $("#foldYS").show()
                }),
                $("body").onn("click", "foldYSLink",
                function(a) {
                    try {
                        a.stop()
                    } catch(a) {}
                    $("._YSfold").addClass("_YSfoldHide"),
                    $("#foldYS").hide(),
                    $("#showMoreYS").show()
                })
            },
            renderNearDateRecommendFlights: function(a) {
                var b = "D" === condition.FlightWay && a[0].ReturnDate,
                c = function(a) {
                    var c = {
                        data: d(a),
                        isShowBtn: a.length <= 2,
                        isShowSlideArrow: a.length > 5,
                        isNoSlide: a.length >= 3 && a.length <= 5
                    };
                    return "S" !== condition.FlightWay || a[0].ReturnDate ? b ? $.tmpl.render(this.nearDateRecommendTmpl.nearDateRecommendRoundTripTmpl, c) : void 0 : $.tmpl.render(this.nearDateRecommendTmpl.nearDateRecommendOneWayTmpl, c)
                },
                d = function(a) {
                    var b = [],
                    c = function(a) {
                        var b = a.split("-");
                        return "" + b[1] + "-" + b[2]
                    };
                    return a.each(function(a) {
                        var d = {
                            DepartureDate: c(a.DepartureDate),
                            DepartYear: a.DepartureDate.split("-")[0],
                            HasDirect: a.HasDirect,
                            ReturnHasDirect: a.ReturnHasDirect
                        };
                        d.DateOfWeek = a.DateOfWeek,
                        a.ReturnDate && (d.ReturnDate = c(a.ReturnDate), d.ReturnYear = a.ReturnDate.split("-")[0]),
                        a.ReturnDateOfWeek && (d.ReturnDateOfWeek = a.ReturnDateOfWeek),
                        b.push(d)
                    }),
                    b
                },
                e = this;
                $("#neardate_recom_box") && $("#neardate_recom_box").remove();
                var f = document.createElement("div");
                f.id = "neardate_recom_box",
                f.style.display = "none";
                var g = $(f);
                g.insertBefore($("#flightList")),
                g.html(c.call(this, a));
                var h = function(a) {
                    var b = (condition.SegmentList[0].DCity, condition.SegmentList[0].ACity, condition.SegmentList[0].ClassGrade, a.find(".fdc-trip")[0].getElementsByTagName("span")[0]),
                    c = a.find(".fdc-trip")[1],
                    d = c && c.getElementsByTagName("span")[0],
                    e = b.getAttribute("data-dyear") + "-" + b.innerText,
                    f = d ? d.getAttribute("data-ryear") + "-" + d.innerText: "";
                    0 != $("#btnSearch").length && ($("#DDate").value(e), "" != f && $("#ADate").value(f), $("#Airline").value(""), $("#txtAirline").value(""), $("#btnSearch")[0].click())
                };
                g.find(".check-btn").length ? g.onn("click", "check-btn",
                function(a) {
                    a.stop(),
                    InternationalRecommend.handleClickNearDate(this.parentNode, e),
                    h($(this.parentNode))
                }) : g.find(".fdc-item").length && g.onn("click", "fdc-item",
                function(a) {
                    a.stop(),
                    InternationalRecommend.handleClickNearDate(this, e),
                    h($(this))
                });
                var i = g.find(".pre-btn"),
                j = g.find(".next-btn"),
                k = 5,
                l = (a.length - k, 0),
                m = function(b, c, d, e, f) {
                    if (b.stop(), !c.hasClass("arrow_left_disable") && !c.hasClass("arrow_right_disable")) {
                        var g = -1 !== c[0].className.indexOf("next"),
                        h = a.length - k;
                        if (! (g && l >= h || !g && 1 > l)) {
                            l += g ? k: -k;
                            var i = e.find(".next-btn"),
                            j = e.find(".pre-btn");
                            g ? j.hasClass("arrow_left_disable") && j.removeClass("arrow_left_disable") : (0 > l && (l = 0), i.hasClass("arrow_right_disable") && i.removeClass("arrow_right_disable")),
                            d.animate({
                                marginLeft: -l * (f ? 156 : 161)
                            }),
                            g ? l === h && c.addClass("arrow_right_disable") : 0 === l && c.addClass("arrow_left_disable")
                        }
                    }
                }; (i.length || j.length) && g.onn("click", "pre-btn",
                function(a) {
                    a.stop(),
                    m(a, $(this), $(".fdc-items"), g, b)
                }).onn("click", "next-btn",
                function(a) {
                    a.stop(),
                    m(a, $(this), $(".fdc-items"), g, b)
                })
            },
            filterNearDateRecommend: function(a) {
                var b = [],
                c = this;
                return a.each(function(a) {
                    switch (c.freeStyleHasBothDirectFlag) {
                    case "half":
                        a.HasDirect && a.ReturnHasDirect && b.push(a);
                        break;
                    case "":
                        a.HasDirect && b.push(a);
                        break;
                    case "both":
                    }
                }),
                b
            },
            renderTransPUConfigedText: function(a) {
                if (!a || 0 == a.length) return a;
                var b = this;
                if (a && a.length > 0) for (var c = 0; c < a.length; c++) {
                    var d = a[c];
                    b.checkIfAllTransMultiPUFare(d)
                }
            },
            checkIfAllTransMultiPUFare: function(a) {
                if (a.FareList && 0 != a.FareList.length) {
                    a.AllTransMultiPUFare = !0;
                    for (var b = 0; b < a.FareList.length; b++) if (!a.FareList[b].TransMultiPUInfo) {
                        a.AllTransMultiPUFare = !1;
                        break
                    }
                    var c = this;
                    a.AllTransMultiPUFare && c.parseTransMultiPUCities(a)
                }
            },
            parseTransMultiPUCities: function(a) {
                if (a.FareList && 0 != a.FareList.length && a.FareList[0].TransMultiPUInfo) {
                    var b = this;
                    "D" === b.flightWay ? a.FlightInfo ? (b.formatFlightTransMultipPUTransCity(a, !0, !1), b.formatFlightTransMultipPUTransCity(a, !0, !0)) : b.formatFlightTransMultipPUTransCity(a, !1, 1 == b.curSegment) : b.formatFlightTransMultipPUTransCity(a, !1, !1)
                }
            },
            formatFlightTransMultipPUTransCity: function(a, b, c) {
                for (var d = !0,
                e = c ? a.FareList[0].TransMultiPUInfo.OutBoundTansSplitPlaceInfo: a.FareList[0].TransMultiPUInfo.InboundTansSplitPlaceInfo, f = (e.HasVisaRisk, 0); f < a.FareList.length; f++) {
                    if (!a.FareList[f].TransMultiPUInfo) {
                        d = !1;
                        break
                    }
                    var g = c ? a.FareList[f].TransMultiPUInfo.OutBoundTansSplitPlaceInfo: a.FareList[f].TransMultiPUInfo.InboundTansSplitPlaceInfo;
                    if (e && !g || !e && g) {
                        d = !1;
                        break
                    }
                    if (e.AllTranscityText != g.AllTranscityText || e.HasVisaRisk != g.HasVisaRisk) {
                        d = !1;
                        break
                    }
                }
                if (d && pageGlobal.TransPUConfig) {
                    var h = "";
                    if (e.HasVisaRisk ? e.VisaRiskTranscityText && e.VisaRiskTranscityText.length > 0 && e.AllTranscityText && e.AllTranscityText.length > 0 && (h = online.stringFormat(pageGlobal.TransPUConfig.HasVisaRiskTipByHoverZJQZ, [e.VisaRiskTranscityText, e.AllTranscityText])) : e.AllTranscityText && e.AllTranscityText.length > 0 && (h = online.stringFormat(pageGlobal.TransPUConfig.NoVisaRiskTipByHoverZJQZ, e.AllTranscityText)), b) {
                        var i = c ? 1 : 0;
                        a.FlightInfo[i].TransContent = h
                    } else a.TransContent = h
                }
            },
            formatFareTransCities: function(a) {
                if (a && 0 != a.length && pageGlobal.TransPUConfig) {
                    var b = pageGlobal.TransPUConfig.HasVisaRiskTipByHoverYDBD,
                    c = pageGlobal.TransPUConfig.NoVisaRiskTipByHoverYDBD;
                    pageGlobal.TransPUConfig.TripGuaranteeForListPage && pageGlobal.TripGuaranteeOfYDBUSwitch && (b = online.stringFormat(pageGlobal.TransPUConfig.TripGuaranteeForListPage, "YDBD") + "<br/>" + b, c = online.stringFormat(pageGlobal.TransPUConfig.TripGuaranteeForListPage, "YDBD") + "<br/>" + c),
                    a.each(function(a) {
                        a.TransMultiPUInfo && (a.TransMultiPUInfo.HasVisaRisk ? a.TransMultiPUInfo.VisaRiskTranscityText && a.TransMultiPUInfo.VisaRiskTranscityText.length > 0 && a.TransMultiPUInfo.AllTranscityText && a.TransMultiPUInfo.AllTranscityText.length > 0 && (a.TransMultiPUInfo.DPZHContent = online.stringFormat(pageGlobal.TransPUConfig.HasVisaRiskTipByHoverDPCP, [a.TransMultiPUInfo.VisaRiskTranscityText, a.TransMultiPUInfo.AllTranscityText]), a.TransMultiPUInfo.YDBUContent = online.stringFormat(b, [a.TransMultiPUInfo.VisaRiskTranscityText, a.TransMultiPUInfo.AllTranscityText])) : a.TransMultiPUInfo.AllTranscityText && a.TransMultiPUInfo.AllTranscityText.length > 0 && (a.TransMultiPUInfo.DPZHContent = online.stringFormat(pageGlobal.TransPUConfig.NoVisaRiskTipByHoverDPCP, a.TransMultiPUInfo.AllTranscityText), a.TransMultiPUInfo.YDBUContent = online.stringFormat(c, a.TransMultiPUInfo.AllTranscityText)))
                    })
                }
            },
            updateFlightImg: function(a) {
                var b = this;
                pageGlobal.IsOpenNewFlightPicInfo && a && 0 != a.length && a.each(function(a, c) {
                    var d = function(b, c) {
                        var d = {};
                        a.FareList.each(function(a) {
                            if (a.ClassInfo && a.ClassInfo.length > 0) a.ClassInfo.each(function(a) {
                                return a ? void b.FlightDetail.each(function(b) {
                                    var e = c + "_" + b.FlightNo;
                                    d[e] || (d[e] = []),
                                    a.SegmentNo == c && a.FlightNumber == b.FlightNo && d[e].push(a.ClassGrade)
                                }) : !0
                            });
                            else {
                                if (!a.ClassGradeKey) return ! 0;
                                b.FlightDetail.each(function(b) {
                                    var e = c + "_" + b.FlightNo;
                                    d[e] || (d[e] = []),
                                    d[e].push(a.ClassGradeKey.split(";")[c - 1] || a.ClassGradeKey)
                                })
                            }
                        });
                        for (var e in d) d[e] = (d[e] || []).unique();
                        var f = [];
                        b.AirlineImage = null,
                        b.FlightDetail && b.FlightDetail.length > 0 && b.FlightDetail.each(function(a) {
                            if (!a.AirlineImageClass) return ! 0;
                            var b = d[c + "_" + a.FlightNo] || [];
                            if (!b || 0 == b.length) return ! 0;
                            var e = "";
                            a.AirlineImage = null,
                            b.each(function(b) {
                                a.AirlineImageClass.indexOf(b) >= 0 && (e += b)
                            }),
                            e && (a.AirlineImage = "SubPage/FlightPicJson.aspx?airline=" + a.AirlineCode + "&flightno=" + a.FlightNo + "&planeType=" + a.CraftType + "&classCode=" + e, f.push([a.AirlineName, a.FlightNo, a.CraftType, a.AirlineImage].join("|")))
                        }),
                        f.length > 0 && (b.AirlineImage = f.join(",,"))
                    };
                    b.isRoundTripCombination() ? a.FlightInfo && a.FlightInfo.length > 0 && (a.FlightInfo = $.extend(!0, [], a.FlightInfo), a.FlightInfo.each(function(a, b) {
                        d(a, b + 1)
                    })) : d(a, b.curSegment + 1)
                })
            },
            getAirlinePackageInfo: function(a, b) {
                if (a && 0 != a.length && b) for (var c = 0; c < a.length; c++) {
                    var d = a[c];
                    if (d.AirLinePackageInfoDict) {
                        var e = [1, 2];
                        d.AirlinePackageInfoList = [];
                        for (var f = 0; 2 > f; f++) {
                            var g = e[f];
                            if (d.AirLinePackageInfoDict[g]) {
                                var h = d.AirLinePackageInfoDict[g];
                                if (b[h.PackageID]) {
                                    var i = b[h.PackageID],
                                    j = {};
                                    if (j.PackageName = i.PackageName || "", j.Description = h.Description, j.Type = h.Type, j.PackagePropertys = i.PackagePropertyList, i.PackagePropertyList && i.PackagePropertyList.length > 0) {
                                        for (var k = [], l = 1, m = 0; m < i.PackagePropertyList.length; m++) {
                                            var n = i.PackagePropertyList[m],
                                            o = n.PropertyComment;
                                            o && o.length > 0 && (k.push(o), n.CommentIndex = l, l += 1)
                                        }
                                        k.length > 0 && (j.CommentList = k)
                                    }
                                    d.AirlinePackageInfoList.push(j)
                                }
                            }
                        }
                    }
                }
            },
            fixedFreeInsureStyle: function() {
                jQuery(".spanFreeInsure").siblings(".tag-discount").find("span.pickup-tag").addClass("tag-mini")
            }
        }
    }),
    online.create("service.NewResult.Page", {
        options: {
            panel: "#pageControl",
            tmpl: {
                next: '<em></em>\u540e\u4e00\u5929\uff08${time.toFormatString("MM-dd")}\uff09',
                prev: '<em></em>\uff08${time.toFormatString("MM-dd")}\uff09\u524d\u4e00\u5929'
            },
            curTime: null,
            minTime: (new Date).toDate(),
            maxTime: null
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this.curTime && (this.minTime = this.minTime.toDate(), this.panel = $(this.panel), this.panel.length < 1 || (null === this.maxTime && (this.maxTime = this.minTime.addYears(1).toDate()), this.curTime = this.curTime.toDate(), this.bindEvent(), this.init()))
            },
            init: function() {
                this.nextTime = this.curTime.addDays(1),
                this.prevTime = this.curTime.addDays( - 1),
                this.nextTime.getTime() > this.maxTime.getTime() && (this.nextTime = this.maxTime.addDays(1)),
                this.prevTime.getTime() < this.minTime.getTime() && (this.prevTime = this.minTime.addDays( - 1)),
                this.next.html($.tmpl.render(this.tmpl.next, {
                    time: this.nextTime
                })),
                this.prev.html($.tmpl.render(this.tmpl.prev, {
                    time: this.prevTime
                }))
            },
            bindEvent: function() {
                this.next = this.panel.find(".flights-page-next"),
                this.prev = this.panel.find(".flights-page-prev");
                var a = this;
                this.curTime.getTime() < this.maxTime.getTime() ? this.next.bind("click",
                function(b) {
                    b.stop(),
                    a.doSearch(a.nextTime)
                }) : this.next.addClass("flights-page-disabled"),
                this.curTime.getTime() > this.minTime.getTime() ? this.prev.bind("click",
                function(b) {
                    b.stop(),
                    a.doSearch(a.prevTime)
                }) : this.prev.addClass("flights-page-disabled")
            },
            doSearch: function(a) {
                $("#DDate").value(a.toFormatString("yyyy-MM-dd")),
                $("#btnSearch")[0].click()
            }
        }
    }),
    online.create("service.NewResult.HistorySearch", {
        options: {
            VID: "",
            allData: [],
            allDataV2: [],
            maxLen: 3,
            urlTpl: "AjaxRequest/UI2_0/HistoryQueryRecordHandler.ashx?",
            target: "#history-wrapper",
            classNames: {
                S: '<span class="history-oneway">\u5355\u7a0b</span>',
                D: '<span class="history-roundtrip">\u5f80\u8fd4</span> ',
                M: '<span class="history-multidest">\u591a\u7a0b</span>'
            },
            historySearchTpl: '			<div class="side-title">\u641c\u7d22\u5386\u53f2</div>			<div class="history-items" >			{{each (i, v) data}}	<div class="history-item"  data-ubt-key="history-item${i}" index="${i}" FlightType="${v.ftv}" From="${v.searchObj.from}" To="${v.searchObj.to}" departDate="${v.searchObj.DepartDate}">					{{ if i > 0}}<a class="history-delete"{{if v.vid}} vid="${v.vid}"{{/if}} recordid="${v.recordid}" href="#">\xd7</a>{{/if}}					<div class="history-type" >${v.flightType} <span class="history-cities">{{if v.ftv == "Multi"}} ${v.MultiFrom} {{else}} ${v.beginCity}\uff0d${v.endCity}{{/if}}</span></div>				{{each (j, s) v.segmentListTime}}					{{if v.ftv == "S"}} <div class="history-date">${s.fromTime}</div> {{/if}}					{{if v.ftv == "D"}} <div class="history-date">${s.fromTime} - ${s.toTime}</div> {{/if}}				{{/each}}				{{if v.ftv == "M"}}<div>${v.MultiTime}</div>{{/if}}					<span class="history-moment ${v.justNow}">${v.historyMoment}</span>				</div>			{{/each}}			</div>'
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this.target = $(this.target),
                this.urlTpl = online.getBaseUrl(this.urlTpl);
                var b = this; !
                function c() {
                    if (window.$_bf && window.$_bf.loaded === !0) {
                        var a = window.$_bf._getFullPV();
                        b.VID = a.split(".").slice(0, 2).join("."),
                        online.log("\u5f53\u524d\u7528\u6237\u7684VID\u4e3a:" + b.VID),
                        pageGlobal.IsOpenHistoryQueryV2 ? b.getAllSearchHistoryV2() : b.getAllSearchHistory()
                    } else setTimeout(c, 50)
                } ()
            },
            getAllSearchHistory: function(a) {
                var b = this;
                $.ajax(this.urlTpl + "Type=GetHistoryRecord&vid=" + b.VID, {
                    method: "GET",
                    async: !0,
                    onsuccess: function(a, c) {
                        if (c = $.parseJSON(c)) for (var d = c.length; d--;) b.allData = b.allData.concat(c[d].results || []);
                        for (var e = [[], [], []], f = condition.SegmentList, d = 0; d < f.length; d++) e[0].push(f[d].DCity),
                        e[1].push(f[d].ACity),
                        e[2].push(f[d].DepartDate);
                        var g = $.tmpl.render("UID=${uid}&FlightWay=${flightWay}&from=${from}&to=${to}&DepartDate=${departDate}", {
                            uid: pageGlobal.Ubt.UID,
                            flightWay: condition.FlightWay || "S",
                            from: e[0].join(","),
                            to: e[1].join(","),
                            departDate: e[2].join(",")
                        }),
                        h = {};
                        h.accessDate = (new Date).toFormatString("yyyy-MM-dd hh:mm:ss"),
                        h.key = "IntlFlight",
                        h.value = g,
                        b.allData.push(h),
                        b.reset()
                    }
                })
            },
            getAllSearchHistoryV2: function() {
                var a = this;
                $.ajax(this.urlTpl + "Type=GetHistoryRecord&vid=" + a.VID, {
                    onsuccess: function(b, c) {
                        if (c = $.parseJSON(c)) {
                            a.allDataV2 = c,
                            c = c.map(function(a) {
                                return {
                                    accessDate: a.builtinTimestamp.replace(/\.\d{3}$/, ""),
                                    key: a.custom_key,
                                    recordId: a.document_id,
                                    value: a.custom_data.data || ""
                                }
                            }),
                            [].push.apply(a.allData, c);
                            for (var d = [[], [], []], e = condition.SegmentList, f = 0; f < e.length; f++) d[0].push(e[f].DCity),
                            d[1].push(e[f].ACity),
                            d[2].push(e[f].DepartDate);
                            var g = $.tmpl.render("UID=${uid}&FlightWay=${flightWay}&from=${from}&to=${to}&DepartDate=${departDate}", {
                                uid: pageGlobal.Ubt.UID,
                                flightWay: condition.FlightWay || "S",
                                from: d[0].join(","),
                                to: d[1].join(","),
                                departDate: d[2].join(",")
                            }),
                            h = {};
                            h.accessDate = (new Date).toFormatString("yyyy-MM-dd hh:mm:ss"),
                            h.key = "IntlFlight",
                            h.value = g,
                            a.allData.push(h),
                            a.reset()
                        }
                    }
                })
            },
            bindEvent: function() {
                var a = this;
                $(".history-item").bind("mousedown",
                function(b) {
                    b.preventDefault(),
                    $(b.target).attr("data-ubt-key", "HistoryReview");
                    var c = b.target;
                    if ($(c).hasClass("history-delete")) {
                        var d = $(c).attr("recordid"),
                        e = $(c).attr("vid") || "";
                        if (pageGlobal.IsOpenHistoryQueryV2) {
                            var f = {};
                            a.allDataV2.each(function(a) {
                                a.document_id == d && (f = a)
                            }),
                            $.ajax(a.urlTpl + "Type=DeleteHistoryRecord&docid=" + (f.document_id || "") + "&indexname=" + (f.index_name || ""))
                        } else $.ajax(a.urlTpl + "Type=DeleteHistoryRecord&vid=" + e + "&recordid=" + d);
                        return void $(c.parentNode).fadeOut()
                    }
                    var g = $(this),
                    h = {
                        flighttype: g.attr("FlightType"),
                        from: g.attr("From"),
                        to: g.attr("To"),
                        departDate: g.attr("departDate")
                    };
                    window.keepHash = !0,
                    location.hash = "ctm_ref=fli_sr_hv_def_t_" + (1 * g.attr("index") + 1),
                    a.autoSearch(h)
                })
            },
            reset: function() {
                this.allData.length > 0 ? (this.target.html($.tmpl.render(this.historySearchTpl, {
                    data: this.formatData()
                })), this.bindEvent()) : this.target.fadeOut()
            },
            formatData: function(a) {
                this.allData.sort(function(a, b) {
                    return new Date(b.accessDate.replace(/-/g, "/")) - new Date(a.accessDate.replace(/-/g, "/"))
                }),
                a = this.allData;
                for (var b, c, d, e, f = [], g = {},
                h = [], i = [], j = [], k = [], l = 0; l < a.length && l !== this.maxLen; l++) {
                    if (j = [], k = [], b = a[l].accessDate, g = this.value2obj(a[l].value), h = g.from.split(","), i = g.to.split(","), "S" == g.FlightWay && (j[0] = online.showTime(g.DepartDate, "yyyy-MM-dd")), "D" == g.FlightWay) {
                        var m = g.DepartDate.split(",");
                        j[0] = online.showTime(m[0], "yyyy-MM-dd"),
                        k[0] = online.showTime(m[1], "yyyy-MM-dd")
                    }
                    if ("M" == g.FlightWay) {
                        j = g.DepartDate.split(",");
                        for (var n = [], o = 0; o < j.length; o++) n.push(online.showTime(j[o], "yyyy-MM-dd"));
                        j = n
                    }
                    e = this.getSegmentListTime(j, k),
                    c = a[l].recordId,
                    d = this.getDateDiff(new Date(b.replace(/-/g, "/"))),
                    f.push({
                        flightType: this.classNames[g.FlightWay],
                        beginCity: h[0].split("|")[1].split("(")[0],
                        endCity: i[0].split("|")[1].split("(")[0],
                        recordid: c,
                        vid: g.UID ? "": this.VID,
                        segmentListTime: e,
                        historyMoment: d,
                        justNow: "\u521a\u521a\u67e5\u8be2" == d ? "just-now": "",
                        ftv: g.FlightWay,
                        MultiFrom: this.multiFrom(h),
                        MultiTime: this.multiTime(j),
                        searchObj: g
                    })
                }
                return f
            },
            value2obj: function(a) {
                for (var a, b = {},
                c = a.split("&"), d = c.length; d--;) a = c[d].split("="),
                b[a[0]] = a[1] || "";
                return b
            },
            getSegmentListTime: function(a, b) {
                for (var c = [], d = "", e = "", f = 0, g = a.length; g > f; f++) d = this.getWeek(a[f]),
                e = b[f] && this.getWeek(b[f]) || "",
                c.push({
                    fromTime: d,
                    toTime: e
                });
                return c
            },
            getDateDiff: function(a) {
                var b = 6e4,
                c = 60 * b,
                d = 24 * c,
                e = 30 * d,
                f = (new Date).getTime(),
                g = f - a,
                h = g / e,
                i = g / (7 * d),
                j = g / d,
                k = g / c,
                l = g / b;
                return h >= 1 ? result = parseInt(h) + "\u4e2a\u6708\u524d": i >= 1 ? result = parseInt(i) + "\u5468\u524d": j >= 1 ? result = parseInt(j) + "\u5929\u524d": k >= 1 ? result = parseInt(k) + "\u5c0f\u65f6\u524d": l >= 1 ? result = parseInt(l) + "\u5206\u949f\u524d": result = "\u521a\u521a\u67e5\u8be2",
                result
            },
            multiFrom: function(a) {
                for (var b = [], c = 0, d = a.length; d > c; c++) b.push(a[c].split("|")[1].split("(")[0]);
                return b.join("\u3001")
            },
            multiTime: function(a) {
                for (var b = [], c = 0; c < a.length; c++) b.push(this.getWeek(a[c]));
                return b.join("\u3001")
            },
            getWeek: function(a) {
                return a.slice(5) + "\uff08\u5468" + "\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(new Date(a.replace(/-/g, "/")).getDay()) + "\uff09"
            },
            autoSearch: function(a) {
                function b(a, b) {
                    try {
                        return new Date(a.replace(/-/g, "/")).toFormatString(b)
                    } catch(c) {
                        return ""
                    }
                }
                var c = a.flighttype,
                d = a.from.split(","),
                e = a.to.split(","),
                f = a.departDate.split(","),
                g = $("#selflightType");
                if (g.value(c), setTimeout(function() {
                    g.trigger("change")
                },
                25), $("#homeCity").getMod("address_poi", "2.0").method("select", d[0]), $("#destCity").getMod("address_poi", "2.0").method("select", e[0]), $("#DDate").value(b(f[0], "yyyy-MM-dd")), $("#ADate").data("minDate", f[0]), online.clearNotice($("#homeCity")), online.clearNotice($("#destCity")), online.clearNotice($("#DDate")), "S" == c && ($("#ADate").value("yyyy-mm-dd"), $("#ADate").getMod("calendar", "6.0").method("setWeek")), "D" == c && ($("#ADate").value(b(f[1], "yyyy-MM-dd")), $("#ADate").getMod("calendar", "6.0").method("setWeek"), online.registerMod.searchBoxVals.flightintl_backdate_single = b(f[1], "yyyy-MM-dd"), online.clearNotice($("#ADate"))), "M" == c) {
                    if (d.length > 2) for (var h = 0; h < d.length - 2; h++) $("#add_new_line").click();
                    for (var i, h = 0; h < d.length; h++) fromCity = d[h],
                    toCity = e[h],
                    i = h + 1,
                    $("#homeCity_" + i).getMod("address_poi", "2.0").method("select", fromCity),
                    $("#destCity_" + i).getMod("address_poi", "2.0").method("select", toCity),
                    $("#DDate_" + i).value(b(f[h], "yyyy-MM-dd")),
                    online.clearNotice($("#destCity_" + i)),
                    online.clearNotice($("#homeCity_" + i)),
                    online.clearNotice($("#DDate_" + i))
                }
                $("#btnSearch")[0].click()
            }
        }
    }),
    online.create("service.NewResult.TicketRecommend", {
        options: {
            resultService: null,
            flag: !0,
            recommendPanel: "#calendar_tab",
            recFltPanel: "#rec_flt_box",
            calendarPanel: "#calendarDialog",
            recCheapBox: "#rec_cheap_box",
            recommendTmpl: "",
            recFltBoxTmpl: "",
            calendarTmpl: "",
            RecCheapTmpl: "",
            RelevantFltTmpl: "",
            recDepartDate: new Date(condition.SegmentList[0].DepartDate.replace(/-/g, "/")).toFormatString("yyyy-MM-dd"),
            index: 0,
            calIndex: 0,
            change: document.documentElement.clientWidth < 1180 ? 6 : 7,
            url: "AjaxRequest/AsyncResult/GetRecommendFlight.ashx",
            lowestPainExponentRecommendItem: null,
            works: {
                "2016-12-31": "ico_xiu",
                "2017-01-01": "ico_xiu",
                "2017-01-02": "ico_xiu",
                "2017-01-22": "ico_ban",
                "2017-01-27": "ico_xiu",
                "2017-01-28": "ico_xiu",
                "2017-01-29": "ico_xiu",
                "2017-01-30": "ico_xiu",
                "2017-01-31": "ico_xiu",
                "2017-02-01": "ico_xiu",
                "2017-02-02": "ico_xiu",
                "2017-02-04": "ico_ban",
                "2017-04-01": "ico_ban",
                "2017-04-02": "ico_xiu",
                "2017-04-03": "ico_xiu",
                "2017-04-04": "ico_xiu",
                "2017-04-29": "ico_xiu",
                "2017-04-30": "ico_xiu",
                "2017-05-01": "ico_xiu",
                "2017-05-27": "ico_ban",
                "2017-05-28": "ico_xiu",
                "2017-05-29": "ico_xiu",
                "2017-05-30": "ico_xiu",
                "2017-09-30": "ico_ban",
                "2017-10-01": "ico_xiu",
                "2017-10-02": "ico_xiu",
                "2017-10-03": "ico_xiu",
                "2017-10-04": "ico_xiu",
                "2017-10-05": "ico_xiu",
                "2017-10-06": "ico_xiu",
                "2017-10-07": "ico_xiu",
                "2017-10-08": "ico_xiu"
            },
            festival: {
                "2017-01-27": ["c_chuxi", "\u9664\u5915"],
                "2016-02-07": ["c_chuxi", "\u9664\u5915"],
                "2015-02-18": ["c_chuxi", "\u9664\u5915"],
                "2017-01-28": ["c_chunjie", "\u6625\u8282"],
                "2016-02-08": ["c_chunjie", "\u6625\u8282"],
                "2015-02-19": ["c_chunjie", "\u6625\u8282"],
                "2017-02-11": ["c_chunjie", "\u5143\u5bb5"],
                "2016-02-22": ["c_chunjie", "\u5143\u5bb5"],
                "2015-03-05": ["c_yuanxiao", "\u5143\u5bb5"],
                "2017-04-04": ["c_qingming", "\u6e05\u660e"],
                "2016-04-04": ["c_qingming", "\u6e05\u660e"],
                "2015-04-05": ["c_qingming", "\u6e05\u660e"],
                "2017-05-30": ["c_duanwu", "\u7aef\u5348"],
                "2016-06-09": ["c_duanwu", "\u7aef\u5348"],
                "2015-06-20": ["c_duanwu", "\u7aef\u5348"],
                "2017-10-04": ["c_zhongqiu", "\u4e2d\u79cb"],
                "2016-09-15": ["c_zhongqiu", "\u4e2d\u79cb"],
                "2015-09-27": ["c_zhongqiu", "\u4e2d\u79cb"],
                "01-01": ["c_yuandan", "\u5143\u65e6"],
                "05-01": ["c_wuyi", "\u4e94\u4e00"],
                "10-01": ["c_guoqing", "\u56fd\u5e86"],
                "12-25": ["c_shengdan", "\u5723\u8bde"]
            },
            LowPriceHis: {
                LastMonth: 0,
                NextMonth: 0,
                ChooseDate: ""
            },
            ClassType: {
                Y: "\u7ecf\u6d4e\u8231",
                S: "\u8d85\u7ea7\u7ecf\u6d4e\u8231",
                C: "\u516c\u52a1\u8231",
                F: "\u5934\u7b49\u8231"
            },
            isMultiTrave: condition.Quantity && (condition.ChildQuantity || condition.InfantQuantity),
            condition: condition
        },
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                0 != this.flag && "S" === this.condition.FlightWay && (pageGlobal.HasRCP_NRB = 3, this.isTouristClass = !this.condition.ClassGrade || -1 != this.condition.ClassGrade.indexOf("Y"), this.initUbt(), $("#calendar_tab,#calendarDialog,#rec_cheap_box,#rec_flt_box").remove(), this.RecommendProduct = pageGlobal.NewUbt.RecommendProduct, this.initDom(), this.recommendPanel = $(this.recommendPanel), this.calendarPanel = $(this.calendarPanel), this.recCheapBox = $(this.recCheapBox), this.recFltPanel = $(this.recFltPanel), this.getCalData(), this.bindEvent())
            },
            initUbt: function() {
                pageGlobal.Ubt.RelationAirline = 0,
                pageGlobal.Ubt.BtmRelationAirline = 0,
                pageGlobal.Ubt.BtmLowerPrice = 0
            },
            initDom: function() {
                if ($("#search_form").length && $("#pageControl").length && $("#result-wrapper").length) {
                    var a = document.createElement("div");
                    a.id = "J_TopContainer",
                    a.innerHTML = '<!--\u5de6\u53f3\u5207\u6362\u4f4e\u4ef7\u65e5\u5386--><div class="calendar_tab clearfix" id="calendar_tab"></div><!--\u5f39\u51fa\u5c42\u4f4e\u4ef7\u65e5\u5386--><div class="pop_calendar" style="position:static;margin:0;display:none;" id="calendarDialog"></div>',
                    $(a).insertAfter($("#search_form"));
                    var b = document.createElement("div");
                    b.innerHTML = '<!--\u63a8\u8350--><div class="rec_cheap_box" id="rec_cheap_box" style="display:none;">	<div id="lowerFlt"></div>	<div id="relevantFlt"></div></div>',
                    $(b).insertAfter($("#pageControl"));
                    var c = document.createElement("div");
                    c.id = "rec_flt_box",
                    c.className = "rec_flt_box",
                    c.style.display = "none",
                    $(c).insertBefore($("#flightList"))
                }
            },
            getCalData: function() {
                var a = this;
                $.ajax(online.getBaseUrl(this.url), {
                    context: {
                        QueryData: a.condition
                    },
                    method: "POST",
                    onsuccess: function(b, c) {
                        if (c = $.parseJSON(c), null == c || "" == c) return a.clearDom(),
                        void a.resultService.checkHasLoad();
                        if (a.calData = c.LowPriceRecommendFlights, a.calData && a.calData.length > 0) for (var d = new Date(a.calData[a.calData.length - 1].DepartureDate.replace(/-/g, "/")), e = 1; 6 >= e; e++) a.calData = a.calData.concat({
                            DepartureDate: d.addDays(e).toFormatString("yyyy-MM-dd"),
                            SalesPrice: -1,
                            SalesTotalPrice: -1
                        });
                        else {
                            a.calData = [];
                            for (var f = new Date,
                            e = 0; 90 > e; e++) {
                                var g = f.toFormatString("yyyy-MM-dd");
                                a.calData.push({
                                    SalesPrice: -1,
                                    DepartureDate: g
                                }),
                                f = new Date(f.getFullYear(), f.getMonth(), f.getDate() + 1)
                            }
                            for (var d = new Date(a.calData[a.calData.length - 1].DepartureDate.replace(/-/g, "/")), e = 1; 6 >= e; e++) a.calData = a.calData.concat({
                                DepartureDate: d.addDays(e).toFormatString("yyyy-MM-dd"),
                                SalesPrice: -1,
                                SalesTotalPrice: -1
                            })
                        }
                        if ("undefined" == typeof a.AcceptPrice && (a.AcceptPrice = 200), a.RecData = c.NearbyRecommendFlights, pageGlobal.NewUbt.LowPrice.RecommendLowestPrice = -3, a.RecData && a.RecData.length > 0) {
                            var h = 999999999,
                            i = a.resultService.curType,
                            j = 999999999;
                            a.RecData.each(function(a) {
                                a.PricePainExponent = parseInt((a.FlightDuration || 0) * (pageGlobal.PainExponentConfig[a.ClassGrade] || 0) * 1e4) / 1e4,
                                a.TotalPricePainExponent = parseInt((a.FlightDurationIncludingTax || 0) * (pageGlobal.PainExponentConfig[a.ClassGrade] || 0) * 1e4) / 1e4,
                                a.PricePainExponent += a.SalesTotalPrice,
                                a.TotalPricePainExponent += a.SalesTotalPrice,
                                a[i + "PainExponent"] < j && (j = a[i + "PainExponent"]),
                                a.SalesTotalPrice < h && (h = a.SalesTotalPrice)
                            }),
                            a.lowestPainExponentRecommendItem = a.getShortestRecommendItem(a.RecData, "NearbyCityDistance", i + "PainExponent", j),
                            pageGlobal.NewUbt.LowPrice.RecommendLowestPrice = h
                        }
                        return (pageGlobal.HasRCP_NRB = online.noResCompen(a.resultService, a.resultService.flightWay)) > 0 ? void a.resultService.nearCompen() : 0 === pageGlobal.HasRCP_NRB ? void a.resultService.hasNoResult() : void a.update()
                    },
                    onerror: function() {
                        a.clearDom(),
                        a.resultService.checkHasLoad()
                    }
                })
            },
            renderRecommendUI: function() {
                if (this.isTouristClass && this.calData) {
                    var a = this,
                    b = this.recDepartDate,
                    c = 0;
                    if (this.calData.each(function(d, e) {
                        d.dateStr = a.getFestival(d.DepartureDate),
                        d.day = new Date(d.DepartureDate.replace(/-/g, "/")).getDate(),
                        d.isFestival = a.checkFestival(d.DepartureDate),
                        d.extendClass = a.checkIsWork(d.DepartureDate),
                        d.SalesPrice <= 0 && (d.clickSearch = !0),
                        b === d.DepartureDate && (d.current = !0, c = e, a.index = c)
                    }), this.isSomedayAfter(93)) {
                        var d = new Date(a.recDepartDate.replace(/-/g, "/")),
                        e = d.addDays( - 3).toFormatString("yyyy-MM-dd"),
                        f = d.addDays( - 2).toFormatString("yyyy-MM-dd"),
                        g = d.addDays( - 1).toFormatString("yyyy-MM-dd"),
                        h = d.addDays(1).toFormatString("yyyy-MM-dd"),
                        i = d.addDays(2).toFormatString("yyyy-MM-dd"),
                        j = d.addDays(3).toFormatString("yyyy-MM-dd");
                        if (this.resultService.loadFinish && this.resultService.lowPrice) var k = this.resultService["low" + this.resultService.curType] || 0;
                        return this.recommendPanel.html($.tmpl.render(this.recommendTmpl, {
                            d: [{
                                DepartureDate: e,
                                clickSearch: !0,
                                dateStr: a.getFestival(e)
                            },
                            {
                                DepartureDate: f,
                                clickSearch: !0,
                                dateStr: a.getFestival(f)
                            },
                            {
                                DepartureDate: g,
                                clickSearch: !0,
                                dateStr: a.getFestival(g)
                            },
                            {
                                DepartureDate: a.recDepartDate,
                                clickSearch: this.resultService.loadFinish ? !1 : !0,
                                current: !0,
                                SalesPrice: k,
                                SalesTotalPrice: k,
                                curType: this.resultService.curType,
                                dateStr: a.getFestival(a.recDepartDate)
                            },
                            {
                                DepartureDate: h,
                                clickSearch: !0,
                                dateStr: a.getFestival(h)
                            },
                            {
                                DepartureDate: i,
                                clickSearch: !0,
                                dateStr: a.getFestival(i)
                            },
                            {
                                DepartureDate: j,
                                clickSearch: !0,
                                dateStr: a.getFestival(j)
                            }]
                        })),
                        7 == this.change && (this.recommendPanel.find(".cal_box").css("width", "917px"), this.recommendPanel.find(".panel_link").css("width", "174px")),
                        this.recommendPanel.find(".cal_box").css("background", "#fff"),
                        this.recommendPanel.find(".rec-next").addClass("arrow_right_disable").removeClass("arrow_right"),
                        void $("#rec_cheap_box").remove()
                    }
                    this.recommendPanel.html($.tmpl.render(this.recommendTmpl, {
                        d: a.calData,
                        curType: this.resultService.curType
                    })),
                    this.wrap = this.recommendPanel.find(".calendar_ul");
                    var l = this.recommendPanel.find(".rec-next"),
                    m = this.recommendPanel.find(".rec-prev"),
                    n = this.wrap.find("li").length - this.change,
                    o = 1,
                    p = 3;
                    a.index < 1 && (a.index = 0, m.addClass("arrow_left_disable"), m.removeClass("arrow_left"), l.removeClass("arrow_right_disable"), l.addClass("arrow_right")),
                    a.index > n && (3 - (a.index - n) > 0 && (p = 3 - (a.index - n)), a.index = n, l.addClass("arrow_right_disable"), l.removeClass("arrow_right"), m.removeClass("arrow_left_disable"), m.addClass("arrow_left"), o = 3, document.documentElement.clientWidth < 1180 && (o = 0)),
                    c >= this.wrap.find("li").length - 4 && (p = 0),
                    c >= 0 && 4 > c && (a.index = 0, p = 0),
                    p && (m.removeClass("arrow_left_disable"), m.addClass("arrow_left"), l.removeClass("arrow_right_disable"), l.addClass("arrow_right"), a.index = a.index - p),
                    this.wrap.css({
                        marginLeft: 132 * -a.index + o + "px"
                    })
                }
            },
            renderCalendarUI: function() {
                if (this.calData) {
                    for (var a = this.calData.slice(), b = a[a.length - 1].DepartureDate, c = this.lastDaysByMonth(b), d = 1; c >= d; d++) a.push({
                        DepartureDate: new Date(b.replace(/-/g, "/")).addDays(d).toFormatString("yyyy-MM-dd"),
                        day: new Date(b.replace(/-/g, "/")).addDays(d).getDate(),
                        clickSearch: !0
                    });
                    var e, f = {};
                    a.each(function(a, b) {
                        e = a.DepartureDate.substring(0, 7),
                        f[e] || (f[e] = []),
                        f[e].push(a)
                    });
                    var g = {};
                    this.renderData = [];
                    for (var d in f) g.key = d,
                    g.arr = f[d],
                    this.renderData.push(g),
                    g = {};
                    for (var h = !1,
                    d = 0,
                    i = this.renderData.length; i > d && !h; d++) for (var j = 0,
                    k = this.renderData[d].arr.length; k > j; j++) if (this.renderData[d].arr[j].DepartureDate == this.recDepartDate) {
                        this.calIndex = d,
                        h = !0;
                        break
                    }
                    try {
                        this.calShow(this.calIndex)
                    } catch(l) {
                        online.log("\u6e32\u67d3\u4f4e\u4ef7\u65e5\u5386\u5f39\u7a97\u51fa\u9519 " + l)
                    }
                }
            },
            renderRecFltBoxUI: function() {
                var a, b, c = function() {
                    $("#rec_flt_box").hide()
                };
                if (this.isTouristClass && this.resultService.loadFinish && this.resultService["low" + (a = this.resultService.curType)] > 0 && this.RelevantFltLowPriObj) {
                    b = this.resultService.sortKey;
                    var d = this.RelevantFltLowPriObj;
                    this.lowestPainExponentRecommendItem && (d = this.lowestPainExponentRecommendItem);
                    var e = this.resultService["low" + a],
                    f = d["Sales" + a],
                    g = 0,
                    h = e - f;
                    e = this.resultService.lowPainExponent || 0,
                    f = 999999,
                    this.RecData.each(function(b) {
                        b[a + "PainExponent"] < f && (f = b[a + "PainExponent"])
                    }),
                    g = e - f,
                    this.isMultiTrave && (g = Math.round(g));
                    var i = /[^|]+\|([^(]+).*/,
                    j = this.condition.SegmentList[0].DCity.match(i) ? condition.SegmentList[0].DCity.match(i)[1] : "",
                    k = this.condition.SegmentList[0].ACity.match(i) ? condition.SegmentList[0].ACity.match(i)[1] : "",
                    l = d.NearbyCityDistance && d.NearbyCityDistance > 0 && d.NearbyCityDistance <= 200 && d.DCityCode && j && d.DCityCode != this.condition.SegmentList[0].DCityCode ? '<p class="distance" title="">\u8ddd' + j + d.NearbyCityDistance + "km</p>": "",
                    m = d.NearbyCityDistance && d.NearbyCityDistance > 0 && d.NearbyCityDistance <= 200 && d.ACityCode && k && d.ACityCode != this.condition.SegmentList[0].ACityCode ? '<p class="distance" title="">\u8ddd' + k + d.NearbyCityDistance + "km</p>": "";
                    if (g > this.AcceptPrice && f > 0) {
                        this.recFltPanel.html($.tmpl.render(this.recFltBoxTmpl, {
                            save: h,
                            dateStr: new Date(d.DepartureDate.replace(/-/g, "/")).toFormatString("MM\u6708dd\u65e5"),
                            DCityName: d.DCityName,
                            DCity: d.DCityPinYin + "|" + d.DCityName + "(" + d.DCityCode + ")|" + d.DCityID + "|" + d.DCityCode,
                            ACityName: d.ACityName,
                            ACity: d.ACityPinYin + "|" + d.ACityName + "(" + d.ACityCode + ")|" + d.ACityID + "|" + d.ACityCode,
                            price: d["Sales" + a],
                            DepartureDate: d.DepartureDate,
                            ClassGrade: d.ClassGrade,
                            DDistanceTip: l,
                            ADistanceTip: m,
                            curType: a,
                            FlightDuration: d.FlightDuration,
                            PainExponent: f
                        })),
                        this.recFltPanel.slideDown(500),
                        pageGlobal.Ubt.RelationAirline = 1,
                        pageGlobal.NewUbt.RecommendProduct = this.RecommendProduct.concat({
                            Type: "1",
                            Price: d["Sales" + a],
                            IsClick: "N",
                            DepartureDate: d.DepartureDate,
                            From: {
                                CityID: d.DCityID,
                                CityName: d.DCityName,
                                CityCode: d.DCityCode
                            },
                            To: {
                                CityID: d.ACityID,
                                CityName: d.ACityName,
                                CityCode: d.ACityCode
                            }
                        });
                        var n = {
                            DepartureCity: d.DCityCode,
                            ArrivalCity: d.ACityCode,
                            DepartureDate: d.DepartureDate,
                            Price: d["Sales" + a]
                        };
                        InternationalRecommend.firstRecommendProd(n, "1")
                    } else c()
                } else c();
                pageGlobal.NearDateDirectFlightRecommendSwitch ? this.resultService.showNearDateOnlineFlight() : this.resultService.showNearOnlineFlight()
            },
            renderBomRec: function() {
                var a = this.renderRecCheapBoxUI(),
                b = this.renderRelevantFltUI();
                return a || b
            },
            renderRecCheapBoxUI: function(a) {
                if (this.isSomedayAfter(90)) return void $("#rec_cheap_box").hide();
                var b = this,
                c = this.RCPData = this.sortPrice(this.filterRCP(this.calData));
                if (c.length < 1) return void $("#lowerFlt,#relevantFlt").hide();
                c.each(function(a, c) {
                    a.index = c,
                    a.DCity = a.DCityPinYin + "|" + a.DCityName + "(" + a.DCityCode + ")|" + a.DCityID + "|" + a.DCityCode,
                    a.ACity = a.ACityPinYin + "|" + a.ACityName + "(" + a.ACityCode + ")|" + a.ACityID + "|" + a.ACityCode,
                    a.dateStr = b.getWeekNoFestival(a.DepartureDate),
                    a.grade = b.ClassType[a.ClassGrade]
                });
                var d = c[0].DCityName + " - " + c[0].ACityName;
                return a && a.noRelevantFlt ? $("#relevantFlt").html($.tmpl.render(this.RecCheapTmpl, {
                    title: d,
                    d: c.slice(5, 10),
                    noRelevantFlt: !0,
                    curType: this.resultService.curType
                })).show() : $("#lowerFlt").html($.tmpl.render(this.RecCheapTmpl, {
                    title: d,
                    d: c.slice(0, 5),
                    curType: this.resultService.curType
                })).show(),
                pageGlobal.Ubt.BtmLowerPrice = 1,
                !0
            },
            renderRelevantFltUI: function() {
                var a = this;
                return this.isSomedayAfter(90) ? void $("#rec_cheap_box").hide() : (a.NRBData = a.sortPrice(this.filterNRB(this.RecData)), a.RelevantFltLowPriObj = a.NRBData[0], a.RelevantFltLowPriObj ? (a.NRBData.each(function(b, c) {
                    b.DCity = b.DCityPinYin + "|" + b.DCityName + "(" + b.DCityCode + ")|" + b.DCityID + "|" + b.DCityCode,
                    b.ACity = b.ACityPinYin + "|" + b.ACityName + "(" + b.ACityCode + ")|" + b.ACityID + "|" + b.ACityCode,
                    b.dateStr = a.getWeekNoFestival(b.DepartureDate),
                    b.index = c,
                    b.grade = a.ClassType[b.ClassGrade]
                }), $("#relevantFlt").html($.tmpl.render(a.RelevantFltTmpl, {
                    title: new Date(a.recDepartDate.replace(/-/g, "/")).toFormatString("MM\u6708dd\u65e5"),
                    d: a.NRBData.slice(0, 5),
                    curType: a.resultService.curType
                })).show(), pageGlobal.Ubt.BtmRelationAirline = 1, !0) : void a.renderRecCheapBoxUI({
                    noRelevantFlt: !0
                }))
            },
            filterRCP: function(a) {
                if (! ("array" === $.type(a) && a.length > 0)) return [];
                var b = [],
                c = this,
                d = this.resultService.curType,
                e = this.resultService["low" + d];
                return e > 0 ? (a.each(function(a) {
                    a["Sales" + d] < e && 1 * a.DepartureDate.toDate() !== 1 * c.recDepartDate.toDate() && b.push(a)
                }), b) : a
            },
            filterNRB: function(a) {
                if (! ("array" === $.type(a) && a.length > 0)) return [];
                var b = [],
                c = this.resultService.curType,
                d = this.resultService["low" + c];
                return d > 0 ? (a.each(function(a) {
                    a["Sales" + c] < d && b.push(a)
                }), b) : a
            },
            calShow: function(a) {
                1 > a && (this.calIndex = a = 0),
                a >= this.renderData.length && (this.calIndex = a = this.renderData.length - 1);
                var b, c, d, e = '{{each (i,v) d}}<tr {{if v.line}} class="line"{{/if}}>{{each (ii,vv) v}}{{if vv.disable}}	<td></td>{{else}}	<td data-grade="${vv.ClassGrade}" {{if vv.DepartureDate}}data-time="${vv.DepartureDate}" {{/if}} class="{{if vv.current}}choosed {{/if}}{{if vv.SalesPrice || vv.clickSearch}} optional{{/if}} ${vv.extendClass}">		<div class="day">			{{if vv.isFestival}} 				<span class="festival">${vv.isFestival[1]}</span>			{{else}}				${vv.day}			{{/if}}		</div>		{{if vv.clickSearch || vv["Sales"+curType] <= 0}}			<a href="javascript:void(0);" class="base_txtgray search">\u70b9\u51fb\u67e5\u770b</a>		{{else}}			<div class="price {{if vv.isLower}} hot_price{{/if}}"><dfn>&yen;</dfn>${vv["Sales"+curType]}</div>		{{/if}}	</td> {{/if}}{{/each}}</tr>{{/each}}',
                f = [],
                g = [],
                d = 0;
                if (0 == a) {
                    if (b = $.copy(this.renderData[a], !0), this.markLowPrice(b), c = b.arr[0].DepartureDate, d = this.needDays(c), d > 0) for (var h = 1; d >= h; h++) b.arr.splice(0, 0, {
                        disable: !0
                    });
                    for (var h = 0; 36 >= h; h++) {
                        if (!b.arr[h]) {
                            for (var i = this.insertDays(b.arr[b.arr.length - 1].DepartureDate), j = 0; i > j; j++) g.push({
                                disable: !0
                            });
                            break
                        }
                        g.push(b.arr[h]),
                        (h + 1) % 7 === 0 && (f.push(g), g = [])
                    }
                    if (g.length > 0) {
                        d = 7 - g.length;
                        for (var h = 0; d > h; h++) g.push({
                            disable: !0
                        });
                        f.push(g)
                    }
                    if (b = $.copy(this.renderData[1], !0), this.markLowPrice(b), g = [], d = 0, c = b.arr[0].DepartureDate, d = this.needDays(c), d > 0) for (var h = 1; d >= h; h++) b.arr.splice(0, 0, {
                        disable: !0
                    });
                    for (var k = !1,
                    h = 0; 42 >= h; h++) b.arr[h] ? g.push(b.arr[h]) : g.push({
                        disable: !0
                    }),
                    (h + 1) % 7 === 0 && (k === !1 && (g.line = !0), f.push(g), k = !0, g = []);
                    f = f.slice(0, 6)
                } else {
                    if (b = $.copy(this.renderData[a], !0), this.markLowPrice(b), d = 0, c = b.arr[0].DepartureDate, d = this.needDays(c), d > 0) for (var h = 1; d >= h; h++) b.arr.splice(0, 0, {
                        disable: !0
                    });
                    for (var h = 0; 42 > h; h++) b.arr[h] ? g.push(b.arr[h]) : g.push({
                        disable: !0
                    }),
                    (h + 1) % 7 === 0 && (f.push(g), g = [])
                }
                var l = $.tmpl.render(e, {
                    d: f,
                    curType: this.resultService.curType
                });
                if (this.calendarPanel.html($.tmpl.render(this.calendarTmpl, {
                    tcontent: l
                })), this.isSomedayAfter(90) && this.resultService.loadFinish && this.resultService.lowPrice) {
                    var m = $("#calendarDialog td[data-time=" + this.recDepartDate + "]");
                    if (m.length > 0) {
                        m.addClass("choosed"),
                        m.find(".base_txtgray").remove(),
                        m.find(".price").remove();
                        var n = document.createElement("div");
                        n.className = "price",
                        n.innerHTML = this.resultService.lowPrice,
                        m.append($(n))
                    }
                }
                var o = this.getRange(f),
                p = '<span class="year">${year}</span><br><span class="month">${month}\u6708</span>';
                this.calendarPanel.find(".prev_month > div").html($.tmpl.render(p, {
                    year: o[0].split("-")[0],
                    month: o[0].split("-")[1]
                })),
                this.calendarPanel.find(".next_month > div").html(1 == o.length ? "": $.tmpl.render(p, {
                    year: o[0].split("-")[0],
                    month: o[1].split("-")[1]
                })),
                0 === a ? this.calendarPanel.find(".top_arrow").addClass("top_arrow_disabled") : a === this.renderData.length - 1 ? this.calendarPanel.find(".bottom_arrow").addClass("bottom_arrow_disabled") : (this.calendarPanel.find(".top_arrow").removeClass("top_arrow_disabled"), this.calendarPanel.find(".bottom_arrow").removeClass("bottom_arrow_disabled"))
            },
            markLowPrice: function(a) {
                a = a.arr;
                for (var b, c = 999999999,
                d = "Sales" + this.resultService.curType,
                e = a.length; e--;) b = a[e][d] || -1,
                b > 0 && c > b && (c = b);
                for (var e = a.length; e--;) a[e].isLower = a[e][d] === c
            },
            scrollPos: function(a, b) {
                if (a.stop(), !b.hasClass("arrow_left_disable") && !b.hasClass("arrow_right_disable")) {
                    var c = -1 !== b[0].className.indexOf("next"),
                    d = this.wrap.find("li").length - this.change;
                    if (! (c && this.index >= d || !c && this.index < 1)) {
                        this.index += c ? this.change: -this.change;
                        var e = this.recommendPanel.find(".rec-next"),
                        f = this.recommendPanel.find(".rec-prev");
                        c ? (this.index > d && (this.index = d), f.hasClass("arrow_left_disable") && (f.removeClass("arrow_left_disable"), f.addClass("arrow_left"))) : (this.index < 0 && (this.index = 0), e.hasClass("arrow_right_disable") && (e.removeClass("arrow_right_disable"), e.addClass("arrow_right")));
                        var g = 1;
                        this.index === d && (g = 3),
                        document.documentElement.clientWidth < 1180 && (g = 0),
                        this.wrap.animate({
                            marginLeft: 132 * -this.index + g
                        }),
                        c ? this.index === d && (e.addClass("arrow_right_disable"), e.removeClass("arrow_right")) : 0 === this.index && (f.addClass("arrow_left_disable"), f.removeClass("arrow_left"))
                    }
                }
            },
            bindEvent: function() {
                var a, b = this;
                $(window).bind("resize",
                function() {
                    a && clearTimeout(a),
                    a = setTimeout(function() {
                        b.change = document.documentElement.clientWidth < 1180 ? 6 : 7
                    },
                    250)
                }),
                this.recommendPanel.onn("click", "rec-prev",
                function(a) {
                    $(a.target).attr("data-ubt-key", $(this).attr("data-ubt-key")),
                    b.scrollPos(a, $(this))
                }).onn("click", "rec-next",
                function(a) {
                    $(a.target).attr("data-ubt-key", $(this).attr("data-ubt-key")),
                    b.scrollPos(a, $(this))
                }),
                this.recommendPanel.onn("mousedown", "searchDate",
                function(a) {
                    a.preventDefault(),
                    $(a.target).attr("data-ubt-key", $(this).attr("data-ubt-key")),
                    pageGlobal.Ubt.LowPriceDate = $(this).attr("data-time"),
                    b.addHash("ctm_ref=fli_sr_lp_sr_bn"),
                    b.autoSearch($(this), !0)
                }).onn("click", "days90",
                function(a) {
                    if (a.stop(), $("#calendarDialog").html()) {
                        $("#calendarDialog").mask();
                        var b = $("#calendarDialog");
                        b.css({
                            position: "fixed",
                            top: "50%",
                            left: "50%",
                            margin: -b.offset().height / 2 + "px 0 0 " + -b.offset().width / 2 + "px"
                        })
                    }
                }),
                this.recFltPanel.onn("click", "btn-book",
                function(a) {
                    a.stop(),
                    b.addHash("ctm_ref=fli_sr_ra_sr_bn");
                    var c;
                    pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                        a && "1" === a.Type && (a.IsClick = "Y", c = a)
                    }),
                    $.storage.set("SearchNearByCityUBTInfo", c || {},
                    30),
                    $.storage.set("SearchNearRecFltFlag", "T", 30),
                    InternationalRecommend.setClickedObj("1", c, pageGlobal.NewUbt.FlightWay),
                    b.autoSearch($(this))
                }),
                this.calendarPanel.onn("click", "top_arrow",
                function() {
                    b.calShow(--b.calIndex),
                    b.LowPriceHis.LastMonth++
                }).onn("click", "bottom_arrow",
                function() {
                    b.calShow(++b.calIndex),
                    b.LowPriceHis.NextMonth++
                }).onn("click", "close",
                function() {
                    $("#calendarDialog").unmask()
                }).onn("mousedown", "optional",
                function(a) {
                    $(a.target).attr("data-ubt-key", "LowestPrice_Choose"),
                    b.LowPriceHis.ChooseDate = $(this).attr("data-time"),
                    b.reportLowPriceHisData(),
                    b.addHash("ctm_ref=fli_sr_lp_sr_bn"),
                    b.autoSearch($(this))
                }),
                $(".container").onn("mousedown", "lowerPri",
                function(a) {
                    $(a.target).attr("data-ubt-key", "LowestTickets"),
                    b.addHash("ctm_ref=fli_sr_btm_lp_t_" + $(this).attr("data-index")),
                    b.autoSearch($(this))
                }),
                $(".container").onn("mousedown", "relationAir",
                function(a) {
                    $(a.target).attr("data-ubt-key", "NearLine"),
                    b.addHash("ctm_ref=fli_sr_btm_ra_t_" + $(this).attr("data-index")),
                    b.autoSearch($(this))
                })
            },
            getFestival: function(a) {
                var b = a.substring(5),
                c = "",
                d = this.festival;
                return c = d[a] ? "<b>" + d[a][1] + "</b>": d[b] ? "<b>" + d[b][1] + "</b>": this.getWeek(a),
                b + " " + c
            },
            checkFestival: function(a) {
                var b = a.substring(5),
                c = this.festival;
                return c[a] ? c[a] : c[b] ? c[b] : !1
            },
            checkIsWork: function(a) {
                return this.works[a] || ""
            },
            getWeek: function(a) {
                try {
                    return "\u5468" + "\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(new Date(a.replace(/-/g, "/")).getDay())
                } catch(b) {
                    return ""
                }
            },
            getWeekNoFestival: function(a) {
                try {
                    return a.substring(5) + " \u5468" + "\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(new Date(a.replace(/-/g, "/")).getDay())
                } catch(b) {
                    return ""
                }
            },
            sortPrice: function(a) {
                if (! ("array" === $.type(a) && a.length > 0)) return [];
                var b = this;
                try {
                    for (var c = a.slice(), d = [], e = "Sales" + b.resultService.curType, f = 0, g = c.length; g > f; f++) c[f].DepartureDate = c[f].DepartureDate.replace(/\//g, "-"),
                    c[f][e] > 0 && d.push(c[f]);
                    return d.sort(function(a, b) {
                        var c = a[e] - b[e];
                        return c > 0 ? 1 : 0 > c ? -1 : 1 * a.DepartureDate.toDate() - 1 * b.DepartureDate.toDate()
                    }),
                    d.slice(0, 10)
                } catch(h) {
                    return []
                }
            },
            autoSearch: function(a, b) {
                var c = a.attr("data-dcity"),
                d = a.attr("data-acity"),
                e = a.attr("data-time"),
                f = a.attr("data-grade");
                null === c && (c = this.condition.SegmentList[0].DCity, d = this.condition.SegmentList[0].ACity),
                0 != $("#btnSearch").length && ($("#selflightType").value("S"), $("#selflightType").trigger("change"), $("#homeCity").getMod("address_poi", "2.0").method("select", c), $("#destCity").getMod("address_poi", "2.0").method("select", d), $("#DDate").value(e), $("#ADate").value("yyyy-mm-dd"), $("#Airline").value(""), $("#txtAirline").value(""), online.clearNotice($("#homeCity")), online.clearNotice($("#destCity")), online.clearNotice($("#DDate")), f && ($("#drpSubClass").value(online.SwitchClassGrade(f)), $("#drpSubClass").trigger("change")), b !== !0 && (this.resultService.sortKey = this.resultService.curType, this.resultService.orderBy = "asc", this.resultService.saveOrderBy()), $("#btnSearch")[0].click())
            },
            haveDaysByMonth: function(a) {
                return a = new Date(a.replace(/-/g, "/")),
                a = a.addMonths(1),
                a.setDate(1),
                new Date( + a - 1).getDate()
            },
            lastDaysByMonth: function(a) {
                return this.haveDaysByMonth(a) - new Date(a.replace(/-/g, "/")).getDate()
            },
            needDays: function(a) {
                return new Date(a.replace(/-/g, "/")).getDay()
            },
            insertDays: function(a) {
                return 6 - new Date(a.replace(/-/g, "/")).getDay()
            },
            update: function() {
                if (this.resultService.loadFinish && this.resultService.lowPrice) {
                    var a, b = this;
                    if (pageGlobal.NewUbt.LowPrice.Days90LowestPrice = -3, this.calData) for (var c = 0,
                    d = this.calData.length; d > c; c++) if (a = this.calData[c], a.DepartureDate == b.recDepartDate) {
                        a.clickSearch && delete a.clickSearch,
                        pageGlobal.NewUbt.LowPrice.Days90LowestPrice = "undefined" != typeof a.SalesTotalPrice ? a.SalesTotalPrice: -2,
                        a["Sales" + b.resultService.curType] = b.resultService["low" + b.resultService.curType],
                        b.isMultiTrave && (a["Sales" + b.resultService.curType] = Math.round(b.resultService["low" + b.resultService.curType]));
                        break
                    }
                    return this.draw(1),
                    void $("#rec_cheap_box").show()
                }
                this.draw()
            },
            draw: function(a) {
                this.renderRecommendUI(),
                this.renderCalendarUI(),
                a && (this.renderBomRec(), this.renderRecFltBoxUI())
            },
            is: function(a, b) {
                return Object.prototype.toString.call(a).slice(8, -1) === b
            },
            getRange: function(a) {
                for (var b, c = Array.prototype.concat.apply([], a), d = {},
                e = 0, f = c.length; f > e; e++) c[e].DepartureDate && (b = c[e].DepartureDate.substring(0, 7), d[b] || (d[b] = !0));
                var g = [];
                for (var h in d) g.push(h);
                return g
            },
            isSomedayAfter: function(a) {
                var b = this,
                c = new Date(b.recDepartDate.replace(/-/g, "/")) - new Date((new Date).addDays(a).toFormatString("yyyy/MM/dd"));
                return c >= 0 ? !0 : !1
            },
            clearDom: function() {
                $("#calendar_tab,#calendarDialog,#rec_cheap_box").remove()
            },
            reportLowPriceHisData: function() {
                var a = this;
                try {
                    var b = a.LowPriceHis,
                    c = $.tmpl.render("{{enum (k,v) Ubt}}${k}=${v}&{{/enum}}", {
                        Ubt: b
                    });
                    if ("" === c) return;
                    window.__bfi.push(["_tracklog", "LowPriceHis  ", c])
                } catch(d) {}
            },
            addHash: function(a) {
                window.keepHash = !0,
                location.hash = a
            },
            getShortestRecommendItem: function(a, b, c, d) {
                var e, f = 999999999;
                return a.each(function(a) {
                    a[c] === d && a[b] < f && (f = a[b], e = a)
                }),
                e
            }
        }
    });
    var LP_Tmpl = {
        TravelCheaperTmpl: '<span class="close J_chpClose">\xd7</span><table class="flight-mod J_travelCheaper"><tbody><tr><th class="flt-tit"><h3>\u8fd9\u6bb5\u65f6\u95f4\u51fa\u884c<strong>\u66f4\u4fbf\u5b9c</strong></h3></th><td class="flt-date"><div class="date-go">${chp.DDepartDate}\u53bb<span>{{if chp.DDelay}}\uff08${chp.DDelay}\u5929\uff09{{/if}}</span></div><div class="date-back">${chp.ADepartDate}\u56de<span>{{if chp.ADelay}}\uff08${chp.ADelay}\u5929\uff09{{/if}}</span></div></td><td class="flt-depart"><strong class="leave-city" title="${chp.TakeOffCity}">${chp.TakeOffCity}</strong></td><td class="flt-arr"><div class="arrow"></div></td><td class="flt-return"><strong class="arrive-city" title="${chp.ArrivalCity}">${chp.ArrivalCity}</strong></td><td class="flt-price" style="padding-right:50px;"><span class="info-price">\u5f80\u8fd4\u603b\u4ef7</span><span class="base-price02"><dfn>&yen;</dfn>${chp[curType]}</span>{{if curType===\'SalesTotalPrice\'}}\uff08\u542b\u7a0e\uff09{{else}}+<strong class="price">${chp.Tax}</strong>{{/if}}\u8d77</td></tr></tbody></table>',
        TopLowPriceRecommendTmpl: '<div class="calendar_tab calendar_tab_round clearfix" id="J_topRecommend" style="display:none;"></div><div class="J_Cal_popWrap"><div class="price_calendar" id="J_TopCalendar" style="display:none;"><div class="calendar_tit" id="J_calendarHead"></div><div class="calendar_panel" id="J_calWrap_DRC" upbn="0" downbn="0"></div><div class="calendar_panel calendar_panel_month" id="J_calWrap_MHC" upbn="0" downbn="0" style="display:none;"></div></div></div>',
        TRD_innerTmpl: '<div class="prev_date"><a class="J_prevDate{{if curPage<1}} arrow_left_disable{{else}} arrow_left{{/if}}" href="javascript:;" rel="nofollow" data-ubt-key="LowestPrice_UP"><b></b></a></div><div class="cal_box"><ul class="calendar_ul clearfix" style="width:2000%;">{{each(i,v) list}}<li{{if v.current}} class="current"{{/if}}><a href="javascript:;" class="J_optional" data-dep="${v.DepartureDate}" data-ret="${v.ReturnDate}" data-grade="${v.ClassGrade}" data-price="${v[curType]}" data-idx="${i}"><span class="date_go">${v.DepDetail}</span><span class="date_back">${v.RetDetail}</span>{{if v.noPrice}}<span>\u70b9\u51fb\u67e5\u8be2</span>{{else}}{{if v[curType]&&v[curType]<999999}}<span class="price"><dfn>&yen;</dfn>${v[curType]}</span>{{/if}}{{/if}}</a></li>{{/each}}</ul></div><div class="next_date"><a class="J_nextDate{{if curPage>=size}} arrow_right_disable{{else}} arrow_right{{/if}}" href="javascript:;" rel="nofollow" data-ubt-key="LowestPrice_Down"><b></b></a></div><div class="panel_link"><a class="days90 J_showCalendar" href="javascript:;"></a></div>',
        DRC_innerTmpl: '<div class="turn_arrow turn_arrow_left"><a class="left_arrow J_prevDate{{if curPage<1}} left_arrow_disabled{{/if}}" href="javascript:;" data-ubt-key="Calendar_Left"></a></div><div class="turn_arrow turn_arrow_right"><a class="right_arrow J_nextDate{{if curPage>=size}} right_arrow_disabled{{/if}}" href="javascript:;" data-ubt-key="Calendar_Right"></a></div><div class="panel"><div class="inner_panel" id="J_calPanel_DRC" style="width:2000%;">${content}</div></div>',
        MHC_innerTmpl: '<div class="turn_arrow"><div class="prev_month"><a href="javascript:;" class="top_arrow J_prevDate{{if curPage<1}} top_arrow_disabled{{/if}}"></a></div><div class="month_info"><span class="year">${head.year}</span><span class="month">${head.month}</span>\u51fa\u53d1</div><div class="next_month"><a href="javascript:;" class="bottom_arrow J_nextDate{{if curPage>=size}} bottom_arrow_disabled{{/if}}"></a></div></div><table class="month_table_tit"><thead><tr><th><div class="date">\u5468\u65e5</div></th><th><div class="date">\u5468\u4e00</div></th><th><div class="date">\u5468\u4e8c</div></th><th><div class="date">\u5468\u4e09</div></th><th><div class="date">\u5468\u56db</div></th><th><div class="date">\u5468\u4e94</div></th><th><div class="date">\u5468\u516d</div></th></tr></thead></table><div class="panel"><div class="inner_panel" id="J_calPanel_MHC">${content}</div></div>',
        DRC_calendarTmpl: '<table class="date_table"><thead><tr>{{each(j,vv) list.head}}<th>{{if vv.TabTitle}}<div class="date"><div class="go">\u53bb\u7a0b</div><div class="back">\u8fd4\u7a0b</div><div class="line"><i></i></div></div>{{else}}<div class="date">${vv.DepTitle}</div>{{/if}}</th>{{/each}}</tr></thead><tbody>{{each(j,vv) list.body}}<tr>{{each(k,vvv) vv}}{{if vvv.RetTitle}}<th class="row_date"><div class="date">${vvv.RetTitle}</div></th>{{else vvv.disable}}<td>-</td>{{else}}<td class="optional J_optional{{if vvv.isGap}} select_tag{{/if}}{{if vvv.current}} choosed{{/if}}" data-dep="${vvv.DepartureDate}" data-ret="${vvv.ReturnDate}" data-grade="${vvv.ClassGrade}" data-price="${vvv[curType]}">{{if vvv.noPrice}}<a href="javascript:;" class="check">\u67e5\u770b</a>{{else}}<div class="price{{if vvv.lowPrice}} hot_price{{/if}}"><dfn>&yen;</dfn>${vvv[curType]}{{if vvv.lowPrice}}<i class="icon icon-cheaper"></i>{{/if}}</div>{{/if}}</td>{{/if}}{{/each}}</tr>{{/each}}</tbody></table>',
        MHC_calendarTmpl: '{{each(i,v) list}}<table class="month_table">{{each(j,vv) v.body}}<tr>{{each(k,vvv) vv}}{{if vvv.disable}}<td></td>{{else vvv.expired}}<td class="optional forbid"><div class="date"><div class="day">${vvv.day}</div></div></td>{{else}}<td class="optional J_optional{{if vvv.current}} choosed{{/if}}" data-dep="${vvv.DepartureDate}" data-ret="${vvv.ReturnDate}" data-grade="${vvv.ClassGrade}" data-price="${vvv[curType]}" data-role="jmp" data-params="{options:{type:\'jmp_text\',css:{minWidth:90},showArrow:false,template:\'#jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},api:{onShow:function(obj){online.toAdjust.call(this,obj);}},content:{\'txt1\':\'\u53bb\u7a0b&nbsp;&nbsp;${vvv.DepartureDate.substring(5)}&lt;br /&gt;\u56de\u7a0b&nbsp;&nbsp;${vvv.ReturnDate.substring(5)}\'}}}"><div class="date"><div class="day">${vvv.day}</div>{{if vvv.noPrice}}<a href="javascript:;" class="check">\u67e5\u770b</a>{{else}}<div class="price{{if vvv.lowPrice}} hot_price{{/if}}"><dfn>&yen;</dfn><span>${vvv[curType]}</span>{{if vvv.lowPrice}}<i class="icon icon-cheaper"></i>{{/if}}</div>{{/if}}</div></td>{{/if}}{{/each}}</tr>{{/each}}</table>{{/each}}',
        RecCheaperTmpl: '<div class="recommend_box" cname="RCP"><h4>{{if title}}<strong>\u90bb\u8fd1\u65e5\u671f</strong>${title}{{/if}}</h4><div class="recommend_list"><table><tbody>{{each(i,v) list}}<tr class="J_BomRec" style="cursor:pointer;" data-idx="${i}" data-dep="${v.DepartureDate}" data-ret="${v.ReturnDate}" data-dcity="${v.DCity}" data-acity="${v.ACity}" data-grade="${v.ClassGrade}"><th><a href="javascript:;">\u53bb${v.dep}${v.DWeek}<span class="date">${v.gap}\u5929</span>\u8fd4${v.ret}${v.AWeek}</a></th><td>${v.grade}</td><td class="price"><dfn>&yen;</dfn>${v[curType]}</td></tr>{{/each}}</tbody></table></div></div>',
        RecNearByTmpl: '<div class="recommend_box" cname="NRB"><h4><strong>\u90bb\u8fd1\u822a\u7ebf</strong>${title}</h4><div class="recommend_list"><table><tbody>{{each(i,v) list}}<tr data-ubt-key="NearLine" class="J_BomRec" style="cursor:pointer;" data-idx="${i}" data-dep="${v.DepartureDate}" data-ret="${v.ReturnDate}" data-dcity="${v.DCity}" data-acity="${v.ACity}" data-grade="${v.ClassGrade}"><th><a href="javascript:;">${v.DCityName} - ${v.ACityName}</a></th><td>${v.grade}</td><td class="price"><dfn>&yen;</dfn>${v[curType]}</td>{{/each}}</tr></tbody></table></div></div>',
        recFltBoxTmpl: '<div class="rec-tit"><i class="ico-recomm">\u8350</i><h4>\u90bb\u8fd1\u822a\u7ebf\u63a8\u8350</h4></div><div class="rec-fromto"><div class="depart" title="${DCityName}">${DCityName}${DDistanceTip}</div><div class="arrow"></div><div class="arrive" title="${ACityName}">${ACityName}${ADistanceTip}</div></div><div class="rec-date f12"><div>\u53bb: <span>${DdateStr}</span></div><div>\u56de: <span>${RdateStr}</span></div></div><div class="rec-price" {{if FlightDuration && FlightDuration != 9999999}}PainExponent="${PainExponent}"{{/if}}><dfn>&yen;</dfn><strong>${price}</strong></div>{{if save<999999}}<div class="rec-discount">{{if curType=="TotalPrice"}}\u8282\u7701<span class="price"><dfn>&yen;</dfn>${save}</span>{{/if}}</div>{{else}}<div class="rec-discount"></div>{{/if}}<div class="rec-action"><button class="btn-book J_recFltBox" type="button" data-dep="${DepartureDate}" data-ret="${ReturnDate}" data-dcity="${DCity}" data-acity="${ACity}" data-grade="${ClassGrade}" data-ubt-key="CheaperLine_Detail">\u67e5\u770b</button></div>'
    };
    online.create("service.NewResult.LowReturnRecommend",
    function() {
        var a = [],
        b = {
            TCP: null,
            TRD: null,
            DRC: null,
            MHC: null,
            NRB: null
        },
        c = {
            TRD: null,
            DRC: null,
            MHC: null
        },
        d = {
            TRD: null,
            DRC: null,
            MHC: null
        },
        e = 7;
        return online.toAdjust = function(a) {
            var b = $(a),
            c = $(this.elem),
            d = b.offset().width,
            e = b.offset().left,
            f = b.offset().top,
            g = c.offset().width - d;
            b.css("display", "none"),
            setTimeout(function() {
                b.css({
                    display: "block",
                    width: d + "px",
                    left: e + g + "px",
                    top: f - 8 + "px"
                }),
                b.find(".tooltip-content").css("padding", "5px 10px")
            },
            60)
        },
        {
            options: {
                StepPanel: $("#StepPanel"),
                SearchBtn: $("#btnSearch"),
                url: "AjaxRequest/AsyncResult/GetRecommendFlight.ashx",
                url_chp: "AjaxRequest/AsyncResult/LowPriceGeneric.ashx",
                condition: condition,
                isMultiTrave: condition.Quantity && (condition.ChildQuantity || condition.InfantQuantity),
                MaxInterval: null,
                curInterval: null,
                showMonth: !1,
                ClassType: {
                    Y: "\u7ecf\u6d4e\u8231",
                    S: "\u8d85\u7ea7\u7ecf\u6d4e\u8231",
                    C: "\u516c\u52a1\u8231",
                    F: "\u5934\u7b49\u8231"
                },
                festival: {
                    "2017-01-27": ["c_chuxi", "\u9664\u5915"],
                    "2016-02-07": ["c_chuxi", "\u9664\u5915"],
                    "2015-02-18": ["c_chuxi", "\u9664\u5915"],
                    "2017-01-28": ["c_chunjie", "\u6625\u8282"],
                    "2016-02-08": ["c_chunjie", "\u6625\u8282"],
                    "2015-02-19": ["c_chunjie", "\u6625\u8282"],
                    "2017-02-11": ["c_chunjie", "\u5143\u5bb5\u8282"],
                    "2016-02-22": ["c_chunjie", "\u5143\u5bb5\u8282"],
                    "2015-03-05": ["c_yuanxiao", "\u5143\u5bb5\u8282"],
                    "2017-04-04": ["c_qingming", "\u6e05\u660e\u8282"],
                    "2016-04-04": ["c_qingming", "\u6e05\u660e\u8282"],
                    "2015-04-05": ["c_qingming", "\u6e05\u660e\u8282"],
                    "2017-05-30": ["c_duanwu", "\u7aef\u5348\u8282"],
                    "2016-06-09": ["c_duanwu", "\u7aef\u5348\u8282"],
                    "2015-06-20": ["c_duanwu", "\u7aef\u5348\u8282"],
                    "2017-10-04": ["c_zhongqiu", "\u4e2d\u79cb\u8282"],
                    "2016-09-15": ["c_zhongqiu", "\u4e2d\u79cb\u8282"],
                    "2015-09-27": ["c_zhongqiu", "\u4e2d\u79cb\u8282"],
                    "01-01": ["c_yuandan", "\u5143\u65e6"],
                    "05-01": ["c_wuyi", "\u52b3\u52a8\u8282"],
                    "10-01": ["c_guoqing", "\u56fd\u5e86\u8282"],
                    "12-25": ["c_shengdan", "\u5723\u8bde\u8282"]
                }
            },
            methods: {
                initialize: function(a) {
                    this.info(),
                    this.extend(this, a),
                    this.flag && "D" === this.condition.FlightWay && (this.DepartDate = this.fixDate(this.condition.SegmentList[0].DepartDate), this.ReturnDate = this.fixDate(this.condition.SegmentList[1].DepartDate), this.ReturnDate !== this.DepartDate && (pageGlobal.HasRCP_NRB = 3, this.isTouristClass = !this.condition.ClassGrade || -1 != this.condition.ClassGrade.indexOf("Y"), this.RecommendProduct = pageGlobal.NewUbt.RecommendProduct, this.curType = "Sales" + this.resultService.curType, this.gap = (1 * this.ReturnDate.toDate() - 1 * this.DepartDate.toDate()) / 864e5, this.initUbt(), this.bindEvent(), this.request()))
                },
                initUbt: function() {
                    pageGlobal.Ubt.date_diff = this.gap,
                    pageGlobal.Ubt.date_method = "day",
                    pageGlobal.Ubt.price_method = "SalesTotalPrice" === this.curType ? "withtax": "notax",
                    pageGlobal.Ubt.isclose = 0,
                    pageGlobal.Ubt.upbn = 0,
                    pageGlobal.Ubt.downbn = 0,
                    pageGlobal.Ubt.choosetodate = this.DepartDate,
                    pageGlobal.Ubt.choosebackdate = this.ReturnDate
                },
                request: function() {
                    var c = this;
                    $.ajax(online.getBaseUrl(this.url), {
                        context: {
                            QueryData: c.condition
                        },
                        method: "POST",
                        onsuccess: function(d, e) {
                            if (!e || "{}" === e || !b) return online.log("\u6ca1\u6709\u62ff\u523045\u5929\u4f4e\u4ef7\u6570\u636e!"),
                            void c.resultService.checkHasLoad();
                            var f = $.parseJSON(e);
                            b.TCP = f.AdjacentDateLowPrice,
                            f.NearbyRecommendFlights || (f.NearbyRecommendFlights = []),
                            f.NearbyRecommendFlights.each(function(a) {
                                a.PricePainExponent = parseInt((a.FlightDuration || 0) * (pageGlobal.PainExponentConfig[a.ClassGrade] || 0) * 1e4) / 1e4,
                                a.TotalPricePainExponent = parseInt((a.FlightDurationIncludingTax || 0) * (pageGlobal.PainExponentConfig[a.ClassGrade] || 0) * 1e4) / 1e4,
                                a.PricePainExponent += a.SalesTotalPrice,
                                a.TotalPricePainExponent += a.SalesTotalPrice
                            }),
                            b.NRB = f.NearbyRecommendFlights,
                            c.initCorlt(),
                            pageGlobal.NewUbt.LowPrice.Days90LowestPrice = -3;
                            var g = f.RoundLowPriceRecommendFlights;
                            if (a = c.filterIeg(c.toArray(g)), g && g[c.DepartDate]) {
                                var h, i = g[c.DepartDate];
                                if (i && i.length) for (var j = i.length; j--;) if (h = i[j], c.ReturnDate == h.ReturnDate) {
                                    pageGlobal.NewUbt.LowPrice.Days90LowestPrice = "undefined" != typeof h.SalesTotalPrice ? h.SalesTotalPrice: -2;
                                    break
                                }
                            }
                            return (pageGlobal.HasRCP_NRB = online.noResCompen(c.resultService, c.resultService.flightWay)) > 0 ? void c.resultService.nearCompen() : 0 === pageGlobal.HasRCP_NRB ? void c.resultService.hasNoResult() : void c.dataProcess()
                        },
                        onerror: function() {
                            online.log("\u8bf7\u6c4245\u5929\u6570\u636e\u51fa\u9519!"),
                            c.resultService.checkHasLoad()
                        }
                    })
                },
                initCorlt: function() {
                    if ($("#J_TopContainer").length < 1) {
                        var a = document.createElement("div");
                        a.id = "J_TopContainer",
                        $(a).insertAfter(this.StepPanel),
                        this.container = $("#J_TopContainer"),
                        this.container.html(LP_Tmpl.TopLowPriceRecommendTmpl)
                    }
                    if ($("#J_BomRecommend").length < 1) {
                        var a = document.createElement("div");
                        a.id = "J_BomRecommend",
                        a.className = "recommend_flight",
                        $(a).insertAfter($("#pageControl")),
                        this.BomRecommend = $("#J_BomRecommend")
                    }
                    if ($("#rec_flt_box").length < 1) {
                        var a = document.createElement("div");
                        a.id = "rec_flt_box",
                        a.className = "rec_flt_box",
                        a.style.display = "none",
                        $(a).insertBefore($("#flightList")),
                        this.RecFltPanel = $("#rec_flt_box")
                    }
                    this.TopRecommend = $("#J_topRecommend"),
                    this.TopCalendar = $("#J_TopCalendar"),
                    this.DRCwrap = $("#J_calWrap_DRC"),
                    this.MHCwrap = $("#J_calWrap_MHC"),
                    this.bindAjust()
                },
                renderTCP: function() {
                    if (! (this.flag_chp && !condition.AdjacentDateKey && "array" === $.type(b.TCP) && b.TCP.length > 0 && this.resultService && this.isTouristClass)) return void(this.TravelCheaper && this.TravelCheaper.remove());
                    var a = b.TCP[0];
                    if ("undefined" == typeof a.DDelay && (a.TakeOffDateTime = this.fixDate(a.TakeOffDateTime), a.ArrivalDateTime = this.fixDate(a.ArrivalDateTime), a.SalesPrice = a.Price, a.SalesTotalPrice = a.Price + a.Tax, a.DDepartDate = a.TakeOffDateTime.toDate().toFormatString("M\u6708d\u65e5"), a.ADepartDate = a.ArrivalDateTime.toDate().toFormatString("M\u6708d\u65e5"), a.DDelay = this.getGap(this.DepartDate, a.TakeOffDateTime), a.ADelay = this.getGap(this.ReturnDate, a.ArrivalDateTime)), !(a[this.curType] >= this.lowPrice || 1 * a.TakeOffDateTime.toDate() === 1 * this.DepartDate.toDate() && 1 * a.ArrivalDateTime.toDate() === 1 * this.ReturnDate.toDate())) {
                        if ($("#TravelCheaper").length < 1 && !this.TCPdisable) {
                            var c = document.createElement("div");
                            c.className = "cheaper-box",
                            c.id = "TravelCheaper",
                            $(c).insertBefore(this.StepPanel),
                            $(c).attr("data-ubt-key", "TravelCheaper"),
                            this.TravelCheaper = $("#TravelCheaper")
                        }
                        if (this.TravelCheaper) {
                            this.TravelCheaper.html($.tmpl.render(LP_Tmpl.TravelCheaperTmpl, {
                                chp: a,
                                curType: this.curType
                            })),
                            this.TravelCheaper.find(".J_travelCheaper").css("cursor", "pointer"),
                            this.TravelCheaper.find(".J_travelCheaper").attr("data-dep", a.TakeOffDateTime),
                            this.TravelCheaper.find(".J_travelCheaper").attr("data-ret", a.ArrivalDateTime),
                            this.TravelCheaper.find(".J_travelCheaper").attr("data-key", a.Key);
                            try {
                                var d = {
                                    DepartureCity: condition.SegmentList[0].DCityCode,
                                    ArrivalCity: condition.SegmentList[0].ACityCode,
                                    DepartureDate: a.TakeOffDateTime.slice(0, 10),
                                    Price: a.Price,
                                    IsRt: !0,
                                    Tax: a.Tax,
                                    ReturnDate: a.ArrivalDateTime.slice(0, 10)
                                };
                                InternationalRecommend.firstRecommendProd(d, "6")
                            } catch(e) {}
                        }
                    }
                },
                cheapFlight: function(a, b) {
                    if (this.flag_chp && this.resultService && "array" === $.type(a) && a.length > 0 && this.isTouristClass) {
                        if (pageGlobal.VirtualFlightSwitch) {
                            for (var c = [], d = 0; d < a.length; d++) a[d].ContainsVirtualFlight || c.push(a[d]);
                            a = c
                        }
                        var e = this,
                        f = this.resultService,
                        g = {},
                        h = {
                            FlightNumberGroup: [],
                            OrigDestGroup: this.condition.SegmentList,
                            Flights: []
                        },
                        i = h.Flights;
                        switch (b) {
                        case 0:
                            if (f.curSegment < 1) a.each(function(a, b) {
                                g[a.FlightNoRoute] = b;
                                var c = [];
                                a.FlightDetail.each(function(a) {
                                    c.push(a.FlightNo)
                                }),
                                i.push(c.join("|"))
                            });
                            else {
                                var j = f.Depflight,
                                k = [];
                                j.FlightDetail.each(function(a) {
                                    k.push(a.FlightNo)
                                }),
                                a.each(function(a, b) {
                                    g[j.FlightNoRoute + "_" + a.FlightNoRoute] = b;
                                    var c = [];
                                    a.FlightDetail.each(function(a) {
                                        c.push(a.FlightNo)
                                    }),
                                    i.push(k.join("|") + "_" + c.join("|"))
                                })
                            }
                            break;
                        case 1:
                            a.each(function(a, b) {
                                var c = a.FlightInfo[0].FlightNoRoute + "_" + a.FlightInfo[1].FlightNoRoute;
                                g[c] = b;
                                var d = [];
                                a.FlightInfo.each(function(a) {
                                    var b = [];
                                    a.FlightDetail.each(function(a) {
                                        b.push(a.FlightNo)
                                    }),
                                    d.push(b.join("|"))
                                }),
                                i.push(d.join("_"))
                            });
                            break;
                        default:
                            return void online.log("\u7c7b\u578b\u4e0d\u5b58\u5728!")
                        }
                        $.ajax(online.getBaseUrl(this.url_chp), {
                            context: {
                                QueryData: h
                            },
                            method: "POST",
                            onsuccess: function(b, c) {
                                if (!c || "[]" === c) return void online.log("\u6ca1\u6709\u62ff\u5230\u540c\u4e2a\u822a\u73ed\u6362\u4e2a\u65e5\u671f\u66f4\u4fbf\u5b9c\u6570\u636e!");
                                var d, h, i, j, k = $.parseJSON(c);
                                if (i = e.fixDate(e.condition.SegmentList[0].DepartDate), j = e.fixDate(e.condition.SegmentList[1].DepartDate), "array" === $.type(k)) {
                                    for (var l = 0,
                                    m = k.length; m > l; l++) if (d = k[l], d.TakeOffDateTime = e.fixDate(d.TakeOffDateTime), d.ArrivalDateTime = e.fixDate(d.ArrivalDateTime), d.TotalPrice = d.Price + d.Tax, d.DDepartDate = d.TakeOffDateTime.toDate().toFormatString("M\u6708d\u65e5"), d.ADepartDate = d.ArrivalDateTime.toDate().toFormatString("M\u6708d\u65e5"), h = g[d.Key], "undefined" != typeof h) {
                                        if (d[f.curType] >= a[h][f.curType] || 1 * d.TakeOffDateTime.toDate() === 1 * i.toDate() && 1 * d.ArrivalDateTime.toDate() === 1 * j.toDate()) continue;
                                        d.DDelay = e.getGap(i, d.TakeOffDateTime),
                                        d.ADelay = e.getGap(j, d.ArrivalDateTime),
                                        a[h].cheapFlight = d
                                    }
                                    e.resultService.runTimes = 0,
                                    e.resultService.update(),
                                    $("#flightList").data("hasBindChp") || ($("#flightList").data("hasBindChp", 1), $("#flightList").onn("click", "J_cheakCheap",
                                    function(a) {
                                        a.stop();
                                        var b = $(this);
                                        e.resultService.lpSuggestUbt.lookothertime++,
                                        "D" === e.resultService.flightWay && "builtUp" !== e.resultService.flightType && e.addHash("builtUp"),
                                        $("#AdjacentDateKey").value(b.attr("data-key")),
                                        e.doSearch(b)
                                    }))
                                }
                            },
                            onerror: function() {
                                online.log("\u8bf7\u6c42\u540c\u4e2a\u822a\u73ed\u6362\u4e2a\u65e5\u671f\u66f4\u4fbf\u5b9c\u6570\u636e\u51fa\u9519!")
                            }
                        })
                    }
                },
                dataProcess: function() {
                    if (! (a.length < 0)) {
                        if (0 == a.length) {
                            if (this.MaxInterval = 7, this.gap > this.MaxInterval) return;
                            for (var b = new Date,
                            c = 0; 45 > c; c++) {
                                for (var d = b.toFormatString("yyyy-MM-dd"), e = new Date(b.getFullYear(), b.getMonth(), b.getDate() + 1), f = [], g = 0; 7 > g; g++) f.push({
                                    SalesPrice: -1,
                                    DepartureDate: d,
                                    SalesTotalPrice: -1,
                                    ReturnDate: e.toFormatString("yyyy-MM-dd"),
                                    noPrice: !0
                                }),
                                e = new Date(e.getFullYear(), e.getMonth(), e.getDate() + 1);
                                a.push(f),
                                b = new Date(b.getFullYear(), b.getMonth(), b.getDate() + 1)
                            }
                        } else if (this.MaxInterval = a[0].length, this.gap > this.MaxInterval) return;
                        this.TopRecommend.css("display", "block"),
                        this.renderCalenHead(),
                        this.renderLPlist(),
                        pageGlobal.ShowTopCalBtn = 1,
                        pageGlobal.Ubt.chooseprice = 1 * this.TopRecommend.find("li.current a").attr("data-price")
                    }
                },
                renderCalenHead: function() {
                    var a = '<h3>\u51fa\u884c\u95f4\u9694\u5929\u6570</h3>${AllSecLow}<label class="label" for="calendar_MHC_check" data-ubt-key="Calendar_Month"><input type="checkbox"{{if showMonth}} checked="true"{{/if}} class="J_calendar_MHC_check" id="calendar_MHC_check">\u6309\u6708\u4efd\u663e\u793a</label><div class="tax-switcher"><label class="label" for="directFlight" style="display:none;"><input type="checkbox" class="J_DirectFlight" id="directFlight">\u4ec5\u67e5\u770b\u76f4\u98de</label><div class="switch"><label for="tax" class="switch-label switch-label-off{{if curType===\'SalesPrice\'}} switch-label-checked{{/if}}" data-ubt-key="Calendar_PriceNoTax">\u4e0d\u542b\u7a0e\u4ef7\u683c</label><label for="notax" class="switch-label switch-label-on{{if curType===\'SalesTotalPrice\'}} switch-label-checked{{/if}}" data-ubt-key="Calendar_PriceWithTax">\u542b\u7a0e\u4ef7\u683c</label><span class="switch-selection{{if curType===\'SalesTotalPrice\'}} switch-selection-on{{/if}}"></span></div></div><a href="javascript:;" class="close J_closeTopCal" data-ubt-key="Calendar_Close">\xd7</a>';
                    $("#J_calendarHead").html($.tmpl.render(a, {
                        AllSecLow: this.getAllSecLow(),
                        curType: this.curType,
                        showMonth: this.showMonth
                    }))
                },
                renderBomRec: function() {
                    var c, d = this,
                    e = Array.prototype.concat.apply([], a),
                    f = "",
                    g = "",
                    h = "",
                    i = "",
                    j = function(a) {
                        "array" === $.type(a) && a.length > 0 && a.each(function(a) {
                            a.DCity = a.DCityPinYin + "|" + a.DCityName + "(" + a.DCityCode + ")|" + a.DCityID + "|" + a.DCityCode,
                            a.ACity = a.ACityPinYin + "|" + a.ACityName + "(" + a.ACityCode + ")|" + a.ACityID + "|" + a.ACityCode,
                            a.dep = d.forMatDate(a.DepartureDate, "MM-dd"),
                            a.ret = d.forMatDate(a.ReturnDate, "MM-dd"),
                            a.DWeek = d.getWeek(a.DepartureDate),
                            a.AWeek = d.getWeek(a.ReturnDate),
                            a.gap = 1 * d.getGap(a.DepartureDate, a.ReturnDate).match(/\d+/g),
                            a.grade = d.ClassType[a.ClassGrade]
                        })
                    },
                    k = function(a) {
                        return a.length < 6 ? "": $.tmpl.render(LP_Tmpl.RecCheaperTmpl, {
                            list: a.slice(5, 10),
                            curType: d.curType
                        })
                    };
                    if (j(e), e = this.ascSort(e,
                    function(a, b) {
                        var c = a[d.curType] - b[d.curType],
                        e = a.gap - b.gap,
                        f = 1 * a.DepartureDate.toDate() - 1 * b.DepartureDate.toDate();
                        return c > 0 ? 1 : 0 > c ? -1 : e > 0 ? 1 : 0 > e ? -1 : f
                    }), this.RCPData = c = this.filterRCP(e), c.length < 1 ? g = "": (f = c[0].DCityName + " - " + c[0].ACityName, g = $.tmpl.render(LP_Tmpl.RecCheaperTmpl, {
                        title: f,
                        list: c.slice(0, 5),
                        curType: this.curType
                    })), "array" === $.type(b.NRB) && b.NRB.length > 0) {
                        var l = this.filterNRB(b.NRB);
                        l.length < 1 ? i = k(c) : (this.NRBData = l = this.ascSort(l), j(l), h = "\u53bb\u7a0b" + this.forMatDate(this.DepartDate, "MM-dd") + this.getWeek(this.DepartDate) + "&nbsp;&nbsp;&nbsp;&nbsp;\u8fd4\u7a0b" + this.forMatDate(this.ReturnDate, "MM-dd") + this.getWeek(this.ReturnDate), i = $.tmpl.render(LP_Tmpl.RecNearByTmpl, {
                            title: h,
                            list: l.slice(0, 5),
                            curType: this.curType
                        }))
                    } else i = k(c);
                    return $("#J_BomRecommend").html(g + i),
                    (g + i).length > 0
                },
                renderRecFlt: function() {
                    var a = this.filterNRB(b.NRB),
                    c = a[0],
                    d = this.resultService,
                    e = d.curType,
                    f = (d.sortKey,
                    function() {
                        $("#rec_flt_box").hide()
                    });
                    if (! (this.isTouristClass && c && d["low" + e] > 0 && ("freeStyle" === d.flightType && d.curSegment < 1 || "builtUp" === d.flightType && d.runTimes < 1))) return void f();
                    var g, h = d["low" + e],
                    i = c["Sales" + e],
                    j = 0,
                    k = h - i;
                    if (h = d.lowPainExponent || 0, i = 999999, a.each(function(a) {
                        a[e + "PainExponent"] < i && (i = a[e + "PainExponent"])
                    }), g = this.getShortestRecommendItem(a, "NearbyCityDistance", e + "PainExponent", i), g && (c = g), j = h - i, this.isMultiTrave && (j = Math.round(j)), j > 400 && i > 0) {
                        var l = /[^|]+\|([^(]+).*/,
                        m = this.condition.SegmentList[0].DCity.match(l) ? condition.SegmentList[0].DCity.match(l)[1] : "",
                        n = this.condition.SegmentList[0].ACity.match(l) ? condition.SegmentList[0].ACity.match(l)[1] : "",
                        o = c.NearbyCityDistance && c.NearbyCityDistance > 0 && c.NearbyCityDistance <= 200 && c.DCityCode && m && c.DCityCode != this.condition.SegmentList[0].DCityCode ? '<p class="distance" title="">\u8ddd' + m + c.NearbyCityDistance + "km</p>": "",
                        p = c.NearbyCityDistance && c.NearbyCityDistance > 0 && c.NearbyCityDistance <= 200 && c.ACityCode && n && c.ACityCode != this.condition.SegmentList[0].ACityCode ? '<p class="distance" title="">\u8ddd' + n + c.NearbyCityDistance + "km</p>": "";
                        this.RecFltPanel.html($.tmpl.render(LP_Tmpl.recFltBoxTmpl, {
                            save: k,
                            DdateStr: new Date(c.DepartureDate.replace(/-/g, "/")).toFormatString("MM\u6708dd\u65e5"),
                            RdateStr: new Date(c.ReturnDate.replace(/-/g, "/")).toFormatString("MM\u6708dd\u65e5"),
                            DCityName: c.DCityName,
                            DCity: c.DCityPinYin + "|" + c.DCityName + "(" + c.DCityCode + ")|" + c.DCityID + "|" + c.DCityCode,
                            ACityName: c.ACityName,
                            ACity: c.ACityPinYin + "|" + c.ACityName + "(" + c.ACityCode + ")|" + c.ACityID + "|" + c.ACityCode,
                            price: c["Sales" + e],
                            DepartureDate: c.DepartureDate,
                            DDistanceTip: o,
                            ADistanceTip: p,
                            ReturnDate: c.ReturnDate,
                            ClassGrade: c.ClassGrade,
                            curType: e,
                            FlightDuration: c.FlightDuration,
                            PainExponent: i
                        })),
                        this.RecFltPanel.slideDown(500),
                        pageGlobal.NewUbt.RecommendProduct = this.RecommendProduct.concat({
                            Type: "1",
                            Price: c["Sales" + e],
                            IsClick: "N",
                            From: {
                                CityID: c.DCityID,
                                CityName: c.DCityName,
                                CityCode: c.DCityCode
                            },
                            To: {
                                CityID: c.ACityID,
                                CityName: c.ACityName,
                                CityCode: c.ACityCode
                            }
                        });
                        var q = {
                            DepartureCity: c.DCityCode,
                            ArrivalCity: c.ACityCode,
                            DepartureDate: c.DepartureDate,
                            Price: c["Sales" + e],
                            IsRt: !0,
                            ReturnDate: c.ReturnDate
                        };
                        InternationalRecommend.firstRecommendProd(q, "1")
                    } else f()
                },
                filterRCP: function(a) {
                    if (! ("array" === $.type(a) && a.length > 0)) return [];
                    var b = [],
                    c = this;
                    return c.lowPrice > 0 ? (a.each(function(a) {
                        a[c.curType] > 0 && a[c.curType] < c.lowPrice && (1 * a.DepartureDate.toDate() !== 1 * c.DepartDate.toDate() || 1 * a.ReturnDate.toDate() !== 1 * c.ReturnDate.toDate()) && b.push(a)
                    }), b) : a
                },
                filterNRB: function(a) {
                    if (! ("array" === $.type(a) && a.length > 0)) return [];
                    var b = [],
                    c = this,
                    d = this.resultService;
                    return this.lowPrice = d["low" + d.curType],
                    c.lowPrice > 0 ? (a.each(function(a) {
                        a[c.curType] > 0 && a[c.curType] < c.lowPrice && b.push(a)
                    }), b) : a
                },
                getAllSecLow: function() {
                    for (var b, c = [], d = [], e = 0; e < this.MaxInterval; e++) {
                        c = [];
                        for (var f = 0,
                        g = a.length; g > f; f++) c.push(a[f][e]),
                        f === g - 1 && (c = this.ascSort(c), c.length > 0 && d.push(c[0][this.curType]))
                    }
                    return b = $.tmpl.render('<select name="" class="J_searchInterval" data-ubt-key="Calendar_Gapday">{{each(i,v) list}}<option value="${i+1}"{{if i+1===curSec}} selected="selected"{{/if}}>${i+1}\u5929&nbsp;&nbsp;&yen;${v}\u8d77</option>{{/each}}</select>', {
                        list: d,
                        curSec: this.curInterval || this.gap
                    })
                },
                toArray: function(a) {
                    var b = [];
                    for (var c in a) b.push(a[c]);
                    return b
                },
                filterIeg: function(a) {
                    for (var b = [], c = 0, d = a.length; d > c; c++) {
                        b[c] = [];
                        for (var e = 0,
                        f = a[c].length; f > e; e++) this.fixDate(a[c][e].DepartureDate),
                        this.fixDate(a[c][e].ReturnDate),
                        a[c][e][this.curType] < 0 && (a[c][e].noPrice = !0),
                        b[c].push(a[c][e])
                    }
                    return b
                },
                DR_PHD: function(a) {
                    var b = [],
                    c = a.length % 7 > 0 ? 7 - a.length % 7 : 0,
                    d = a[a.length - 1][0].DepartureDate;
                    if (c > 0) for (var e = 1; c >= e; e++) {
                        b.push([]);
                        for (var f = 1; f <= this.MaxInterval; f++) b[e - 1].push({
                            DepartureDate: d.toDate().addDays(e).toFormatString("yyyy-MM-dd"),
                            ReturnDate: d.toDate().addDays(e + f).toFormatString("yyyy-MM-dd"),
                            noPrice: !0
                        })
                    }
                    return a.concat(b)
                },
                DR_SEG: function(a) {
                    for (var b = [], c = 0, d = a.length; d > c; c += 7) b.push(a.slice(c, c + 7));
                    return b
                },
                ascSort: function(a, b) {
                    if (! ("array" === $.type(a) && a.length > 0)) return [];
                    var c = [],
                    d = [],
                    e = this;
                    d = $.copy(a);
                    for (var f = 0,
                    g = d.length; g > f; f++) d[f] && d[f][this.curType] > 0 && c.push(d[f]);
                    return c.sort(b ? b: function(a, b) {
                        var c = a[e.curType] - b[e.curType],
                        d = 1 * a.DepartureDate.toDate() - 1 * b.DepartureDate.toDate(),
                        f = 1 * a.ReturnDate.toDate() - 1 * b.ReturnDate.toDate();
                        return c > 0 ? 1 : 0 > c ? -1 : d > 0 ? 1 : 0 > d ? -1 : f
                    }),
                    c
                },
                fixDate: function(a) {
                    return a.replace(/\//g, "-").toDate().toFormatString("yyyy-MM-dd")
                },
                forMatDate: function(a, b) {
                    return this.fixDate(a).toDate().toFormatString(b)
                },
                outRange: function(b) {
                    return b = b || 0,
                    this.DepartDate && 1 * this.DepartDate.toDate() > 1 * a[a.length - 1][0].DepartureDate.toDate().addDays(b)
                },
                getWeek: function(a) {
                    try {
                        return "\u5468" + "\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(this.fixDate(a).toDate().getDay())
                    } catch(b) {
                        return ""
                    }
                },
                getFestival: function(a) {
                    a = this.fixDate(a);
                    var b = a.substring(5),
                    c = this.festival;
                    return c[a] ? c[a][1] : c[b] ? c[b][1] : ""
                },
                getDateDetail: function(a, b) {
                    var c = a.toDate().toFormatString("yyyy-MM-dd");
                    return a.substring(5) + " " + (this.getFestival(c) ? "<strong>" + this.getFestival(c) + "</strong>": this.getWeek(a) + (b ? "Dep" === b ? "\u53bb": "\u8fd4": ""))
                },
                getDays: function(a) {
                    var b = a.toDate(),
                    c = b.getFullYear(),
                    d = b.getMonth(),
                    e = c % 100 == 0 ? c % 400 == 0 ? 1 : 0 : c % 4 == 0 ? 1 : 0;
                    return [31, 28 + e, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][d]
                },
                getGap: function(a, b) {
                    a = this.fixDate(a),
                    b = this.fixDate(b);
                    var c = 1 * a.toDate(),
                    d = 1 * b.toDate();
                    return d > c ? "\u665a" + (d - c) / 864e5: c > d ? "\u65e9" + (c - d) / 864e5: ""
                },
                unshiftDay: function(a) {
                    return a.toDate().getDay()
                },
                pushDay: function(a) {
                    return 6 - a.toDate().getDay()
                },
                update: function() {
                    try {
                        if (a.length < 1 || this.gap > this.MaxInterval || "D" !== this.condition.FlightWay) return;
                        var b = this,
                        c = this.resultService;
                        this.curType = "Sales" + c.curType,
                        pageGlobal.Ubt.price_method = "SalesTotalPrice" === this.curType ? "withtax": "notax",
                        this.lowPrice = c["low" + c.curType],
                        this.renderTCP(),
                        this.renderBomRec(),
                        ["TRD", "DRC", "MHC"].each(function(a) {
                            b.renderLPlist(a, "TRD" === a ? b.gap: b.curInterval)
                        }),
                        this.renderCalenHead(),
                        pageGlobal.Ubt.chooseprice = this.lowPrice
                    } catch(d) {}
                },
                updateLowPri: function(a) {
                    if (a = Array.prototype.concat.apply([], a), this.lowPrice && 1 * this.ReturnDate.toDate() > 1 * this.DepartDate.toDate()) for (var b = 0,
                    c = a.length; c > b; b++) if (a[b].DepartureDate === this.DepartDate && a[b].ReturnDate === this.ReturnDate) {
                        a[b][this.curType] = this.lowPrice,
                        this.isMultiTrave && (a[b][this.curType] = Math.round(this.lowPrice)),
                        delete a[b].noPrice;
                        break
                    }
                },
                renderLPlist: function(a, e) {
                    a = a || this.getCurShowType();
                    var f, g, h, i, j = this;
                    switch (f = b[a] = this.getLPlist(a, e), g = c[a], h = d[a], a) {
                    case "TRD":
                        ;
                        this.TopRecommend.html($.tmpl.render(LP_Tmpl.TRD_innerTmpl, {
                            curPage: c[a] || 0,
                            size: d[a],
                            list: f,
                            curType: this.curType
                        })),
                        i = this.TopRecommend.find("ul"),
                        i.css({
                            marginLeft: -c[a] * this.getDist(a) + "px"
                        });
                        break;
                    case "DRC":
                        var k, l = function() {
                            f = b[a],
                            k = '<div class="J_tab">' + $.tmpl.render(LP_Tmpl[a + "_calendarTmpl"], {
                                list: f[c[a] || 0],
                                curType: this.curType
                            }) + "</div>"
                        }.bind(this);
                        "undefined" == typeof this.DRCfixed ? (f = this.getLPlist(a, e,
                        function(a) {
                            for (var b = [], c = 0, d = a.length; d > c; c++) for (var e = 0,
                            f = a[c].length; f > e; e++) if (a[c][e].DepartureDate === j.DepartDate && a[c][e].ReturnDate === j.ReturnDate && c > 3 && d - 7 > c) {
                                b = a.slice(c - 3, c + 4);
                                break
                            }
                            return b
                        }), f.length > 0 ? (k = '<div class="J_tab">' + $.tmpl.render(LP_Tmpl[a + "_calendarTmpl"], {
                            list: f[0],
                            curType: this.curType
                        }) + "</div>", c[a] = c[a] < 1 ? 1 : c[a]) : l()) : l(),
                        this[a + "wrap"].html($.tmpl.render(LP_Tmpl[a + "_innerTmpl"], {
                            curPage: c[a] || 0,
                            size: h,
                            content: k
                        })),
                        i = this[a + "panel"] = $("#J_calPanel_" + a);
                        break;
                    case "MHC":
                        this[a + "wrap"].html($.tmpl.render(LP_Tmpl[a + "_innerTmpl"], {
                            curPage: c[a] || 0,
                            size: d[a],
                            head: f[c[a] || 0].head,
                            content: $.tmpl.render(LP_Tmpl[a + "_calendarTmpl"], {
                                list: f,
                                curType: this.curType
                            })
                        })),
                        i = this[a + "panel"] = $("#J_calPanel_" + a),
                        i.css({
                            marginTop: -c[a] * this.getDist(a) + "px"
                        })
                    }
                    d[a] = h
                },
                getDist: function(a) {
                    a = a || this.getCurShowType();
                    var b = {
                        TRD: document.documentElement.clientWidth < 1180 ? 112 : 132,
                        DRC: document.documentElement.clientWidth < 1180 ? 860 : 1060,
                        MHC: 343
                    };
                    return b[a]
                },
                getLPlist: function(b, f, g) {
                    b = b || this.getCurShowType(),
                    f = f ? isNaN(f) ? 1 : 1 * f: this.gap;
                    var h = this,
                    i = [],
                    j = [];
                    if (this.updateLowPri(a), i = $.copy(a, !0), "TRD" === b || "MHC" === b) for (var k = 0,
                    l = i.length; l > k; k++) for (var m = 0,
                    n = i[k].length; n > m; m++) if (i[k][m].DepartureDate.toDate().addDays(f).toFormatString("yyyy-MM-dd") === i[k][m].ReturnDate) {
                        "MHC" === b && i[k][m].DepartureDate === this.DepartDate && (i[k][m].current = !0),
                        j.push(i[k][m]);
                        break
                    }
                    switch (b) {
                    case "TRD":
                        if (this.outRange(3)) {
                            var o, p = this.DepartDate,
                            q = this.ReturnDate;
                            o = [{
                                DepartureDate: p,
                                ReturnDate: q,
                                DepDetail: this.getDateDetail(p, "Dep"),
                                RetDetail: this.getDateDetail(q, "Ret"),
                                current: !0
                            }],
                            this.lowPrice ? o[0][this.curType] = this.lowPrice: o[0].noPrice = !0;
                            for (var k = 1; 3 >= k; k++) o.push({
                                DepartureDate: p.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                                ReturnDate: q.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                                DepDetail: this.getDateDetail(p.toDate().addDays(k).toFormatString("yyyy-MM-dd"), "Dep"),
                                RetDetail: this.getDateDetail(q.toDate().addDays(k).toFormatString("yyyy-MM-dd"), "Ret"),
                                noPrice: !0
                            }),
                            o.unshift({
                                DepartureDate: p.toDate().addDays( - k).toFormatString("yyyy-MM-dd"),
                                ReturnDate: q.toDate().addDays( - k).toFormatString("yyyy-MM-dd"),
                                DepDetail: this.getDateDetail(p.toDate().addDays( - k).toFormatString("yyyy-MM-dd"), "Dep"),
                                RetDetail: this.getDateDetail(q.toDate().addDays( - k).toFormatString("yyyy-MM-dd"), "Ret"),
                                noPrice: !0
                            });
                            return d[b] = o.length - e,
                            o
                        }
                        for (var r = j[j.length - 1].DepartureDate, s = j[j.length - 1].ReturnDate, k = 1; 6 >= k; k++) j.push({
                            DepartureDate: r.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                            ReturnDate: s.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                            DepDetail: this.getDateDetail(r.toDate().addDays(k).toFormatString("yyyy-MM-dd"), "Dep"),
                            RetDetail: this.getDateDetail(s.toDate().addDays(k).toFormatString("yyyy-MM-dd"), "Ret"),
                            noPrice: !0
                        });
                        this.updateLowPri(j);
                        for (var k = 0,
                        l = j.length; l > k; k++) j[k].DepDetail = this.getDateDetail(j[k].DepartureDate, "Dep"),
                        j[k].RetDetail = this.getDateDetail(j[k].ReturnDate, "Ret"),
                        j[k].DepartureDate === this.DepartDate && (j[k].current = !0, null === c[b] && (c[b] = k));
                        if ("undefined" == typeof this.TRDfixed) {
                            this.TRDfixed = !0,
                            d[b] = j.length - e;
                            var t = 3,
                            u = c[b];
                            c[b] > d[b] && (3 - (c[b] - d[b]) > 0 && (t = 3 - (c[b] - d[b])), c[b] = d[b]),
                            u >= j.length - 4 ? t = 0 : 4 > u && (c[b] = 0, t = 0),
                            t > 0 && (c[b] -= t)
                        }
                        break;
                    case "DRC":
                        var v, w, x, y = [],
                        z = [];
                        if (i = this.DR_PHD(i), "function" === $.type(g) && (i = g(i)), i.length < 1) return [];
                        i = this.DR_SEG(i);
                        for (var k = 0,
                        l = i.length; l > k; k++) {
                            j.push({
                                head: [],
                                body: []
                            }),
                            z = [];
                            for (var m = 0,
                            n = i[k].length; n > m; m++) {
                                w = i[k][m][0].DepartureDate,
                                w === this.DepartDate && null === c[b] && (c[b] = k),
                                x = w.toDate().addDays(f).toFormatString("yyyy-MM-dd"),
                                j[k].head.push({
                                    DepTitle: this.getDateDetail(w.toDate().toFormatString("yyyy-M-d"))
                                }),
                                j[k].body.push([]);
                                for (var A = 0,
                                B = 7; B > A; A++) {
                                    v = i[k][A];
                                    for (var C = 0,
                                    D = v.length; D > C; C++) {
                                        if (v[C].disable) {
                                            j[k].body[m].push(v[C]);
                                            break
                                        }
                                        if (x === v[0].DepartureDate || 1 * x.toDate() < 1 * v[0].ReturnDate.toDate()) {
                                            j[k].body[m].push({
                                                disable: !0
                                            });
                                            break
                                        }
                                        if (1 * x.toDate() > 1 * v[D - 1].ReturnDate.toDate()) {
                                            j[k].body[m].push({
                                                DepartureDate: v[D - 1].DepartureDate,
                                                ReturnDate: x,
                                                noPrice: !0
                                            });
                                            break
                                        }
                                        if (x === v[C].ReturnDate) {
                                            v[C].DepartureDate === this.DepartDate && v[C].ReturnDate === this.ReturnDate && (v[C].current = !0),
                                            v[C].isGap = m === A,
                                            j[k].body[m].push(v[C]),
                                            z.push(v[C]);
                                            break
                                        }
                                    }
                                    A === B - 1 && j[k].body[m].unshift({
                                        RetTitle: this.getDateDetail(x.toDate().toFormatString("yyyy-M-d"))
                                    })
                                }
                                m === n - 1 && (j[k].head.unshift({
                                    TabTitle: !0
                                }), z = this.ascSort(z), y.push(z[0]))
                            }
                        }
                        for (var k = 0,
                        l = j.length; l > k; k++) if ("undefined" != typeof y[k]) for (var m = 0,
                        n = j[k].body.length; n > m; m++) for (var A = 0,
                        B = j[k].body[m].length; B > A; A++) j[k].body[m][A][this.curType] === y[k][this.curType] && (j[k].body[m][A].lowPrice = !0);
                        d[b] = j.length - 1;
                        break;
                    case "MHC":
                        var E, F, G, H, I, J, K, L, M, N, O = {},
                        P = [],
                        Q = [],
                        R = [],
                        S = [];
                        if (E = j[0].DepartureDate, F = E.toDate().getDate() - 1, G = j[j.length - 1].DepartureDate, H = j[j.length - 1].ReturnDate, I = this.getDays(G), J = I - G.toDate().getDate(), F > 0) for (var k = 1; F >= k; k++) j.unshift({
                            DepartureDate: E.toDate().addDays( - k).toFormatString("yyyy-MM-dd"),
                            expired: !0
                        });
                        if (J > 0) for (var k = 1; J >= k; k++) j.push({
                            DepartureDate: G.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                            ReturnDate: H.toDate().addDays(k).toFormatString("yyyy-MM-dd"),
                            noPrice: !0
                        });
                        j.each(function(a) {
                            a.day = h.getFestival(a.DepartureDate) ? "<strong>" + h.getFestival(a.DepartureDate) + "</strong>": a.DepartureDate.toDate().getDate(),
                            M = a.DepartureDate.substring(0, 7),
                            O[M] || (O[M] = []),
                            O[M].push(a)
                        }),
                        j = this.toArray(O);
                        for (var k = 0,
                        l = j.length; l > k; k++) {
                            if (N = j[k], Q.push({
                                head: {
                                    year: N[0].DepartureDate.toDate().getFullYear() + "\u5e74",
                                    month: N[0].DepartureDate.toDate().getMonth() + 1 + "\u6708"
                                },
                                body: []
                            }), R = [], K = this.unshiftDay(N[0].DepartureDate), K > 0) for (var m = 0; K > m; m++) N.unshift({
                                disable: !0
                            });
                            if (L = this.pushDay(N[N.length - 1].DepartureDate), L > 0) for (var m = 0; L > m; m++) N.push({
                                disable: !0
                            });
                            if (42 - N.length > 0) for (var T = 42 - N.length,
                            m = 0; T > m; m++) N.push({
                                disable: !0
                            });
                            for (var m = 0,
                            n = N.length; n > m; m++) N[m].DepartureDate === this.DepartDate && null === c[b] && (c[b] = k),
                            P.push(N[m]),
                            N[m][this.curType] > 0 && R.push(N[m]),
                            (m + 1) % 7 === 0 && (Q[k].body.push(P), P = []),
                            m === n - 1 && (R = this.ascSort(R), S.push(R[0]))
                        }
                        for (var k = 0,
                        l = Q.length; l > k; k++) if ("undefined" != typeof S[k]) for (var m = 0,
                        n = Q[k].body.length; n > m; m++) for (var A = 0,
                        B = Q[k].body[m].length; B > A; A++) Q[k].body[m][A][this.curType] === S[k][this.curType] && (Q[k].body[m][A].lowPrice = !0);
                        j = Q,
                        d[b] = j.length - 1;
                        break;
                    default:
                        b = "NON"
                    }
                    return j
                },
                scrolling: function(a) {
                    var f, g, h, i, j, k = this.getCurShowType(),
                    l = -1 != a[0].className.indexOf("MHC" === k ? "bottom": "right");
                    if ("TRD" === k ? (f = this.TopRecommend, g = this.TopRecommend.find("ul")) : (f = this[k + "wrap"], g = this[k + "panel"]), h = f.find(".J_prevDate"), i = f.find(".J_nextDate"), !(!k || l && c[k] >= d[k] || !l && c[k] < 1)) {
                        switch (k) {
                        case "TRD":
                            c[k] += l ? e: -e,
                            c[k] >= d[k] ? (c[k] = d[k], h.hasClass("arrow_left_disable") && h.removeClass("arrow_left_disable").addClass("arrow_left"), i.removeClass("arrow_right").addClass("arrow_right_disable")) : c[k] < 1 ? (c[k] = 0, h.removeClass("arrow_left").addClass("arrow_left_disable"), i.hasClass("arrow_right_disable") && i.removeClass("arrow_right_disable").addClass("arrow_right")) : (h.hasClass("arrow_left_disable") && h.removeClass("arrow_left_disable").addClass("arrow_left"), i.hasClass("arrow_right_disable") && i.removeClass("arrow_right_disable").addClass("arrow_right")),
                            g.animate({
                                marginLeft: -c[k] * this.getDist(k)
                            });
                            break;
                        case "DRC":
                            c[k] = l ? ++c[k] : --c[k];
                            var m = 1 * this.DRCwrap.attr("upbn"),
                            n = 1 * this.DRCwrap.attr("downbn");
                            l ? this.DRCwrap.attr("downbn", ++n) : this.DRCwrap.attr("upbn", ++m),
                            c[k] >= d[k] ? (h.hasClass("left_arrow_disabled") && h.removeClass("left_arrow_disabled"), i.addClass("right_arrow_disabled")) : c[k] < 1 ? (h.addClass("left_arrow_disabled"), i.hasClass("right_arrow_disabled") && i.removeClass("right_arrow_disabled")) : (h.hasClass("left_arrow_disabled") && h.removeClass("left_arrow_disabled"), i.hasClass("right_arrow_disabled") && i.removeClass("right_arrow_disabled")),
                            this.DRCfixed = !0,
                            j = b[k];
                            var o = document.createElement("div");
                            o.className = "J_tab",
                            o.innerHTML = $.tmpl.render(LP_Tmpl[k + "_calendarTmpl"], {
                                list: j[c[k]],
                                curType: this.curType
                            }),
                            l ? (g.append(o), g.animate({
                                marginLeft: -this.getDist(k)
                            },
                            "slow",
                            function() {
                                g.find(".J_tab:eq(0)").remove(),
                                g.css({
                                    marginLeft: 0
                                })
                            })) : (g.css({
                                marginLeft: -this.getDist(k) + "px"
                            }), $(o).prependTo(g), g.animate({
                                marginLeft: 0
                            },
                            "slow",
                            function() {
                                g.find(".J_tab:eq(1)").remove()
                            }));
                            break;
                        case "MHC":
                            c[k] = l ? ++c[k] : --c[k];
                            var m = 1 * this.MHCwrap.attr("upbn"),
                            n = 1 * this.MHCwrap.attr("downbn");
                            l ? this.MHCwrap.attr("downbn", ++n) : this.MHCwrap.attr("upbn", ++m),
                            c[k] >= d[k] ? (h.hasClass("top_arrow_disabled") && h.removeClass("top_arrow_disabled"), i.addClass("bottom_arrow_disabled")) : c[k] < 1 ? (h.addClass("top_arrow_disabled"), i.hasClass("bottom_arrow_disabled") && i.removeClass("bottom_arrow_disabled")) : (h.hasClass("top_arrow_disabled") && h.removeClass("top_arrow_disabled"), i.hasClass("bottom_arrow_disabled") && i.removeClass("bottom_arrow_disabled")),
                            j = b[k],
                            this[k + "wrap"].find(".month_info .year").html(j[c[k]].head.year),
                            this[k + "wrap"].find(".month_info .month").html(j[c[k]].head.month),
                            g.animate({
                                marginTop: -c[k] * this.getDist(k)
                            })
                        }
                        this.recordCalUbt()
                    }
                },
                getCurShowType: function() {
                    return "block" === this.TopRecommend.css("display") ? "TRD": "block" === this.DRCwrap.css("display") ? "DRC": this.TopCalendar.find(".J_calendar_MHC_check").is(":checked") && "block" === this.MHCwrap.css("display") ? "MHC": ""
                },
                doSearch: function(a, b) {
                    var c = this.resultService,
                    d = a.attr("data-dcity"),
                    e = a.attr("data-acity"),
                    f = a.attr("data-dep"),
                    g = a.attr("data-ret"),
                    h = a.attr("data-grade");
                    null === d && (d = this.condition.SegmentList[0].DCity, e = this.condition.SegmentList[0].ACity),
                    this.SearchBtn.length < 1 || ($("#selflightType").value("D"), $("#selflightType").trigger("change"), $("#homeCity").getMod("address_poi", "2.0").method("select", d), $("#destCity").getMod("address_poi", "2.0").method("select", e), $("#DDate").value(f), $("#ADate").value(g), $("#Airline").value(""), $("#txtAirline").value(""), online.clearNotice($("#DDate")), online.clearNotice($("#ADate")), online.clearNotice($("#homeCity")), online.clearNotice($("#destCity")), h && ($("#drpSubClass").value(online.SwitchClassGrade(h)), $("#drpSubClass").trigger("change")), b !== !0 && (c.sortKey = c.curType, c.orderBy = "asc", c.saveOrderBy()), this.SearchBtn[0].click())
                },
                callGC: function(c) {
                    a = b = null,
                    c && (this.container && this.container.remove(), $("#TravelCheaper").length > 0 && $("#TravelCheaper").remove())
                },
                addHash: function(a) {
                    window.keepHash = !0,
                    location.hash = a
                },
                recordCalUbt: function() {
                    var a = this;
                    setTimeout(function() {
                        var b = "block" === a.DRCwrap.css("display");
                        pageGlobal.Ubt.upbn = b ? 1 * a.DRCwrap.attr("upbn") : 1 * a.MHCwrap.attr("upbn"),
                        pageGlobal.Ubt.downbn = b ? 1 * a.DRCwrap.attr("downbn") : 1 * a.MHCwrap.attr("downbn")
                    },
                    400)
                },
                bindAjust: function() {
                    var a, b = this;
                    $(window).bind("resize",
                    function() {
                        clearTimeout(a),
                        a = setTimeout(function() {
                            var a, d = b.getCurShowType();
                            if ("TRD" === d) {
                                switch (d) {
                                case "TRD":
                                    a = b.TopRecommend.find("ul")
                                }
                                a && a.length > 0 && a.css({
                                    marginLeft: -c[d] * b.getDist(d) + "px"
                                })
                            }
                        },
                        250)
                    })
                },
                bindEvent: function() {
                    var a, b = this;
                    $(".container").onn("click", "J_prevDate",
                    function(c) {
                        c.stop();
                        var d = $(this);
                        clearTimeout(a),
                        a = setTimeout(function() {
                            b.scrolling(d)
                        },
                        200)
                    }).onn("click", "J_nextDate",
                    function(c) {
                        c.stop();
                        var d = $(this);
                        clearTimeout(a),
                        a = setTimeout(function() {
                            b.scrolling(d)
                        },
                        200)
                    }).onn("click", "J_showCalendar",
                    function(a) {
                        a.stop(),
                        b.DRCwrap.html().length < 1 && b.renderLPlist("DRC"),
                        b.TopCalendar.slideDown("slow"),
                        b.TopRecommend.css("display", "none")
                    }).onn("click", "J_closeTopCal",
                    function(a) {
                        a.stop(),
                        b.TopCalendar.slideUp("slow",
                        function() {
                            b.TopRecommend.slideDown("slow"),
                            $(".J_Cal_popWrap").length > 0 && $(".J_Cal_popWrap").removeClass("price_calendar_pop"),
                            $(".J_Cal_PW_mask").length > 0 && $(".J_Cal_PW_mask").css("display", "none"),
                            pageGlobal.Ubt.isclose = 1
                        })
                    }).onn("click", "J_calendar_MHC_check",
                    function() {
                        this.checked ? (b.MHCwrap.html().length < 1 && b.renderLPlist("MHC"), b.showMonth = !0, b.DRCwrap.css("display", "none"), b.MHCwrap.css("display", "block"), pageGlobal.Ubt.date_method = "month") : (b.showMonth = !1, b.DRCwrap.css("display", "block"), b.MHCwrap.css("display", "none"), pageGlobal.Ubt.date_method = "day"),
                        b.recordCalUbt()
                    }).onn("click", "J_optional",
                    function(a) {
                        a.stop();
                        var c = $(this),
                        d = b.getCurShowType();
                        switch (d) {
                        case "TRD":
                            b.addHash("ctm_ref=fli_rtsr_djkb_sr_bn_" + (1 * c.attr("data-idx") + 1));
                            break;
                        case "DRC":
                        case "MHC":
                            b.addHash("ctm_ref=fli_rtsr_lp_sr_bn")
                        }
                        b.doSearch(c, "TRD" === d)
                    }).onn("click", "J_DirectFlight",
                    function() {}).onn("click", "switch-label",
                    function() {
                        var a = $(this),
                        c = a.hasClass("switch-label-on") ? "switch-label-on": "switch-label-off";
                        b.resultService.sortControl.find("." + c)[0].click()
                    }).onn("change", "J_searchInterval",
                    function() {
                        var a = this;
                        b.curInterval = 1 * a.value,
                        ["DRC", "MHC"].each(function(a) {
                            b.renderLPlist(a, b.curInterval)
                        })
                    }).onn("mousedown", "J_travelCheaper",
                    function(a) {
                        a.preventDefault();
                        var c = $(this);
                        $(a.target).attr("data-ubt-key", "ThisPeriod_Cheaper"),
                        b.addHash("ctm_ref=fli_rdsr_othertime_sr"),
                        $("#AdjacentDateKey").value(c.attr("data-key")),
                        InternationalRecommend.setClickedObj("6", null, pageGlobal.NewUbt.FlightWay),
                        b.doSearch(c)
                    }).onn("click", "J_chpClose",
                    function(a) {
                        a.stop(),
                        b.resultService.lpSuggestUbt.closecheaptime++,
                        b.TCPdisable = !0,
                        b.TravelCheaper.remove()
                    }).onn("click", "J_showPopCalendar",
                    function(a) {
                        if (a.stop(), $(".J_showCalendar")[0].click(), $(".J_Cal_popWrap").addClass("price_calendar_pop"), $(".J_Cal_popWrap").css("display", "block"), $(".J_Cal_PW_mask").length < 1) {
                            var b = document.createElement("div");
                            b.className = "J_Cal_PW_mask",
                            b.style.cssText = "position:absolute;z-index:966;left:0px;top:0;width:" + $(document.body).offset().width + "px;height:" + $(document.body).offset().height + "px;opacity:.5;filter:alpha(opacity=50);background-color:#000;",
                            document.body.appendChild(b)
                        }
                        $(".J_Cal_PW_mask").css("display", "block")
                    }).onn("click", "J_BomRec",
                    function() {
                        var a, c = $(this),
                        d = $(online.getParentsByClass(this, "recommend_box")).attr("cname");
                        switch (d) {
                        case "RCP":
                            a = "fli_rdsr_btm_lp";
                            break;
                        case "NRB":
                            a = "fli_rdsr_btm_ra"
                        }
                        b.addHash("ctm_ref=" + a),
                        b.doSearch(c)
                    }).onn("click", "J_recFltBox",
                    function(a) {
                        a.stop();
                        var c;
                        pageGlobal.NewUbt.RecommendProduct.each(function(a) {
                            a && "1" === a.Type && (a.IsClick = "Y", c = a)
                        }),
                        $.storage.set("SearchNearByCityUBTInfo", c || {},
                        30),
                        $.storage.set("SearchNearRecFltFlag", "T", 30),
                        InternationalRecommend.setClickedObj("1", c, pageGlobal.NewUbt.FlightWay),
                        b.doSearch($(this))
                    })
                },
                getShortestRecommendItem: function(a, b, c, d) {
                    var e, f = 999999999;
                    return a.each(function(a) {
                        a[c] === d && a[b] < f && (f = a[b], e = a)
                    }),
                    e
                }
            }
        }
    } ()),
    online.create("service.NewResult.DrecommendService",
    function() {
        return {
            options: {
                container: $("#flightList"),
                cond: condition,
                SotoIndex: 1,
                SotoFareCache: {}
            },
            methods: {
                initialize: function(a) {
                    this.info(),
                    this.extend(this, a),
                    this.resultService.DrecommendService = this,
                    this.flightWay = this.resultService.flightWay,
                    "S" == this.flightWay && (pageGlobal.NewUbt.Sequence[0].Drecommand = 0)
                },
                initMask: function() {
                    if (!this.DRMask) {
                        var a = document.createElement("div");
                        a.className = "popup-round-cheaper",
                        a.id = "DRecommendMask",
                        a.style.display = "none",
                        document.body.appendChild(a),
                        this.DRMask = $("#DRecommendMask")
                    }
                },
                addOption: function(a) {
                    for (var b = {},
                    c = 0,
                    d = a.FareList.length; d > c; c++) {
                        var e = a.FareList[c]; ! e.IsSotoFlight && e.DoubleFlightInfo && 2 === e.DoubleFlightInfo.length && (e.IsSotoFlight = 1, pageGlobal.NewUbt.Sequence[0].Drecommand += 1, e.DoubleFlightInfo.each(function(a, b) { ["CityName", "PortName", "Terminal"].each(function(b) {
                                a["D" + b] = a.FlightDetail[0]["D" + b],
                                a["A" + b] = a.FlightDetail[a.FlightDetail.length - 1]["A" + b]
                            }),
                            a.DepartTime = a.FlightDetail[0].DepartTime,
                            a.ArrivalTime = a.FlightDetail[a.FlightDetail.length - 1].ArrivalTime,
                            a.ClassInfo = [],
                            e.ClassName ? a.ClassInfo.push(e.ClassName) : e.ClassInfo && e.ClassInfo.each(function(b) {
                                a.FIndex + 1 === b.SegmentNo && a.ClassInfo.push(b.ClassName)
                            }),
                            a.TransferCount = 1,
                            a.FlightDetail.each(function(b) {
                                b.TransferTime && (a.TransferCount += 1)
                            })
                        }), this.SotoFareCache[e.sId = this.SotoIndex++] = e),
                        b[e.PlanCategory] = e
                    }
                    b[2] && b[1e3] && ["Price", "TotalPrice"].each(function(a) {
                        b[1e3]["OW" + a] = b[2][a]
                    })
                },
                showPopup: function(a) {
                    if (a && a.length > 0) {
                        var b, c, d, e = this,
                        f = e.resultService;
                        d = this.SotoFareCache[c = a.attr("sid")],
                        d && (b = '<div class="round-cheaper-header"><a href="javascript:;" class="close" onclick="$(\'#DRecommendMask\').unmask()" data-ubt-key="Close_Drecommand">\xd7</a><h3 class="round-cheaper-title">${f.DoubleFlightInfo[0].DCityName}<span class="icon-round-white"></span>${f.DoubleFlightInfo[0].ACityName}</h3></div><div class="round-cheaper-body">{{each(ind,item) f.DoubleFlightInfo}}<div class="round-cheaper-part"><div class="part-header"><span class="voyage-tag">${ind==0? "\u53bb": "\u8fd4"}</span>${online.showTime(DepartTime,"M\u6708d\u65e5")} ${online.showTime(DepartTime,"hh:mm")} - ${online.showTime(ArrivalTime,"M\u6708d\u65e5")} ${online.showTime(ArrivalTime,"hh:mm")} {{if Duration}}<span title="${item.totalDurationText||"\u98de\u884c"}\u603b\u65f6\u957f:${online.getFlightTime(Duration,1)}"><i class="i-time"></i>${online.getFlightTime(Duration)}</span>{{/if}}</div><div class="part-body"><span class="city">${DPortName} {{if DTerminal.toLowerCase() == "i"}}<br/>\u56fd\u9645\u822a\u7ad9\u697c{{else}}${DTerminal}{{/if}}</span><span class="{{if TransferCount>1}}middle-stop{{else}}middle{{/if}}">{{if TransferCount>1}}\u4e2d\u8f6c{{else}}\u81f3{{/if}}</span><span class="city">${APortName} {{if ATerminal.toLowerCase() == "i"}}<br/>\u56fd\u9645\u822a\u7ad9\u697c{{else}}${ATerminal}{{/if}}</span></div><div class="part-footer"><div class="part-footer-main"><i class="disc-left"></i><i class="disc-right"></i>{{each(j,detail) item.FlightDetail}}{{if detail.AirlineName}}<div class="airline">${FlightNo} ${detail.AirlineName}{{if detail.StopInfo && detail.StopInfo.length>0}}<span class="stay">${detail.StopInfo[0].City}{{if detail.StopInfo.length>1}}\u7b49{{/if}} \u7ecf\u505c</span>{{/if}}</div>{{/if}}{{if detail.Carrier || detail.CarrierFlightNo}}<div class="airline"><i class="i-share"></i>\u5b9e\u9645\u627f\u8fd0 ${detail.Carrier} ${detail.CarrierFlightNo}</div>{{/if}}{{if detail.TransferTime}}<div class="transfer"><span class="transfer-info">${detail.TDCityName || detail.ACityName}&nbsp;&nbsp;\u4e2d\u8f6c:${detail.TransferTime}</span></div>{{/if}}{{/each}}</div><div class="seat">{{if ClassInfo && ClassInfo.length>0}}{{each(i,v) ClassInfo}}<p><span class="seat-info">${v}</span></p>{{/each}}{{/if}}</div></div></div>{{/each}}</div><div class="round-cheaper-footer"><div class="round-cheaper-more" data-ubt-key="More_Drecommand"><i class="disc-left"></i><i class="disc-right"></i><i class="i-more"></i><i class="i-cal"></i>\u66f4\u591a\u5f80\u8fd4\u65e5\u671f</div><div class="round-cheaper-book"><div class="round-cheaper-price">\u5f80\u8fd4${curType == "Price"? "\u4e0d\u542b\u7a0e": "\u542b\u7a0e"}\u4ef7\uff1a<span class="price"><dfn>&yen;</dfn>${f[curType]}</span><span class="one-price">\uff08<del>\u53bb\u7a0b\u5355\u4ef7<dfn>&yen;</dfn>${f["OW"+curType]}\u8d77</del>\uff09</span></div><div class="round-cheaper-btn"><button class="btn-book J_SRBooking" type="button" sid="${f.sId}" data-ubt-key="Ordernow" data-booking="1" token="${f.Parameter}"{{if IsFlayer}} data-time="${f.FlyerTime}"  data-cityid="${f.TicketCity}"{{/if}}>\u7acb\u5373\u9884\u8ba2</button></div></div></div>', this.DRMask.html($.tmpl.render(b, {
                            f: d,
                            curType: f.curType
                        })).mask(), this.DRMask.css({
                            position: "fixed",
                            top: "50%",
                            left: "50%",
                            margin: -this.DRMask.offset().height / 2 + "px 0 0 " + -this.DRMask.offset().width / 2 + "px"
                        }), this.DRMask.find(".round-cheaper-more").bind("click",
                        function() {
                            window.location.href = online.getBaseUrl("FlightResult.aspx?") + online.param({
                                flighttype: "D",
                                DCity: e.cond.SegmentList[0].DCityCode,
                                ACity: e.cond.SegmentList[0].ACityCode,
                                relddate: online.showTime(d.DoubleFlightInfo[0].DepartTime, "yyyy-MM-dd"),
                                relrdate: online.showTime(d.DoubleFlightInfo[1].DepartTime, "yyyy-MM-dd")
                            })
                        }))
                    }
                },
                bindEvent: function() {
                    var a = this,
                    b = a.resultService;
                    this.container.onn("click", "J_DRecommend",
                    function() {
                        var a = this;
                        if (b.stayTimeout) return void b.showTimeoutTips();
                        if (!a.isChecking) {
                            a.isChecking = 1,
                            setTimeout(function() {
                                delete a.isChecking
                            },
                            2e3);
                            var c = a.id;
                            c || (c = "checkBtn_" + Math.random().toString().substr(4), a.id = c);
                            try {
                                __SSO_booking(c, 1)
                            } catch(d) {
                                $.error(d, "__SSO_booking Soto\u5355\u63a8\u5f80\u8fd4\u767b\u5f55\u68c0\u6d4b"),
                                online.checkLogin(c)
                            }
                        }
                    })
                }
            }
        }
    } ());
    var shareIdent = "{{if item.shareIdent&&!item.ContainsVirtualFlight}} <span class=\"plan-share\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip'},css:{maxWidth:350},template:'#jmp_text',content:{'txt1':'${item.shareIdent}'}}}\">(\u5171\u4eab)</span>{{/if}}",
    flightTips = "{{if (detail.Tips && detail.Tips.length > 0) || detail.IsDifferentAirPort===1 || detail.CorssVisa || detail.LuggageDirectTip}}<span class=\"stop-extra-info\">&nbsp;&nbsp;{{if detail.IsDifferentAirPort === 1 || detail.CorssVisa || detail.LuggageDirectTip}}&nbsp;<span class=\"tag-text J-transfer-warn\"{{if detail.CorssVisa}} tips_ajax=\"${detail.CorssVisa}\"{{/if}} data-role=\"jmp\" data-params=\"{options: {css:{maxWidth:400},showArrow:false,api:{onBeforeShow:function(obj){online.getStopoverVisaInfo.call(this, obj, 1);}},type:'jmp_text',classNames:{boxType:'tooltip-combine'},content:{'txt0':'{{if detail.VirtualFlightRemarkList && detail.VirtualFlightRemarkList.length}}{{each(j, remark) detail.VirtualFlightRemarkList}}{{if ((curSegment+1)==remark.SegmentNo) && remark.PreTransRemark}}<h4>${pageGlobal.VirtualFlightPreTransHeader}</h4><p>${remark.PreTransRemark}</p>{{/if}}{{if ((curSegment+1)==remark.SegmentNo) && remark.NextTransRemark}}<h4>${pageGlobal.VirtualFlightNextTransHeader}</h4><p>${remark.NextTransRemark}</p>{{/if}}{{/each}}{{/if}}{{if item.TransContent && item.TransContent.length > 0}}${item.TransContent}{{/if}}{{if detail.IsDifferentAirPort === 1}}${detail.DifferentAirPortTip}{{/if}}{{if detail.LuggageDirectTip}}${detail.LuggageDirectTip}{{/if}}'},template:'#jmp_text'}}\">{{if detail.IsDifferentAirPort === 1 || detail.CorssVisa || detail.LuggageDirectTip}}{{if detail.IsDifferentAirPort === 1}}\u8f6c\u673a{{/if}}{{if detail.CorssVisa }}{{if detail.IsDifferentAirPort === 1 || detail.LuggageDirectTip}}\u7b7e\u8bc1{{else}}\u8fc7\u5883\u7b7e{{/if}}{{/if}}{{if detail.LuggageDirectTip}}{{if !(detail.IsDifferentAirPort === 1 || detail.CorssVisa)}}\u4e2d\u8f6c{{/if}}\u884c\u674e{{/if}}\u63d0\u9192{{/if}}</span>{{/if}}{{if detail.Tips}}{{each (j, tip, tlen) detail.Tips}}&nbsp;<span class=\"tag-text J-transfer-warn\" {{if tip.Url}} tips_ajax=\"${tip.Url}\"{{/if}} data-role=\"jmp\" data-params=\"{options: {showArrow:false,css:{maxWidth:320,minWidth:260},api:{onBeforeShow:function(obj){online.getStopoverVisaInfo.call(this, obj);}},type:'jmp_text',classNames:{boxType:'tooltip-combine'},content:{'txt0':'${online.fixSpecChar(tip.Content||\"\u52a0\u8f7d\u4e2d...\")}'},template:'#jmp_text'}}\">${tip.Text}</span>{{/each}}{{/if}}</span>{{/if}}",
    virtualFlightHeader = '<h3 id="virtualFlightHeader" class="flight-title-tab J_lowPriceTitle"><span class="tab-cur">\u66f4\u591a\u51fa\u884c\u65b9\u6848</span><a href="javascript:;" class="book_notice virtualFlightBuyShouldKnow" style="font-weight: normal;font-size: 12px;margin-left: 15px;">\u8d2d\u4e70\u987b\u77e5</a></h3>',
    flightBase = '<div class="flight-col-base"><div class="airline-logo"><img src="//pic.c-ctrip.com/flight_intl/airline_logo/40x35/{{if item.HasTrain}}flt_trn{{else item.ContainsVirtualFlight&&item.virtualFlightSequenceCnt&&item.notVirtualFlightSequenceCnt}}flt_trn2{{else item.ContainsVirtualFlight&&item.virtualFlightSequenceCnt&&!item.notVirtualFlightSequenceCnt}}train{{else}}${item.PrimaryAirlineCode || item.FlightDetail[0].AirlineCode}{{/if}}.png" height="35" onerror="onAirlineLogoNotFound();"/></div><div class="airline-name">{{if item.HasTrain}}\u7a7a\u94c1\u7ec4\u5408{{else item.ContainsVirtualFlight&&item.virtualFlightSequenceCnt&&item.notVirtualFlightSequenceCnt}}\u7a7a\u94c1\u7ec4\u5408{{else item.ContainsVirtualFlight&&item.virtualFlightSequenceCnt&&!item.notVirtualFlightSequenceCnt&&item.firstVirtualFlightCarrierName}}${item.firstVirtualFlightCarrierName}{{else}}{{if item.IsSingleAirline || item.IsSameAirline}}${item.FlightDetail[0].AirlineName}{{else}}<strong class="base-airline">${item.PrimaryAirlineName || item.FlightDetail[0].AirlineName}</strong>&nbsp;<span class="extra-airline" data-role="jmp" data-params="{options:{type: \'jmp_text\',css: { maxWidth:260},showArrow: false,template:\'#jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'<ul class=extra-airline-list>{{each(i, AirlineCompany) item.AirlineCompanies}}<li><span class=airline-logo><img src=//pic.c-ctrip.com/flight_intl/airline_logo/40x35/${AirlineCompany.Code}.png?v=1 /></span>${AirlineCompany.Name}</li>{{/each}}</ul>\'}}}">\u7b49${item.AirlineCompanies.length}\u4e2a\u822a\u53f8</span>{{/if}}{{/if}}</div><div class="flight-No${list[index].Mode === 1 ? "" : " flight-highlight"}">{{if (item.IsSingleAirline || item.IsSameAirline) && ((list[index].Mode === "Depart" && ind === 0) || (list[index].Mode == "Back" && ind === 1))}}<strong>{{/if}}{{if item.IsSingleAirline}}${item.FlightDetail[0].FlightNo}' + shareIdent + "{{else}}{{if item.HasTrain}}1\u7a0b\u94c1\u8def+${item.FlightLen - 1}\u7a0b\u822a\u73ed{{else item.sequenceText}}${item.sequenceText}{{else}}${item.FlightLen}\u7a0b\u822a\u73ed{{/if}}" + shareIdent + '{{/if}}{{if (item.IsSingleAirline || item.IsSameAirline) && ((list[index].Mode === "Depart" && ind === 0) || (list[index].Mode == "Back" && ind === 1))}}</strong>{{/if}}{{if item.AirlineImage}}&nbsp;<i class="icon-gallery" title="\u5355\u51fb\u67e5\u770b\u673a\u578b\u56fe\u7247" data-url="${item.AirlineImage}"></i>{{/if}}{{if item.IsSingleAirline}}{{if item.FlightDetail[0].CraftType}} <span class="plane-type" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:490},type:\'jmp_table\',classNames:{tipContent:\'tooltip-table\',boxType:\'jmp_table\'},template:\'#jmp_table\', content:online.registerMod.getTableTips(\'?=${item.FlightDetail[0].CraftType}\',1)}}"><span class="abbr">${item.FlightDetail[0].CraftTypeName}</span></span>{{/if}}{{/if}}</div></div><div class="flight-col-detail"><div class="flight-detail-depart"><div class="flight-detail-time">${online.showTime(item.DepartTime, "hh:mm")}</div><div class="flight-detail-airport">{{if item.HasTrain && item.TrainWay}}${item.TDPortName}\u706b\u8f66\u7ad9<img height="14" alt="${item.TDPortName}" src="//pic.c-ctrip.com/flight_intl/icons/trn_sm.png">{{else item.ContainsVirtualFlight && item.DPortEnName}}<span class="abbr" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'${item.DPortEnName}\'},template:\'#jmp_text\'}}">${online.handleLongPortName(true,item.DPortName, "")}</span>{{else}}${online.handleLongPortName(true, item.DPortName, item.DTerminal)}{{if item.DTerminal}} {{if item.DTerminal.toLowerCase() == "i"}}\u56fd\u9645\u822a\u7ad9\u697c{{else}}<span class="terminal" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'${item.DTerminal}\u53f7\u822a\u7ad9\u697c\'},template:\'#jmp_text\'}}">${item.DTerminal}</span>{{/if}}{{/if}}{{/if}}</div>{{if item.DDistance && item.DDistanceName && item.DDistance > 0}}<div class="flight-detail-distance">\u4e0e${item.DDistanceName}\u76f4\u7ebf\u8ddd\u79bb <i>${item.DDistance}km</i></div>{{/if}}</div><div class="{{if item.TransferCount > 1 || item.HasTrain}}arr-stop{{else}}arr-nostop{{/if}}"{{if item.HasTrain === false}} title="{{if item.TransferCount > 1}}{{if flightWay !== "S"}}\u5f53\u524d\u7a0b: {{/if}}${item.TransferCount - 1}\u7a0b\u4e2d\u8f6c{{else}}{{if flightWay !== "S"}}\u5f53\u524d\u7a0b: {{/if}}\u76f4\u98de{{/if}}"{{/if}}></div><div class="flight-detail-return"><div class="flight-detail-time">${online.showTime(item.ArrivalTime, "hh:mm")}{{if item.CrossDay}}<span class="redeye-days" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'\u62b5\u8fbe\u65f6\u95f4\u4e3a\u5f53\u5730\u65f6\u95f4\uff1a${online.showTime(item.ArrivalTime, "yyyy-MM-dd hh:mm")}\'},template:\'#jmp_text\'}}">${item.CrossDay}\u5929</span>{{/if}}</div><div class="flight-detail-airport">{{if item.HasTrain && !item.TrainWay}}${item.TAPortName}\u706b\u8f66\u7ad9<img height="14" alt="${item.TAPortName}" src="//pic.c-ctrip.com/flight_intl/icons/trn_sm.png">{{else item.ContainsVirtualFlight && item.APortEnName}}<span class="abbr" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'${item.APortEnName}\'},template:\'#jmp_text\'}}">${online.handleLongPortName(false, item.APortName, "")}</span>{{else}}${online.handleLongPortName(false, item.APortName, item.ATerminal)}{{if item.ATerminal}} {{if item.ATerminal.toLowerCase() == "i"}}\u56fd\u9645\u822a\u7ad9\u697c{{else}}<span class="terminal" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'${item.ATerminal}\u53f7\u822a\u7ad9\u697c\'},template:\'#jmp_text\'}}">${item.ATerminal}</span>{{/if}}{{/if}}{{/if}}</div>{{if item.ADistance && item.ADistanceName && item.ADistance > 0}}<div class="flight-detail-distance"><i>${item.ADistance}km</i> \u4e0e${item.ADistanceName}\u76f4\u7ebf\u8ddd\u79bb</div>{{/if}}</div></div><div class="flight-col-more">{{if item.FlightTime && item.FlightTime != 9999999}}<div class="flight-total-time"{{if item.HasTrain == false}} title="${item.totalDurationText||"\u98de\u884c"}\u603b\u65f6\u957f:${online.getFlightTime(item.FlightTime, 1)}"{{/if}}{{if item.PainExponent}} PainExponent="${item.PainExponent}"{{/if}}>&nbsp;${online.getFlightTime(item.FlightTime)}</div>{{else}}<div class="flight-total-time"{{if item.PainExponent}} PainExponent="${item.PainExponent}"{{/if}}>&nbsp;\u672a\u77e5</div>{{/if}}{{if item.HasTrain == false && item.TransferCount < 2}}<div class="flight-stop-info">${item.ContainsVirtualFlight?"\u76f4\u8fbe":"\u76f4\u98de"}</div>{{/if}}<div class="flight-stop-info">{{each (i, detail, len) item.FlightDetail}}{{if detail.IsPartial !== 1}}{{if detail.StopInfo}}{{each (i, stop) detail.StopInfo}}<div class="flight-stop"><span class="stop-city stop-city-over">${stop.City} ${stop.AirportName}</span>{{if i=== 0}}' + flightTips + '{{/if}}</div>{{/each}}{{/if}}<div class="flight-stop">{{if detail.TransferTime && detail.IsLastFlight !== true && (((i+1) < item.FlightLen) || ((i+1) == item.FlightLen && detail.SegementType === 1))}}{{if (item.HasTrain === false || detail.SegementType === 0)}}<span class="stop-city stop-city-transfer">${detail.ACityName}</span>{{else}}<span class="stop-city" title="\u4e2d\u8f6c\u505c\u7559\u57ce\u5e02\u53ca\u8f66\u7ad9">{{if item.TrainWay}}${detail.ACityName} ${detail.APortName}{{else}}${detail.DCityName} ${detail.DPortName}{{/if}}\u706b\u8f66\u7ad9</span> <span class="train-extra-info" data-remark="${encodeURIComponent(detail.TransferRemarkRequest)}" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:420,minWidth:200},template:\'#jmp_text\',api:{onBeforeShow:function(obj){online.getRemark.call(this,obj);}},content:{\'txt1\':\'loading ...\'}}}">\u6362\u4e58</span>{{/if}}{{/if}}{{if typeof detail.StopInfo === "undefined"}}' + flightTips + "{{/if}}</div>{{/if}}{{/each}}</div></div><div class=\"humanity-tags\">{{if item.IsShowFlyer}}<span class=\"tag-fly-man\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,position:'bottomRight-topRight',css:{maxWidth:420,minWidth:300},type:'jmp_text',classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip'},template:'#jmp_text',content:{'txt1':'\u201c\u98de\u4eba\u901a\u9053\u201d\u662f\u643a\u7a0b\u4e3a\u9700\u8981\u7d27\u6025\u9884\u8ba2\u7684\u7528\u6237\u63a8\u51fa\u7684\u4e00\u9879\u4fbf\u6377\u670d\u52a1\u3002&lt;/br&gt;\u4ea7\u54c1\u7279\u8272\uff1a&lt;/br&gt;1.\u4eab\u53d7\u201c\u98de\u4eba\u901a\u9053\u201d\u670d\u52a1\u53ea\u80fd\u4f7f\u7528\u56fd\u5185\u4fe1\u7528\u5361\u6765\u652f\u4ed8\u673a\u7968\u6b3e\u548c\u5176\u4ed6\u76f8\u5173\u8d39\u7528\uff1b&lt;/br&gt;2.\u7535\u5b50\u673a\u7968\u884c\u7a0b\u5355\uff08\u62a5\u9500\u51ed\u8bc1\uff09\u5c06\u7531\u6211\u4eec\u90ae\u5bc4\u5230\u60a8\u6307\u5b9a\u7684\u5730\u5740\uff1b&lt;/br&gt;3.\u5982\u679c\u60a8\u5728\u673a\u573a\u529e\u7406\u767b\u673a\u624b\u7eed\u65f6\u53d1\u751f\u95ee\u9898\uff0c\u8bf7\u7acb\u523b\u7535\u8bdd\u8054\u7cfb\u6211\u4eec\uff0c\u7535\u8bdd\uff1a" + (window.intlBookTelInfo || {}).Normal + '\u3002\'}}}">\u98de\u4eba</span>{{/if}}{{if online.checkIsRedEye(item.DepartTime, item.ArrivalTime, item)}} <span class="icon-redeye" title="\u7ea2\u773c\u822a\u73ed\uff08\u6307\u6df1\u591c\u8d77\u98de\uff0c\u51cc\u6668\u6216\u65e9\u4e0a\u62b5\u8fbe\u7684\u822a\u73ed\uff09"></span>{{/if}}</div><!-- \u8d85\u7ea7\u98de\u4eba --><div class="humanity-tags">{{if item.IsSuperFlyer}}<span class="tag-fly-man" data-role="jmp" data-params="{options: {showArrow:false,position:\'bottomRight-topRight\',css:{maxWidth:420,minWidth:300},type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},template:\'#jmp_text\',content:{\'txt1\':\'${ pageGlobal.SuperFlyerHoverTip } \'}}}">\u8d85\u98de</span>{{/if}}{{if online.checkIsRedEye(item.DepartTime, item.ArrivalTime, item)}} <span class="icon-redeye" title="\u7ea2\u773c\u822a\u73ed\uff08\u6307\u6df1\u591c\u8d77\u98de\uff0c\u51cc\u6668\u6216\u65e9\u4e0a\u62b5\u8fbe\u7684\u822a\u73ed\uff09"></span>{{/if}}</div>',
    flightDetail = '{{each (i, detail, len) item.FlightDetail}}{{if detail.IsPartial === 1 && detail.isFirst === 1}}<div class="one-more-free"><p class="free-title"><strong>\u63d0\u793a</strong><span class="help-text">\u9644\u52a0\u822a\u7a0b</span>' + flightTips + '</p>{{/if}}<div class="flight-detail-section" flightNO="${detail.FlightNo}" airlineName="${detail.AirlineName}" segmentNo="${detail.SegmentNo}" transferCount="${item.TransferCount}">{{if i === 0 && title}}<span class="tag-dir">${title}</span>{{/if}}{{if detail.IsVirtualFlight}}<img src="//pic.c-ctrip.com/flight_intl/airline_logo/40x35/train.png?v=1" onerror="onAirlineLogoNotFound();" class="detail-airline-logo" height="24" />{{else}}<img src="//pic.c-ctrip.com/flight_intl/airline_logo/40x35/${detail.AirlineCode}.png?v=1" onerror="onAirlineLogoNotFound();" class="detail-airline-logo" height="24" />{{/if}}<p class="section-flight-base">{{if detail.IsVirtualFlight&&detail.Carrier}}${detail.Carrier}{{else}}${detail.AirlineName}{{/if}}<span class="flight-No" AirlineImageClass="${detail.AirlineImageClass}">${detail.FlightNo}</span>{{if detail.IsVirtualFlight}} <span class="plane-type" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:490},type:\'jmp_table\',classNames:{tipContent:\'tooltip-table\',boxType:\'jmp_table\'},template:\'#jmp_table2\', content:online.registerMod.getTableTips(\'?=${detail.CraftType}\',1)}}"><span class="abbr">${detail.CraftTypeName}</span></span>{{else detail.CraftType}} <span class="plane-type" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:490},type:\'jmp_table\',classNames:{tipContent:\'tooltip-table\',boxType:\'jmp_table\'},template:\'#jmp_table\', content:online.registerMod.getTableTips(\'?=${detail.CraftType}\',1)}}"><span class="abbr">${detail.CraftTypeName}</span></span>{{/if}}{{if detail.AirlineImage}}&nbsp;<i class="icon-gallery" title="\u5355\u51fb\u67e5\u770b\u673a\u578b\u56fe\u7247" data-url="${detail.AirlineName}|${detail.FlightNo}|${detail.CraftType}|${detail.AirlineImage}"></i>{{/if}}{{if detail.ClassName}}<span class="flight-ship">${detail.ClassName}</span>{{/if}}{{if !detail.IsVirtualFlight && (detail.Carrier || detail.CarrierFlightNo)}}<span class="tag-info">\u5171\u4eab</span><span class="detail-fragment">\u5b9e\u9645\u627f\u8fd0${detail.Carrier}${detail.CarrierFlightNo}</span>{{/if}}{{if detail.StopInfo}}{{each (i, stop) detail.StopInfo}}<span class="detail-fragment">\u7ecf\u505c ${stop.City} ${stop.AirportName}</span>{{/each}}{{/if}}</p><p><span class="section-date{{if (item.HasTrain || item.TransferCount > 1) && i === 0}} section-emphasis{{/if}}">${online.showTime(detail.DepartTime, "M\u6708d\u65e5")}</span><span class="section-time{{if (item.HasTrain || item.TransferCount > 1) && i === 0}} section-emphasis{{/if}}">${online.showTime(detail.DepartTime, "hh:mm")}</span><span class="section-airport">${detail.DPort} ${detail.DPortName}{{if detail.SegementType===1}}\u706b\u8f66\u7ad9{{/if}}</span>{{if detail.DTerminal}} <span class="section-terminal">{{if detail.DTerminal.toLowerCase() == "i"}}\u56fd\u9645\u822a\u7ad9\u697c{{else}}${detail.DTerminal}{{/if}}</span>{{/if}}<span class="section-duration">{{if detail.SegementType === 1 || detail.IsVirtualFlight}}\u884c\u9a76{{else}}\u98de\u884c{{/if}}\u65f6\u957f&nbsp;${detail.FlightTime || "\u672a\u77e5"}</span></p><p><span class="section-date{{if (item.HasTrain || item.TransferCount > 1) && i+1 === item.FlightLen}} section-emphasis{{/if}}">${online.showTime(detail.ArrivalTime, "M\u6708d\u65e5")}</span><span class="section-time{{if (item.HasTrain || item.TransferCount > 1) && i+1 === item.FlightLen}} section-emphasis{{/if}}">${online.showTime(detail.ArrivalTime, "hh:mm")}</span><span class="section-airport">${detail.APort} ${detail.APortName}{{if detail.SegementType===1}}\u706b\u8f66\u7ad9{{/if}}</span>{{if detail.ATerminal}} <span class="section-terminal">{{if detail.ATerminal.toLowerCase() == "i"}}\u56fd\u9645\u822a\u7ad9\u697c{{else}}${detail.ATerminal}{{/if}}</span>{{/if}}</p></div>{{if detail.TransferTime && detail.HideTransferTime !== true}}<div class="section-stop"><div class="in"><strong>${detail.TDCityName || detail.ACityName}</strong> {{if detail.SegementType === 1 || detail.IsLastFlight}}\u6362\u4e58 \u95f4\u9694{{else}}\u4e2d\u8f6c \u505c\u7559\u65f6\u957f{{/if}}\uff1a${detail.TransferTime}</div></div>{{/if}}{{if detail.IsPartial === 1 && (i+1) === len}}</div>{{/if}}{{/each}}',
    multLowTmpl = '<h4 class="multidest-recommend-title">\u591a\u7a0b\u8d85\u4f4e\u4ef7</h4><div class="multidest-recommend-flights"{{if HasTrain}} data-train="1"{{/if}}><div class="multidest-recommend-left">{{each (i, v, len) list}}<div class="multidest-recommend-item"><div class="recommend-item-detail"><span class="multidest-count">${i+1}</span><span class="recommend-flight-no">${v.FlightNo}</span>|<span class="recommend-depart">${v.DPortName}</span><span class="recommend-arrow">\u2192</span><span class="recommend-arrive">${v.APortName}</span><span class="recommend-depart-time">\u51fa\u53d1\uff1a<b>${online.showTime(v.DepartTime, "M\u6708d\u65e5 hh:mm")}</b></span><span class="recommend-arrive-time">\u5230\u8fbe\uff1a<b>${online.showTime(v.ArrivalTime, "M\u6708d\u65e5 hh:mm")}</b></span>|<span class="recommend-stop">${v.Stop}</span></div></div>{{/each}}<div class="multidest-recommend-showdetail"><a href="#show_recommend_detail">\u822a\u73ed\u8be6\u60c5<i class="icon-caret"></i></a></div><div class="flight-detail-expend-mult">${detail}</div></div><div class="multidest-recommend-right"><div class="multidest-col-price"><ul><li>\u603b\u4ef7</li><li>{{if Fare.ChildPrice || (typeof Fare.InfPrice !== "undefined")}}<span data-role="jmp" data-params="{options:{type: \'jmp_text\', css: { minWidth:330,maxWidth:360},showArrow: false, template:\'#tip-tmpl-showPriceInfo\', classNames:{boxType:\'tooltip-tmpl\', tipContent:\'tooltip-combine\'},  content:{\'txt1\':\'\'}, api:{onBeforeShow:function(obj){online.getPriceInfo.call(this,obj,${Fare.AdultPrice || 0},${Fare.ChildPrice || 0},${Fare.InfPrice || 0}, ${Fare.AdultTax || 0},${Fare.ChildTax || 0},${Fare.InfTax||0});}} }}"  class="price prompt tabPriceMore"><dfn>&yen;</dfn>${Fare.TotalPrice}</span><span style="display:none;" data-role="jmp" data-params="{options:{type: \'jmp_text\', css: { minWidth:330,maxWidth:360},showArrow: false, template:\'#tip-tmpl-showPriceInfo\', classNames:{boxType:\'tooltip-tmpl\', tipContent:\'tooltip-combine\'},  content:{\'txt1\':\'\'}, api:{onBeforeShow:function(obj){online.getPriceInfo.call(this,obj,${Fare.AdultPrice || 0},${Fare.ChildPrice || 0},${Fare.InfPrice || 0}, ${Fare.AdultTax || 0},${Fare.ChildTax || 0},${Fare.InfTax||0});}} }}"  class="price prompt tabNoPriceMore"><dfn>&yen;</dfn>${Fare.Price}</span>{{else}} <span class="price tabPriceMore"><dfn>&yen;</dfn>${Fare.TotalPrice}</span><span class="price tabNoPriceMore" style="display:none;"><dfn>&yen;</dfn>${Fare.Price}</span>{{/if}}</li><li>{{if Fare.Tax < 0}}\u672a\u542b\u7a0e\u8d39{{else}}<span class="tabPriceTax" style="display:none;"> \u7a0e\u8d39 </span>{{if typeof Fare.ChildTax !== "undefined" || (typeof Fare.InfTax !== "undefined")}}<span class="tabPriceTax" style="display:none;"}}"><dfn>&nbsp;&yen;</dfn>${Fare.Tax}</span>{{else}}<span class="tabPriceTax" style="display:none;"> <dfn>&yen;</dfn>${(Fare.Tax < 0 ? 0 : Fare.Tax) + (Fare.OilFee || 0)} </span>{{/if}}{{/if}}</li><li><span class="tag-text">{{if Fare.RebookRefund || Fare.Declaration}}<span class="tag-text" data-dec="${encodeURIComponent($.stringifyJSON(Fare.Declaration))}" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:560,minWidth:400},type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip-combine\'},template:\'#tip-tmpl-tgq\'{{if Fare.RebookRefund && (Fare.RebookRefund.URL || Fare.RebookRefund.RemarkParameter)}},api:{onBeforeShow:function(obj){online.getEndorseBack.call(this,obj,\'${Fare.RebookRefund.URL}\',\'${Fare.RebookRefund.RemarkParameter}\');}}{{/if}},content:{\'txt1\':\'${online.getRR(Fare.RebookRefund, Fare.Declaration, Fare.CustomRebookRefund)}\'}}}">{{if Fare.RebookRefund && Fare.Declaration}}\u9000\u6539\u7b7e\u53ca\u8d2d\u7968\u8bf4\u660e{{else}}{{if Fare.RebookRefund}}\u9000\u6539\u7b7e\u8bf4\u660e{{/if}}{{if Fare.Declaration}}\u8d2d\u7968\u8bf4\u660e{{/if}}{{/if}}</span>{{else}}&nbsp;{{/if}}</li><li>{{if Fare.GiftList && Fare.GiftList.length>0}}{{each(i,v) Fare.GiftList}}{{if (v.GiftIDList && v.GiftIDList.length > 0) && v.IconName}}<img class="tag tag-img" src="//pic.c-ctrip.com/fltcommon/icons/${v.IconName}" data-role=\'jmp\' data-params="{options: {showArrow:false,css:{minWidth:\'375\'},type:\'jmp_text\',classNames:{boxType:\'tooltip\',tipContent:\'tooltip-content\'},template:\'#gift_list_tmpl\',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,\'${v.GiftIDList.join()}\');}}}}" />&nbsp;{{/if}}{{/each}}{{/if}}</li></ul></div>{{if Fare.Coupon}}<div class="multidest-col-coupon"><span class="tag{{if Fare.Coupon.Text}}-verb{{/if}}" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:500,minWidth:200},type:\'jmp_title\',classNames:{boxType:\'tooltip-combine\'},template:\'#jmp_title\',content:{\'txt1\':\'${online.fixSpecChar(Fare.Coupon.Content)}\'}}}">{{if Fare.Coupon.Text}}<i>\u8fd4</i>${Fare.Coupon.Text}\u5143{{else}}\u8fd4{{/if}}</span></div>{{/if}}<div class="multidest-col-action"><button {{if Fare.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}} class="btn-book J_SRBooking" type="button" data-booking="1" data-validatetime="${list[0].ValidateTime}" token="${Fare.Parameter}"{{if Fare.IsFlayer}} data-time="${Fare.FlyerTime}" data-cityid="${Fare.TicketCity}"{{/if}}>\u9884\u8ba2</button>{{if Fare.TicketLack}}<span class="seat-only">${Fare.TicketLack}</span>{{/if}}</div></div></div>',
    TGQTmpl = " data-role=\"jmp\" {{if showDec}}data-dec=\"${encodeURIComponent($.stringifyJSON(f.Declaration))}\"{{else}}{{if f.BuiltUpSpecialDeclaration}}data-dec=\"${encodeURIComponent($.stringifyJSON(f.BuiltUpSpecialDeclaration))}\"{{/if}}{{/if}} data-params=\"{options: {showArrow:false,css:{maxWidth:560},type:'jmp_text',classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip-combine'},template:'#tip-tmpl-tgq',api:{onBeforeShow:function(obj){ {{if f.RebookRefund && (f.RebookRefund.URL || f.RebookRefund.RemarkParameter)}}online.getEndorseBack.call(this,obj,'${f.RebookRefund.URL}','${f.RebookRefund.RemarkParameter}');{{/if}}{{if f.BaggageUbtLogInfoList}}online.reportBaggageSizeUbt.call(this, '${encodeURIComponent($.stringifyJSON(f.BaggageUbtLogInfoList || []))}');{{/if}}}},content:{'txt1':'${online.getRR(f.RebookRefund, showDec ? f.Declaration : f.BuiltUpSpecialDeclaration, f.CustomRebookRefund) || \"loading...\"}'}}}\"{{if f.TransMultiPUInfo}}isTransMultiPU=\"T\"{{/if}}",
    giftClassTmpl = "<img class=\"tag tag_gift_img\" src=\"//pic.c-ctrip.com/fltcommon/icons/${v.IconName}\" data-role='jmp' data-params=\"{options: {showArrow:false,css:{minWidth:'375'},type:'jmp_text',classNames:{boxType:'tooltip',tipContent:'tooltip-content'},template:'#gift_list_tmpl',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,'${v.GiftIDList.join()}');}}}}\" />",
    multiPUBookingTagText = "<div class=\"red-tip\"><span class=\"abbr\" data-role=\"jmp\" data-params=\"{							options:									{										type: 'jmp_text',										css: { maxWidth:320},										showArrow: false,										template:'#tip-tmpl-simple',										classNames:										{											boxType:'tooltip-tmpl',											tipContent:'tooltip'										},										content:										{											'txt1':'${f.TransMultiPUInfo.YDBUContent}'										},										api:										{											onBeforeShow: function() {												online.reportMultipleTickets.call(this, 'right')											}										}									}}\">\u9884\u8ba2\u5fc5\u8bfb</span></div>",
    orderBtnTmpl = '{{if pageGlobal.IsRebook === 1}}<button{{if f[curType] == lowPrice}} data-lowprice="1"{{/if}}{{if f.AddtionShow}} data-fid="${f.FID}"{{/if}}  data-category="${f.PlanCategory}" {{if f.IsOWIntelligenceRec}} data-isOWIntelligenceRec="1" {{/if}} {{if f.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}} class="btn-book J_SRBooking{{if f.addtionSelectedNum<1}}{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}} btn-disabled J_disabled{{else f.BindingType===1}} btn-disabled{{/if}}{{/if}}" type="button" key="${Key}" seatType="${f.ClassName||"\u591a\u8231\u7b49"}" pkey="${f.pkey}" token="${f.Parameter}"{{if f.IsFlayer}} data-time="${f.FlyerTime}" data-cityid="${f.TicketCity}"{{/if}}>\u9009\u5b9a{{else}}<button xx="${lowPrice}" yy="${f[curType]}" {{if f[curType] == lowPrice}} data-lowprice="1"{{/if}}{{if f.AddtionShow}} data-fid="${f.FID}"{{/if}}  data-category="${f.PlanCategory}" {{if f.IsOWIntelligenceRec}} data-isOWIntelligenceRec="1" {{/if}} {{if f.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}}  class="btn-book J_SRBooking{{if f.addtionSelectedNum<1}}{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}} btn-disabled J_disabled{{else f.BindingType===1}} btn-disabled{{/if}}{{/if}}{{if f.SuccRate}} btn-apply{{/if}}" type="button"{{if flightWay === "S" || isLastSegment}} data-booking="1" {{else}} data-ubt-key="FreeCombine_Check" key="${Key}"{{/if}} pkey="${f.pkey}" token="${f.Parameter}" {{if f.isWiFiCopy}} data-IsWifiPackage="${f.isWiFiCopy}" {{/if}} {{if f.IsFlayer}} data-time="${f.FlyerTime}" data-cityid="${f.TicketCity}"{{/if}}{{if f.IsSotoFlight}} data-ubt="Drecommand"{{/if}}>{{if flightWay === "S" || isLastSegment}}{{if f.SuccRate}}\u7533\u8bf7{{else}}\u9884\u8ba2{{/if}}{{else}}\u9009\u5b9a{{/if}}{{/if}}</button>{{if f.SuccRate}}<span class="success-text" data-role="jmp" data-params="{options:{type:\'jmp_text\',css:{maxWidth:330,minWidth:330},api:{onShow:function(obj){online.SuccRate.call(this,obj)}},showArrow:false,template:\'#jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'&lt;div class=&quot;pop-success&quot;&gt;&lt;table class=&quot;table_success_text&quot;&gt;&lt;tr class=&quot;tr_line&quot;&gt;&lt;th&gt;\u6210\u529f\u7387&lt;/th&gt;&lt;td&gt;${f.SuccRate}%\u6210\u529f\u7387\u4fdd\u8bc1\u7533\u8bf7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;\u7533\u8bf7\u8bf4\u660e&lt;/th&gt;&lt;td&gt;\u60a8\u9009\u8d2d\u7684\u673a\u7968\u9700\u5355\u72ec\u5411\u822a\u7a7a\u516c\u53f8\u7533\u8bf7\uff0c \u4e00\u65e6\u7533\u8bf7\u6210\u529f\u77ed\u4fe1\u901a\u77e5\u60a8\uff0c\u4ec5\u9650\u4fe1\u7528\u5361\u652f\u4ed8\u3002&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\'}}}"><b></b>${f.SuccRate}<em></em></span><div class="confirm-time">1\u5c0f\u65f6\u5185\u786e\u8ba4</div>{{else}}{{if (isRoundTrip === 0 && f.TicketLack) || (isRoundTrip === 1 && f.RoundTripTicketLack)}}<span class="seat-only">${(isRoundTrip === 1 ? f.RoundTripTicketLack : f.TicketLack)}</span>{{/if}}{{/if}}{{if f.TransMultiPUInfo}}' + multiPUBookingTagText + "{{/if}}",
    orderBtnTmpl2 = '{{if pageGlobal.IsRebook === 1}}<button {{if f.AddtionShow}} data-new3x-infoJson="${f.New3XInfoJson}" data-new3x-fid="${f.FID}" {{/if}}  {{if f[curType] == lowPrice}} data-lowprice="1"{{/if}} data-category="${f.PlanCategory}" {{if f.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}} class="btn-apply btn-book J_SRBooking{{if f.addtionSelectedNum<1}}{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}} btn-disabled J_disabled{{else f.BindingType===1}} btn-disabled{{/if}}{{/if}}" type="button" key="${Key}" seatType="${f.ClassName||"\u591a\u8231\u7b49"}" pkey="${f.pkey}" token="${f.Parameter}"{{if f.IsFlayer}} data-time="${f.FlyerTime}" data-cityid="${f.TicketCity}"{{/if}}>\u9009\u5b9a{{else}}<button {{if f.AddtionShow}} data-new3x-infoJson="${f.New3XInfoJson}" data-new3x-fid="${f.FID}" {{/if}} xx="${lowPrice}" yy="${f[curType]}" {{if f[curType] == lowPrice}} data-lowprice="1"{{/if}}  data-category="${f.PlanCategory}" {{if f.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}}  class="btn-apply btn-book J_SRBooking{{if f.addtionSelectedNum<1}}{{if pageGlobal.IsMustByAddtion===1 || f.BindingType===0}} btn-disabled J_disabled{{else f.BindingType===1}} btn-disabled{{/if}}{{/if}}{{if f.SuccRate}} btn-apply{{/if}}" type="button"{{if flightWay === "S" || isLastSegment}} data-booking="1" {{else}} data-ubt-key="FreeCombine_Check" key="${Key}"{{/if}} pkey="${f.pkey}" token="${f.Parameter}" {{if f.isWiFiCopy}} data-IsWifiPackage="${f.isWiFiCopy}" {{/if}} {{if f.IsFlayer}} data-time="${f.FlyerTime}" data-cityid="${f.TicketCity}"{{/if}}{{if f.IsSotoFlight}} data-ubt="Drecommand"{{/if}}>{{if flightWay === "S" || isLastSegment}}{{if f.SuccRate}}\u7533\u8bf7{{else}}\u9884\u8ba2{{/if}}{{else}}\u9009\u5b9a{{/if}}{{/if}}</button>{{if f.SuccRate}}<span class="success-text" data-role="jmp" data-params="{options:{type:\'jmp_text\',css:{maxWidth:330,minWidth:330},api:{onShow:function(obj){online.SuccRate.call(this,obj)}},showArrow:false,template:\'#jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'&lt;div class=&quot;pop-success&quot;&gt;&lt;table class=&quot;table_success_text&quot;&gt;&lt;tr class=&quot;tr_line&quot;&gt;&lt;th&gt;\u6210\u529f\u7387&lt;/th&gt;&lt;td&gt;${f.SuccRate}%\u6210\u529f\u7387\u4fdd\u8bc1\u7533\u8bf7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;\u7533\u8bf7\u8bf4\u660e&lt;/th&gt;&lt;td&gt;\u60a8\u9009\u8d2d\u7684\u673a\u7968\u9700\u5355\u72ec\u5411\u822a\u7a7a\u516c\u53f8\u7533\u8bf7\uff0c \u4e00\u65e6\u7533\u8bf7\u6210\u529f\u77ed\u4fe1\u901a\u77e5\u60a8\uff0c\u4ec5\u9650\u4fe1\u7528\u5361\u652f\u4ed8\u3002&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\'}}}"><b></b>${f.SuccRate}<em></em></span><div class="confirm-time">1\u5c0f\u65f6\u5185\u786e\u8ba4</div>{{else}}{{if (isRoundTrip === 0 && f.TicketLack) || (isRoundTrip === 1 && f.RoundTripTicketLack)}}<span class="seat-only">${(isRoundTrip === 1 ? f.RoundTripTicketLack : f.TicketLack)}</span>{{/if}}{{/if}}{{if f.TransMultiPUInfo}}' + multiPUBookingTagText + "{{/if}}",
    tongYongQuan = '{{if f.XProductPrePoseInfoList && f.XProductPrePoseInfoList.length > 0}}{{each(i,v) f.XProductPrePoseInfoList}}<span class="tag-transfer pickup-tag-free"{{if v.ProdcutDesc}} data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:500,minWidth:200},type:\'jmp_title\',classNames:{boxType:\'tooltip-combine\'},template:\'#jmp_title\',content:{\'txt1\':\'${online.fixSpecChar(v.ProdcutDesc)}\'}}}" {{else}} style="cursor:default;" {{/if}} data-freeType="6">${v.ProdcutName}</span>{{/each}}{{/if}}{{if f.isWiFiCopy}}<span class="tag-green">\u542b${f.WifiPackage.DayGap}\u65e5WiFi</span>{{/if}}',
    refundRebookSpanText = pageGlobal && pageGlobal.RefundRebookLuggageNoteLabel || "\u9000\u6539/\u884c\u674e\u989d\u53ca\u987b\u77e5",
    tripGuaranteeText = pageGlobal.TransPUConfig && pageGlobal.TransPUConfig.TripGuaranteeForListPage || "",
    airlinePackageTips = "{{if f.AirlinePackageInfoList && f.AirlinePackageInfoList.length > 0}}{{each (i, package) f.AirlinePackageInfoList }}<div class=\\'frequentflt-tit\\'>${package.PackageName}{{if package.Type != \"0\"}}<br><span style=\\'font-size:12px;font-weight:normal;\\'>(${package.Description}\u822a\u7a0b\u63d0\u4f9b)</span>{{/if}}</div><div class=\\'frequentflt-cont\\'>{{if package.PackagePropertys && package.PackagePropertys.length > 0}}<ul class=\\'xpros\\'>{{each (j, property) package.PackagePropertys }}<li>{{if property.PropertyType == \"1\"}}<i class=\\'ico-luggage\\'></i>\u63d0\u4f9b${property.PropertyElement}\u6258\u8fd0\u884c\u674e\u989d{{else property.PropertyType == \"2\"}}<i class=\\'ico-refund-free\\'></i>\u514d\u8d39\u9000\u7968{{else property.PropertyType == \"3\"}}<i class=\\'ico-change-free\\'></i>\u514d\u8d39\u6539\u7b7e{{else property.PropertyType == \"4\"}}<i class=\\'ico-meals\\'></i>${property.PropertyElement}{{else property.PropertyType == \"5\"}}<i class=\\'ico-nice-seat\\'></i>${property.PropertyElement}{{else property.PropertyType == \"6\"}}<i class=\\'ico-priority-board\\'></i>${property.PropertyElement}{{else property.PropertyType == \"7\"}}<i class=\\'ico-consignment\\'></i>${property.PropertyElement}{{/if}}{{if property.CommentIndex}}<span class=\\'num\\'>${property.CommentIndex}</span>{{/if}}</li>{{/each}}</ul>{{/if}}{{if package.CommentList && package.CommentList.length > 0}}<ul class=\\'explain\\'>{{each (k, comment) package.CommentList }}<li><span class=\\'num\\'>${k + 1}</span>${comment}</li>{{/each}}</ul>{{/if}}</div>{{/each}}{{/if}}",
    priceTmpl = '<div {{if f.AddtionShow}} id="${f.FID}"{{/if}} class="seat-row{{if pageGlobal.AllowAddTag && (f[curType] == lowPrice)}} seat-lowprice{{/if}}{{if f.AddtionShow}} seat-package J_seat_package{{/if}}  {{if f.FreeInsure}}flt-insurance-pack{{/if}}  " invoiceTypes="${f.InvoiceTypes}" fareIndex="${fareIndex}" key="${Key}" totalPrice="${f.TotalPrice}" className="${f.ClassName}" classInfo="${encodeURIComponent($.stringifyJSON(f.ClassInfo) || \'\')}"  planCategory="${f.PlanCategory}" {{if f.BookingChannelUbt}}BookingChannel="${f.BookingChannelUbt}"{{/if}} productShowName="${f.ProductShowName}"  IsY="${f.IsY}" IsGV="${f.IsGV}" Force="${f.Force}"  Eligibility="${f.Eligibility}"   {{if f.FreeInsure}} data-freeins-code="${f.FreeInsure.ProductCode}"  data-freeins-typeid="${f.FreeInsure.TypeID}" {{/if}}>{{if pageGlobal.AllowAddTag && (f[curType] == lowPrice)}}<div class="tag-lowprice"><span class="path">${pageGlobal.AllowAddTag}</span>\u6700\u4f4e\u4ef7</div>{{/if}}{{if f.TagType}}{{if f.TagType === "highSpeed"}}<img class="tag-speed" src="https://pic.c-ctrip.com/fltcommon/search_result/tag-speed.png" {{if f.TicketTime}}data-role="jmp" data-params="' + "{					options:					{						type: 'jmp_text',						css: { maxWidth:500},						showArrow: false,						template:'#tip-tmpl-simple',						classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip'},						content:{'txt1':'<div><img src=\\'https://pic.c-ctrip.com/fltcommon/search_result/ico-speed.png\\' class=\\'ico-speed\\'/>\u652f\u4ed8\u6210\u529f\u540e\uff0c\u9884\u8ba1${f.TicketTime}\u5206\u949f\u5185\u5b8c\u6210\u51fa\u7968</div>'}					}				}\"{{/if}}/>{{/if}}{{if f.TagType === \"todayRefund\"}}<img class=\"tag-filter-x\" src=\"https://pic.c-ctrip.com/fltcommon/search_result/tag-filter-x.png\" {{if f.TicketTime||f.InvoiceTypes||(f.TodayFreePolicyTipTime&&f.TodayFreePolicyTipArea)}}data-role=\"jmp\" data-params=\"{				options:				{					type: 'jmp_text',					css: { maxWidth:500, marginTop: -3},					showArrow: false,					template:'#tip-tmpl-simple',					classNames:{boxType:'tooltip-tmpl filter-x-tip',tipContent:'tooltip'},					content:{'txt1':'<div>							<div class=\\'title\\'>\u2014\u2014 \u7504\u9009\u670d\u52a1 \u2014\u2014</div>							{{if f.TicketTime}}<p><img class=\\'ico-speed-gold\\' src=\\'https://pic.c-ctrip.com/fltcommon/search_result/ico-speed-gold.png\\'/>\u652f\u4ed8\u6210\u529f\u540e\uff0c\u9884\u8ba1${f.TicketTime}\u5206\u949f\u5185\u5b8c\u6210\u51fa\u7968</p>{{/if}}							{{if f.InvoiceTypes}}<p><img class=\\'ico-ticket\\' src=\\'https://pic.c-ctrip.com/fltcommon/search_result/ico-ticket.png\\'/>{{if f.InvoiceTypes === \"T\"}}\u63d0\u4f9b\u201d\u884c\u7a0b\u5355\u201d{{else f.InvoiceTypes === \"F\"}}\u63d0\u4f9b\u201d\u53d1\u7968\u201d{{else f.InvoiceTypes === \"E\"}}\u4ec5\u652f\u6301\u201d\u7535\u5b50\u51ed\u8bc1\u201d{{/if}}\u4f5c\u4e3a\u62a5\u9500\u51ed\u8bc1</p>{{/if}}							{{if f.TodayFreePolicyTipTime&&f.TodayFreePolicyTipArea}}<p><img class=\\'ico-wallet\\' src=\\'https://pic.c-ctrip.com/fltcommon/search_result/ico-wallet.png\\'/>\u9884\u8ba1\u5f53\u5929${f.TodayFreePolicyTipTime}(${f.TodayFreePolicyTipArea})\u524d\u53ef\u514d\u8d39\u9000\u7968{{if f.TodayDepartTip}}<br><span style=\\'width:21px;opacity:0;display:inline-block\\'>&</span>${f.TodayDepartTip}{{/if}}</p>{{/if}}						</div>'					}				}			}\"{{/if}}/>{{/if}}{{if f.TagType === \"anniversarySale\"}}<img class=\"tag-anniversary\" src=\"https://pic.c-ctrip.com/fltcommon/icons/tag_anniversary.png\"/>{{/if}}{{/if}}<div class=\"seat-special\">{{if f.AirlinePackageInfoList && f.AirlinePackageInfoList.length > 0}}<span class=\"tag-text ml10\" data-role=\"jmp\" data-params=\"{					options:					{						type: 'jmp_text',						css: { maxWidth:500},						showArrow: false,						template:'#tip-tmpl-simple',						classNames:{boxType:'tooltip-tmpl filter-x-tip',tipContent:'tooltip-frequentflt'},						content:						{							'txt1':'" + airlinePackageTips + "'						}					}}\">\u7279\u60e0\u5347\u7ea7</span>&nbsp;<span class=\"tag-meals\" data-role=\"jmp\" data-params=\"{    				options:    				{    					type: 'jmp_text',    					css: { maxWidth:500},    					showArrow: false,    					template:'#tip-tmpl-simple',    					classNames:{boxType:'tooltip-tmpl filter-x-tip',tipContent:'tooltip-frequentflt'},    					content:    					{							'txt1':'" + airlinePackageTips + "'    					}    				}}\">\u7279\u60e0\u8be6\u60c5</span>{{else}}{{if !f.IsNewImpower}}{{if f.SpecialPriceTip}}<span class=\"tag-text\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,css:{maxWidth:500},type:'jmp_title',classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip-combine'},template:'#jmp_title',content:{'txt0':'${online.fixSpecChar(f.SpecialPriceTip.Title)}','txt1':'${online.fixSpecChar(f.SpecialPriceTip.Content)}'}}}\">${f.SpecialPriceTip.Text}</span> {{/if}}{{if f.InsuranceTip}}<span class=\"tag\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-combine'},css:{maxWidth:500,minWidth:200},content:{'txt0':'${online.fixSpecChar(f.InsuranceTip)}'},template:'#jmp_text'}}\">\u60e0\u98de\u4fdd</span> {{/if}}{{if f.isWiFiCopy}}<img src=\"//pic.c-ctrip.com/fltcommon/icons/wifi-package.png\" class=\"tag tag-img tag-wifi-package\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-combine'},css:{maxWidth:320},content:{'txt0':'<p>${f.WifiPackage.Tips}</p>'},template:'#jmp_text'}}\"/> {{/if}}{{if f.IsOWIntelligenceRec}}<span class=\"tag-text ow-intelligence-rec\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip'},css:{maxWidth:700},content:{'txt1':'<p style=&quot;font-size:14px;padding-bottom:5px;&quot;>\u591a\u98de\u4e00\u7a0b\u66f4\u4fbf\u5b9c\uff1a</p><p>\u7b2c\u4e00\u7a0b(${online.getOWIntelligenceRecPopHeaderWrapperOf(f,0).dCityName} - ${online.getOWIntelligenceRecPopHeaderWrapperOf(f,0).aCityName}) + \u7b2c\u4e8c\u7a0b(${online.getOWIntelligenceRecPopHeaderWrapperOf(f,1).dCityName} - ${online.getOWIntelligenceRecPopHeaderWrapperOf(f,1).aCityName}) =<span style=&quot;color:#fd8337;font-size:16px;vertical-align:middle;padding: 0 3px;&quot;><dfn style=&quot;font-size:12px;vertical-align:middle;&quot;>&yen;</dfn>${f[curType]}</span>{{if curType === \"Price\"}}(\u7a0e\u8d39<dfn>&yen;</dfn>${f.Tax}){{/if}}</p>'},template:'#jmp_text'}}\">\u591a\u98de\u4e00\u7a0b\u66f4\u4fbf\u5b9c</span> {{/if}}{{/if}}{{if f.Tips && f.Tips.length > 0}}{{each (i, tips, tMax) f.Tips}}{{if tips.Type==\"FreeInsure\"}}<span class=\"tag-fltinsurance\" {{if tips.Url}} style=\"background: url(${tips.Url}) no-repeat;background-position:0 0;\" {{/if}}  {{if tips.DisplayContent}}   data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-combine'},css:{maxWidth:320},content:{'txt0':'<p>${tips.DisplayContent}</p>'},template:'#jmp_text'}}\"  {{/if}}  ></span>{{else tips.Type==\"NewImpower\"}}<img src=\"${tips.Url}\" class=\"newAirlineLogo help\" data-role=\"jmp\" data-params=\"{options: {showArrow:false,type:'jmp_text',classNames:{boxType:'tooltip-combine'},css:{maxWidth:320},content:{'txt0':'<p>${tips.DisplayContent}</p>'},template:'#jmp_text'}}\"/>{{else tips.Type === \"TRANSPU\"}}<span class=\"tag-text ml10\" data-role=\"jmp\" data-params=\"{				options:				{					type: 'jmp_text',					css: { maxWidth:350},					showArrow: false,					template:'#tip-tmpl-simple',					classNames:					{						boxType:'tooltip-tmpl',						tipContent:'tooltip'					},					content:					{						'txt1':'{{if f.TransMultiPUInfo}}${f.TransMultiPUInfo.DPZHContent}{{/if}}'					}				}}\">${tips.Text}</span>{{if pageGlobal.TripGuaranteeOfDPZHSwitch && pageGlobal.TransPUConfig}}&nbsp;&nbsp;<span class=\"tag-assure\" data-role=\"jmp\" data-params=\"{    			options:    			{    				type: 'jmp_text',    				css: { maxWidth:'260'},    				showArrow: false,    				template:'#tip-tmpl-simple',    				classNames:{boxType:'tooltip-tmpl',tipContent:'tooltip'},					content:{'txt1':'" + tripGuaranteeText + '\'},					api:{onBeforeShow:function(){online.reportMultipleTickets.call(this, \'left\')}}    			}}">\u51fa\u884c\u4fdd\u969c</span>{{/if}}{{else tips.Type === "ONLYTEXT"}}<span class="tag-onlyText" style="cursor:default;"{{if tips.Content}} data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:500,minWidth:310},content:{\'txt1\':\'${online.fixSpecChar(tips.Content)}\'},template:\'#jmp_text\'}}"{{/if}}>${tips.Text || tips.Content}</span>{{else tips.Type === "TicketGift"}}<span class="tag tag-hk" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:\'420\', minWidth:\'420\'},type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip_give\'},template:\'#gift_list_tmpl\',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this, obj, \'${tips.Title}\');}}}}">{{if tips.Title === "-100"}}<i>\u8d60</i>\u8f66\u8239\u7968 </span>{{else tips.Title === "-98"}}<i>\u8d60</i>\u5546\u52a1\u8f66\u7968 </span>{{/if}}{{else tips.Type === "AIRLINE"}}<img src="//pic.c-ctrip.com/fltcommon/flagship/${tips.Text}.png" class="flagship-store flagship-${tips.Text} help" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-combine\'},css:{maxWidth:320},content:{\'txt0\':\'<p>${tips.DisplayContent?tips.DisplayContent:("\u4e2d\u56fd"+tips.Content+"\u822a\u7a7a\u516c\u53f8\u5b98\u65b9\u4ea7\u54c1\uff0c\u63d0\u4f9b\u5b98\u7f51\u7279\u60e0\u4ef7\u683c")}</p>\'},template:\'#jmp_text\'}}"/>{{else tips.Type === "LoungePre"}}<span class="tag tag-hk" data-tipstype="LoungePre" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:\'418\', minWidth:\'418\', borderStyle: \'none\'},type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},api:{onBeforeShow:function(obj){$(obj).hide(); setTimeout(function() {$(obj).find(\'.tooltip-content\').css(\'padding\',\'0\');$(obj).find(\'.lounge-tooltip\').css(\'display\',\'block\'); $(obj).show();}, 0); }},template:\'#jmp_text\',content:{\'txt1\':\'${online.fixSpecChar(\'<div class="lounge-tooltip" style="display:none;"><img src="//pic.c-ctrip.com/flight_intl/temp/tooltip_lounge.jpg" width="418" height="182"><div class="tooltip-cont"><span class="tag-green">\u514d\u8d39WiFi</span><span class="tag-green">\u8212\u9002\u5bbd\u655e</span><span class="tag-green">\u7f8e\u5473\u5c0f\u98df</span><span class="tag-green">\u996e\u6599\u7545\u996e</span><p>\')}${online.fixSpecChar(tips.Content)}${online.fixSpecChar(\'</p></div></div>\')}\'}}}"><i>\u4eab</i>\u8d35\u5bbe\u4f11\u606f\u5ba4</span>{{else tips.Type === "HUI"}}<span class="tag-text" data-role="jmp" data-params="{options:{type:\'jmp_text\',css: {maxWidth:\'480\'},showArrow: false,template:\'#{{if tips.Content}}jmp_text{{else}}gift_list_tmpl{{/if}}\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'}{{if tips.Content}},content:{\'txt1\':\'${online.fixSpecChar(tips.Content)}\'}{{else}},api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,\'${tips.Title}\');}}{{/if}}}}">{{if !f.isWiFiCopy}}<img src="//pic.c-ctrip.com/fltcommon/gift-icon/ico-sales.png" class="tag tag-img"/>{{/if}} ${tips.Text}</span>{{else tips.Type === "PK"}}{{if (isRoundTrip === 1 && f.PickUpTagNOR) || f.PickUpTagNOR && (curSegment<1 && f.PickUpList && f.PickUpList[0] && f.PickUpList[0].PickUpType===3218) || (isLastSegment && f.PickUpList && ((f.PickUpList[0] && f.PickUpList[0].PickUpType===3217) || (f.PickUpList[1] && f.PickUpList[1].PickUpType===3217)))}}<span data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:440},content:{\'txt1\':\'${online.fixSpecChar(online.replaceWith(f.PickUpTagNOR.HoverDes,{FlightInfo : tips.Content }))}\'},template:\'#jmp_text\'}}"><span class="tag-text pickup-package">${f.PickUpTagNOR.Title}</span> <img src="//pic.c-ctrip.com/flight_intl/icons/auto_small.png" width="22" height="13" /></span>{{/if}}{{else tips.Type === "OnlineCheckin"}}<span class="tag tag-hk" data-role="jmp" data-freeType="5" data-params="{options:{type: \'jmp_text\',css: {maxWidth:420},showArrow: false,template:\'#tip-tmpl-simple\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'${tips.Text}\'}}}"><i>\u9001</i>\u5728\u7ebf\u503c\u673a</span>&nbsp;{{else}}{{if tips.Type === "STU"}}<img src="//pic.c-ctrip.com/fltcommon/icons/students.png" class="tag-student-img" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-combine\'},css:{maxWidth:320},content:{\'txt0\':\'<p>\u8d2d\u4e70\u7559\u5b66\u751f\u7968\u9700\u63d0\u4f9b\u76ee\u7684\u5730\u56fd\u7684\u5b66\u751f\u7b7e\u8bc1\u3001\u5b66\u751f\u8bc1\u6216\u5165\u5b66\u901a\u77e5\u4e66\u626b\u63cf\u4ef6</p>\'},template:\'#jmp_text\'}}">&nbsp;{{/if}}<span class="tag{{if (tips.Type === "STU" || tips.Type === "TEXT" || tips.Type === "MULTI")}}-text{{else tips.Type === "WifiGift" || tips.Type === "ZuChe"}}-verb{{else tips.Type === "BUSS"}}${f.Is24Refund?"-text":"-business"} ${f.IsNeedMarkKEAirlineGod?"markKEAirlineGod":""}  ${f.Is24Refund?"mark24Refund":""}{{/if}}" {{if tips.Type !== "STU" && tips.Content}} data-role="jmp" {{/if}} data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'{{if tips.Type === "ZuChe"}}tooltip_drive{{else}}tooltip{{/if}}\'},css:{maxWidth:{{if tips.Type === "ZuChe"}}380{{else}}500{{/if}},minWidth:{{if tips.Type === "ZuChe"}}380{{else}}20{{/if}}},content:{\'txt1\':\'{{if tips.Type !== "STU" || tips.Content}}${online.fixSpecChar(tips.Content)}{{else}}\u6709\u673a\u4f1a\u4eab\u53d7\uff08\u66f4\u591a\u7684\u884c\u674e\u6258\u8fd0\u91cd\u91cf\uff09{{/if}}\'},template:\'#jmp_text\'}}">{{if tips.Type === "WifiGift"}}<i>\u9001</i><span class="ico-tag-wifi"></span>{{else tips.Type === "ZuChe"}}<i>\u8d60</i><span class="ico-tag-drive"></span>{{else tips.Type === "TicketGift"}}<i>\u8d60</i><span class="ico-tag-drive"></span>{{else tips.Type === "Gift"}}\u793c{{else tips.Type === "MULTI"}}{{if f.DisplayDiscountIcon}}<img src="//pic.c-ctrip.com/fltcommon/gift-icon/ico-sales.png" class="tag tag-img"> {{/if}}<span class="inner-tips">${tips.Text}</span>{{else}}${tips.Text}{{/if}}${f.Is24Refund?"24H\u7279\u60e0\u9000":""}</span>{{/if}}{{if i+1 < tMax}} {{/if}}{{/each}}{{/if}}{{if f.CarRental && f.CarRental.RentalID}} <img src="//pic.c-ctrip.com/fltcommon/icons/ico_flt_car.png" class="tag tag-img" data-role=\'jmp\' data-params="{options: {showArrow:false,css:{minWidth:\'375\'},type:\'jmp_text\',classNames:{boxType:\'jmp_title\'},template:\'#carRental_jmp\',url:\'../AjaxRequest/CarRent/Service.ashx?RentalID=${f.CarRental.RentalID}\'}}" />{{/if}}{{if f.PickCarRental && f.PickCarRental.RentalID}} <span class="ico_reduce" data-role="jmp" data-params="{options:{type:\'jmp_text\',css: { maxWidth:\'375\'},showArrow: false,classNames:{boxType:\'jmp_title\'},template:\'#carRental_jmp\',url:\'../AjaxRequest/CarRent/Service.ashx?RentalID=${f.PickCarRental.RentalID}\'}}"><i class="ico"></i>\u51cf<dfn>&yen;</dfn>200</span>{{/if}}{{if f.GiftList && f.GiftList.length>0}}{{each(i,v) f.GiftList}}{{if (v.GiftIDList && v.GiftIDList.length > 0) && ["default.png","default-l.png"].indexOf(v.IconName) === -1}}' + giftClassTmpl + '{{/if}}{{/each}}{{/if}}${online.generateGiftTagHtml(f)}{{/if}}</div> <div class="seat-type ${online.getClassNameIfDiffClass(f, showDec)}">{{if f.ClassName}}${f.IgnoreTheClassName?"\u706b\u8f66":f.ClassName}{{else}}{{if f.ClassInfo}}${online.getClassInfo(f.ClassInfo, showDec)}{{else}} {{/if}}{{/if}}{{if f.GiftList && f.GiftList.length>0 }}{{each(i,v) f.GiftList}}{{if (v.GiftIDList && v.GiftIDList.length > 0) && ["default.png","default-l.png"].indexOf(v.IconName) != -1}}<img class="tag tag_gift_img" src="//pic.c-ctrip.com/fltcommon/icons/default-l.png" data-role=\'jmp\' data-params="{options: {showArrow:false,css:{minWidth:\'375\'},type:\'jmp_text\',classNames:{boxType:\'tooltip\',tipContent:\'tooltip-content\'},template:\'#gift_list_tmpl\',api:{onBeforeShow:function(obj){online.getGiftInfo.call(this,obj,\'${v.GiftIDList.join()}\');}}}}" />{{/if}}{{/each}}{{/if}}</div> <div class="seat-info">{{if pageGlobal.IsOpenRebookRefundDisplayChange === 1}}{{if f.RebookRefund && f.RebookRefund.HighLight}}{{if (isRoundTrip === 1 || f.IsSotoFlight) && f.RebookRefund.HighLight.length == 2}}<div class="seat-round"' + TGQTmpl + '><span class="tag-text"><i class="tag-go">\u53bb</i>${f.RebookRefund.HighLight[0] || "' + refundRebookSpanText + '"}</span><span class="tag-text"><i class="tag-back">\u8fd4</i>${f.RebookRefund.HighLight[1] || "' + refundRebookSpanText + '"}</span></div>{{else}}<span class="tag-text"' + TGQTmpl + '>${f.RebookRefund.HighLight[0] || "' + refundRebookSpanText + '"}</span>{{/if}}{{else}}<span class="tag-text"' + TGQTmpl + ">" + refundRebookSpanText + '</span>{{/if}}{{else}}{{if pageGlobal.RefundRebookHighLightSwitch === 1}}{{if isRoundTrip === 1 || f.IsSotoFlight}}<div class="seat-round"' + TGQTmpl + '><span class="tag-text"><i class="tag-go">\u53bb</i>${(f.RebookRefund && f.RebookRefund.HighLight && f.RebookRefund.HighLight[0]) || "' + refundRebookSpanText + '"}</span><span class="tag-text"><i class="tag-back">\u8fd4</i>${(f.RebookRefund && f.RebookRefund.HighLight && f.RebookRefund.HighLight[1]) || "' + refundRebookSpanText + '"}</span>{{if showDec && f.Declaration}}<i class="tag-limit">\u9650</i>{{/if}}</div>{{else}}<span class="tag-text"' + TGQTmpl + '>${(f.RebookRefund && f.RebookRefund.HighLight && f.RebookRefund.HighLight[0]) || "' + refundRebookSpanText + '"}{{if showDec && f.Declaration}}<i class="tag-limit">\u9650</i>{{/if}}</span>{{/if}}{{else}}{{if !f.RebookRefund && showDec === 0}}&nbsp;{{else}}{{if f.RebookRefund || f.Declaration}}<span class="tag-text"' + TGQTmpl + ">" + refundRebookSpanText + '</span>{{else}}&nbsp;{{/if}}{{/if}}{{/if}}{{/if}}{{if f.InvoiceTypes.indexOf("E")>=0 }} <span class="tag-invoice" style="cursor:default;" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:500,minWidth:310},content:{\'txt1\':\'<div class=invoice-img><img src=http://pages.ctrip.com/flight/invoice/invoice_small.png alt=\u5883\u5916\u7535\u5b50\u51ed\u8bc1></div>\'},template:\'#jmp_text\'}}">${f.EInvoiceText}</span>{{else}}{{if f.InvoiceTypes.indexOf("F")>=0 }} <span class="tag-invoice" style="cursor:default;">${f.EInvoiceText}</span>{{else f.InvoiceTypes.indexOf("T")>=0 }} <span class="tag-invoice" style="cursor:default;">${f.EInvoiceText}</span>{{/if}}{{/if}}</div> <div class="seat-price" SeatPriceTag="T" {{if f.StandardPriceFare}}IsStandardPrice="T"{{/if}} {{if pageGlobal.IsShowSensitiveData}}SortIndicate="${f.SortCost}"{{/if}} {{if f.ComparePriceInfo}}PriceAttributeCombineCode="${f.ComparePriceInfo.PriceAttributeCombineCode}" DisCountPrice="${f.ComparePriceInfo.DisCountPrice}"{{/if}}><div><div class="mb5" {{if f.TravelInsureExtend && f.TravelInsureExtend.hasSelectedTravelInsurePre}} style="display:none;" {{/if}}><span class="tag-discount">{{if f.IsCASpecialDiscount && pageGlobal.CAPCDiscountShow}}<span class="preferential_tag" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>\u9884\u8ba2\u6b64\u822a\u7a7a\u516c\u53f8\u7279\u60e0\u4ea7\u54c1\uff0c\u6bcf\u4f4d\u4e58\u673a\u4eba\u5df2\u4eab\u53d7\u7acb\u51cf${f.DiscountPrice}\u5143\u7684\u7279\u60e0\u3002\u5982\u9700\u9000\u8ba2\uff0c${f.DiscountPrice}\u5143\u7acb\u51cf\u91d1\u989d\u4e0d\u9000\uff1b\u5982\u9700\u6539\u671f\uff0c\u9700\u8865\u9f50${f.DiscountPrice}\u5143\u7acb\u51cf\u91d1\u989d\uff0c\u66f4\u6539\u540e\u822a\u73ed\u4e0d\u53ef\u518d\u4eab\u53d7\u7acb\u51cf\u7279\u60e0\u3002</p>\'},template:\'#jmp_text\'}}"><img src="//pic.c-ctrip.com/fltcommon/icons/preferential_ca.png" class="tag tag_gift_img"></span>{{/if}}{{if f.IsCASpecialInvite && pageGlobal.CASpecialInvite}}<span class="preferential_tag ca_special_invite" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>${pageGlobal.CASpecialInviteHoverTip}</p>\'},template:\'#jmp_text\'}}"><img src="//pic.c-ctrip.com/fltcommon/icons/guest_ca.png" class="tag tag_gift_img"></span>{{/if}}{{if f.IsMUSpecialInvite && pageGlobal.MUSpecialInvite }}<span class="tag tag_fare_info mu_special_invite" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>${pageGlobal.MUSpecialInviteHoverTip}</p>\'},template:\'#jmp_text\'}}" {{if !pageGlobal.MUSpecialInviteHoverTip}} style="cursor: initial"{{/if}}>${pageGlobal.MUSpecialInviteTag}</span>{{/if}}{{if f.Coupon}} <span class="tag{{if f.Coupon.Text}}-verb{{/if}}" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:500,minWidth:200},type:\'jmp_title\',classNames:{boxType:\'tooltip-combine\'},template:\'#jmp_title\',content:{\'txt1\':\'${online.fixSpecChar(f.Coupon.Content)}\'}}}">{{if f.Coupon.Text}}<i>\u8fd4\u73b0</i><dfn>&yen;</dfn>${f.Coupon.Text}{{else}}\u8fd4{{/if}}</span>{{/if}}{{if f.DiscountPrice && pageGlobal.CAPCDiscountShow && f.IsCASpecialDiscount}} <span class="tag-verb no-ico" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>\u9884\u8ba2\u6b64\u822a\u7a7a\u516c\u53f8\u7279\u60e0\u4ea7\u54c1\uff0c\u6bcf\u4f4d\u4e58\u673a\u4eba\u4e0b\u5355\u65f6\u53ef\u4eab\u53d7<span class=price><dfn>&yen;</dfn>${f.DiscountPrice}</span>\u4f18\u60e0\u3002<br>\u5982\u9700\u9000\u8ba2\uff0c<span class=price><dfn>&yen;</dfn>${f.DiscountPrice}</span>\u7279\u60e0\u6d3b\u52a8\u5dee\u989d\u4e0d\u9000\uff1b<br>\u5982\u9700\u6539\u7b7e\uff0c\u9700\u8865\u9f50<span class=price><dfn>&yen;</dfn>${f.DiscountPrice}</span>\u7279\u60e0\u6d3b\u52a8\u5dee\u989d\uff0c\u66f4\u6539\u540e\u822a\u73ed\u4e0d\u518d\u4eab\u53d7\u6b64\u4f18\u60e0\u3002</p>\'},template:\'#jmp_text\'}}">\u4e0b\u5355\u518d\u964d<dfn>&yen;</dfn>${f.DiscountPrice}</span>{{/if}}{{ if pageGlobal.IsOpenMUFareTagSwitch && f.MUFareInfo }}<span class="${f.MUFareInfo.TagClassName||\'tag tag_fare_info\'}" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>${f.MUFareInfo.Hover}</p>\'},template:\'#jmp_text\'}}" {{if !f.MUFareInfo.Hover}} style="cursor: initial"{{/if}}>${f.MUFareInfo.Tag}</span>{{/if}}${online.generateUpgradeClassRecommendTag(fareList,fareIndex,curType,flightWay,flightType,curSegment)}{{if f.IsShowHKCarShipFree && f.HKCarShipFreeList && f.HKCarShipFreeList.length}}{{if curSegment<1 && f.HKCarShipFreeList[0].SegmentNo == 1}}<span class="tag tag-hk" data-freeType="${f.HKCarShipFreeList[0].CarShipType}" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltipbox\',tipContent:\'tooltip\'},css:{maxWidth:480,minWidth:260},content:{\'txt1\':\'${f.HKCarShipListResultFreeHover}\'},template:\'#jmp_text\'}}"><i>\u8d60</i>${f.HKCarShipFreeList[0].CarShipTag}</span>{{else}}{{if isLastSegment && ( f.HKCarShipFreeList.length == 1 && f.HKCarShipFreeList[0].SegmentNo == 1 || f.HKCarShipFreeList[1] && f.HKCarShipFreeList[1].SegmentNo == 2)}}<span class="tag tag-hk" data-freeType="${f.HKCarShipFreeList.length == 1 ? f.HKCarShipFreeList[0].CarShipType : f.HKCarShipFreeList[1].CarShipType}" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltipbox\',tipContent:\'tooltip\'},css:{maxWidth:480,minWidth:260},content:{\'txt1\':\'${f.HKCarShipListResultFreeHover}\'},template:\'#jmp_text\'}}"><i>\u8d60</i>${f.HKCarShipFreeList.length == 1 ? f.HKCarShipFreeList[0].CarShipTag : f.HKCarShipFreeList[1].CarShipTag}</span>{{/if}}{{/if}}{{/if}}{{if (isRoundTrip === 1 && f.PickUpTagNOR) || f.PickUpList && f.PickUpList.length > 1 && ((curSegment<1 && f.PickUpList && f.PickUpList[0] && f.PickUpList[0].PickUpType===3218) || (isLastSegment && f.PickUpList && ((f.PickUpList[0] && f.PickUpList[0].PickUpType===3217) || (f.PickUpList[1] && f.PickUpList[1].PickUpType===3217)))) || f.PickUpList && f.PickUpList.length && f.PickUpList.length < 2}}<span class="tag-transfer pickup-tag" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:500,minWidth:200},type:\'jmp_title\',classNames:{boxType:\'tooltip-combine\'},template:\'#jmp_title\',content:{\'txt1\':\'${online.fixSpecChar(f.PickUpTagNOR.Content)}\'}}}">${f.PickUpTagNOR.Text}</span>{{/if}}{{if f.AddtionShow && f.IsNew3X}}' + tongYongQuan + '{{/if}}</span> {{if f.FreeInsure}}	        <span class="tag-discount  spanFreeInsure">		        <div class="seat"><i class="ico-flt"></i>\u673a\u7968</div >		        <i class="ico-plus">+</i>		        <div class="insurance"><i class="ico-fltinsurance"></i><span class="abbr" style="color:#333;"  data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:350},template:\'#jmp_text\',content:{txt1:\' <div class=popup-coupon-rule><div class=popup-coupon-rule-title><div class=title>${f.FreeInsure.Name}</div></div><div class=popup-coupon-rule-detail><p class=title>\u4fdd\u9669\u8bf4\u660e</p>${f.FreeInsure.Desc}{{if f.FreeInsure.StipulationUrl}}<p>\u70b9\u51fb\u4e0b\u8f7d: <a target=\\\'_blank\\\' href=\\\'${f.FreeInsure.StipulationUrl}\\\'>\u4fdd\u9669\u6761\u6b3e</a></p>{{/if}}</div></div> \'}}}">${f.FreeInsure.Name}</span>&nbsp;<span class="tag" style="cursor:auto;">\u8d60\u9001</span></div>	        </span>        {{/if}}{{if f.ChildPrice || (pageGlobal.MultiPassengerTypeSwitch && f.InfPrice)}}<span data-role="jmp" data-params="{options:{type: \'jmp_text\', css: { minWidth: ${flightWay==\'S\'?300:330},maxWidth:360}, showArrow: false, template:\'#tip-tmpl-showPriceInfo\', classNames:{boxType:\'tooltip-tmpl\', tipContent:\'tooltip-combine\'}, content:{\'txt1\':\'\'},api:{onBeforeShow:function(obj){online.getPriceInfo.call(this,obj,${f.AdultPrice || 0},${f.ChildPrice || 0},${f.InfPrice || 0},${f.AdultTax || 0},${f.ChildTax || 0},${f.InfTax || 0} );}}   }}"  class="price{{if f[curType] == lowPrice}} price2{{/if}} prompt{{if f.AddtionShow===2}} J_AddtionPrice{{/if}}"><dfn>&yen;</dfn>${f[curType]}</span>{{else}}<span class="price{{if f[curType] == lowPrice}} price2{{/if}}{{if f.AddtionShow===2}} J_AddtionPrice{{/if}}"><dfn>&yen;</dfn>${f[curType]}</span>{{/if}}<span class="price-tax2">{{if f.Tax < 0}}\u672a\u542b\u7a0e\u8d39<span></span>{{else}}{{if curType == "Price"}}\u7a0e\u8d39 {{if typeof f.ChildTax !== "undefined" || (pageGlobal.MultiPassengerTypeSwitch && f.InfTax !== "undefined")}}<span><dfn>&yen;</dfn>${f.Tax}</span>{{else}}<span><dfn>&yen;</dfn>${f.Tax + f.OilFee}</span>{{/if}}{{/if}}{{/if}}</span></div></div>{{if f.TravelInsureExtend && f.TravelInsureExtend.price && f.TravelInsureExtend.price > 0}}<div>					<span class="tag-discount">		                {{if f.DiscountPrice}}<span class="preferential_tag" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip\'},css:{maxWidth:400,minWidth:400},content:{\'txt1\':\'<p>\u9884\u8ba2\u6b64\u822a\u7a7a\u516c\u53f8\u7279\u60e0\u4ea7\u54c1\uff0c\u6bcf\u4f4d\u4e58\u673a\u4eba\u5df2\u4eab\u53d7\u7acb\u51cf${f.DiscountPrice}\u5143\u7684\u7279\u60e0\u3002\u5982\u9700\u9000\u8ba2\uff0c${f.DiscountPrice}\u5143\u7acb\u51cf\u91d1\u989d\u4e0d\u9000\uff1b\u5982\u9700\u6539\u671f\uff0c\u9700\u8865\u9f50${f.DiscountPrice}\u5143\u7acb\u51cf\u91d1\u989d\uff0c\u66f4\u6539\u540e\u822a\u73ed\u4e0d\u53ef\u518d\u4eab\u53d7\u7acb\u51cf\u7279\u60e0\u3002</p>\'},template:\'#jmp_text\'}}"><img src="//pic.c-ctrip.com/fltcommon/icons/preferential_ca.png" class="tag tag_gift_img"></span>{{/if}}                        {{if f.Coupon}} <span class="tag{{if f.Coupon.Text}}-verb{{/if}}" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:500,minWidth:200},type:\'jmp_title\',classNames:{boxType:\'tooltip-combine\'},template:\'#jmp_title\',content:{\'txt1\':\'${online.fixSpecChar(f.Coupon.Content)}\'}}}">{{if f.Coupon.Text}}<i>\u8fd4\u73b0</i><dfn>&yen;</dfn>${f.Coupon.Text}{{else}}\u8fd4{{/if}}</span>{{/if}}						{{if (!f.DiscountPrice && !f.Coupon)}}                            <span class="tag-green" data-role="jmp" data-params="						    {							    options:							    {								    type: \'jmp_text\',								    css: { maxWidth:\'320\'},								    showArrow: false,								    template:\'#tip-tmpl-simple\',								    classNames:{boxType:\'tooltip-tmpl insurance-tip\',tipContent:\'tooltip\'},								    content:{\'txt1\':\'${f.TravelInsureExtend.ins.Rule}\'}							    }						    }">\u591a\u91cd\u4fdd\u969c</span>                        {{/if}}					</span>					<span class="price2"><dfn>\xa5</dfn>${f.TravelInsureExtend.price}</span>                    <span class="price-tax2">                    {{if f.Tax < 0}}	                    \u672a\u542b\u7a0e\u8d39<span></span>                    {{else}}	                    {{if curType == "Price"}}		                    \u7a0e\u8d39 		                    {{if typeof f.ChildTax !== "undefined" }}			                    <span class="prompt" data-role="jmp" data-params="{options:{type: \'jmp_text\', css: { minWidth:240,maxWidth:360}, showArrow: false, template:\'#tip-tmpl-showPriceInfo\', classNames:{boxType:\'tooltip-tmpl\', tipContent:\'tooltip-combine\'}, content:{\'txt1\':\'\'},api:{onBeforeShow:function(obj){online.getPriceInfo.call(this,obj,${(f.AdultTax || 0) + (f.AdultOilFee || 0)},${(f.ChildTax || 0) + (f.ChildOilFee || 0)},0,0,\'tax\');}}}}"><dfn>&yen;</dfn>${f.Tax}</span>		                    {{else}}			                    <span><dfn>&yen;</dfn>${f.Tax + f.OilFee}</span>		                    {{/if}}	                    {{/if}}                    {{/if}}                    </span>			</div>{{/if}}</div><div class="seat-bonus">{{if f.FreeInsure}}	    <div class="package-price">		    <div class="package-info">			    \u673a\u7968+<span class="price">\u4fdd\u9669</span>\u603b\u4ef7		    </div>	    </div>    {{/if}}{{if f.AddtionShow && f.IsNew3X}}        <div class="package-price  package-recommend J_package_price divNew3XProductName" style="position:relative;cursor: help;" data-fid="${f.FID}"  data-role="jmp" data-params="{options: {api:{onShow:function(){  window.pageGlobal.NewUbt.HoverTime.xproduct=(window.pageGlobal.NewUbt.HoverTime.xproduct||0)+1;   }},showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:450,minWidth:20},content:{\'txt1\':\'${f.New3XDetailHTML}\'},template:\'#jmp_text\'}}">	        {{if f.addtionSelectedNum>0}}		        <i class="plus">+</i>		        <div class="package-info{{if f.addtionSelectedNum>1}} package-info-mid{{/if}}">		        <span class="price"><dfn>&yen;</dfn>${f.totalAddtionPrice}</span>		        ${f.selectedName}		        </div>	        {{else}}		        <div class="package-info package-info-mid" style="position:relative;">${f.selectedName}</div>	        {{/if}}        </div>    {{/if}}{{if f.AddtionShow && !f.IsNew3X}}{{if f.Cache3X}}{{if addtionTmplVar.Cache3X.addtionIdList && addtionTmplVar.Cache3X.addtionIdList.length>0}}<div class="package-price J_package_price"><i class="plus">+</i><div class="package-info{{if addtionTmplVar.Cache3X.addtionIdList.length>1}} package-info-mid{{/if}}"><span class="price"><dfn>&yen;</dfn>${addtionTmplVar.Cache3X.totalAddtionPrice}</span>${addtionTmplVar.Cache3X.selectedName}</div></div>{{/if}}{{else}}<div class="package-price J_package_price">{{if f.addtionSelectedNum>0}}<i class="plus">+</i><div class="package-info{{if f.addtionSelectedNum>1}} package-info-mid{{/if}}"><span class="price"><dfn>&yen;</dfn>${f.totalAddtionPrice}</span>${f.selectedName}</div>{{else}}<div class="package-info package-info-mid">${f.selectedName}</div>{{/if}}<i class="icon-caret-b{{if f.AddShowDetail}}up{{/if}} J_select_addtion" data-category="${f.PlanCategory}" data-rel="${f.FID}" data-ubt-key="ChooseX"></i></div>{{/if}}{{/if}}{{if !f.AddtionShow || !f.IsNew3X}}' + tongYongQuan + '{{/if}}{{if f.TravelInsureExtend && f.TravelInsureExtend.price && f.TravelInsureExtend.price > 0}}         <div class="package-price"  {{if (f.TravelInsureExtend && f.TravelInsureExtend.hasSelectedTravelInsurePre) || (((isRoundTrip === 1 && f.PickUpTagBUP) || (curSegment<1 && f.PickUpList && f.PickUpList[0] && f.PickUpList[0].PickUpType===3218) || (isLastSegment && f.PickUpList && ((f.PickUpList[0] && f.PickUpList[0].PickUpType===3217) || (f.PickUpList[1] && f.PickUpList[1].PickUpType===3217)))) || (f.isWiFiCopy)) }} style="display:none;" {{/if}}>&nbsp;</div>	    <div class="package-price" style="position:relative;">		<i class="plus">+</i>		<div class="package-info help" data-role="jmp" data-params="            {            options:            {                type: \'jmp_text\',                css: { maxWidth:\'320\'},                showArrow: false,                template:\'#tip-tmpl-simple\',                classNames:{boxType:\'tooltip-tmpl insurance-tip\',tipContent:\'tooltip\'},                content:{\'txt1\':\'${f.TravelInsureExtend.ins.Rule}\'}            }            }">			<span class="price"><dfn>\xa5</dfn>${f.TravelInsureExtend.insurePrice}</span>${f.TravelInsureExtend.ins.ProductShortName}			<span class="summary-tip">${f.TravelInsureExtend.ins.Description}</span>		</div>	</div>{{/if}}{{if f.AddtionShow && f.IsNew3X}}<div class="package-price package-bare"><span class="package-info">${f.New3XInfo.QuickBookTipTpl}</span></div>{{/if}}</div><div class="seat-action"> <div class="${f.AddtionShow && f.IsNew3X ? "pb10":"mb5"}" {{if f.TravelInsureExtend && f.TravelInsureExtend.hasSelectedTravelInsurePre}} style="display:none;" {{/if}}>' + orderBtnTmpl + '</div>    {{if f.TravelInsureExtend && f.TravelInsureExtend.price && f.TravelInsureExtend.price > 0}}<!--.\u65c5\u884c\u9669\u524d\u7f6e..-->        <div>            <button xx="${lowPrice}" yy="${f[curType]}" {{if f[curType] == lowPrice}} data-lowprice="1"{{/if}}{{if f.AddtionShow}} data-fid="${f.FID}"{{/if}}  data-category="${f.PlanCategory}" {{if f.IsSuperFlyer}} data-isSuperFlyer="isSuperFlyer" {{/if}} class="btn-book J_SRBooking" type="button"{{if flightWay === "S" || isLastSegment}} data-booking="1" {{else}} data-ubt-key="FreeCombine_Check" key="${Key}"{{/if}} pkey="${f.pkey}" token="${f.Parameter}" data-TravelInsurePre="${f.TravelInsureExtend.jsonStr}">${isLastSegment?"\u9884\u8ba2":"\u9009\u5b9a"}</button>{{if f.SuccRate}}<span class="success-text" data-role="jmp" data-params="{options:{type:\'jmp_text\',css:{maxWidth:330,minWidth:330},api:{onShow:function(obj){online.SuccRate.call(this,obj)}},showArrow:false,template:\'#jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},content:{\'txt1\':\'&lt;div class=&quot;pop-success&quot;&gt;&lt;table class=&quot;table_success_text&quot;&gt;&lt;tr class=&quot;tr_line&quot;&gt;&lt;th&gt;\u6210\u529f\u7387&lt;/th&gt;&lt;td&gt;${f.SuccRate}%\u6210\u529f\u7387\u4fdd\u8bc1\u7533\u8bf7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;\u7533\u8bf7\u8bf4\u660e&lt;/th&gt;&lt;td&gt;\u60a8\u9009\u8d2d\u7684\u673a\u7968\u9700\u5355\u72ec\u5411\u822a\u7a7a\u516c\u53f8\u7533\u8bf7\uff0c \u4e00\u65e6\u7533\u8bf7\u6210\u529f\u77ed\u4fe1\u901a\u77e5\u60a8\uff0c\u4ec5\u9650\u4fe1\u7528\u5361\u652f\u4ed8\u3002&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\'}}}"><b></b>${f.SuccRate}<em></em></span><div class="confirm-time">1\u5c0f\u65f6\u5185\u786e\u8ba4</div>{{else}}{{if (isRoundTrip === 0 && f.TicketLack) || (isRoundTrip === 1 && f.RoundTripTicketLack)}}<span class="seat-only">${(isRoundTrip === 1 ? f.RoundTripTicketLack : f.TicketLack)}</span>{{/if}}{{/if}}{{if f.TransMultiPUInfo}}' + multiPUBookingTagText + '{{/if}}        </div>    {{/if}}{{if f.AddtionShow && f.IsNew3X}}<div class="dashline"></div><div style="padding-top: 6px">' + orderBtnTmpl2 + '</div>{{/if}}</div>{{if f.IsOWIntelligenceRec}}<div class="more-flt"><i class="ico-buckle"></i><i class="contain">\u542b</i><div class="flt-cities"><span class="txt">\u7b2c\u4e8c\u7a0b\uff1a</span><span class="city">${online.getOWIntelligenceRec2ndPopHeaderWrapper(f).dCityName} \u2014 ${online.getOWIntelligenceRec2ndPopHeaderWrapper(f).aCityName}</span></div><div class="flt-date">${online.getOWIntelligenceRec2ndPopHeaderWrapper(f).dDate}\u51fa\u53d1</div><div class="flt-hover ow-intellignece-rec-detail" data-info="${encodeURIComponent(JSON.stringify(online.getOWIntelligenceRecPopHeaderWrapperOf(f,1)))}" data-role="jmp" data-params="{options: {showArrow:false,type:\'jmp_text\',classNames:{boxType:\'tooltip-tmpl\',tipContent:\'tooltip\'},css:{maxWidth:700},content:{header: \'${online.getOWIntelligenceRec2ndPopHeader(f)}\',body:\'${online.getOWIntelligenceRec2ndPopBody(f)}\'},template:\'#OWIntelligenceRecFlightInfoPop\'}}">\u822a\u73ed\u8be6\u60c5/\u5165\u5883\u987b\u77e5</div></div>{{/if}}</div>{{if f.AddtionShow && !f.Cache3X}}<div id="${f.aid}"{{if !f.AddShowDetail}} style="display:none;"{{/if}}>{{if f.AddShowDetail}}{{tmpl addtionTmplVar.addtionTmpl, {addtionTmplVar:addtionTmplVar,f:f,flightWay:flightWay,curType:curType,lowPrice:lowPrice,isLastSegment:isLastSegment,isRoundTrip:isRoundTrip,Key:Key} }}{{/if}}</div>{{/if}}',
    matrixTmpl = '<a href="javascript:void(0);" class="flight-mx-close"></a><div class="flights-mx-main"><div class="flights-mx-data"><div class="mx-data-wrapper">{{each (I, v) matrix}}{{if I > 0}}<ul class="mx-column"><li data-index="0" class="mx-cell{{if v.hasValue}} hasValue{{/if}}{{if v.name && v.name !== "ALL"}} mx-airline" data-value="${(v[0] || v[1] || v[2]).OwnerAirlineName}"><img height="16" alt="${(v[0] || v[1] || v[2]).OwnerAirlineName}" src="//pic.c-ctrip.com/flight_intl/airline_logo/40x35/${(v[0] || v[1] || v[2]).OwnerAirline}.png?v=1"><p>${(v[0] || v[1] || v[2]).OwnerAirlineName}</p>{{else}} mx-airline">{{/if}}</li>{{each (i, j) [0,1,2]}}{{if matrix[0][i]}}{{if v.name}}<li class="mx-cell{{if v[i] && !v[i].FlightDayMemo}} hasValue{{/if}}" data-index="${i+1}" data-value="${(v[0] || v[1] || v[2]).OwnerAirlineName}">{{if i===0 && v[0].FlightDayMemo}}<span class="tag-text" data-role="jmp" data-params="{options: {showArrow:false,css:{maxWidth:320,minWidth:300},type:\'jmp_title\',classNames:{boxType:\'jmp_title\'},template:\'#jmp_title\',content:{\'txt1\':\'${v[0].FlightDayMemo}\'}}}">\u76f4\u98de\u73ed\u671f</span>{{else}}{{if v[i]}}<span class="{{if v[i][curType] === matrix[0][i][curType]}}best-{{/if}}price">{{if v[i][curType] !== 99999999 }}<dfn>&yen;</dfn>${v[i][curType]}</span>{{/if}}{{/if}}{{/if}}</li>{{else}}<li class="mx-cell" data-index="${i+1}"></li>{{/if}}{{/if}}{{/each}}</ul>{{/if}}{{/each}}</div></div></div><a href="javascript:void(0);" class="flight-mx-prev"> &lt;</a><a href="javascript:void(0);" class="flight-mx-next"> &gt;</a><div class="flights-mx-side"><ul class="mx-label"><li class="mx-cell" data-index="0" data-all="true"></li>{{if matrix[0][0]}}<li class="mx-cell{{if matrix[0][0].hasValue}} hasValue{{/if}}" data-index="1" data-all="true">\u76f4\u98de</li>{{/if}}{{if matrix[0][1]}}<li class="mx-cell{{if matrix[0][1].hasValue}} hasValue{{/if}}" data-index="2" data-all="true">1\u7a0b\u4e2d\u8f6c</li>{{/if}}{{if matrix[0][2]}}<li class="mx-cell{{if matrix[0][2].hasValue}} hasValue{{/if}}" data-index="3" data-all="true">2\u7a0b\u4e2d\u8f6c</li>{{/if}}</ul></div>',
    recommendTmpl = '<div class="prev_date" id="prevDate"><a class="rec-prev arrow_left_disable" href="javascript:void(0)" rel="nofollow" data-ubt-key="ChangeDate_Left"><b></b></a></div><div class="cal_box" ><ul class="calendar_ul clearfix" style="width:2000%;">{{each (i, v) d}}<li {{if v.current}} class="current" style="z-index:0;" {{/if}}><a class="searchDate" href="javascript:void(0);" data-time="${v.DepartureDate}" data-grade="${v.ClassGrade}" data-ubt-key="ChangeDate${i%7+1}"><span class="calendar_date">${v.dateStr}</span>{{if v["Sales"+curType]>0}}{{if (v["Sales"+curType]&&v["Sales"+curType]<999999)}}<span class="base_price02"><dfn>&yen;</dfn> ${v["Sales"+curType]}</span>{{/if}}{{else}}<span>\u70b9\u51fb\u67e5\u8be2</span>{{/if}}{{/if}}</a></li>{{/each}}</ul></div><div class="next_date" id="nextDate"><a class="rec-next arrow_right" href="javascript:void(0)" rel="nofollow" data-ubt-key="ChangeDate_Right"><b></b></a></div><div class="panel_link"><a class="days90" href="javascript:void(0)" data-ubt-key=""lowPriceCalendar></a></div>',
    calendarTmpl = '<div class="f16"><strong>\u8bf7\u9009\u62e9\u51fa\u884c\u65e5\u671f</strong></div> <div class="bd_box mt10"> <div class="calendar_panel"> <div class="prev_month"><a data-ubt-key="LowestPrice_UP" href="javascript:void(0);" class="top_arrow"></a><div><span class="year">2014\u5e74</span><br /><span class="month">5\u6708</span></div></div> <div class="next_month"><div class="mb5"><span class="year">2014\u5e74</span><br /><span class="month">6\u6708</span></div><a data-ubt-key="LowestPrice_Down" href="javascript:void(0);" class="bottom_arrow"></a></div> <div class="panel"> <table cellpadding="0" cellspacing="0" border="1" width="100%"> <thead> <tr> <th width="72" class="weekend">SUN \u65e5</th> <th width="72">MON \u4e00</th> <th width="72">TUE \u4e8c</th> <th width="72">WED \u4e09</th> <th width="72">THU \u56db</th> <th width="72">FRI \u4e94</th> <th class="weekend">SAT \u516d</th> </tr> </thead> <tbody class="tbContent">${tcontent}</tbody> </table> <div class="base_txtgray mt5">\u56e0\u7968\u4ef7\u53d8\u52a8\u9891\u7e41\uff0c\u8bf7\u4ee5\u5b9e\u65f6\u67e5\u8be2\u62a5\u4ef7\u4e3a\u51c6\u3002</div> </div> </div> </div> <a data-ubt-key="LowestPrice_Close" href="javascript:void(0);" class="close">&times;</a>',
    RecCheapTmpl = '<div class="rec_cheap mr" {{if noRelevantFlt}} style="margin-right:0;"{{/if}}>{{if d && d.length>0}}<div class="hd">{{if noRelevantFlt}} {{else}}<h4>\u90bb\u8fd1\u65e5\u671f</h4><p>${title}</p>{{/if}}</div><div class="bd"><ul class="rec_chp_list">{{each (i, v) d}}<li data-ubt-key="LowestTickets" data-index="${v.index+1}" class="{{if ((v.index+1) % 5) == 0}} end {{/if}} lowerPri" data-time="${v.DepartureDate}" data-dcity="${v.DCity}" data-acity="${v.ACity}" data-grade="${v.ClassGrade}"><a href="javascript:void(0);">		<span class="fst">${title}</span><span class="mid">${v.dateStr}</span><span class="lst"><b class="ship_lv">${v.grade}</b><dfn>&yen;</dfn><strong class="pri">${v["Sales"+curType]}</strong></span></a></li>{{/each}}</ul></div>{{/if}}</div>',
    RelevantFltTmpl = '<div class="rec_cheap"><div class="hd"><h4>\u90bb\u8fd1\u822a\u7ebf</h4><p>${title}</p></div><div class="bd"><ul class="rec_chp_list">{{each (i, v) d}}{{if v["Sales"+curType] > 0}}<li data-ubt-key="NearAirline" data-index="${v.index+1}" class="{{if ((v.index+1) % 5) == 0}} end {{/if}} relationAir" data-time="${v.DepartureDate}" data-dcity="${v.DCity}" data-acity="${v.ACity}" data-grade="${v.ClassGrade}"><a href="javascript:void(0);"><span class="fst">${v.dateStr}</span><span class="mid">${v.DCityName} - ${v.ACityName}</span><span class="lst"><b class="ship_lv">${v.grade}</b><dfn>&yen;</dfn><strong class="pri">${v["Sales"+curType]}</strong></span></a></li>{{/if}}{{/each}}</ul></div></div>',
    recFltBoxTmpl = '<div class="rec-tit"><i class="ico-recomm">\u8350</i><h4>\u90bb\u8fd1\u822a\u7ebf\u63a8\u8350</h4></div><div class="rec-fromto"><div class="depart" title="${DCityName}">${DCityName}${DDistanceTip}</div><div class="arrow"></div><div class="arrive" title="${ACityName}">${ACityName}${ADistanceTip}</div></div>{{if FlightDuration && FlightDuration != 9999999}}<div class="flight-total-time" title="\u98de\u884c\u603b\u65f6\u957f:${online.getFlightTime(FlightDuration, 1)}" PainExponent="${PainExponent}">&nbsp;${online.getFlightTime(FlightDuration)}</div>{{else}}<div class="rec-date">${dateStr}</div>{{/if}}<div class="rec-price"><dfn>&yen;</dfn><strong>${price}</strong></div>{{if save<999999}}<div class="rec-discount">{{if curType=="TotalPrice"}}\u8282\u7701<span class="price"><dfn>&yen;</dfn>${save}</span>{{/if}}</div>{{else}}<div class="rec-discount"></div>{{/if}}<div class="rec-action"><button class="btn-book" type="button" data-time="${DepartureDate}" data-dcity="${DCity}" data-acity="${ACity}" data-grade="${ClassGrade}" data-ubt-key="CheaperLine_Detail">\u67e5\u770b</button></div>',
    CreateNearDateRecommendTmpl = function() {
        if (! (this instanceof CreateNearDateRecommendTmpl)) return new CreateNearDateRecommendTmpl;
        var a = '        {{each (index, item) data}}        <div class="fdc-item">            <div class="fdc-trips">                <div class="fdc-trip"><span data-dyear=${item.DepartYear}>${item.DepartureDate}</span><span>${item.DateOfWeek}</span>{{if item.HasDirect}}<i class="tag-fd-orange"></i>{{/if}}</div>            </div>            {{if isShowBtn}} <a href="javascript:;" class="check-btn">\u67e5\u770b</a> {{/if}}        </div>        {{/each}}',
        b = '        <div class="pre-btn"><i class="ico-pre"></i></div>        <div class="next-btn"><i class="ico-next"></i></div>',
        c = '        {{each (index, item) data}}        <div class="fdc-item">            <div class="fdc-trips">                <div class="fdc-trip"><span data-dyear=${item.DepartYear}>${item.DepartureDate}</span><span>${item.DateOfWeek}</span><span>\u53bb</span>{{if item.HasDirect}}<i class="tag-fd-orange"></i>{{/if}}</div>                <div class="fdc-trip"><span data-ryear=${item.ReturnYear}>${item.ReturnDate}</span><span>${item.ReturnDateOfWeek}</span><span>\u8fd4</span>{{if item.ReturnHasDirect}}<i class="tag-fd-blue"></i>{{/if}}</div>            </div>            {{if isShowBtn}} <a href="javascript:;" class="check-btn">\u67e5\u770b</a> {{/if}}        </div>        {{/each}}',
        d = '	{{each (index, item) DepartList}}		<th class="date"><span>${item.DepartureDate} ${item.DateOfWeek}</span><i class="{{if item.HasDirect}} tag-fd-orange {{/if}}"></i></th>	{{/each}}',
        e = '		{{each (indexR, itemR) ReturnList}}			<tr>				<th class="date"><span>${itemR.DepartureDate} ${itemR.DateOfWeek}</span><i class="{{if itemR.HasDirect}}tag-fd-blue {{/if}}"></i></th>				{{each (indexD, itemD) DepartList}}					<td class="{{if trMatrix[indexR][indexD].className}} ${trMatrix[indexR][indexD].className} {{else}} state {{/if}} selectDirCalendar {{if defaultIndex[0] == indexR && defaultIndex[1] == indexD}} active {{/if}}" tdColIndex=${indexD} index=${trMatrix[indexR][indexD].index} daysBetween=${trMatrix[indexR][indexD].daysBetween}>						<i class="${trMatrix[indexR][indexD].directFlag}"></i><span>${trMatrix[indexR][indexD].txt}</span>					</td>				{{/each}}			</tr>		{{/each}}';
        this.nearDateRecommendOneWayTmpl = '        <div class="flight-direct-calendar {{if isShowBtn}} few-amount {{/if}} {{if isNoSlide}} no-scroll {{/if}} one-way">            {{if isShowSlideArrow}}' + b + '{{/if}}            <div class="fdc-group">                <div class="fdc-items">' + a + '</div>            </div>            <a href="javascript:;" class="fdc-btn">\u4e34\u8fd1\u65e5\u671f<br>\u76f4\u98de\u63a8\u8350</a>        </div>',
        this.nearDateRecommendRoundTripTmpl = '        <div class="flight-direct-calendar {{if isShowBtn}} few-amount {{/if}} {{if isNoSlide}} no-scroll {{/if}}">' + b + '<div class="fdc-group">                <div class="fdc-items">' + c + '</div>            </div>			<a href="javascript:;" class="fdc-btn neardate-calendar-btn" data-ubt-key="IsClickCalendar"><i class="ico-calendar"></i>\u76f4\u98de\u65e5\u5386</a>            <div class="mask" style="display: none;"></div>        </div>',
        this.calendarTmpl = '    <div class="fd-calendar-body" id="near_date_rec_container" style="display: block;">    	<a href="javascript:;" class="close-btn jq-close-calendar">			<i class="ico-close"></i>		</a>        <div class="calendar-title">			<span>${DepartureCity}</span>			<i class="ico-round"></i>			<span>${ArrivalCity}</span>		</div>        <div class="calendar-subtitle">            <span class="date"><span>\u53bb\uff1a${DepartureDate}</span><i class="{{if HasDirect}} tag-fd-orange {{/if}}"></i></span>            <span class="days">\u95f4\u9694${daysBetween}\u5929</span>            <span class="date"><span>\u8fd4\uff1a${ReturnDate}</span><i class=" {{if ReturnHasDirect}} tag-fd-blue {{/if}}"></i></span>        </div>        <div class="calendar-tbl">            <table>            <tbody><tr>	        <th>	        <div class="trip-type">	        	<span class="depart">\u53bb\u7a0b</span>	            <span class="return">\u8fd4\u7a0b</span>	        </div>	        </th>' + d + "</tr>" + e + '</tbody></table>			<div class="turn-page">				<div class="pre-week">					<i class="ico-pre-r"></i>\u524d\u4e00\u5468				</div>				<div class="next-week">					\u540e\u4e00\u5468<i class="ico-next-r"></i>				</div>			</div>        </div>        <a href="javascript:;" class="check-btn jq-search-btn">\u786e\u8ba4</a>    </div>'
    };
    online.GiftCache = {},
    online.getGiftInfoGlobalByBooking = function(a) {
        var b = {};
        b.GiftDetailList = pageGlobal.Discount.GiftList;
        for (var c = 0,
        d = b.GiftDetailList.length; d > c; c++) b.GiftDetailList[c].DescriptionHtml = "",
        b.GiftDetailList[c].DetailInfoHtml = "";
        online.getGiftInfoGlobal1.call(this, b, a)
    },
    online.getGiftInfoGlobalByReview = function(a) {
        var b = {};
        b.GiftDetailList = pageGlobal.GiftList;
        for (var c = 0,
        d = b.GiftDetailList.length; d > c; c++) b.GiftDetailList[c].DescriptionHtml = "",
        b.GiftDetailList[c].DetailInfoHtml = "";
        online.getGiftInfoGlobal1.call(this, b, a)
    },
    online.getGiftInfoGlobalByComplete = function(a) {
        var b = {};
        b.GiftDetailList = pageGlobal.GiftList;
        for (var c = 0,
        d = b.GiftDetailList.length; d > c; c++) b.GiftDetailList[c].DescriptionHtml = "",
        b.GiftDetailList[c].DetailInfoHtml = "";
        online.getGiftInfoGlobal1.call(this, b, a)
    },
    online.showGiftInfoGlobalByOrderDetail = function(a) {
        var b = online.toJson($("#hdn_detail_orderInfo").value());
        data = b.GiftList[a],
        $("#OrderDetailgiftTpl")[0] && $("#OrderDetailgiftTpl").remove();
        var c = '	<div id = "OrderDetailGiftPop" class="pop-info pop-info-gift" style="width: 580px;">			<div class="pop-hd">				<h3>\u793c\u76d2\u8bf4\u660e</h3>				<a href="javascript:;" class="delete" onclick="$(\'#OrderDetailGiftPop\').unmask();">\xd7</a>			</div>			<div class="pop-bd">				<p>${Description}</p>				<ol><li style="list-style: none;">${DetailInfo}</li></ol>				<div class="btn-outer"><a href="javascript:;" onclick="$(\'#OrderDetailGiftPop\').unmask();" class="btn btn-primary">\u5173\u95ed</a></div>			</div>	</div>',
        d = document.createElement("div");
        d.id = "OrderDetailgiftTpl",
        d.innerHTML = $.tmpl.render(c, {
            Description: data.Description,
            DetailInfo: data.DetailInfo
        }),
        d.style.display = "none",
        document.body.appendChild(d),
        $("#OrderDetailGiftPop").mask();
        var e = online.getParentsByClass(this, "tuna_jmpinfo");
        e.length && (e[0].style.visibility = "hidden")
    },
    online.getGiftInfoGlobal1 = function(a, b) {
        0 == $("#giftTplDiv").length && initGiftTpl();
        var c = this;
        setTimeout(function() {
            if (!c.elem.isAjax) {
                var d = $.uid();
                a.uid = d,
                c.data.txt1 = a,
                online.GiftCache[d] = a;
                var e = $(b).find(".tooltip-content:eq(0)");
                $(b).find(".tooltip-content:eq(0)").css({
                    padding: "0px"
                }),
                a.GiftDetailList && 1 == a.GiftDetailList.length && $(b).find(".tooltip:eq(0)").css({
                    padding: "0px"
                }),
                e.html($.tmpl.render($("#gift_list_tmpl").html(), {
                    txt1: a
                })),
                c.elem.isAjax = !0;
                try {
                    b._calcPos()
                } catch(f) {}
            }
        },
        100)
    },
    online.getGiftInfo = function(a, b) {
        if (b && !this.elem.isAjax) {
            var c = "AjaxRequest/UI2_0/GetGifts.ashx?GiftID=" + b;
            $("#giftTplDiv").length < 1 && initGiftTpl(),
            $.ajax(online.getBaseUrl(c), {
                cache: !0,
                async: !0,
                onsuccess: function(b, c) {
                    if (c = $.parseJSON(c), !(c && c.GiftDetailList && c.GiftDetailList.length > 0)) return this._hide(),
                    this.disable(),
                    void(this.elem.isAjax = !0);
                    var d = $(document).getMod("jmp", online.registerMod.version.jmp);
                    if (d && d.method("getTip", this.elem)) {
                        var e = d.method("getTip", this.elem),
                        f = $(a).find(".tooltip-content:eq(0)"),
                        g = $.uid();
                        if (e.data) {
                            c.uid = g,
                            1 == c.GiftDetailList.length && c.GiftDetailList[0].DescriptionHtml && "-100" != c.GiftDetailList[0].GiftID && "-98" != c.GiftDetailList[0].GiftID && ($(a).css("width", ""), $(a).css("maxWidth", "422px")),
                            c.GiftDetailList.each(function(a) {
                                a.DescriptionHtml && (a.DescriptionHtml = a.DescriptionHtml.replace(/\\/g, "")),
                                a.DetailInfoHtml && (a.DetailInfoHtml = a.DetailInfoHtml.replace(/\\/g, ""))
                            }),
                            online.GiftCache[g] = c,
                            e.data.txt1 = c,
                            f.css({
                                padding: "0px"
                            }),
                            f.html($.tmpl.render($("#gift_list_tmpl").html(), {
                                txt1: c
                            })),
                            this.elem.isAjax = !0;
                            try {
                                e._calcPos()
                            } catch(h) {}
                        }
                    }
                }.bind(this),
                onerror: function() {
                    this._hide(),
                    this.disable()
                }.bind(this)
            })
        }
    },
    online.showGiftInfoBox = function(a) {
        var b = online.GiftCache[a];
        $("#pop_bd_ClassName").removeClass("box_gift_detail"),
        $("#pop_bd_ClassName").removeClass("box_gift_tab");
        var c = "";
        if (1 == b.GiftDetailList.length) $("#pop_bd_ClassName").addClass("box_gift_detail"),
        c = $.tmpl.render($("#gift_single").html(), {
            d: b
        });
        else {
            if (! (b.GiftDetailList.length > 1)) return;
            $("#pop_bd_ClassName").addClass("box_gift_tab"),
            c = $.tmpl.render($("#gift_multi").html(), {
                d: b
            })
        }
        if ($("#pop_bd_ClassName").find(".gift_content").html(c), b.GiftDetailList.length > 1) {
            var d = $(".gift_content").find(".item"),
            e = $(".gift_content").find(".item_con");
            d.each(function(a, b) {
                a.bind("click",
                function() {
                    $(this).hasClass("cur") || (d.removeClass("cur"), e.slideUp(), $(this).addClass("cur"), $(this).find(".item_con").slideDown())
                })
            }),
            d.first().addClass("cur"),
            d.first().find(".item_con").css("display", "block")
        }
        $("#gift_pop").mask();
        var f = online.getParentsByClass(this, "tuna_jmpinfo");
        f.length && (f[0].style.visibility = "hidden")
    },
    online.emsTipContent = function(a, b, c) {
        var d = [];
        if (a && a.nl) {
            for (var e = a.nl.length,
            f = 0; e > f; f++) {
                var g = "",
                h = a.nl[f];
                if (h.co) {
                    if (h.f && b < new Date(h.f).getTime()) continue;
                    if (h.t && b > new Date(h.t).getTime()) continue;
                    if (h.la && h.la.length > 0) for (var i = 0,
                    j = h.la.length; j > i; i++) {
                        var k = h.la[i]; (k.p || k.c || k.d) && (k.d ? -1 !== c.indexOf(k.d) && (g = h.co) : k.c ? -1 !== c.indexOf(k.c) && (g = h.co) : k.p && -1 !== c.indexOf(k.p) && (g = h.co))
                    } else g = h.co;
                    "" != g && d.push(g)
                }
            }
            var l = d.length;
            if (l > 1) for (var m = 0; l > m; m++) d[m] = m + 1 + "." + d[m]
        }
        return d.join("<br/>")
    },
    online.bulletinBoardTips = function(a) {
        var b = [];
        if (a && a.NoticeDetailList) for (var c = a.NoticeDetailList.length,
        d = 0; c > d; d++) {
            var e = "",
            f = a.NoticeDetailList[d];
            e = f.Content,
            "" != e && b.push(e)
        }
        var g = b.length;
        if (g > 1) for (var h = 0; g > h; h++) b[h] = h + 1 + "." + b[h];
        return b.join("<br/>")
    },
    online.create("service.HotCountry.HotCountryService", {
        methods: {
            initialize: function(a) {
                this.info(),
                this.extend(this, a),
                this.dateTimeElementId = "#hotCountryDDate";
                try {
                    this.$DatePicker = jQuery.createRangeDatePicker(this.dateTimeElementId,
                    function() {})
                } catch(b) {}
                this.THEMES = {
                    "\u514d\u7b7e/\u843d\u5730\u7b7e": "MianQianLuoDiQian"
                },
                this.COUNTRY_FROM_FILTER = "1",
                this.COUNTRY_FROM_SUGGETION = "3";
                var c = this;
                $("#hotCountrySearchBtn").bind("click",
                function(a) {
                    a.stop(),
                    c.submit()
                }),
                this.showed = !1,
                this.$hotCountryTips = $("#hot_country_tips"),
                this.countrySource = "0"
            },
            hideTips: function() {
                this.$hotCountryTips.hide()
            },
            showTips: function() {
                this.$hotCountryTips.show()
            },
            submit: function() {
                if (this.validate()) {
                    var a = this.$DCity.value(),
                    b = this.$ACity.value(),
                    c = this.$DatePicker.data;
                    "ONEWAY" == this.tripType && (c.maxDays = -1, c.minDays = -1),
                    c.destCityName = b,
                    c.travelType = this.tripType,
                    c.inputDepartureCityName = this._parseCityName(a),
                    c.inputDepartureCity = this._parseCityCode(a),
                    this.THEMES[b] ? (c.inputArrivalCities = {
                        themes: [this.THEMES[b]],
                        cities: [],
                        areas: []
                    },
                    c.inputArrivalCitiesMap = {
                        themes: [b],
                        cities: [],
                        areas: [],
                        filter: {}
                    }) : (c.inputArrivalCities = {
                        themes: [],
                        cities: [],
                        areas: [b]
                    },
                    c.inputArrivalCitiesMap = {
                        themes: [],
                        cities: [],
                        areas: [b],
                        filter: {}
                    });
                    var d = this.$DatePicker.$picker.data("datePicker");
                    c.departStringDate = d.$input.val();
                    var e = "//flights.ctrip.com/fuzzy/";
                    this.countrySource == this.COUNTRY_FROM_FILTER ? e += "#ctm_ref=fli_hp_sb_findlprice_t": this.countrySource == this.COUNTRY_FROM_SUGGETION && (e += "#ctm_ref=fli_hp_sb_findlprice_b");
                    var f = encodeURIComponent($.stringifyJSON(c)),
                    g = "flt_hotcountry_" + +new Date,
                    h = '<form id="' + g + '" action="' + e + '" method="post">';
                    return h += '<input type="hidden" name="searchRequestModel" value="' + f + '" />',
                    h += "</form>",
                    $("#hot_country_form").html(h),
                    $("#" + g)[0].submit(),
                    !1
                }
            },
            validate: function() {
                var a = this.$DCity.value(),
                b = this.$ACity.value(),
                c = this.$DatePicker.$picker.data("datePicker"),
                d = c.$input.val();
                return a ? b ? d ? this.checkIsMappingHotCountryPair() : (online.registerMod.validate($(this.dateTimeElementId), "\u8bf7\u9009\u62e9\u51fa\u53d1\u65e5\u671f"), !1) : (online.registerMod.validate(this.$ACity, "\u8bf7\u9009\u62e9\u5230\u8fbe\u57ce\u5e02"), !1) : (online.registerMod.validate(this.$DCity, "\u8bf7\u9009\u62e9\u51fa\u53d1\u57ce\u5e02"), !1)
            },
            checkIsMappingHotCountryPair: function() {
                var a = this.$DCity.value(),
                b = this.$ACity.value(),
                c = this._parseCityCode(a),
                d = window.HotCountries.getMappingHotCountry(c);
                if (window.HotCountries._contains(d, b)) return this.$hotCountryTips.hide(),
                !0;
                var e = this._parseCityName(a);
                return $("#hot_country_tips_content").html("\u6682\u4e0d\u652f\u6301\u641c\u7d22" + e + "\u98de\u5f80" + b + "\uff0c\u8bf7\u66f4\u6362\u51fa\u53d1\u6216\u5230\u8fbe\u5730\u70b9"),
                this.$hotCountryTips.show(),
                !1
            },
            _parseCityName: function(a) {
                if (a) {
                    var b = a.lastIndexOf("(");
                    if ( - 1 != b) return a.substring(0, b)
                }
                return ""
            },
            _parseCityCode: function(a) {
                if (a) {
                    var b = a.lastIndexOf("("),
                    c = a.lastIndexOf(")");
                    if ( - 1 != b && -1 != c) return a.substring(b + 1, c)
                }
                return ""
            },
            searchTypeChanged: function(a) {
                var b = this.tripType;
                "S" == a ? (this.tripType = "ONEWAY", this._switchDateTimePickerMode()) : "D" == a ? (this.tripType = "ROUNDTRIP", this._switchDateTimePickerMode()) : this.tripType = "",
                this.onChangeFlightWay && this.onChangeFlightWay(a),
                b && this.tripType && this.showed && b != this.tripType && this.uploadUbt()
            },
            _switchDateTimePickerMode: function() {
                if (this.$DatePicker && this.$DatePicker.$picker) {
                    var a = this.$DatePicker.$picker.data("datePicker");
                    if (a) {
                        var b = a.$input.val(),
                        c = "";
                        if ("ONEWAY" === this.tripType) {
                            c = a.range ? b.split(" ")[0] + " \u51fa\u53d1": "\u4efb\u4f55\u65f6\u95f4",
                            a.$input.val(b + " \u51fa\u53d1");
                            var d = a.mode.indexOf("_acc"); - 1 != d && a.switchMode(a.mode.substring(0, d))
                        } else if ("ROUNDTRIP" === this.tripType) {
                            c = b.split(" ")[0] + a.valLen();
                            var d = a.mode.indexOf("_acc"); - 1 == d && a.switchMode(a.mode + "_acc")
                        }
                        a.$input.val(c)
                    }
                }
            },
            updateCountrySource: function(a) {
                "suggestionMousedown" == a ? this.countrySource = this.COUNTRY_FROM_SUGGETION: this.countrySource = this.COUNTRY_FROM_FILTER
            },
            uploadUbt: function() {
                try {
                    if (!this.$DatePicker || !this.$DatePicker.$picker) return;
                    var a = this.$DatePicker.$picker.data("datePicker"),
                    b = {
                        content: {
                            searchway: this.countrySource,
                            flightway: "ONEWAY" == this.tripType ? "S": "D",
                            from: this._parseCityName(this.$DCity.value()),
                            to: this.$ACity.value(),
                            searchdate: a.$input.val()
                        }
                    };
                    window.__bfi.push(["_tracklog", "c_hotsearch", $.stringifyJSON(b)])
                } catch(c) {}
            }
        }
    });
    var msg = online.msg,
    w = window;
    "array" != $.type(pageGlobal.NewUbt.RecommendProduct) && (pageGlobal.NewUbt.RecommendProduct = []),
    function() {
        for (var a = [[], [], []], b = condition.SegmentList, c = 0; c < b.length; c++) a[0].push(b[c].DCity),
        a[1].push(b[c].ACity),
        a[2].push(b[c].DepartDate);
        var d = $.tmpl.render("UID=${uid}&FlightWay=${flightWay}&from=${from}&to=${to}&DepartDate=${departDate}", {
            uid: pageGlobal.Ubt.UID,
            flightWay: condition.FlightWay || "S",
            from: a[0].join(","),
            to: a[1].join(","),
            departDate: a[2].join(",")
        });
        window.__bfi.push(["_tracklog", "fltintl.searchhistory", d]),
        pageGlobal.NewUbt && (pageGlobal.NewUbt.TriggerType = "Load", window.__bfi.push(["_tracklog", "flt_oversea_search_result_online_basic", $.stringifyJSON(pageGlobal.NewUbt)]), pageGlobal.NewUbt.LowPrice = {
            Days90LowestPrice: -4,
            SearchRealLowestPrice: -4,
            RecommendLowestPrice: -4
        })
    } (),
    $(w).bind("scroll",
    function() {
        var a = document.documentElement.scrollTop || document.body.scrollTop;
        if (a >= 173 && !$(".search-form-wrapper").hasClass("fixed") && "M" !== $("#selflightType").value() ? $(".search-form-wrapper").addClass("fixed") : 172 >= a ? $(".search-form-wrapper").removeClass("fixed") : pageGlobal.ShowTopCalBtn && ($("#J_TopCalendar").length > 0 && "none" === $("#J_TopCalendar").css("display") ? $(".search-form-wrapper .panel_link").css("display", a >= 300 ? "block": "none") : $("#J_TopCalendar").length > 0 && "block" === $("#J_TopCalendar").css("display") && $(".search-form-wrapper .panel_link").css("display", a >= 654 ? "block": "none")), $.browser.isIE6) {
            var b = Math.max(document.documentElement.clientWidth, document.documentElement.scrollWidth, document.body.clientWidth, document.body.scrollWidth),
            c = "position:absolute;z-index:999;left:0px;top: " + a + "px;width:" + b + "px";
            a >= 173 && "M" !== $("#selflightType").value() ? $("#search_form")[0].style.cssText = c: 172 >= a && ($("#search_form")[0].style.cssText = "")
        }
    }),
    $('a[href="#freeStyle"]').bind("mousedown",
    function(a) {
        $(a.target).attr("data-ubt-key", "FreeCombine")
    }),
    $(".wx-qr-code .btn-close").bind("click",
    function() {
        $(".wx-qr-code.close").css("display", "block"),
        $(".wx-qr-code.open").css("display", "none")
    }),
    $(".wx-qr-code.close").bind("click",
    function() {
        $(".wx-qr-code.open").css("display", "block"),
        $(".wx-qr-code.close").css("display", "none")
    }),
    $("#gotop2").bind("click",
    function() {
        $(".search-form-wrapper .panel_link").css("display", "none")
    }),
    $("#ADate").bind("blur",
    function() {
        "yyyy-mm-dd" != this.value && "" != this.value ? $("#selflightType").value("D") : $("#selflightType").value("S"),
        $("#selflightType").trigger("change")
    }),
    $("#aChangeCity").bind("click",
    function(a) {
        try {
            a.stop()
        } catch(a) {}
        online.exchangeCity($("#homeCity"), $("#destCity"))
    }),
    online.SuccRate = function(a) {
        var b = $(a),
        c = $(this.elem),
        d = b.offset().width,
        e = c.offset().width,
        f = b.offset().left,
        g = f - d / 2 + e + 8;
        b.css("display", "none"),
        setTimeout(function() {
            b.css({
                display: "block",
                left: g + "px"
            })
        },
        60)
    },
    online.noResCompen = function(a, b) {
        if (! (a && a.loadFinish && a.curSegment < 1 && a.runTimes < 1 && a.flightList.length < 1)) return - 1;
        var c = {
            S: ticketRecommendService,
            D: lowReturnRecommendService
        } [b],
        d = document.createElement("div");
        switch (d.id = "J_BomRecommend", d.style.cssText = "display:none", $(d).insertBefore($("#segmentList")), b) {
        case "S":
            d.className = "rec_cheap_box",
            d.innerHTML = '<div id="lowerFlt"></div><div id="relevantFlt"></div>';
            break;
        case "D":
            d.className = "recommend_flight"
        }
        if (c && c.renderBomRec()) {
            var e = pageGlobal.NewUbt.Norecom || (pageGlobal.NewUbt.Norecom = {}),
            f = (c.RCPData || []).length,
            g = (c.NRBData || []).length;
            if (0 == f && 0 == g) return delete pageGlobal.NewUbt.Norecom,
            0;
            if (f > 0 && g > 0 ? (e.type = "3", e.count = [f, g].join(";")) : f > 0 && 0 == g ? (e.type = "1", e.count = [f].join()) : 0 == f && g > 0 && (e.type = "2", e.count = [g].join()), $("#J_noResultTips").length < 1) {
                var h = document.createElement("div");
                h.id = "J_noResultTips",
                h.innerHTML = '<div class="noresult-notice"><i class="icon-warn"></i><h2 class="notice-title" style="margin:12px 0 0 0;">\u5f53\u65e5\u65e0\u822a\u73ed\uff0c\u4e3a\u60a8\u63a8\u8350\u5982\u4e0b\u89e3\u51b3\u65b9\u6848</h2></div>',
                $(h).insertBefore($("#J_BomRecommend"))
            }
            switch (b) {
            case "S":
                $("#J_BomRecommend .rec_cheap").css("width", "587px"),
                $("#J_BomRecommend .rec_chp_list").css("width", "auto");
                break;
            case "D":
                $("#J_BomRecommend .recommend_box").css("width", "565px")
            }
            return 1
        }
        return 0
    },
    online.SwitchClassGrade = function(a) {
        if (a = a.toUpperCase(), !pageGlobal.CombineClassSwitch) return a;
        for (var b = ["Y_S", "C_F"], c = b.length; c--;) if ( - 1 != b[c].indexOf(a)) return b[c]
    };
    var hotCountryService = online.$c("service.HotCountry.HotCountryService", {
        $DCity: $("#homeCity"),
        $ACity: $("#destCity"),
        $DatePicker: null,
        onChangeFlightWay: function(a) {
            if (window.HotCountries && window.HotCountries.onChangeFlightWay(a), "S" == a || "D" == a) {
                if (hotCountryService.showed && !hotCountryService.checkIsMappingHotCountryPair()) return $("#destCity").getMod("address_poi", "2.0").method("select", ""),
                void showOrHideElementForHotCountry(!1);
                showOrHideElementForHotCountry(hotCountryService.showed)
            } else $("#hotCountrySearchBtn").hide(),
            $("#btnSearch").show(),
            $("#search-options-more").show();
            hotCountryService.hideTips()
        }
    });
    $("#selflightType").bind("change",
    function(a) {
        var b = $(this).value(),
        c = $(this).parentNode().find(".dropdown-status"),
        d = $(".search-roundtrip-wrapper").find(".form-group:eq(4)"),
        e = $("#ADate"),
        f = $("#DDate"),
        g = {
            S: "\u5355\u7a0b",
            D: "\u5f80\u8fd4",
            M: "\u591a\u7a0b"
        };
        switch (c.text(g[b]), b) {
        case "S":
            d.addClass("form-disabled"),
            e.value(""),
            f.attr("mod_calendar_focusNext", "ADate");
            break;
        case "D":
            d.removeClass("form-disabled"),
            f.attr("mod_calendar_focusNext", "ADate~ADate");
            var h = f.value();
            if (h.isDate()) {
                var i = online.registerMod.searchBoxVals,
                j = "flightintl_backdate_single";
                i[j] && i[j].isDate() && i[j].toDate() >= h.toDate() ? e.value(i[j]) : delete i[j]
            }
            break;
        case "M":
            $("#search_form").addClass("search-multidest");
            var k, l = $("#homeCity").value(),
            m = $("#homeCity").attr("mod_change_value") || "",
            n = $("#destCity").attr("mod_change_value") || ""; - 1 != l.indexOf("\u53ca\u5468\u8fb9\u57ce\u5e02") && (k = m.split("|"), k[3] = k[3].substring(0, 3), k[1] = k[1].replace(/\u53ca\u5468\u8fb9\u57ce\u5e02/g, "") + "(" + k[3] + ")", m = k.join("|"), l = k[1]),
            $("#homeCity_1").value(l),
            $("#homeCity_1").attr("mod_change_value", m),
            $("#homeCityID_1").value($("#homeCityID").value()),
            l = $("#destCity").value(),
            -1 == l.indexOf("(") && -1 == l.indexOf("|") && (l = "", n = ""),
            -1 != l.indexOf("\u53ca\u5468\u8fb9\u57ce\u5e02") && (k = n.split("|"), k[3] = k[3].substring(0, 3), k[1] = k[1].replace(/\u53ca\u5468\u8fb9\u57ce\u5e02/g, "") + "(" + k[3] + ")", n = k.join("|"), l = k[1]),
            $("#destCity_1").value(l),
            $("#destCity_1").attr("mod_change_value", n),
            $("#destCityID_1").value($("#destCityID").value()),
            $("#DDate_1").value($("#DDate").value()),
            $("#DDate_2").data("minDate", $("#DDate").value()),
            online.clearNotice($("#homeCity_1")),
            online.clearNotice($("#destCity_1")),
            online.clearNotice($("#DDate_1")),
            setTimeout(function() {
                condition.SegmentList.each(function(a, b) {
                    var c, d = b + 1,
                    e = $("#homeCity_" + d);
                    "M" != condition.FlightWay && b > 0 || e && (c = $("#" + e.attr("mod_address_date")), e.getMod("address_poi", "2.0").method("select", a.DCity), c && c.getMod("calendar", "6.0").method("setWeek"))
                })
            },
            100),
            $("#search-options-more").find(".search-airlines").hide(),
            $("#transferRecomm").hide(),
            $("#seniorSearch").hide(),
            $("#seniorSearchArea").hide()
        }
        "M" != b && ($("#search-options-more").find(".search-airlines").show(), online.clearNotice(e), online.registerMod.searchBoxVals.multipleRound = b, $("#search_form").removeClass("search-multidest"), $("#seniorSearch").length > 0 && $("#seniorSearch")[0].opened ? ($("#seniorSearch").show(), $("#seniorSearchArea").show()) : $("#seniorSearch").show(), $("#transferRecomm").show()),
        hotCountryService.searchTypeChanged(b)
    }),
    $("#drpPassengerType").bind("change",
    function() {
        "ADT" == $(this).value() ? ($(this).parentNode().find(".dropdown-status").text("\u6210\u4eba"), $("#dropdownTip").hide()) : "CHD" == $(this).value() && ($(this).parentNode().find(".dropdown-status").text("\u513f\u7ae5(2 ~ 12 \u5c81)"), $("#dropdownTip").show())
    }),
    $("#Quantity").bind("change",
    function() {
        $(this).parentNode().find(".dropdown-status").text($(this).value())
    });
    var ClassType = {
        Y: "\u7ecf\u6d4e\u8231",
        S: "\u8d85\u7ea7\u7ecf\u6d4e\u8231",
        C: "\u516c\u52a1\u8231",
        F: "\u5934\u7b49\u8231"
    },
    fillValue = function(a, b) {
        a.length < 1 || (a.value(b), a.trigger("change"))
    };
    pageGlobal.CombineClassSwitch && (ClassType = {
        Y_S: "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231",
        C_F: "\u516c\u52a1/\u5934\u7b49\u8231",
        C: "\u516c\u52a1\u8231",
        Y: "\u7ecf\u6d4e\u8231",
        S: "\u8d85\u7ea7\u7ecf\u6d4e\u8231",
        F: "\u5934\u7b49\u8231"
    }),
    $("#drpSubClass").bind("change",
    function() {
        var a = $(this).parentNode().find(".dropdown-status"),
        b = $(this).value();
        a.text(ClassType[b] || "\u7ecf\u6d4e/\u8d85\u7ea7\u7ecf\u6d4e\u8231")
    }),
    $("#seniorSearch").bind("click",
    function(a) {
        a.stop(),
        this.opened = !this.opened,
        $("#seniorSearchArea").slideToggle("fast"),
        $(this).find(".icon-caret").toggleClass("icon-caret-up")
    }),
    $("#transferDuration").bind("change",
    function() {
        var a = $(this).parentNode().find(".dropdown-status");
        a.text($(this).find("option:selected").html())
    }),
    $("#btnSearch2").bind("click",
    function() {
        var a = $("#transferCity2");
        return a.value().trim().length < 1 ? void online.registerMod.validate(a, "\u8bf7\u9009\u62e9\u4e2d\u8f6c\u57ce\u5e02") : ($("#seniorSearch").length > 0 && !$("#seniorSearch")[0].opened && $("#seniorSearch").trigger("click"), $("#transferCity").value(a.value()), $("#transferCityID").value($("#transferCityID2").value()), $("#transferCity").removeClass("inputSel"), void $("#btnSearch")[0].click())
    }),
    online.$c("util.Multipass", {
        target: $("#flight_multiple"),
        addTarget: $("#add_new_line"),
        needEffect: !1,
        min: 2,
        template: '	<div class="flight-block" online_multipass_index="${index-1}">	  <span class="multidest-count online_number">${index}</span>	  <div class="form-group">		<label>${i18n.startCity}		 <input type="text" class="input-text" id="homeCity_${index}" mod_address_hide="7" mod_address_date="DDate_${index}" mod_address_focusnext="destCity_${index}"  mod_change_id="destCity_${index-1}" name="txtBeginAddress${index}" mod="notice|address" mod_notice_tip="\u4e2d\u6587/\u62fc\u97f3/\u82f1\u6587" mod_address_tpl="address" mod_address_source="{{if index==1}}start{{else}}dest{{/if}}" mod_address_reference="homeCityID_${index}"/><input type="hidden" id="homeCityID_${index}" name="txtBeginCityCode${index}"/>		</label>	  </div>	  <div class="form-group">		<label>${i18n.endCity}		   <input type="text" class="input-text" id="destCity_${index}" mod_address_hide="7" mod_next_value="homeCity_${index+1}" mod_address_focusnext="DDate_${index}" name="txtEndAddress${index}" mod="notice|address" mod_notice_tip="\u4e2d\u6587/\u62fc\u97f3/\u82f1\u6587" mod_address_tpl="address" mod_address_source="dest" mod_address_reference="destCityID_${index}"/><input type="hidden" id="destCityID_${index}" name="txtEndCityCode${index}"/>		</label>	  </div>	  <div class="form-group">		<label>\u51fa\u53d1\u65e5\u671f		  <input type="text" class="input-text" id="DDate_${index}" autocomplete="off" name="txtDatePeriod${index}" data-ubt-key="DDate" mod="notice|calendar" mod_notice_tip="yyyy-mm-dd" mod_calendar_focusnext="DDate_${index+1}" mod_calendar_reference="DDate_${index-1}"/>		</label>	  </div> 	<a href="javascript:void(0);" class="flight-remove del_line" style="{{if index<=2}}display:none{{/if}}" data-ubt-key="DeleteSequence"></a>	</div>	'
    }),
    function(a, b) {
        var c, d = [],
        e = document.createElement("div");
        for (var f in a) if (a.hasOwnProperty(f)) for (var g = 0; b > g; g++) c = g + 1,
        d.push('<input type="hidden" id="' + f + c + '" value="' + a[f] + c + '" />');
        e.style.display = "none",
        e.innerHTML = d.join(""),
        document.body.appendChild(e)
    } ({
        hdn_showflt_ddate: "DDate_",
        hdn_showflt_dcity: "homeCity_",
        hdn_showflt_acity: "destCity_"
    },
    6);
    var validateService = online.$c("service.public.ValidateService", {
        single: {
            txtDCity: $("#homeCity")[0],
            dest_city_1: $("#destCity")[0],
            txtDDatePeriod1: $("#DDate")[0],
            txtADatePeriod1: $("#ADate")[0]
        },
        showWait: !1,
        mult: ["#hdn_showflt_ddate", "#hdn_showflt_dcity", "#hdn_showflt_acity"],
        msg: online.msg,
        drpFlightWay: $("#selflightType")
    });
    if (w.validateQuery = function() {
        var a = validateService.getValidate() && online.validateMultiQuantity({
            isResult: !0
        }),
        b = $("#selflightType").value().trim();
        return a && (("M" === b || $("#seniorSearch").length > 0 && !$("#seniorSearch")[0].opened) && ($("#transferCity").value(""), fillValue($("#transferDuration"), "1")), window.__POINORESULT && (pageGlobal.NewUbt.POISearch = window.__POINORESULT, window.__POINORESULT = null)),
        a
    },
    condition && condition.FlightWay && condition.SegmentList) {
        var segmentList = condition.SegmentList,
        selflightType = $("#selflightType"),
        dCity,
        aCity,
        NewResultPage;
        "M" !== condition.FlightWay && (NewResultPage = online.$c("service.NewResult.Page", {
            curTime: new Date(segmentList[0].DepartDate.replace(/-/g, "/")),
            minTime: window.NSTime || (new Date).toDate(),
            maxTime: "D" === condition.FlightWay ? new Date(segmentList[1].DepartDate.replace(/-/g, "/")).toDate() : null
        })),
        selflightType.value(condition.FlightWay),
        setTimeout(function() {
            selflightType.trigger("change")
        },
        150),
        dCity = segmentList[0].DCity.split("|"),
        aCity = segmentList[0].ACity.split("|"),
        dCity[1].indexOf("\u706b\u8f66\u7ad9") >= 0 ? $("#departCity").html(segmentList[0].DCityName) : $("#departCity").html(dCity[1].replace(/\([a-z]+\)/gi, "")),
        aCity[1].indexOf("\u706b\u8f66\u7ad9") >= 0 ? $("#arrivalCity").html(segmentList[0].ACityName) : $("#arrivalCity").html(aCity[1].replace(/\([a-z]+\)/gi, "")),
        $("#departDate").html(online.showTime(segmentList[0].DepartDate, "M\u6708d\u65e5")),
        "D" === condition.FlightWay && $("#arrivalDate").html("\u8fd4 " + online.showTime(segmentList[1].DepartDate, "M\u6708d\u65e5"));
        var dDate = online.showTime(segmentList[0].DepartDate, "yyyy-MM-dd");
        $("#DDate").value(dDate),
        online.registerMod.searchBoxVals.flightintl_startdate_single = dDate,
        dDate.toDate() < new Date && (dDate = (new Date).toStdDateString()),
        $("#ADate").data("minDate", dDate),
        $("#DDate").getMod("calendar", "6.0").method("setWeek"),
        online.clearNotice($("#DDate")),
        setTimeout(function() {
            var a = ["#homeCity", "#destCity"];
            $(a[0]).getMod("address_poi", "2.0").method("select", segmentList[0].DCity),
            $(a[1]).getMod("address_poi", "2.0").method("select", segmentList[0].ACity),
            online.clearNotice($(a[0])),
            online.clearNotice($(a[1]))
        },
        100);
        var searchData = [segmentList[0].DCity, segmentList[0].ACity, online.showTime(segmentList[0].DepartDate, "yyyy-MM-dd")];
        if ("S" == condition.FlightWay && ($("#ADate").value("yyyy-mm-dd"), $("#ADate").getMod("calendar", "6.0").method("setWeek"), online.registerMod.searchBoxVals.multipleRound = "S"), "D" == condition.FlightWay) {
            var aDate = online.showTime(segmentList[1].DepartDate, "yyyy-MM-dd");
            searchData.push(aDate),
            $("#ADate").value(aDate),
            online.registerMod.searchBoxVals.flightintl_backdate_single = aDate,
            $("#ADate").getMod("calendar", "6.0").method("setWeek"),
            online.clearNotice($("#ADate")),
            online.registerMod.searchBoxVals.multipleRound = "D"
        }
        if ("M" == condition.FlightWay) {
            if ($("#transferRecomm").hide(), $("#seniorSearch").hide(), $("#seniorSearchArea").hide(), segmentList.length > 2) for (var i = 0; i < segmentList.length - 2; i++) $("#add_new_line").click();
            searchData.push("");
            for (var index, asd = [], item, ddate, i = 0; i < segmentList.length; i++) item = segmentList[i],
            ddate = online.showTime(item.DepartDate, "yyyy-MM-dd"),
            i > 0 && asd.push([item.DCity, item.ACity, ddate]),
            dCity = item.DCity.split("|"),
            aCity = item.ACity.split("|"),
            index = i + 1,
            $("#homeCity_" + index).value(dCity[1]),
            online.clearNotice($("#homeCity_" + index)),
            $("#homeCityID_" + index).value(dCity[2]),
            $("#destCity_" + index).value(aCity[1]),
            online.clearNotice($("#destCity_" + index)),
            $("#destCityID_" + index).value(aCity[2]),
            $("#DDate_" + index).value(ddate),
            online.clearNotice($("#DDate_" + index));
            searchData.push(asd)
        }
        $.cookie.set("FlightIntl", "Search", $.stringifyJSON(searchData), {
            path: "/",
            expires: 365,
            domain: location.host.split(".").slice( - 2).join(".")
        });
        var hideAdvSearch = !0;
        if (condition.PassengerType && ($("#drpPassengerType").value(condition.PassengerType), $("#drpPassengerType").trigger("change"), hideAdvSearch = !1), condition.Quantity && ($("#Quantity").value(condition.Quantity), $("#Quantity").trigger("change"), hideAdvSearch = condition.Quantity < 2), (condition.TransferCity || condition.TransferTime >= 2) && $("#seniorSearch").length > 0 && !$("#seniorSearch")[0].opened && $("#seniorSearch").trigger("click"), condition.TransferCity && condition.TransferCityID && ($("#transferCity,#transferCity2").value(condition.TransferCity + "(" + condition.TransferCityCode + ")"), $("#transferCityID,#transferCityID2").value(condition.TransferCityID), $("#transferCity,#transferCity2").removeClass("inputSel")), condition.TransferTime && fillValue($("#transferDuration"), condition.TransferTime), $("#ChildQuantity").length > 0 && ($("#ChildQuantity").bind("change",
        function() {
            $(this).parentNode().find(".dropdown-status").text($(this).value()),
            online.validateMultiQuantity({
                isResult: !0
            })
        }), $("#InfantQuantity").bind("change",
        function() {
            $(this).parentNode().find(".dropdown-status").text($(this).value()),
            online.validateMultiQuantity({
                isResult: !0
            })
        }), condition.ChildQuantity && ($("#ChildQuantity").value(condition.ChildQuantity), $("#ChildQuantity").trigger("change")), condition.InfantQuantity && ($("#InfantQuantity").value(condition.InfantQuantity), $("#InfantQuantity").trigger("change")), $("#Quantity").bind("change",
        function() {
            online.validateMultiQuantity({
                isResult: !0
            })
        }), null == $.storage.get("popTips") && setTimeout(function() {
            var a = document.createElement("div");
            a.className = "pop-inform",
            a.id = "popTips",
            a.innerHTML = '<span class="icon arrow-up"></span>\u51c6\u786e\u9009\u62e9\u4e58\u5ba2\u4eba\u6570\uff0c\u53ef\u4eab\u76f8\u5e94\u4f18\u60e0\u3002<a href="javascript:void(0);" id = "hide-pop-inform"><b>\u77e5\u9053\u4e86</b></a>',
            a.style.position = "absolute",
            a.style.left = "52px",
            a.style.top = "36px",
            a.style.width = "255px",
            a = $(a),
            $("#fmResultPage").find(".search-traveler-types").append(a),
            $("#hide-pop-inform").bind("click",
            function() {
                try {
                    b.stop()
                } catch(b) {}
                a.remove(),
                $.storage.set("popTips", 1)
            })
        },
        150)), condition.ClassGrade) {
            var tempClassGrade = condition.ClassGrade; ("Y" == tempClassGrade || "S" == tempClassGrade) && (tempClassGrade = "Y_S"),
            $("#drpSubClass").value(tempClassGrade),
            $("#drpSubClass").trigger("change"),
            hideAdvSearch = !1
        } (condition.Airline || condition.AirlineName) && ($("#txtAirline").value(condition.AirlineName || ""), online.clearNotice($("#txtAirline")), $("#Airline").value(condition.Airline || ""), hideAdvSearch = !1),
        $("#result_advSearchBtn").length > 0 && hideAdvSearch && ($("#search-options-more").slideToggle("fast"), $("#result_advSearchBtn").find(".icon-caret").toggleClass("icon-caret-up"));
        for (var scheduleLinks = [], i = 0; i < segmentList.length; i++) {
            var d = segmentList[i].DCity.split("|"),
            a = segmentList[i].ACity.split("|");
            scheduleLinks.push({
                From: d[1].split("(")[0],
                To: a[1].split("(")[0],
                FCode: d[3].toLowerCase().substring(0, 3),
                TCode: a[3].toLowerCase().substring(0, 3)
            })
        }
        $("#lnkSchedule").html($.tmpl.render('{{each (i,v) links}}<li><a href="Schedule/${v.FCode}-${v.TCode}.html#ctm_ref=fli_sr_irl_def_t_1" target="_blank" data-ubt-key="FlightCalendar">${v.From} \u81f3 ${v.To} \u65f6\u523b\u8868</a></li>{{/each}}', {
            links: scheduleLinks
        }))
    } !
    function() {
        if (/OnlyPrice=1/i.test(location.href) || /ctm_ref=Iflt_hp_hot_fav_p/.test(location.hash) || /https?:\/\/(pages|events(\.flights)?).ctrip.com/i.test(document.referrer)) {
            var a = $.storage.get("OrderBy") || {};
            a.sortKey = "Price",
            a.orderBy = "asc",
            a.curType = "Price",
            sl = condition.SegmentList[0],
            a.id = [sl.DCityCode, sl.ACityCode].join("-"),
            $.storage.set(window.name + "OrderBy", a)
        }
    } ();
    var resultService = online.$c("service.NewResultService", {
        virtualFlightHeaderTmpl: virtualFlightHeader,
        flightBaseTmpl: flightBase,
        detailTmpl: flightDetail,
        priceTmpl: priceTmpl,
        multTmpl: multLowTmpl,
        maxSegment: condition.SegmentList.length,
        nearDateRecommendTmpl: CreateNearDateRecommendTmpl(),
        url: 1 === condition.IsAsync ? "AjaxRequest/SearchFlights/AsyncSearchResultHandler.ashx": "AjaxRequest/SearchFlights/AsyncSearchHandlerSOAII.ashx",
        pageControl: NewResultPage
    }),
    filterService = online.$c("service.NewResult.Filter", {
        resultService: resultService,
        filterList: {
            TransferCount: "StopFliter",
            OwnerAirlineName: "AirlineFliter",
            Alliance: "AllianceFliter",
            DepartTime: "DepartureFliter",
            DDepartTime: "DepartureFliter",
            ADepartTime: "DepartureFliter",
            ArrivalTime: "ArrivalFliter",
            DArrivalTime: "ArrivalFliter",
            AArrivalTime: "ArrivalFliter",
            TransferTime: "TransitFliter",
            DurationTime: "TransitFliter",
            MatrixTimes: "MatrixTimes",
            ClearAllTimes: "ClearAllTimes",
            DPort: "AirportFliter",
            APort: "AirportFliter",
            ClassGradeFilterSection: "ClassGradeFilter"
        },
        cond: condition || {}
    }),
    ticketRecommendService = online.$c("service.NewResult.TicketRecommend", {
        resultService: resultService,
        flag: condition.RecommendedFlightSwitch || !1,
        recommendTmpl: recommendTmpl,
        recFltBoxTmpl: recFltBoxTmpl,
        calendarTmpl: calendarTmpl,
        RecCheapTmpl: RecCheapTmpl,
        RelevantFltTmpl: RelevantFltTmpl,
        condition: condition
    }),
    lowReturnRecommendService = online.$c("service.NewResult.LowReturnRecommend", {
        resultService: resultService,
        flag: pageGlobal.RecommendedFlightSwitch_2,
        flag_chp: pageGlobal.AdjacentDateSwitch
    }),
    DrecommendService = online.$c("service.NewResult.DrecommendService", {
        threshold: pageGlobal.Single2DoublePriceGate,
        resultService: resultService
    });
    if (resultService.callback = function(a) {
        "function" === $.type(a) && a(lowReturnRecommendService)
    },
    "M" === condition.FlightWay) $("#toggleMatrix").parentNode().hide();
    else var matrix = online.$c("service.NewResult.Matrix", {
        filterService: filterService,
        tmpl: matrixTmpl
    }); !
    function() {
        try {
            InternationalRecommend.handleRecommendUbt()
        } catch(e) {}
        var index = 0;
        window.flightLoader ? (window.flightLoader.on("ready",
        function(a, b, c, d, e) {
            if (0 === index) {
                for (var f = 1,
                g = a; g > f; f++) resultService.searchTokens.push(f + 1);
                resultService.searchTimes = resultService.searchTokens.length
            }
            try {
                var h = $.stringifyJSON({
                    SendIndex: b,
                    FinishIndex: c,
                    AjaxUseTime: d[d.length - 1][1],
                    AllTime: (new Date).getTime() - d[1][1],
                    AjaxTimes: d,
                    Result: e.substr(0, 40)
                });
                window.__bfi.push(["_tracklog", "flt_oversea_search_issuccess", h]),
                $.log(h)
            } catch(i) {}
            resultService.searchCallback({
                SearchIndex: 0,
                context: {
                    SearchMode: 0 === index ? "Search": "TokenSearch"
                }
            },
            e),
            index++
        }), window.flightLoader.on("error",
        function() {
            resultService.showTimeoutTips("\u5f88\u62b1\u6b49\uff0c\u7cfb\u7edf\u7e41\u5fd9\uff0c\u6b63\u5728\u8fdb\u884c\u91cd\u65b0\u641c\u7d22\uff01", 5e3)
        })) : resultService.searchFlights("Search");
        var param = {
            pageid: 1005002,
            condition: condition
        };
        $.ajax(online.getBaseUrl("AjaxRequest/Notification.ashx"), {
            method: "POST",
            context: param,
            onsuccess: function(xhr, ret) {
                if (null == ret || "" == ret || "{}" == ret) return void online.log("\u65e0\u6570\u636e");
                if (200 == xhr.status) {
                    var jsTip = eval("(" + ret + ")");
                    if (jsTip.ErrorMessage) return void online.log(jsTip.ErrorMessage);
                    var str = online.bulletinBoardTips(jsTip);
                    if (str) {
                        var div = document.createElement("div");
                        div.id = "winTips",
                        div.className = "help_term help_important",
                        div.innerHTML = '<a class="close" href="#" id="win768">\xd7</a><div class="help_block"><strong class="help_important-t">\u91cd\u8981\u516c\u544a:</strong><p>' + str + "</p></div>",
                        $("#search_form") && $(div).insertAfter($("#search_form")),
                        $("#win768").bind("click",
                        function() {
                            $("#winTips").hide()
                        })
                    }
                }
            },
            onerror: function() {}
        });
        try {
            bindHotCountryEvent(hotCountryService, showOrHideElementForHotCountry)
        } catch(e) {}
    } (),
    online.$c("service.NewResult.HistorySearch"),
    function() {
        var a = function(a) {
            var b = document.createElement("style");
            b.type = "text/css",
            b.styleSheet ? b.styleSheet.cssText = a: b.innerText = a,
            document.getElementsByTagName("head")[0].appendChild(b)
        },
        b = function(a) {
            var b = !1,
            c = !0,
            d = window.document,
            e = d.documentElement,
            f = d.addEventListener,
            g = f ? "addEventListener": "attachEvent",
            h = f ? "removeEventListener": "detachEvent",
            i = f ? "": "on",
            j = function(c) { ("readystatechange" != c.type || "complete" == d.readyState) && (("load" == c.type ? window: d)[h](i + c.type, j, !1), !b && (b = !0) && a.call(window, c.type || c))
            },
            k = function() {
                try {
                    e.doScroll("left")
                } catch(a) {
                    return void setTimeout(k, 50)
                }
                j("poll")
            };
            if ("complete" == d.readyState) a.call(window, "lazy");
            else {
                if (!f && e.doScroll) {
                    try {
                        c = !window.frameElement
                    } catch(l) {}
                    c && k()
                }
                d[g](i + "DOMContentLoaded", j, !1),
                d[g](i + "readystatechange", j, !1),
                window[g](i + "load", j, !1)
            }
        },
        c = !(!document.all || document.addEventListener),
        d = '.explorer-tips { position: relative; padding: 8px 20px 10px 48px; color: #666; font-size: 14px; background: #FFEED2; font-family: BlinkMacSystemFont, Helvetica, Arial, Tahoma, "PingFang SC","Hiragino Sans GB","Lantinghei SC","Microsoft YaHei",sans-serif; } .explorer-tips strong { color: #FF9C2D; font-size: 16px; font-weight: bold; } .explorer-tips a { color: #4394FF; border-bottom: 1px solid #4394FF; } .explorer-tips a:hover { text-decoration: none; } .icon-remind { position: absolute; left: 24px; top: 11px; width: 16px; height: 18px; background: url(//pic.c-ctrip.com/flight/index/icons/icon_remind.png) no-repeat 0 0; } /* mask */ .explorer-mask {z-index: 100; position: fixed; left: 0; top: 0; right: 0; bottom: 0; filter:progid:DXImageTransform.Microsoft.gradient(enabled="true",startColorstr="#B2000000", endColorstr="#B2000000");background:rgba(0,0,0,0.7); } /* explorer-modal */ .explorer-modal, .explorer-modal h3, .explorer-modal h4 { font-weight: normal; font-family: BlinkMacSystemFont, Helvetica, Arial, Tahoma, "PingFang SC","Hiragino Sans GB","Lantinghei SC","Microsoft YaHei",sans-serif; } .explorer-modal h2, .explorer-modal .close { overflow: hidden; line-height: 999em; } .explorer-modal { z-index: 101; position: fixed; left: 50%; top: 50%; margin: -234px 0 0 -272px; width: 543px; height: 468px; background: url(//pic.c-ctrip.com/flight/index/explorer_modal.png) no-repeat 0 0; } .explorer-modal .modal-header { height: 150px; } .explorer-modal h3 { text-align: center; color: #999; font-size: 16px; font-weight: normal; border-top: 1px solid #e7e7e7; } .explorer-modal h3 span { position: relative; top: -10px; padding: 0 20px; background: #fff; } .explorer-modal .modal-body { padding: 42px 30px 0; height: 224px; } .explorer-modal .QR-code { display: inline-block; /*_display: inline; _zoom: 1;*/ width: 132px; margin: 10px 20px 0 60px; text-align: center; color: #999; } .explorer-modal h4 { margin-top: 5px; } .explorer-modal .modal-bottom { height: 52px; line-height: 52px; color: #666; font-size: 14px; text-align: center; } .explorer-modal .link { margin-left: 15px; color: #4394FF; border-bottom: 1px solid #4394FF; } .explorer-modal .link:hover { text-decoration: none; } .explorer-modal .close { position: absolute; top: 16px; right: 16px; width: 30px; height: 30px; cursor: pointer; }',
        e = '<div class="explorer-tips"> <i class="icon-remind"></i> \u60a8\u5f53\u524d\u7684\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e\uff0c\u53ef\u80fd\u6709<strong>\u5b89\u5168\u98ce\u9669</strong>\uff0c\u60a8\u53ef\u4ee5\u624b\u673a\u4e0b\u8f7dAPP\u6216\u5347\u7ea7\u6d4f\u89c8\u5668\uff0c<a href="javascript:;">\u67e5\u770b\u8be6\u60c5</a></div>',
        f = '<div class="explorer-mask"></div>                <div class="explorer-modal">                	<div class="modal-header"><h2>\u60a8\u5f53\u524d\u7684\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e\uff0c\u53ef\u80fd\u6709<span>\u5b89\u5168\u98ce\u9669\uff01</span></h2></div>                	<div class="modal-body">                		<h3><span>\u60a8\u53ef\u4ee5\u624b\u673a\u626b\u7801\u641c\u7d22\u673a\u7968</span></h3>                		<div class="QR-box">                			<div class="QR-code"><img src="//pic.c-ctrip.com/flight/index/QR_h5.png" alt=""><h4>\u624b\u673a\u7f51\u9875\u7248</h4></div>                			<div class="QR-code"><img src="//pic.c-ctrip.com/flight/index/QR_app.png" alt=""><h4>\u643a\u7a0b\u65c5\u884cAPP</h4></div>                		</div>                	</div>                	<div class="modal-bottom">\u6216\u5347\u7ea7\u6d4f\u89c8\u5668<a href="https://www.google.com/chrome/browser/desktop/" class="link" target="_blank">\u8c37\u6b4c\u6d4f\u89c8\u5668</a><a href="http://www.firefox.com.cn/" class="link" target="_blank">\u706b\u72d0\u6d4f\u89c8\u5668</a></div>                	<div class="close">\xd7</div>              </div>';
        b(function() {
            if (c) {
                a(d),
                document.body.insertAdjacentHTML("afterbegin", e),
                document.body.insertAdjacentHTML("beforeend", f);
                var b = function(a) {
                    var b = a ? "show": "hide";
                    cQuery(".explorer-mask")[b](),
                    cQuery(".explorer-modal")[b]()
                };
                cQuery(".explorer-tips a").bind("click",
                function() {
                    b(1)
                }),
                cQuery(".explorer-modal .close").bind("click",
                function() {
                    b(0)
                })
            }
        })
    } ()
} (window.cQuery, window);